const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/browserAll-Cmc7SWhe.js","assets/webworkerAll-DeDUi0nk.js","assets/colorToUniform-DmtBy-2V.js","assets/chunk-NL6KNZEE-CNR1cGc1.js","assets/WebGPURenderer-DFktIJE2.js","assets/SharedSystems-C2wSPIMh.js","assets/WebGLRenderer-D_nHCEk9.js"])))=>i.map(i=>d[i]);
var Yc=Object.defineProperty;var Xc=(s,t,e)=>t in s?Yc(s,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):s[t]=e;var yt=(s,t,e)=>Xc(s,typeof t!="symbol"?t+"":t,e);import{w as qc,t as Kc,v as Zc,j as G,c as ne}from"./chunk-NL6KNZEE-CNR1cGc1.js";function Fo(s){return s&&s.__esModule&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s}const Lo=()=>{const s=new Map;return{on:(o,a)=>{const c=new Date().getTime().toString().slice(-8),h=Math.floor(Math.random()*1e8),l=`evt_${c}_${h}`;return s.set(l,{id:l,event:o,callback:a}),l},fire:(o,a)=>{for(const c of s.values())c.event===o&&c.callback(a)},count:()=>s.size,remove:o=>{s.delete(o)},clear:()=>s.clear()}},Qc="modulepreload",Jc=function(s){return"/canvas-games/"+s},Qn={},Ys=function(t,e,r){let n=Promise.resolve();if(e&&e.length>0){let o=function(h){return Promise.all(h.map(l=>Promise.resolve(l).then(d=>({status:"fulfilled",value:d}),d=>({status:"rejected",reason:d}))))};document.getElementsByTagName("link");const a=document.querySelector("meta[property=csp-nonce]"),c=(a==null?void 0:a.nonce)||(a==null?void 0:a.getAttribute("nonce"));n=o(e.map(h=>{if(h=Jc(h),h in Qn)return;Qn[h]=!0;const l=h.endsWith(".css"),d=l?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${h}"]${d}`))return;const f=document.createElement("link");if(f.rel=l?"stylesheet":Qc,l||(f.as="script"),f.crossOrigin="",f.href=h,c&&f.setAttribute("nonce",c),document.head.appendChild(f),l)return new Promise((u,p)=>{f.addEventListener("load",u),f.addEventListener("error",()=>p(new Error(`Unable to preload CSS for ${h}`)))})}))}function i(o){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=o,window.dispatchEvent(a),!a.defaultPrevented)throw o}return n.then(o=>{for(const a of o||[])a.status==="rejected"&&i(a.reason);return t().catch(i)})};var O=(s=>(s.Application="application",s.WebGLPipes="webgl-pipes",s.WebGLPipesAdaptor="webgl-pipes-adaptor",s.WebGLSystem="webgl-system",s.WebGPUPipes="webgpu-pipes",s.WebGPUPipesAdaptor="webgpu-pipes-adaptor",s.WebGPUSystem="webgpu-system",s.CanvasSystem="canvas-system",s.CanvasPipesAdaptor="canvas-pipes-adaptor",s.CanvasPipes="canvas-pipes",s.Asset="asset",s.LoadParser="load-parser",s.ResolveParser="resolve-parser",s.CacheParser="cache-parser",s.DetectionParser="detection-parser",s.MaskEffect="mask-effect",s.BlendMode="blend-mode",s.TextureSource="texture-source",s.Environment="environment",s.ShapeBuilder="shape-builder",s.Batcher="batcher",s))(O||{});const Jr=s=>{if(typeof s=="function"||typeof s=="object"&&s.extension){if(!s.extension)throw new Error("Extension class must have an extension object");s={...typeof s.extension!="object"?{type:s.extension}:s.extension,ref:s}}if(typeof s=="object")s={...s};else throw new Error("Invalid extension type");return typeof s.type=="string"&&(s.type=[s.type]),s},Ss=(s,t)=>Jr(s).priority??t,ut={_addHandlers:{},_removeHandlers:{},_queue:{},remove(...s){return s.map(Jr).forEach(t=>{t.type.forEach(e=>{var r,n;return(n=(r=this._removeHandlers)[e])==null?void 0:n.call(r,t)})}),this},add(...s){return s.map(Jr).forEach(t=>{t.type.forEach(e=>{var i,o;const r=this._addHandlers,n=this._queue;r[e]?(o=r[e])==null||o.call(r,t):(n[e]=n[e]||[],(i=n[e])==null||i.push(t))})}),this},handle(s,t,e){var o;const r=this._addHandlers,n=this._removeHandlers;if(r[s]||n[s])throw new Error(`Extension type ${s} already has a handler`);r[s]=t,n[s]=e;const i=this._queue;return i[s]&&((o=i[s])==null||o.forEach(a=>t(a)),delete i[s]),this},handleByMap(s,t){return this.handle(s,e=>{e.name&&(t[e.name]=e.ref)},e=>{e.name&&delete t[e.name]})},handleByNamedList(s,t,e=-1){return this.handle(s,r=>{t.findIndex(i=>i.name===r.name)>=0||(t.push({name:r.name,value:r.ref}),t.sort((i,o)=>Ss(o.value,e)-Ss(i.value,e)))},r=>{const n=t.findIndex(i=>i.name===r.name);n!==-1&&t.splice(n,1)})},handleByList(s,t,e=-1){return this.handle(s,r=>{t.includes(r.ref)||(t.push(r.ref),t.sort((n,i)=>Ss(i,e)-Ss(n,e)))},r=>{const n=t.indexOf(r.ref);n!==-1&&t.splice(n,1)})},mixin(s,...t){for(const e of t)Object.defineProperties(s.prototype,Object.getOwnPropertyDescriptors(e))}},tl={extension:{type:O.Environment,name:"browser",priority:-1},test:()=>!0,load:async()=>{await Ys(()=>import("./browserAll-Cmc7SWhe.js"),__vite__mapDeps([0,1,2,3]))}},el={extension:{type:O.Environment,name:"webworker",priority:0},test:()=>typeof self<"u"&&self.WorkerGlobalScope!==void 0,load:async()=>{await Ys(()=>import("./webworkerAll-DeDUi0nk.js"),__vite__mapDeps([1,2,3]))}};class bt{constructor(t,e,r){this._x=e||0,this._y=r||0,this._observer=t}clone(t){return new bt(t??this._observer,this._x,this._y)}set(t=0,e=t){return(this._x!==t||this._y!==e)&&(this._x=t,this._y=e,this._observer._onUpdate(this)),this}copyFrom(t){return(this._x!==t.x||this._y!==t.y)&&(this._x=t.x,this._y=t.y,this._observer._onUpdate(this)),this}copyTo(t){return t.set(this._x,this._y),t}equals(t){return t.x===this._x&&t.y===this._y}toString(){return`[pixi.js/math:ObservablePoint x=${this._x} y=${this._y} scope=${this._observer}]`}get x(){return this._x}set x(t){this._x!==t&&(this._x=t,this._observer._onUpdate(this))}get y(){return this._y}set y(t){this._y!==t&&(this._y=t,this._observer._onUpdate(this))}}var pr={exports:{}},Jn;function sl(){return Jn||(Jn=1,function(s){var t=Object.prototype.hasOwnProperty,e="~";function r(){}Object.create&&(r.prototype=Object.create(null),new r().__proto__||(e=!1));function n(c,h,l){this.fn=c,this.context=h,this.once=l||!1}function i(c,h,l,d,f){if(typeof l!="function")throw new TypeError("The listener must be a function");var u=new n(l,d||c,f),p=e?e+h:h;return c._events[p]?c._events[p].fn?c._events[p]=[c._events[p],u]:c._events[p].push(u):(c._events[p]=u,c._eventsCount++),c}function o(c,h){--c._eventsCount===0?c._events=new r:delete c._events[h]}function a(){this._events=new r,this._eventsCount=0}a.prototype.eventNames=function(){var h=[],l,d;if(this._eventsCount===0)return h;for(d in l=this._events)t.call(l,d)&&h.push(e?d.slice(1):d);return Object.getOwnPropertySymbols?h.concat(Object.getOwnPropertySymbols(l)):h},a.prototype.listeners=function(h){var l=e?e+h:h,d=this._events[l];if(!d)return[];if(d.fn)return[d.fn];for(var f=0,u=d.length,p=new Array(u);f<u;f++)p[f]=d[f].fn;return p},a.prototype.listenerCount=function(h){var l=e?e+h:h,d=this._events[l];return d?d.fn?1:d.length:0},a.prototype.emit=function(h,l,d,f,u,p){var g=e?e+h:h;if(!this._events[g])return!1;var m=this._events[g],y=arguments.length,x,b;if(m.fn){switch(m.once&&this.removeListener(h,m.fn,void 0,!0),y){case 1:return m.fn.call(m.context),!0;case 2:return m.fn.call(m.context,l),!0;case 3:return m.fn.call(m.context,l,d),!0;case 4:return m.fn.call(m.context,l,d,f),!0;case 5:return m.fn.call(m.context,l,d,f,u),!0;case 6:return m.fn.call(m.context,l,d,f,u,p),!0}for(b=1,x=new Array(y-1);b<y;b++)x[b-1]=arguments[b];m.fn.apply(m.context,x)}else{var w=m.length,_;for(b=0;b<w;b++)switch(m[b].once&&this.removeListener(h,m[b].fn,void 0,!0),y){case 1:m[b].fn.call(m[b].context);break;case 2:m[b].fn.call(m[b].context,l);break;case 3:m[b].fn.call(m[b].context,l,d);break;case 4:m[b].fn.call(m[b].context,l,d,f);break;default:if(!x)for(_=1,x=new Array(y-1);_<y;_++)x[_-1]=arguments[_];m[b].fn.apply(m[b].context,x)}}return!0},a.prototype.on=function(h,l,d){return i(this,h,l,d,!1)},a.prototype.once=function(h,l,d){return i(this,h,l,d,!0)},a.prototype.removeListener=function(h,l,d,f){var u=e?e+h:h;if(!this._events[u])return this;if(!l)return o(this,u),this;var p=this._events[u];if(p.fn)p.fn===l&&(!f||p.once)&&(!d||p.context===d)&&o(this,u);else{for(var g=0,m=[],y=p.length;g<y;g++)(p[g].fn!==l||f&&!p[g].once||d&&p[g].context!==d)&&m.push(p[g]);m.length?this._events[u]=m.length===1?m[0]:m:o(this,u)}return this},a.prototype.removeAllListeners=function(h){var l;return h?(l=e?e+h:h,this._events[l]&&o(this,l)):(this._events=new r,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=e,a.EventEmitter=a,s.exports=a}(pr)),pr.exports}var rl=sl();const Wt=Fo(rl),nl=Math.PI*2,il=180/Math.PI,ol=Math.PI/180;class ft{constructor(t=0,e=0){this.x=0,this.y=0,this.x=t,this.y=e}clone(){return new ft(this.x,this.y)}copyFrom(t){return this.set(t.x,t.y),this}copyTo(t){return t.set(this.x,this.y),t}equals(t){return t.x===this.x&&t.y===this.y}set(t=0,e=t){return this.x=t,this.y=e,this}toString(){return`[pixi.js/math:Point x=${this.x} y=${this.y}]`}static get shared(){return mr.x=0,mr.y=0,mr}}const mr=new ft;class X{constructor(t=1,e=0,r=0,n=1,i=0,o=0){this.array=null,this.a=t,this.b=e,this.c=r,this.d=n,this.tx=i,this.ty=o}fromArray(t){this.a=t[0],this.b=t[1],this.c=t[3],this.d=t[4],this.tx=t[2],this.ty=t[5]}set(t,e,r,n,i,o){return this.a=t,this.b=e,this.c=r,this.d=n,this.tx=i,this.ty=o,this}toArray(t,e){this.array||(this.array=new Float32Array(9));const r=e||this.array;return t?(r[0]=this.a,r[1]=this.b,r[2]=0,r[3]=this.c,r[4]=this.d,r[5]=0,r[6]=this.tx,r[7]=this.ty,r[8]=1):(r[0]=this.a,r[1]=this.c,r[2]=this.tx,r[3]=this.b,r[4]=this.d,r[5]=this.ty,r[6]=0,r[7]=0,r[8]=1),r}apply(t,e){e=e||new ft;const r=t.x,n=t.y;return e.x=this.a*r+this.c*n+this.tx,e.y=this.b*r+this.d*n+this.ty,e}applyInverse(t,e){e=e||new ft;const r=this.a,n=this.b,i=this.c,o=this.d,a=this.tx,c=this.ty,h=1/(r*o+i*-n),l=t.x,d=t.y;return e.x=o*h*l+-i*h*d+(c*i-a*o)*h,e.y=r*h*d+-n*h*l+(-c*r+a*n)*h,e}translate(t,e){return this.tx+=t,this.ty+=e,this}scale(t,e){return this.a*=t,this.d*=e,this.c*=t,this.b*=e,this.tx*=t,this.ty*=e,this}rotate(t){const e=Math.cos(t),r=Math.sin(t),n=this.a,i=this.c,o=this.tx;return this.a=n*e-this.b*r,this.b=n*r+this.b*e,this.c=i*e-this.d*r,this.d=i*r+this.d*e,this.tx=o*e-this.ty*r,this.ty=o*r+this.ty*e,this}append(t){const e=this.a,r=this.b,n=this.c,i=this.d;return this.a=t.a*e+t.b*n,this.b=t.a*r+t.b*i,this.c=t.c*e+t.d*n,this.d=t.c*r+t.d*i,this.tx=t.tx*e+t.ty*n+this.tx,this.ty=t.tx*r+t.ty*i+this.ty,this}appendFrom(t,e){const r=t.a,n=t.b,i=t.c,o=t.d,a=t.tx,c=t.ty,h=e.a,l=e.b,d=e.c,f=e.d;return this.a=r*h+n*d,this.b=r*l+n*f,this.c=i*h+o*d,this.d=i*l+o*f,this.tx=a*h+c*d+e.tx,this.ty=a*l+c*f+e.ty,this}setTransform(t,e,r,n,i,o,a,c,h){return this.a=Math.cos(a+h)*i,this.b=Math.sin(a+h)*i,this.c=-Math.sin(a-c)*o,this.d=Math.cos(a-c)*o,this.tx=t-(r*this.a+n*this.c),this.ty=e-(r*this.b+n*this.d),this}prepend(t){const e=this.tx;if(t.a!==1||t.b!==0||t.c!==0||t.d!==1){const r=this.a,n=this.c;this.a=r*t.a+this.b*t.c,this.b=r*t.b+this.b*t.d,this.c=n*t.a+this.d*t.c,this.d=n*t.b+this.d*t.d}return this.tx=e*t.a+this.ty*t.c+t.tx,this.ty=e*t.b+this.ty*t.d+t.ty,this}decompose(t){const e=this.a,r=this.b,n=this.c,i=this.d,o=t.pivot,a=-Math.atan2(-n,i),c=Math.atan2(r,e),h=Math.abs(a+c);return h<1e-5||Math.abs(nl-h)<1e-5?(t.rotation=c,t.skew.x=t.skew.y=0):(t.rotation=0,t.skew.x=a,t.skew.y=c),t.scale.x=Math.sqrt(e*e+r*r),t.scale.y=Math.sqrt(n*n+i*i),t.position.x=this.tx+(o.x*e+o.y*n),t.position.y=this.ty+(o.x*r+o.y*i),t}invert(){const t=this.a,e=this.b,r=this.c,n=this.d,i=this.tx,o=t*n-e*r;return this.a=n/o,this.b=-e/o,this.c=-r/o,this.d=t/o,this.tx=(r*this.ty-n*i)/o,this.ty=-(t*this.ty-e*i)/o,this}isIdentity(){return this.a===1&&this.b===0&&this.c===0&&this.d===1&&this.tx===0&&this.ty===0}identity(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this}clone(){const t=new X;return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t}copyTo(t){return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t}copyFrom(t){return this.a=t.a,this.b=t.b,this.c=t.c,this.d=t.d,this.tx=t.tx,this.ty=t.ty,this}equals(t){return t.a===this.a&&t.b===this.b&&t.c===this.c&&t.d===this.d&&t.tx===this.tx&&t.ty===this.ty}toString(){return`[pixi.js:Matrix a=${this.a} b=${this.b} c=${this.c} d=${this.d} tx=${this.tx} ty=${this.ty}]`}static get IDENTITY(){return cl.identity()}static get shared(){return al.identity()}}const al=new X,cl=new X,Ce=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],ke=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],Me=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],Pe=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],tn=[],zo=[],Cs=Math.sign;function ll(){for(let s=0;s<16;s++){const t=[];tn.push(t);for(let e=0;e<16;e++){const r=Cs(Ce[s]*Ce[e]+Me[s]*ke[e]),n=Cs(ke[s]*Ce[e]+Pe[s]*ke[e]),i=Cs(Ce[s]*Me[e]+Me[s]*Pe[e]),o=Cs(ke[s]*Me[e]+Pe[s]*Pe[e]);for(let a=0;a<16;a++)if(Ce[a]===r&&ke[a]===n&&Me[a]===i&&Pe[a]===o){t.push(a);break}}}for(let s=0;s<16;s++){const t=new X;t.set(Ce[s],ke[s],Me[s],Pe[s],0,0),zo.push(t)}}ll();const et={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MAIN_DIAGONAL:10,MIRROR_HORIZONTAL:12,REVERSE_DIAGONAL:14,uX:s=>Ce[s],uY:s=>ke[s],vX:s=>Me[s],vY:s=>Pe[s],inv:s=>s&8?s&15:-s&7,add:(s,t)=>tn[s][t],sub:(s,t)=>tn[s][et.inv(t)],rotate180:s=>s^4,isVertical:s=>(s&3)===2,byDirection:(s,t)=>Math.abs(s)*2<=Math.abs(t)?t>=0?et.S:et.N:Math.abs(t)*2<=Math.abs(s)?s>0?et.E:et.W:t>0?s>0?et.SE:et.SW:s>0?et.NE:et.NW,matrixAppendRotationInv:(s,t,e=0,r=0)=>{const n=zo[et.inv(t)];n.tx=e,n.ty=r,s.append(n)}},ks=[new ft,new ft,new ft,new ft];class q{constructor(t=0,e=0,r=0,n=0){this.type="rectangle",this.x=Number(t),this.y=Number(e),this.width=Number(r),this.height=Number(n)}get left(){return this.x}get right(){return this.x+this.width}get top(){return this.y}get bottom(){return this.y+this.height}isEmpty(){return this.left===this.right||this.top===this.bottom}static get EMPTY(){return new q(0,0,0,0)}clone(){return new q(this.x,this.y,this.width,this.height)}copyFromBounds(t){return this.x=t.minX,this.y=t.minY,this.width=t.maxX-t.minX,this.height=t.maxY-t.minY,this}copyFrom(t){return this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height,this}copyTo(t){return t.copyFrom(this),t}contains(t,e){return this.width<=0||this.height<=0?!1:t>=this.x&&t<this.x+this.width&&e>=this.y&&e<this.y+this.height}strokeContains(t,e,r,n=.5){const{width:i,height:o}=this;if(i<=0||o<=0)return!1;const a=this.x,c=this.y,h=r*(1-n),l=r-h,d=a-h,f=a+i+h,u=c-h,p=c+o+h,g=a+l,m=a+i-l,y=c+l,x=c+o-l;return t>=d&&t<=f&&e>=u&&e<=p&&!(t>g&&t<m&&e>y&&e<x)}intersects(t,e){if(!e){const M=this.x<t.x?t.x:this.x;if((this.right>t.right?t.right:this.right)<=M)return!1;const k=this.y<t.y?t.y:this.y;return(this.bottom>t.bottom?t.bottom:this.bottom)>k}const r=this.left,n=this.right,i=this.top,o=this.bottom;if(n<=r||o<=i)return!1;const a=ks[0].set(t.left,t.top),c=ks[1].set(t.left,t.bottom),h=ks[2].set(t.right,t.top),l=ks[3].set(t.right,t.bottom);if(h.x<=a.x||c.y<=a.y)return!1;const d=Math.sign(e.a*e.d-e.b*e.c);if(d===0||(e.apply(a,a),e.apply(c,c),e.apply(h,h),e.apply(l,l),Math.max(a.x,c.x,h.x,l.x)<=r||Math.min(a.x,c.x,h.x,l.x)>=n||Math.max(a.y,c.y,h.y,l.y)<=i||Math.min(a.y,c.y,h.y,l.y)>=o))return!1;const f=d*(c.y-a.y),u=d*(a.x-c.x),p=f*r+u*i,g=f*n+u*i,m=f*r+u*o,y=f*n+u*o;if(Math.max(p,g,m,y)<=f*a.x+u*a.y||Math.min(p,g,m,y)>=f*l.x+u*l.y)return!1;const x=d*(a.y-h.y),b=d*(h.x-a.x),w=x*r+b*i,_=x*n+b*i,S=x*r+b*o,C=x*n+b*o;return!(Math.max(w,_,S,C)<=x*a.x+b*a.y||Math.min(w,_,S,C)>=x*l.x+b*l.y)}pad(t=0,e=t){return this.x-=t,this.y-=e,this.width+=t*2,this.height+=e*2,this}fit(t){const e=Math.max(this.x,t.x),r=Math.min(this.x+this.width,t.x+t.width),n=Math.max(this.y,t.y),i=Math.min(this.y+this.height,t.y+t.height);return this.x=e,this.width=Math.max(r-e,0),this.y=n,this.height=Math.max(i-n,0),this}ceil(t=1,e=.001){const r=Math.ceil((this.x+this.width-e)*t)/t,n=Math.ceil((this.y+this.height-e)*t)/t;return this.x=Math.floor((this.x+e)*t)/t,this.y=Math.floor((this.y+e)*t)/t,this.width=r-this.x,this.height=n-this.y,this}enlarge(t){const e=Math.min(this.x,t.x),r=Math.max(this.x+this.width,t.x+t.width),n=Math.min(this.y,t.y),i=Math.max(this.y+this.height,t.y+t.height);return this.x=e,this.width=r-e,this.y=n,this.height=i-n,this}getBounds(t){return t||(t=new q),t.copyFrom(this),t}containsRect(t){if(this.width<=0||this.height<=0)return!1;const e=t.x,r=t.y,n=t.x+t.width,i=t.y+t.height;return e>=this.x&&e<this.x+this.width&&r>=this.y&&r<this.y+this.height&&n>=this.x&&n<this.x+this.width&&i>=this.y&&i<this.y+this.height}set(t,e,r,n){return this.x=t,this.y=e,this.width=r,this.height=n,this}toString(){return`[pixi.js/math:Rectangle x=${this.x} y=${this.y} width=${this.width} height=${this.height}]`}}const gr={default:-1};function at(s="default"){return gr[s]===void 0&&(gr[s]=-1),++gr[s]}const ti={},Z="8.0.0",hl="8.3.4";function Y(s,t,e=3){if(ti[t])return;let r=new Error().stack;typeof r>"u"?console.warn("PixiJS Deprecation Warning: ",`${t}
Deprecated since v${s}`):(r=r.split(`
`).splice(e).join(`
`),console.groupCollapsed?(console.groupCollapsed("%cPixiJS Deprecation Warning: %c%s","color:#614108;background:#fffbe6","font-weight:normal;color:#614108;background:#fffbe6",`${t}
Deprecated since v${s}`),console.warn(r),console.groupEnd()):(console.warn("PixiJS Deprecation Warning: ",`${t}
Deprecated since v${s}`),console.warn(r))),ti[t]=!0}const Go=()=>{};function We(s){return s+=s===0?1:0,--s,s|=s>>>1,s|=s>>>2,s|=s>>>4,s|=s>>>8,s|=s>>>16,s+1}function ei(s){return!(s&s-1)&&!!s}function No(s){const t={};for(const e in s)s[e]!==void 0&&(t[e]=s[e]);return t}const si=Object.create(null);function dl(s){const t=si[s];return t===void 0&&(si[s]=at("resource")),t}const Oo=class Uo extends Wt{constructor(t={}){super(),this._resourceType="textureSampler",this._touched=0,this._maxAnisotropy=1,this.destroyed=!1,t={...Uo.defaultOptions,...t},this.addressMode=t.addressMode,this.addressModeU=t.addressModeU??this.addressModeU,this.addressModeV=t.addressModeV??this.addressModeV,this.addressModeW=t.addressModeW??this.addressModeW,this.scaleMode=t.scaleMode,this.magFilter=t.magFilter??this.magFilter,this.minFilter=t.minFilter??this.minFilter,this.mipmapFilter=t.mipmapFilter??this.mipmapFilter,this.lodMinClamp=t.lodMinClamp,this.lodMaxClamp=t.lodMaxClamp,this.compare=t.compare,this.maxAnisotropy=t.maxAnisotropy??1}set addressMode(t){this.addressModeU=t,this.addressModeV=t,this.addressModeW=t}get addressMode(){return this.addressModeU}set wrapMode(t){Y(Z,"TextureStyle.wrapMode is now TextureStyle.addressMode"),this.addressMode=t}get wrapMode(){return this.addressMode}set scaleMode(t){this.magFilter=t,this.minFilter=t,this.mipmapFilter=t}get scaleMode(){return this.magFilter}set maxAnisotropy(t){this._maxAnisotropy=Math.min(t,16),this._maxAnisotropy>1&&(this.scaleMode="linear")}get maxAnisotropy(){return this._maxAnisotropy}get _resourceId(){return this._sharedResourceId||this._generateResourceId()}update(){this.emit("change",this),this._sharedResourceId=null}_generateResourceId(){const t=`${this.addressModeU}-${this.addressModeV}-${this.addressModeW}-${this.magFilter}-${this.minFilter}-${this.mipmapFilter}-${this.lodMinClamp}-${this.lodMaxClamp}-${this.compare}-${this._maxAnisotropy}`;return this._sharedResourceId=dl(t),this._resourceId}destroy(){this.destroyed=!0,this.emit("destroy",this),this.emit("change",this),this.removeAllListeners()}};Oo.defaultOptions={addressMode:"clamp-to-edge",scaleMode:"linear"};let je=Oo;const Do=class Ho extends Wt{constructor(t={}){super(),this.options=t,this.uid=at("textureSource"),this._resourceType="textureSource",this._resourceId=at("resource"),this.uploadMethodId="unknown",this._resolution=1,this.pixelWidth=1,this.pixelHeight=1,this.width=1,this.height=1,this.sampleCount=1,this.mipLevelCount=1,this.autoGenerateMipmaps=!1,this.format="rgba8unorm",this.dimension="2d",this.antialias=!1,this._touched=0,this._batchTick=-1,this._textureBindLocation=-1,t={...Ho.defaultOptions,...t},this.label=t.label??"",this.resource=t.resource,this.autoGarbageCollect=t.autoGarbageCollect,this._resolution=t.resolution,t.width?this.pixelWidth=t.width*this._resolution:this.pixelWidth=this.resource?this.resourceWidth??1:1,t.height?this.pixelHeight=t.height*this._resolution:this.pixelHeight=this.resource?this.resourceHeight??1:1,this.width=this.pixelWidth/this._resolution,this.height=this.pixelHeight/this._resolution,this.format=t.format,this.dimension=t.dimensions,this.mipLevelCount=t.mipLevelCount,this.autoGenerateMipmaps=t.autoGenerateMipmaps,this.sampleCount=t.sampleCount,this.antialias=t.antialias,this.alphaMode=t.alphaMode,this.style=new je(No(t)),this.destroyed=!1,this._refreshPOT()}get source(){return this}get style(){return this._style}set style(t){var e,r;this.style!==t&&((e=this._style)==null||e.off("change",this._onStyleChange,this),this._style=t,(r=this._style)==null||r.on("change",this._onStyleChange,this),this._onStyleChange())}get addressMode(){return this._style.addressMode}set addressMode(t){this._style.addressMode=t}get repeatMode(){return this._style.addressMode}set repeatMode(t){this._style.addressMode=t}get magFilter(){return this._style.magFilter}set magFilter(t){this._style.magFilter=t}get minFilter(){return this._style.minFilter}set minFilter(t){this._style.minFilter=t}get mipmapFilter(){return this._style.mipmapFilter}set mipmapFilter(t){this._style.mipmapFilter=t}get lodMinClamp(){return this._style.lodMinClamp}set lodMinClamp(t){this._style.lodMinClamp=t}get lodMaxClamp(){return this._style.lodMaxClamp}set lodMaxClamp(t){this._style.lodMaxClamp=t}_onStyleChange(){this.emit("styleChange",this)}update(){if(this.resource){const t=this._resolution;if(this.resize(this.resourceWidth/t,this.resourceHeight/t))return}this.emit("update",this)}destroy(){this.destroyed=!0,this.emit("destroy",this),this.emit("change",this),this._style&&(this._style.destroy(),this._style=null),this.uploadMethodId=null,this.resource=null,this.removeAllListeners()}unload(){this._resourceId=at("resource"),this.emit("change",this),this.emit("unload",this)}get resourceWidth(){const{resource:t}=this;return t.naturalWidth||t.videoWidth||t.displayWidth||t.width}get resourceHeight(){const{resource:t}=this;return t.naturalHeight||t.videoHeight||t.displayHeight||t.height}get resolution(){return this._resolution}set resolution(t){this._resolution!==t&&(this._resolution=t,this.width=this.pixelWidth/t,this.height=this.pixelHeight/t)}resize(t,e,r){r||(r=this._resolution),t||(t=this.width),e||(e=this.height);const n=Math.round(t*r),i=Math.round(e*r);return this.width=n/r,this.height=i/r,this._resolution=r,this.pixelWidth===n&&this.pixelHeight===i?!1:(this._refreshPOT(),this.pixelWidth=n,this.pixelHeight=i,this.emit("resize",this),this._resourceId=at("resource"),this.emit("change",this),!0)}updateMipmaps(){this.autoGenerateMipmaps&&this.mipLevelCount>1&&this.emit("updateMipmaps",this)}set wrapMode(t){this._style.wrapMode=t}get wrapMode(){return this._style.wrapMode}set scaleMode(t){this._style.scaleMode=t}get scaleMode(){return this._style.scaleMode}_refreshPOT(){this.isPowerOfTwo=ei(this.pixelWidth)&&ei(this.pixelHeight)}static test(t){throw new Error("Unimplemented")}};Do.defaultOptions={resolution:1,format:"bgra8unorm",alphaMode:"premultiply-alpha-on-upload",dimensions:"2d",mipLevelCount:1,autoGenerateMipmaps:!1,sampleCount:1,antialias:!1,autoGarbageCollect:!1};let jt=Do;class kn extends jt{constructor(t){const e=t.resource||new Float32Array(t.width*t.height*4);let r=t.format;r||(e instanceof Float32Array?r="rgba32float":e instanceof Int32Array||e instanceof Uint32Array?r="rgba32uint":e instanceof Int16Array||e instanceof Uint16Array?r="rgba16uint":(e instanceof Int8Array,r="bgra8unorm")),super({...t,resource:e,format:r}),this.uploadMethodId="buffer"}static test(t){return t instanceof Int8Array||t instanceof Uint8Array||t instanceof Uint8ClampedArray||t instanceof Int16Array||t instanceof Uint16Array||t instanceof Int32Array||t instanceof Uint32Array||t instanceof Float32Array}}kn.extension=O.TextureSource;const ri=new X;class ul{constructor(t,e){this.mapCoord=new X,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._textureID=-1,this._updateID=0,this.clampOffset=0,typeof e>"u"?this.clampMargin=t.width<10?0:.5:this.clampMargin=e,this.isSimple=!1,this.texture=t}get texture(){return this._texture}set texture(t){var e;this.texture!==t&&((e=this._texture)==null||e.removeListener("update",this.update,this),this._texture=t,this._texture.addListener("update",this.update,this),this.update())}multiplyUvs(t,e){e===void 0&&(e=t);const r=this.mapCoord;for(let n=0;n<t.length;n+=2){const i=t[n],o=t[n+1];e[n]=i*r.a+o*r.c+r.tx,e[n+1]=i*r.b+o*r.d+r.ty}return e}update(){const t=this._texture;this._updateID++;const e=t.uvs;this.mapCoord.set(e.x1-e.x0,e.y1-e.y0,e.x3-e.x0,e.y3-e.y0,e.x0,e.y0);const r=t.orig,n=t.trim;n&&(ri.set(r.width/n.width,0,0,r.height/n.height,-n.x/n.width,-n.y/n.height),this.mapCoord.append(ri));const i=t.source,o=this.uClampFrame,a=this.clampMargin/i._resolution,c=this.clampOffset/i._resolution;return o[0]=(t.frame.x+a+c)/i.width,o[1]=(t.frame.y+a+c)/i.height,o[2]=(t.frame.x+t.frame.width-a+c)/i.width,o[3]=(t.frame.y+t.frame.height-a+c)/i.height,this.uClampOffset[0]=this.clampOffset/i.pixelWidth,this.uClampOffset[1]=this.clampOffset/i.pixelHeight,this.isSimple=t.frame.width===i.width&&t.frame.height===i.height&&t.rotate===0,!0}}class $ extends Wt{constructor({source:t,label:e,frame:r,orig:n,trim:i,defaultAnchor:o,defaultBorders:a,rotate:c,dynamic:h}={}){if(super(),this.uid=at("texture"),this.uvs={x0:0,y0:0,x1:0,y1:0,x2:0,y2:0,x3:0,y3:0},this.frame=new q,this.noFrame=!1,this.dynamic=!1,this.isTexture=!0,this.label=e,this.source=(t==null?void 0:t.source)??new jt,this.noFrame=!r,r)this.frame.copyFrom(r);else{const{width:l,height:d}=this._source;this.frame.width=l,this.frame.height=d}this.orig=n||this.frame,this.trim=i,this.rotate=c??0,this.defaultAnchor=o,this.defaultBorders=a,this.destroyed=!1,this.dynamic=h||!1,this.updateUvs()}set source(t){this._source&&this._source.off("resize",this.update,this),this._source=t,t.on("resize",this.update,this),this.emit("update",this)}get source(){return this._source}get textureMatrix(){return this._textureMatrix||(this._textureMatrix=new ul(this)),this._textureMatrix}get width(){return this.orig.width}get height(){return this.orig.height}updateUvs(){const{uvs:t,frame:e}=this,{width:r,height:n}=this._source,i=e.x/r,o=e.y/n,a=e.width/r,c=e.height/n;let h=this.rotate;if(h){const l=a/2,d=c/2,f=i+l,u=o+d;h=et.add(h,et.NW),t.x0=f+l*et.uX(h),t.y0=u+d*et.uY(h),h=et.add(h,2),t.x1=f+l*et.uX(h),t.y1=u+d*et.uY(h),h=et.add(h,2),t.x2=f+l*et.uX(h),t.y2=u+d*et.uY(h),h=et.add(h,2),t.x3=f+l*et.uX(h),t.y3=u+d*et.uY(h)}else t.x0=i,t.y0=o,t.x1=i+a,t.y1=o,t.x2=i+a,t.y2=o+c,t.x3=i,t.y3=o+c}destroy(t=!1){this._source&&t&&(this._source.destroy(),this._source=null),this._textureMatrix=null,this.destroyed=!0,this.emit("destroy",this),this.removeAllListeners()}update(){this.noFrame&&(this.frame.width=this._source.width,this.frame.height=this._source.height),this.updateUvs(),this.emit("update",this)}get baseTexture(){return Y(Z,"Texture.baseTexture is now Texture.source"),this._source}}$.EMPTY=new $({label:"EMPTY",source:new jt({label:"EMPTY"})});$.EMPTY.destroy=Go;$.WHITE=new $({source:new kn({resource:new Uint8Array([255,255,255,255]),width:1,height:1,alphaMode:"premultiply-alpha-on-upload",label:"WHITE"}),label:"WHITE"});$.WHITE.destroy=Go;function fl(s,t,e){const{width:r,height:n}=e.orig,i=e.trim;if(i){const o=i.width,a=i.height;s.minX=i.x-t._x*r,s.maxX=s.minX+o,s.minY=i.y-t._y*n,s.maxY=s.minY+a}else s.minX=-t._x*r,s.maxX=s.minX+r,s.minY=-t._y*n,s.maxY=s.minY+n}const ni=new X;class Dt{constructor(t=1/0,e=1/0,r=-1/0,n=-1/0){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.matrix=ni,this.minX=t,this.minY=e,this.maxX=r,this.maxY=n}isEmpty(){return this.minX>this.maxX||this.minY>this.maxY}get rectangle(){this._rectangle||(this._rectangle=new q);const t=this._rectangle;return this.minX>this.maxX||this.minY>this.maxY?(t.x=0,t.y=0,t.width=0,t.height=0):t.copyFromBounds(this),t}clear(){return this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.matrix=ni,this}set(t,e,r,n){this.minX=t,this.minY=e,this.maxX=r,this.maxY=n}addFrame(t,e,r,n,i){i||(i=this.matrix);const o=i.a,a=i.b,c=i.c,h=i.d,l=i.tx,d=i.ty;let f=this.minX,u=this.minY,p=this.maxX,g=this.maxY,m=o*t+c*e+l,y=a*t+h*e+d;m<f&&(f=m),y<u&&(u=y),m>p&&(p=m),y>g&&(g=y),m=o*r+c*e+l,y=a*r+h*e+d,m<f&&(f=m),y<u&&(u=y),m>p&&(p=m),y>g&&(g=y),m=o*t+c*n+l,y=a*t+h*n+d,m<f&&(f=m),y<u&&(u=y),m>p&&(p=m),y>g&&(g=y),m=o*r+c*n+l,y=a*r+h*n+d,m<f&&(f=m),y<u&&(u=y),m>p&&(p=m),y>g&&(g=y),this.minX=f,this.minY=u,this.maxX=p,this.maxY=g}addRect(t,e){this.addFrame(t.x,t.y,t.x+t.width,t.y+t.height,e)}addBounds(t,e){this.addFrame(t.minX,t.minY,t.maxX,t.maxY,e)}addBoundsMask(t){this.minX=this.minX>t.minX?this.minX:t.minX,this.minY=this.minY>t.minY?this.minY:t.minY,this.maxX=this.maxX<t.maxX?this.maxX:t.maxX,this.maxY=this.maxY<t.maxY?this.maxY:t.maxY}applyMatrix(t){const e=this.minX,r=this.minY,n=this.maxX,i=this.maxY,{a:o,b:a,c,d:h,tx:l,ty:d}=t;let f=o*e+c*r+l,u=a*e+h*r+d;this.minX=f,this.minY=u,this.maxX=f,this.maxY=u,f=o*n+c*r+l,u=a*n+h*r+d,this.minX=f<this.minX?f:this.minX,this.minY=u<this.minY?u:this.minY,this.maxX=f>this.maxX?f:this.maxX,this.maxY=u>this.maxY?u:this.maxY,f=o*e+c*i+l,u=a*e+h*i+d,this.minX=f<this.minX?f:this.minX,this.minY=u<this.minY?u:this.minY,this.maxX=f>this.maxX?f:this.maxX,this.maxY=u>this.maxY?u:this.maxY,f=o*n+c*i+l,u=a*n+h*i+d,this.minX=f<this.minX?f:this.minX,this.minY=u<this.minY?u:this.minY,this.maxX=f>this.maxX?f:this.maxX,this.maxY=u>this.maxY?u:this.maxY}fit(t){return this.minX<t.left&&(this.minX=t.left),this.maxX>t.right&&(this.maxX=t.right),this.minY<t.top&&(this.minY=t.top),this.maxY>t.bottom&&(this.maxY=t.bottom),this}fitBounds(t,e,r,n){return this.minX<t&&(this.minX=t),this.maxX>e&&(this.maxX=e),this.minY<r&&(this.minY=r),this.maxY>n&&(this.maxY=n),this}pad(t,e=t){return this.minX-=t,this.maxX+=t,this.minY-=e,this.maxY+=e,this}ceil(){return this.minX=Math.floor(this.minX),this.minY=Math.floor(this.minY),this.maxX=Math.ceil(this.maxX),this.maxY=Math.ceil(this.maxY),this}clone(){return new Dt(this.minX,this.minY,this.maxX,this.maxY)}scale(t,e=t){return this.minX*=t,this.minY*=e,this.maxX*=t,this.maxY*=e,this}get x(){return this.minX}set x(t){const e=this.maxX-this.minX;this.minX=t,this.maxX=t+e}get y(){return this.minY}set y(t){const e=this.maxY-this.minY;this.minY=t,this.maxY=t+e}get width(){return this.maxX-this.minX}set width(t){this.maxX=this.minX+t}get height(){return this.maxY-this.minY}set height(t){this.maxY=this.minY+t}get left(){return this.minX}get right(){return this.maxX}get top(){return this.minY}get bottom(){return this.maxY}get isPositive(){return this.maxX-this.minX>0&&this.maxY-this.minY>0}get isValid(){return this.minX+this.minY!==1/0}addVertexData(t,e,r,n){let i=this.minX,o=this.minY,a=this.maxX,c=this.maxY;n||(n=this.matrix);const h=n.a,l=n.b,d=n.c,f=n.d,u=n.tx,p=n.ty;for(let g=e;g<r;g+=2){const m=t[g],y=t[g+1],x=h*m+d*y+u,b=l*m+f*y+p;i=x<i?x:i,o=b<o?b:o,a=x>a?x:a,c=b>c?b:c}this.minX=i,this.minY=o,this.maxX=a,this.maxY=c}containsPoint(t,e){return this.minX<=t&&this.minY<=e&&this.maxX>=t&&this.maxY>=e}toString(){return`[pixi.js:Bounds minX=${this.minX} minY=${this.minY} maxX=${this.maxX} maxY=${this.maxY} width=${this.width} height=${this.height}]`}copyFrom(t){return this.minX=t.minX,this.minY=t.minY,this.maxX=t.maxX,this.maxY=t.maxY,this}}var pl={grad:.9,turn:360,rad:360/(2*Math.PI)},ee=function(s){return typeof s=="string"?s.length>0:typeof s=="number"},ht=function(s,t,e){return t===void 0&&(t=0),e===void 0&&(e=Math.pow(10,t)),Math.round(e*s)/e+0},Ft=function(s,t,e){return t===void 0&&(t=0),e===void 0&&(e=1),s>e?e:s>t?s:t},Wo=function(s){return(s=isFinite(s)?s%360:0)>0?s:s+360},ii=function(s){return{r:Ft(s.r,0,255),g:Ft(s.g,0,255),b:Ft(s.b,0,255),a:Ft(s.a)}},xr=function(s){return{r:ht(s.r),g:ht(s.g),b:ht(s.b),a:ht(s.a,3)}},ml=/^#([0-9a-f]{3,8})$/i,Ms=function(s){var t=s.toString(16);return t.length<2?"0"+t:t},jo=function(s){var t=s.r,e=s.g,r=s.b,n=s.a,i=Math.max(t,e,r),o=i-Math.min(t,e,r),a=o?i===t?(e-r)/o:i===e?2+(r-t)/o:4+(t-e)/o:0;return{h:60*(a<0?a+6:a),s:i?o/i*100:0,v:i/255*100,a:n}},$o=function(s){var t=s.h,e=s.s,r=s.v,n=s.a;t=t/360*6,e/=100,r/=100;var i=Math.floor(t),o=r*(1-e),a=r*(1-(t-i)*e),c=r*(1-(1-t+i)*e),h=i%6;return{r:255*[r,a,o,o,c,r][h],g:255*[c,r,r,a,o,o][h],b:255*[o,o,c,r,r,a][h],a:n}},oi=function(s){return{h:Wo(s.h),s:Ft(s.s,0,100),l:Ft(s.l,0,100),a:Ft(s.a)}},ai=function(s){return{h:ht(s.h),s:ht(s.s),l:ht(s.l),a:ht(s.a,3)}},ci=function(s){return $o((e=(t=s).s,{h:t.h,s:(e*=((r=t.l)<50?r:100-r)/100)>0?2*e/(r+e)*100:0,v:r+e,a:t.a}));var t,e,r},ds=function(s){return{h:(t=jo(s)).h,s:(n=(200-(e=t.s))*(r=t.v)/100)>0&&n<200?e*r/100/(n<=100?n:200-n)*100:0,l:n/2,a:t.a};var t,e,r,n},gl=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s*,\s*([+-]?\d*\.?\d+)%\s*,\s*([+-]?\d*\.?\d+)%\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,xl=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s+([+-]?\d*\.?\d+)%\s+([+-]?\d*\.?\d+)%\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,yl=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,bl=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,en={string:[[function(s){var t=ml.exec(s);return t?(s=t[1]).length<=4?{r:parseInt(s[0]+s[0],16),g:parseInt(s[1]+s[1],16),b:parseInt(s[2]+s[2],16),a:s.length===4?ht(parseInt(s[3]+s[3],16)/255,2):1}:s.length===6||s.length===8?{r:parseInt(s.substr(0,2),16),g:parseInt(s.substr(2,2),16),b:parseInt(s.substr(4,2),16),a:s.length===8?ht(parseInt(s.substr(6,2),16)/255,2):1}:null:null},"hex"],[function(s){var t=yl.exec(s)||bl.exec(s);return t?t[2]!==t[4]||t[4]!==t[6]?null:ii({r:Number(t[1])/(t[2]?100/255:1),g:Number(t[3])/(t[4]?100/255:1),b:Number(t[5])/(t[6]?100/255:1),a:t[7]===void 0?1:Number(t[7])/(t[8]?100:1)}):null},"rgb"],[function(s){var t=gl.exec(s)||xl.exec(s);if(!t)return null;var e,r,n=oi({h:(e=t[1],r=t[2],r===void 0&&(r="deg"),Number(e)*(pl[r]||1)),s:Number(t[3]),l:Number(t[4]),a:t[5]===void 0?1:Number(t[5])/(t[6]?100:1)});return ci(n)},"hsl"]],object:[[function(s){var t=s.r,e=s.g,r=s.b,n=s.a,i=n===void 0?1:n;return ee(t)&&ee(e)&&ee(r)?ii({r:Number(t),g:Number(e),b:Number(r),a:Number(i)}):null},"rgb"],[function(s){var t=s.h,e=s.s,r=s.l,n=s.a,i=n===void 0?1:n;if(!ee(t)||!ee(e)||!ee(r))return null;var o=oi({h:Number(t),s:Number(e),l:Number(r),a:Number(i)});return ci(o)},"hsl"],[function(s){var t=s.h,e=s.s,r=s.v,n=s.a,i=n===void 0?1:n;if(!ee(t)||!ee(e)||!ee(r))return null;var o=function(a){return{h:Wo(a.h),s:Ft(a.s,0,100),v:Ft(a.v,0,100),a:Ft(a.a)}}({h:Number(t),s:Number(e),v:Number(r),a:Number(i)});return $o(o)},"hsv"]]},li=function(s,t){for(var e=0;e<t.length;e++){var r=t[e][0](s);if(r)return[r,t[e][1]]}return[null,void 0]},wl=function(s){return typeof s=="string"?li(s.trim(),en.string):typeof s=="object"&&s!==null?li(s,en.object):[null,void 0]},yr=function(s,t){var e=ds(s);return{h:e.h,s:Ft(e.s+100*t,0,100),l:e.l,a:e.a}},br=function(s){return(299*s.r+587*s.g+114*s.b)/1e3/255},hi=function(s,t){var e=ds(s);return{h:e.h,s:e.s,l:Ft(e.l+100*t,0,100),a:e.a}},sn=function(){function s(t){this.parsed=wl(t)[0],this.rgba=this.parsed||{r:0,g:0,b:0,a:1}}return s.prototype.isValid=function(){return this.parsed!==null},s.prototype.brightness=function(){return ht(br(this.rgba),2)},s.prototype.isDark=function(){return br(this.rgba)<.5},s.prototype.isLight=function(){return br(this.rgba)>=.5},s.prototype.toHex=function(){return t=xr(this.rgba),e=t.r,r=t.g,n=t.b,o=(i=t.a)<1?Ms(ht(255*i)):"","#"+Ms(e)+Ms(r)+Ms(n)+o;var t,e,r,n,i,o},s.prototype.toRgb=function(){return xr(this.rgba)},s.prototype.toRgbString=function(){return t=xr(this.rgba),e=t.r,r=t.g,n=t.b,(i=t.a)<1?"rgba("+e+", "+r+", "+n+", "+i+")":"rgb("+e+", "+r+", "+n+")";var t,e,r,n,i},s.prototype.toHsl=function(){return ai(ds(this.rgba))},s.prototype.toHslString=function(){return t=ai(ds(this.rgba)),e=t.h,r=t.s,n=t.l,(i=t.a)<1?"hsla("+e+", "+r+"%, "+n+"%, "+i+")":"hsl("+e+", "+r+"%, "+n+"%)";var t,e,r,n,i},s.prototype.toHsv=function(){return t=jo(this.rgba),{h:ht(t.h),s:ht(t.s),v:ht(t.v),a:ht(t.a,3)};var t},s.prototype.invert=function(){return Vt({r:255-(t=this.rgba).r,g:255-t.g,b:255-t.b,a:t.a});var t},s.prototype.saturate=function(t){return t===void 0&&(t=.1),Vt(yr(this.rgba,t))},s.prototype.desaturate=function(t){return t===void 0&&(t=.1),Vt(yr(this.rgba,-t))},s.prototype.grayscale=function(){return Vt(yr(this.rgba,-1))},s.prototype.lighten=function(t){return t===void 0&&(t=.1),Vt(hi(this.rgba,t))},s.prototype.darken=function(t){return t===void 0&&(t=.1),Vt(hi(this.rgba,-t))},s.prototype.rotate=function(t){return t===void 0&&(t=15),this.hue(this.hue()+t)},s.prototype.alpha=function(t){return typeof t=="number"?Vt({r:(e=this.rgba).r,g:e.g,b:e.b,a:t}):ht(this.rgba.a,3);var e},s.prototype.hue=function(t){var e=ds(this.rgba);return typeof t=="number"?Vt({h:t,s:e.s,l:e.l,a:e.a}):ht(e.h)},s.prototype.isEqual=function(t){return this.toHex()===Vt(t).toHex()},s}(),Vt=function(s){return s instanceof sn?s:new sn(s)},di=[],_l=function(s){s.forEach(function(t){di.indexOf(t)<0&&(t(sn,en),di.push(t))})};function vl(s,t){var e={white:"#ffffff",bisque:"#ffe4c4",blue:"#0000ff",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",antiquewhite:"#faebd7",aqua:"#00ffff",azure:"#f0ffff",whitesmoke:"#f5f5f5",papayawhip:"#ffefd5",plum:"#dda0dd",blanchedalmond:"#ffebcd",black:"#000000",gold:"#ffd700",goldenrod:"#daa520",gainsboro:"#dcdcdc",cornsilk:"#fff8dc",cornflowerblue:"#6495ed",burlywood:"#deb887",aquamarine:"#7fffd4",beige:"#f5f5dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkkhaki:"#bdb76b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",peachpuff:"#ffdab9",darkmagenta:"#8b008b",darkred:"#8b0000",darkorchid:"#9932cc",darkorange:"#ff8c00",darkslateblue:"#483d8b",gray:"#808080",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",deeppink:"#ff1493",deepskyblue:"#00bfff",wheat:"#f5deb3",firebrick:"#b22222",floralwhite:"#fffaf0",ghostwhite:"#f8f8ff",darkviolet:"#9400d3",magenta:"#ff00ff",green:"#008000",dodgerblue:"#1e90ff",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",blueviolet:"#8a2be2",forestgreen:"#228b22",lawngreen:"#7cfc00",indianred:"#cd5c5c",indigo:"#4b0082",fuchsia:"#ff00ff",brown:"#a52a2a",maroon:"#800000",mediumblue:"#0000cd",lightcoral:"#f08080",darkturquoise:"#00ced1",lightcyan:"#e0ffff",ivory:"#fffff0",lightyellow:"#ffffe0",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",linen:"#faf0e6",mediumaquamarine:"#66cdaa",lemonchiffon:"#fffacd",lime:"#00ff00",khaki:"#f0e68c",mediumseagreen:"#3cb371",limegreen:"#32cd32",mediumspringgreen:"#00fa9a",lightskyblue:"#87cefa",lightblue:"#add8e6",midnightblue:"#191970",lightpink:"#ffb6c1",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",mintcream:"#f5fffa",lightslategray:"#778899",lightslategrey:"#778899",navajowhite:"#ffdead",navy:"#000080",mediumvioletred:"#c71585",powderblue:"#b0e0e6",palegoldenrod:"#eee8aa",oldlace:"#fdf5e6",paleturquoise:"#afeeee",mediumturquoise:"#48d1cc",mediumorchid:"#ba55d3",rebeccapurple:"#663399",lightsteelblue:"#b0c4de",mediumslateblue:"#7b68ee",thistle:"#d8bfd8",tan:"#d2b48c",orchid:"#da70d6",mediumpurple:"#9370db",purple:"#800080",pink:"#ffc0cb",skyblue:"#87ceeb",springgreen:"#00ff7f",palegreen:"#98fb98",red:"#ff0000",yellow:"#ffff00",slateblue:"#6a5acd",lavenderblush:"#fff0f5",peru:"#cd853f",palevioletred:"#db7093",violet:"#ee82ee",teal:"#008080",slategray:"#708090",slategrey:"#708090",aliceblue:"#f0f8ff",darkseagreen:"#8fbc8f",darkolivegreen:"#556b2f",greenyellow:"#adff2f",seagreen:"#2e8b57",seashell:"#fff5ee",tomato:"#ff6347",silver:"#c0c0c0",sienna:"#a0522d",lavender:"#e6e6fa",lightgreen:"#90ee90",orange:"#ffa500",orangered:"#ff4500",steelblue:"#4682b4",royalblue:"#4169e1",turquoise:"#40e0d0",yellowgreen:"#9acd32",salmon:"#fa8072",saddlebrown:"#8b4513",sandybrown:"#f4a460",rosybrown:"#bc8f8f",darksalmon:"#e9967a",lightgoldenrodyellow:"#fafad2",snow:"#fffafa",lightgrey:"#d3d3d3",lightgray:"#d3d3d3",dimgray:"#696969",dimgrey:"#696969",olivedrab:"#6b8e23",olive:"#808000"},r={};for(var n in e)r[e[n]]=n;var i={};s.prototype.toName=function(o){if(!(this.rgba.a||this.rgba.r||this.rgba.g||this.rgba.b))return"transparent";var a,c,h=r[this.toHex()];if(h)return h;if(o!=null&&o.closest){var l=this.toRgb(),d=1/0,f="black";if(!i.length)for(var u in e)i[u]=new s(e[u]).toRgb();for(var p in e){var g=(a=l,c=i[p],Math.pow(a.r-c.r,2)+Math.pow(a.g-c.g,2)+Math.pow(a.b-c.b,2));g<d&&(d=g,f=p)}return f}},t.string.push([function(o){var a=o.toLowerCase(),c=a==="transparent"?"#0000":e[a];return c?new s(c).toRgb():null},"name"])}_l([vl]);const $e=class as{constructor(t=16777215){this._value=null,this._components=new Float32Array(4),this._components.fill(1),this._int=16777215,this.value=t}get red(){return this._components[0]}get green(){return this._components[1]}get blue(){return this._components[2]}get alpha(){return this._components[3]}setValue(t){return this.value=t,this}set value(t){if(t instanceof as)this._value=this._cloneSource(t._value),this._int=t._int,this._components.set(t._components);else{if(t===null)throw new Error("Cannot set Color#value to null");(this._value===null||!this._isSourceEqual(this._value,t))&&(this._value=this._cloneSource(t),this._normalize(this._value))}}get value(){return this._value}_cloneSource(t){return typeof t=="string"||typeof t=="number"||t instanceof Number||t===null?t:Array.isArray(t)||ArrayBuffer.isView(t)?t.slice(0):typeof t=="object"&&t!==null?{...t}:t}_isSourceEqual(t,e){const r=typeof t;if(r!==typeof e)return!1;if(r==="number"||r==="string"||t instanceof Number)return t===e;if(Array.isArray(t)&&Array.isArray(e)||ArrayBuffer.isView(t)&&ArrayBuffer.isView(e))return t.length!==e.length?!1:t.every((i,o)=>i===e[o]);if(t!==null&&e!==null){const i=Object.keys(t),o=Object.keys(e);return i.length!==o.length?!1:i.every(a=>t[a]===e[a])}return t===e}toRgba(){const[t,e,r,n]=this._components;return{r:t,g:e,b:r,a:n}}toRgb(){const[t,e,r]=this._components;return{r:t,g:e,b:r}}toRgbaString(){const[t,e,r]=this.toUint8RgbArray();return`rgba(${t},${e},${r},${this.alpha})`}toUint8RgbArray(t){const[e,r,n]=this._components;return this._arrayRgb||(this._arrayRgb=[]),t||(t=this._arrayRgb),t[0]=Math.round(e*255),t[1]=Math.round(r*255),t[2]=Math.round(n*255),t}toArray(t){this._arrayRgba||(this._arrayRgba=[]),t||(t=this._arrayRgba);const[e,r,n,i]=this._components;return t[0]=e,t[1]=r,t[2]=n,t[3]=i,t}toRgbArray(t){this._arrayRgb||(this._arrayRgb=[]),t||(t=this._arrayRgb);const[e,r,n]=this._components;return t[0]=e,t[1]=r,t[2]=n,t}toNumber(){return this._int}toBgrNumber(){const[t,e,r]=this.toUint8RgbArray();return(r<<16)+(e<<8)+t}toLittleEndianNumber(){const t=this._int;return(t>>16)+(t&65280)+((t&255)<<16)}multiply(t){const[e,r,n,i]=as._temp.setValue(t)._components;return this._components[0]*=e,this._components[1]*=r,this._components[2]*=n,this._components[3]*=i,this._refreshInt(),this._value=null,this}premultiply(t,e=!0){return e&&(this._components[0]*=t,this._components[1]*=t,this._components[2]*=t),this._components[3]=t,this._refreshInt(),this._value=null,this}toPremultiplied(t,e=!0){if(t===1)return(255<<24)+this._int;if(t===0)return e?0:this._int;let r=this._int>>16&255,n=this._int>>8&255,i=this._int&255;return e&&(r=r*t+.5|0,n=n*t+.5|0,i=i*t+.5|0),(t*255<<24)+(r<<16)+(n<<8)+i}toHex(){const t=this._int.toString(16);return`#${"000000".substring(0,6-t.length)+t}`}toHexa(){const e=Math.round(this._components[3]*255).toString(16);return this.toHex()+"00".substring(0,2-e.length)+e}setAlpha(t){return this._components[3]=this._clamp(t),this}_normalize(t){let e,r,n,i;if((typeof t=="number"||t instanceof Number)&&t>=0&&t<=16777215){const o=t;e=(o>>16&255)/255,r=(o>>8&255)/255,n=(o&255)/255,i=1}else if((Array.isArray(t)||t instanceof Float32Array)&&t.length>=3&&t.length<=4)t=this._clamp(t),[e,r,n,i=1]=t;else if((t instanceof Uint8Array||t instanceof Uint8ClampedArray)&&t.length>=3&&t.length<=4)t=this._clamp(t,0,255),[e,r,n,i=255]=t,e/=255,r/=255,n/=255,i/=255;else if(typeof t=="string"||typeof t=="object"){if(typeof t=="string"){const a=as.HEX_PATTERN.exec(t);a&&(t=`#${a[2]}`)}const o=Vt(t);o.isValid()&&({r:e,g:r,b:n,a:i}=o.rgba,e/=255,r/=255,n/=255)}if(e!==void 0)this._components[0]=e,this._components[1]=r,this._components[2]=n,this._components[3]=i,this._refreshInt();else throw new Error(`Unable to convert color ${t}`)}_refreshInt(){this._clamp(this._components);const[t,e,r]=this._components;this._int=(t*255<<16)+(e*255<<8)+(r*255|0)}_clamp(t,e=0,r=1){return typeof t=="number"?Math.min(Math.max(t,e),r):(t.forEach((n,i)=>{t[i]=Math.min(Math.max(n,e),r)}),t)}static isColorLike(t){return typeof t=="number"||typeof t=="string"||t instanceof Number||t instanceof as||Array.isArray(t)||t instanceof Uint8Array||t instanceof Uint8ClampedArray||t instanceof Float32Array||t.r!==void 0&&t.g!==void 0&&t.b!==void 0||t.r!==void 0&&t.g!==void 0&&t.b!==void 0&&t.a!==void 0||t.h!==void 0&&t.s!==void 0&&t.l!==void 0||t.h!==void 0&&t.s!==void 0&&t.l!==void 0&&t.a!==void 0||t.h!==void 0&&t.s!==void 0&&t.v!==void 0||t.h!==void 0&&t.s!==void 0&&t.v!==void 0&&t.a!==void 0}};$e.shared=new $e;$e._temp=new $e;$e.HEX_PATTERN=/^(#|0x)?(([a-f0-9]{3}){1,2}([a-f0-9]{2})?)$/i;let ct=$e;const Al={cullArea:null,cullable:!1,cullableChildren:!0};class Mn{constructor(t,e){this._pool=[],this._count=0,this._index=0,this._classType=t,e&&this.prepopulate(e)}prepopulate(t){for(let e=0;e<t;e++)this._pool[this._index++]=new this._classType;this._count+=t}get(t){var r;let e;return this._index>0?e=this._pool[--this._index]:e=new this._classType,(r=e.init)==null||r.call(e,t),e}return(t){var e;(e=t.reset)==null||e.call(t),this._pool[this._index++]=t}get totalSize(){return this._count}get totalFree(){return this._index}get totalUsed(){return this._count-this._index}clear(){this._pool.length=0,this._index=0}}class Sl{constructor(){this._poolsByClass=new Map}prepopulate(t,e){this.getPool(t).prepopulate(e)}get(t,e){return this.getPool(t).get(e)}return(t){this.getPool(t.constructor).return(t)}getPool(t){return this._poolsByClass.has(t)||this._poolsByClass.set(t,new Mn(t)),this._poolsByClass.get(t)}stats(){const t={};return this._poolsByClass.forEach(e=>{const r=t[e._classType.name]?e._classType.name+e._classType.ID:e._classType.name;t[r]={free:e.totalFree,used:e.totalUsed,size:e.totalSize}}),t}}const ae=new Sl,Cl={get isCachedAsTexture(){var s;return!!((s=this.renderGroup)!=null&&s.isCachedAsTexture)},cacheAsTexture(s){typeof s=="boolean"&&s===!1?this.disableRenderGroup():(this.enableRenderGroup(),this.renderGroup.enableCacheAsTexture(s===!0?{}:s))},updateCacheTexture(){var s;(s=this.renderGroup)==null||s.updateCacheTexture()},get cacheAsBitmap(){return this.isCachedAsTexture},set cacheAsBitmap(s){Y("v8.6.0","cacheAsBitmap is deprecated, use cacheAsTexture instead."),this.cacheAsTexture(s)}};function kl(s,t,e){const r=s.length;let n;if(t>=r||e===0)return;e=t+e>r?r-t:e;const i=r-e;for(n=t;n<i;++n)s[n]=s[n+e];s.length=i}const Ml={allowChildren:!0,removeChildren(s=0,t){var i;const e=t??this.children.length,r=e-s,n=[];if(r>0&&r<=e){for(let a=e-1;a>=s;a--){const c=this.children[a];c&&(n.push(c),c.parent=null)}kl(this.children,s,e);const o=this.renderGroup||this.parentRenderGroup;o&&o.removeChildren(n);for(let a=0;a<n.length;++a){const c=n[a];(i=c.parentRenderLayer)==null||i.detach(c),this.emit("childRemoved",c,this,a),n[a].emit("removed",this)}return n.length>0&&this._didViewChangeTick++,n}else if(r===0&&this.children.length===0)return n;throw new RangeError("removeChildren: numeric values are outside the acceptable range.")},removeChildAt(s){const t=this.getChildAt(s);return this.removeChild(t)},getChildAt(s){if(s<0||s>=this.children.length)throw new Error(`getChildAt: Index (${s}) does not exist.`);return this.children[s]},setChildIndex(s,t){if(t<0||t>=this.children.length)throw new Error(`The index ${t} supplied is out of bounds ${this.children.length}`);this.getChildIndex(s),this.addChildAt(s,t)},getChildIndex(s){const t=this.children.indexOf(s);if(t===-1)throw new Error("The supplied Container must be a child of the caller");return t},addChildAt(s,t){this.allowChildren||Y(Z,"addChildAt: Only Containers will be allowed to add children in v8.0.0");const{children:e}=this;if(t<0||t>e.length)throw new Error(`${s}addChildAt: The index ${t} supplied is out of bounds ${e.length}`);if(s.parent){const n=s.parent.children.indexOf(s);if(s.parent===this&&n===t)return s;n!==-1&&s.parent.children.splice(n,1)}t===e.length?e.push(s):e.splice(t,0,s),s.parent=this,s.didChange=!0,s._updateFlags=15;const r=this.renderGroup||this.parentRenderGroup;return r&&r.addChild(s),this.sortableChildren&&(this.sortDirty=!0),this.emit("childAdded",s,this,t),s.emit("added",this),s},swapChildren(s,t){if(s===t)return;const e=this.getChildIndex(s),r=this.getChildIndex(t);this.children[e]=t,this.children[r]=s;const n=this.renderGroup||this.parentRenderGroup;n&&(n.structureDidChange=!0),this._didContainerChangeTick++},removeFromParent(){var s;(s=this.parent)==null||s.removeChild(this)},reparentChild(...s){return s.length===1?this.reparentChildAt(s[0],this.children.length):(s.forEach(t=>this.reparentChildAt(t,this.children.length)),s[0])},reparentChildAt(s,t){if(s.parent===this)return this.setChildIndex(s,t),s;const e=s.worldTransform.clone();s.removeFromParent(),this.addChildAt(s,t);const r=this.worldTransform.clone();return r.invert(),e.prepend(r),s.setFromMatrix(e),s}},Pl={collectRenderables(s,t,e){this.parentRenderLayer&&this.parentRenderLayer!==e||this.globalDisplayStatus<7||!this.includeInBuild||(this.sortableChildren&&this.sortChildren(),this.isSimple?this.collectRenderablesSimple(s,t,e):this.renderGroup?t.renderPipes.renderGroup.addRenderGroup(this.renderGroup,s):this.collectRenderablesWithEffects(s,t,e))},collectRenderablesSimple(s,t,e){const r=this.children,n=r.length;for(let i=0;i<n;i++)r[i].collectRenderables(s,t,e)},collectRenderablesWithEffects(s,t,e){const{renderPipes:r}=t;for(let n=0;n<this.effects.length;n++){const i=this.effects[n];r[i.pipe].push(i,this,s)}this.collectRenderablesSimple(s,t,e);for(let n=this.effects.length-1;n>=0;n--){const i=this.effects[n];r[i.pipe].pop(i,this,s)}}};class ui{constructor(){this.pipe="filter",this.priority=1}destroy(){for(let t=0;t<this.filters.length;t++)this.filters[t].destroy();this.filters=null,this.filterArea=null}}class Tl{constructor(){this._effectClasses=[],this._tests=[],this._initialized=!1}init(){this._initialized||(this._initialized=!0,this._effectClasses.forEach(t=>{this.add({test:t.test,maskClass:t})}))}add(t){this._tests.push(t)}getMaskEffect(t){this._initialized||this.init();for(let e=0;e<this._tests.length;e++){const r=this._tests[e];if(r.test(t))return ae.get(r.maskClass,t)}return t}returnMaskEffect(t){ae.return(t)}}const rn=new Tl;ut.handleByList(O.MaskEffect,rn._effectClasses);const El={_maskEffect:null,_maskOptions:{inverse:!1},_filterEffect:null,effects:[],_markStructureAsChanged(){const s=this.renderGroup||this.parentRenderGroup;s&&(s.structureDidChange=!0)},addEffect(s){this.effects.indexOf(s)===-1&&(this.effects.push(s),this.effects.sort((e,r)=>e.priority-r.priority),this._markStructureAsChanged(),this._updateIsSimple())},removeEffect(s){const t=this.effects.indexOf(s);t!==-1&&(this.effects.splice(t,1),this._markStructureAsChanged(),this._updateIsSimple())},set mask(s){const t=this._maskEffect;(t==null?void 0:t.mask)!==s&&(t&&(this.removeEffect(t),rn.returnMaskEffect(t),this._maskEffect=null),s!=null&&(this._maskEffect=rn.getMaskEffect(s),this.addEffect(this._maskEffect)))},get mask(){var s;return(s=this._maskEffect)==null?void 0:s.mask},setMask(s){this._maskOptions={...this._maskOptions,...s},s.mask&&(this.mask=s.mask),this._markStructureAsChanged()},set filters(s){var i;!Array.isArray(s)&&s&&(s=[s]);const t=this._filterEffect||(this._filterEffect=new ui);s=s;const e=(s==null?void 0:s.length)>0,r=((i=t.filters)==null?void 0:i.length)>0,n=e!==r;s=Array.isArray(s)?s.slice(0):s,t.filters=Object.freeze(s),n&&(e?this.addEffect(t):(this.removeEffect(t),t.filters=s??null))},get filters(){var s;return(s=this._filterEffect)==null?void 0:s.filters},set filterArea(s){this._filterEffect||(this._filterEffect=new ui),this._filterEffect.filterArea=s},get filterArea(){var s;return(s=this._filterEffect)==null?void 0:s.filterArea}},Il={label:null,get name(){return Y(Z,"Container.name property has been removed, use Container.label instead"),this.label},set name(s){Y(Z,"Container.name property has been removed, use Container.label instead"),this.label=s},getChildByName(s,t=!1){return this.getChildByLabel(s,t)},getChildByLabel(s,t=!1){const e=this.children;for(let r=0;r<e.length;r++){const n=e[r];if(n.label===s||s instanceof RegExp&&s.test(n.label))return n}if(t)for(let r=0;r<e.length;r++){const i=e[r].getChildByLabel(s,!0);if(i)return i}return null},getChildrenByLabel(s,t=!1,e=[]){const r=this.children;for(let n=0;n<r.length;n++){const i=r[n];(i.label===s||s instanceof RegExp&&s.test(i.label))&&e.push(i)}if(t)for(let n=0;n<r.length;n++)r[n].getChildrenByLabel(s,!0,e);return e}},mt=new Mn(X),ce=new Mn(Dt),Bl=new X,Rl={getFastGlobalBounds(s,t){t||(t=new Dt),t.clear(),this._getGlobalBoundsRecursive(!!s,t,this.parentRenderLayer),t.isValid||t.set(0,0,0,0);const e=this.renderGroup||this.parentRenderGroup;return t.applyMatrix(e.worldTransform),t},_getGlobalBoundsRecursive(s,t,e){let r=t;if(s&&this.parentRenderLayer&&this.parentRenderLayer!==e||this.localDisplayStatus!==7||!this.measurable)return;const n=!!this.effects.length;if((this.renderGroup||n)&&(r=ce.get().clear()),this.boundsArea)t.addRect(this.boundsArea,this.worldTransform);else{if(this.renderPipeId){const o=this.bounds;r.addFrame(o.minX,o.minY,o.maxX,o.maxY,this.groupTransform)}const i=this.children;for(let o=0;o<i.length;o++)i[o]._getGlobalBoundsRecursive(s,r,e)}if(n){let i=!1;const o=this.renderGroup||this.parentRenderGroup;for(let a=0;a<this.effects.length;a++)this.effects[a].addBounds&&(i||(i=!0,r.applyMatrix(o.worldTransform)),this.effects[a].addBounds(r,!0));i&&(r.applyMatrix(o.worldTransform.copyTo(Bl).invert()),t.addBounds(r,this.relativeGroupTransform)),t.addBounds(r),ce.return(r)}else this.renderGroup&&(t.addBounds(r,this.relativeGroupTransform),ce.return(r))}};function Vo(s,t,e){e.clear();let r,n;return s.parent?t?r=s.parent.worldTransform:(n=mt.get().identity(),r=Pn(s,n)):r=X.IDENTITY,Yo(s,e,r,t),n&&mt.return(n),e.isValid||e.set(0,0,0,0),e}function Yo(s,t,e,r){var a,c;if(!s.visible||!s.measurable)return;let n;r?n=s.worldTransform:(s.updateLocalTransform(),n=mt.get(),n.appendFrom(s.localTransform,e));const i=t,o=!!s.effects.length;if(o&&(t=ce.get().clear()),s.boundsArea)t.addRect(s.boundsArea,n);else{s.bounds&&(t.matrix=n,t.addBounds(s.bounds));for(let h=0;h<s.children.length;h++)Yo(s.children[h],t,n,r)}if(o){for(let h=0;h<s.effects.length;h++)(c=(a=s.effects[h]).addBounds)==null||c.call(a,t);i.addBounds(t,X.IDENTITY),ce.return(t)}r||mt.return(n)}function Pn(s,t){const e=s.parent;return e&&(Pn(e,t),e.updateLocalTransform(),t.append(e.localTransform)),t}function Xo(s,t){if(s===16777215||!t)return t;if(t===16777215||!s)return s;const e=s>>16&255,r=s>>8&255,n=s&255,i=t>>16&255,o=t>>8&255,a=t&255,c=e*i/255|0,h=r*o/255|0,l=n*a/255|0;return(c<<16)+(h<<8)+l}const fi=16777215;function pi(s,t){return s===fi?t:t===fi?s:Xo(s,t)}function js(s){return((s&255)<<16)+(s&65280)+(s>>16&255)}const Fl={getGlobalAlpha(s){if(s)return this.renderGroup?this.renderGroup.worldAlpha:this.parentRenderGroup?this.parentRenderGroup.worldAlpha*this.alpha:this.alpha;let t=this.alpha,e=this.parent;for(;e;)t*=e.alpha,e=e.parent;return t},getGlobalTransform(s,t){if(t)return s.copyFrom(this.worldTransform);this.updateLocalTransform();const e=Pn(this,mt.get().identity());return s.appendFrom(this.localTransform,e),mt.return(e),s},getGlobalTint(s){if(s)return this.renderGroup?js(this.renderGroup.worldColor):this.parentRenderGroup?js(pi(this.localColor,this.parentRenderGroup.worldColor)):this.tint;let t=this.localColor,e=this.parent;for(;e;)t=pi(t,e.localColor),e=e.parent;return js(t)}};function qo(s,t,e){return t.clear(),e||(e=X.IDENTITY),Ko(s,t,e,s,!0),t.isValid||t.set(0,0,0,0),t}function Ko(s,t,e,r,n){var c,h;let i;if(n)i=mt.get(),i=e.copyTo(i);else{if(!s.visible||!s.measurable)return;s.updateLocalTransform();const l=s.localTransform;i=mt.get(),i.appendFrom(l,e)}const o=t,a=!!s.effects.length;if(a&&(t=ce.get().clear()),s.boundsArea)t.addRect(s.boundsArea,i);else{s.renderPipeId&&(t.matrix=i,t.addBounds(s.bounds));const l=s.children;for(let d=0;d<l.length;d++)Ko(l[d],t,i,r,!1)}if(a){for(let l=0;l<s.effects.length;l++)(h=(c=s.effects[l]).addLocalBounds)==null||h.call(c,t,r);o.addBounds(t,X.IDENTITY),ce.return(t)}mt.return(i)}function Zo(s,t){const e=s.children;for(let r=0;r<e.length;r++){const n=e[r],i=n.uid,o=(n._didViewChangeTick&65535)<<16|n._didContainerChangeTick&65535,a=t.index;(t.data[a]!==i||t.data[a+1]!==o)&&(t.data[t.index]=i,t.data[t.index+1]=o,t.didChange=!0),t.index=a+2,n.children.length&&Zo(n,t)}return t.didChange}const Ll=new X,zl={_localBoundsCacheId:-1,_localBoundsCacheData:null,_setWidth(s,t){const e=Math.sign(this.scale.x)||1;t!==0?this.scale.x=s/t*e:this.scale.x=e},_setHeight(s,t){const e=Math.sign(this.scale.y)||1;t!==0?this.scale.y=s/t*e:this.scale.y=e},getLocalBounds(){this._localBoundsCacheData||(this._localBoundsCacheData={data:[],index:1,didChange:!1,localBounds:new Dt});const s=this._localBoundsCacheData;return s.index=1,s.didChange=!1,s.data[0]!==this._didViewChangeTick&&(s.didChange=!0,s.data[0]=this._didViewChangeTick),Zo(this,s),s.didChange&&qo(this,s.localBounds,Ll),s.localBounds},getBounds(s,t){return Vo(this,s,t||new Dt)}},Gl={_onRender:null,set onRender(s){const t=this.renderGroup||this.parentRenderGroup;if(!s){this._onRender&&(t==null||t.removeOnRender(this)),this._onRender=null;return}this._onRender||t==null||t.addOnRender(this),this._onRender=s},get onRender(){return this._onRender}},Nl={_zIndex:0,sortDirty:!1,sortableChildren:!1,get zIndex(){return this._zIndex},set zIndex(s){this._zIndex!==s&&(this._zIndex=s,this.depthOfChildModified())},depthOfChildModified(){this.parent&&(this.parent.sortableChildren=!0,this.parent.sortDirty=!0),this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0)},sortChildren(){this.sortDirty&&(this.sortDirty=!1,this.children.sort(Ol))}};function Ol(s,t){return s._zIndex-t._zIndex}const Ul={getGlobalPosition(s=new ft,t=!1){return this.parent?this.parent.toGlobal(this._position,s,t):(s.x=this._position.x,s.y=this._position.y),s},toGlobal(s,t,e=!1){const r=this.getGlobalTransform(mt.get(),e);return t=r.apply(s,t),mt.return(r),t},toLocal(s,t,e,r){t&&(s=t.toGlobal(s,e,r));const n=this.getGlobalTransform(mt.get(),r);return e=n.applyInverse(s,e),mt.return(n),e}};class Qo{constructor(){this.uid=at("instructionSet"),this.instructions=[],this.instructionSize=0,this.renderables=[],this.gcTick=0}reset(){this.instructionSize=0}add(t){this.instructions[this.instructionSize++]=t}log(){this.instructions.length=this.instructionSize,console.table(this.instructions,["type","action"])}}let Dl=0;class Hl{constructor(t){this._poolKeyHash=Object.create(null),this._texturePool={},this.textureOptions=t||{},this.enableFullScreen=!1,this.textureStyle=new je(this.textureOptions)}createTexture(t,e,r){const n=new jt({...this.textureOptions,width:t,height:e,resolution:1,antialias:r,autoGarbageCollect:!1});return new $({source:n,label:`texturePool_${Dl++}`})}getOptimalTexture(t,e,r=1,n){let i=Math.ceil(t*r-1e-6),o=Math.ceil(e*r-1e-6);i=We(i),o=We(o);const a=(i<<17)+(o<<1)+(n?1:0);this._texturePool[a]||(this._texturePool[a]=[]);let c=this._texturePool[a].pop();return c||(c=this.createTexture(i,o,n)),c.source._resolution=r,c.source.width=i/r,c.source.height=o/r,c.source.pixelWidth=i,c.source.pixelHeight=o,c.frame.x=0,c.frame.y=0,c.frame.width=t,c.frame.height=e,c.updateUvs(),this._poolKeyHash[c.uid]=a,c}getSameSizeTexture(t,e=!1){const r=t.source;return this.getOptimalTexture(t.width,t.height,r._resolution,e)}returnTexture(t,e=!1){const r=this._poolKeyHash[t.uid];e&&(t.source.style=this.textureStyle),this._texturePool[r].push(t)}clear(t){if(t=t!==!1,t)for(const e in this._texturePool){const r=this._texturePool[e];if(r)for(let n=0;n<r.length;n++)r[n].destroy(!0)}this._texturePool={}}}const Wl=new Hl;class jl{constructor(){this.renderPipeId="renderGroup",this.root=null,this.canBundle=!1,this.renderGroupParent=null,this.renderGroupChildren=[],this.worldTransform=new X,this.worldColorAlpha=4294967295,this.worldColor=16777215,this.worldAlpha=1,this.childrenToUpdate=Object.create(null),this.updateTick=0,this.gcTick=0,this.childrenRenderablesToUpdate={list:[],index:0},this.structureDidChange=!0,this.instructionSet=new Qo,this._onRenderContainers=[],this.textureNeedsUpdate=!0,this.isCachedAsTexture=!1,this._matrixDirty=7}init(t){this.root=t,t._onRender&&this.addOnRender(t),t.didChange=!0;const e=t.children;for(let r=0;r<e.length;r++){const n=e[r];n._updateFlags=15,this.addChild(n)}}enableCacheAsTexture(t={}){this.textureOptions=t,this.isCachedAsTexture=!0,this.textureNeedsUpdate=!0}disableCacheAsTexture(){this.isCachedAsTexture=!1,this.texture&&(Wl.returnTexture(this.texture),this.texture=null)}updateCacheTexture(){this.textureNeedsUpdate=!0}reset(){this.renderGroupChildren.length=0;for(const t in this.childrenToUpdate){const e=this.childrenToUpdate[t];e.list.fill(null),e.index=0}this.childrenRenderablesToUpdate.index=0,this.childrenRenderablesToUpdate.list.fill(null),this.root=null,this.updateTick=0,this.structureDidChange=!0,this._onRenderContainers.length=0,this.renderGroupParent=null,this.disableCacheAsTexture()}get localTransform(){return this.root.localTransform}addRenderGroupChild(t){t.renderGroupParent&&t.renderGroupParent._removeRenderGroupChild(t),t.renderGroupParent=this,this.renderGroupChildren.push(t)}_removeRenderGroupChild(t){const e=this.renderGroupChildren.indexOf(t);e>-1&&this.renderGroupChildren.splice(e,1),t.renderGroupParent=null}addChild(t){if(this.structureDidChange=!0,t.parentRenderGroup=this,t.updateTick=-1,t.parent===this.root?t.relativeRenderGroupDepth=1:t.relativeRenderGroupDepth=t.parent.relativeRenderGroupDepth+1,t.didChange=!0,this.onChildUpdate(t),t.renderGroup){this.addRenderGroupChild(t.renderGroup);return}t._onRender&&this.addOnRender(t);const e=t.children;for(let r=0;r<e.length;r++)this.addChild(e[r])}removeChild(t){if(this.structureDidChange=!0,t._onRender&&(t.renderGroup||this.removeOnRender(t)),t.parentRenderGroup=null,t.renderGroup){this._removeRenderGroupChild(t.renderGroup);return}const e=t.children;for(let r=0;r<e.length;r++)this.removeChild(e[r])}removeChildren(t){for(let e=0;e<t.length;e++)this.removeChild(t[e])}onChildUpdate(t){let e=this.childrenToUpdate[t.relativeRenderGroupDepth];e||(e=this.childrenToUpdate[t.relativeRenderGroupDepth]={index:0,list:[]}),e.list[e.index++]=t}updateRenderable(t){t.globalDisplayStatus<7||(this.instructionSet.renderPipes[t.renderPipeId].updateRenderable(t),t.didViewUpdate=!1)}onChildViewUpdate(t){this.childrenRenderablesToUpdate.list[this.childrenRenderablesToUpdate.index++]=t}get isRenderable(){return this.root.localDisplayStatus===7&&this.worldAlpha>0}addOnRender(t){this._onRenderContainers.push(t)}removeOnRender(t){this._onRenderContainers.splice(this._onRenderContainers.indexOf(t),1)}runOnRender(t){for(let e=0;e<this._onRenderContainers.length;e++)this._onRenderContainers[e]._onRender(t)}destroy(){this.disableCacheAsTexture(),this.renderGroupParent=null,this.root=null,this.childrenRenderablesToUpdate=null,this.childrenToUpdate=null,this.renderGroupChildren=null,this._onRenderContainers=null,this.instructionSet=null}getChildren(t=[]){const e=this.root.children;for(let r=0;r<e.length;r++)this._getChildren(e[r],t);return t}_getChildren(t,e=[]){if(e.push(t),t.renderGroup)return e;const r=t.children;for(let n=0;n<r.length;n++)this._getChildren(r[n],e);return e}invalidateMatrices(){this._matrixDirty=7}get inverseWorldTransform(){return(this._matrixDirty&1)===0?this._inverseWorldTransform:(this._matrixDirty&=-2,this._inverseWorldTransform||(this._inverseWorldTransform=new X),this._inverseWorldTransform.copyFrom(this.worldTransform).invert())}get textureOffsetInverseTransform(){return(this._matrixDirty&2)===0?this._textureOffsetInverseTransform:(this._matrixDirty&=-3,this._textureOffsetInverseTransform||(this._textureOffsetInverseTransform=new X),this._textureOffsetInverseTransform.copyFrom(this.inverseWorldTransform).translate(-this._textureBounds.x,-this._textureBounds.y))}get inverseParentTextureTransform(){if((this._matrixDirty&4)===0)return this._inverseParentTextureTransform;this._matrixDirty&=-5;const t=this._parentCacheAsTextureRenderGroup;return t?(this._inverseParentTextureTransform||(this._inverseParentTextureTransform=new X),this._inverseParentTextureTransform.copyFrom(this.worldTransform).prepend(t.inverseWorldTransform).translate(-t._textureBounds.x,-t._textureBounds.y)):this.worldTransform}get cacheToLocalTransform(){return this._parentCacheAsTextureRenderGroup?this._parentCacheAsTextureRenderGroup.textureOffsetInverseTransform:null}}function $l(s,t,e={}){for(const r in t)!e[r]&&t[r]!==void 0&&(s[r]=t[r])}const wr=new bt(null),_r=new bt(null),vr=new bt(null,1,1),mi=1,Vl=2,Ar=4;class zt extends Wt{constructor(t={}){var e,r;super(),this.uid=at("renderable"),this._updateFlags=15,this.renderGroup=null,this.parentRenderGroup=null,this.parentRenderGroupIndex=0,this.didChange=!1,this.didViewUpdate=!1,this.relativeRenderGroupDepth=0,this.children=[],this.parent=null,this.includeInBuild=!0,this.measurable=!0,this.isSimple=!0,this.updateTick=-1,this.localTransform=new X,this.relativeGroupTransform=new X,this.groupTransform=this.relativeGroupTransform,this.destroyed=!1,this._position=new bt(this,0,0),this._scale=vr,this._pivot=_r,this._skew=wr,this._cx=1,this._sx=0,this._cy=0,this._sy=1,this._rotation=0,this.localColor=16777215,this.localAlpha=1,this.groupAlpha=1,this.groupColor=16777215,this.groupColorAlpha=4294967295,this.localBlendMode="inherit",this.groupBlendMode="normal",this.localDisplayStatus=7,this.globalDisplayStatus=7,this._didContainerChangeTick=0,this._didViewChangeTick=0,this._didLocalTransformChangeId=-1,this.effects=[],$l(this,t,{children:!0,parent:!0,effects:!0}),(e=t.children)==null||e.forEach(n=>this.addChild(n)),(r=t.parent)==null||r.addChild(this)}static mixin(t){Y("8.8.0","Container.mixin is deprecated, please use extensions.mixin instead."),ut.mixin(zt,t)}set _didChangeId(t){this._didViewChangeTick=t>>12&4095,this._didContainerChangeTick=t&4095}get _didChangeId(){return this._didContainerChangeTick&4095|(this._didViewChangeTick&4095)<<12}addChild(...t){if(this.allowChildren||Y(Z,"addChild: Only Containers will be allowed to add children in v8.0.0"),t.length>1){for(let n=0;n<t.length;n++)this.addChild(t[n]);return t[0]}const e=t[0],r=this.renderGroup||this.parentRenderGroup;return e.parent===this?(this.children.splice(this.children.indexOf(e),1),this.children.push(e),r&&(r.structureDidChange=!0),e):(e.parent&&e.parent.removeChild(e),this.children.push(e),this.sortableChildren&&(this.sortDirty=!0),e.parent=this,e.didChange=!0,e._updateFlags=15,r&&r.addChild(e),this.emit("childAdded",e,this,this.children.length-1),e.emit("added",this),this._didViewChangeTick++,e._zIndex!==0&&e.depthOfChildModified(),e)}removeChild(...t){if(t.length>1){for(let n=0;n<t.length;n++)this.removeChild(t[n]);return t[0]}const e=t[0],r=this.children.indexOf(e);return r>-1&&(this._didViewChangeTick++,this.children.splice(r,1),this.renderGroup?this.renderGroup.removeChild(e):this.parentRenderGroup&&this.parentRenderGroup.removeChild(e),e.parentRenderLayer&&e.parentRenderLayer.detach(e),e.parent=null,this.emit("childRemoved",e,this,r),e.emit("removed",this)),e}_onUpdate(t){t&&t===this._skew&&this._updateSkew(),this._didContainerChangeTick++,!this.didChange&&(this.didChange=!0,this.parentRenderGroup&&this.parentRenderGroup.onChildUpdate(this))}set isRenderGroup(t){!!this.renderGroup!==t&&(t?this.enableRenderGroup():this.disableRenderGroup())}get isRenderGroup(){return!!this.renderGroup}enableRenderGroup(){if(this.renderGroup)return;const t=this.parentRenderGroup;t==null||t.removeChild(this),this.renderGroup=ae.get(jl,this),this.groupTransform=X.IDENTITY,t==null||t.addChild(this),this._updateIsSimple()}disableRenderGroup(){if(!this.renderGroup)return;const t=this.parentRenderGroup;t==null||t.removeChild(this),ae.return(this.renderGroup),this.renderGroup=null,this.groupTransform=this.relativeGroupTransform,t==null||t.addChild(this),this._updateIsSimple()}_updateIsSimple(){this.isSimple=!this.renderGroup&&this.effects.length===0}get worldTransform(){return this._worldTransform||(this._worldTransform=new X),this.renderGroup?this._worldTransform.copyFrom(this.renderGroup.worldTransform):this.parentRenderGroup&&this._worldTransform.appendFrom(this.relativeGroupTransform,this.parentRenderGroup.worldTransform),this._worldTransform}get x(){return this._position.x}set x(t){this._position.x=t}get y(){return this._position.y}set y(t){this._position.y=t}get position(){return this._position}set position(t){this._position.copyFrom(t)}get rotation(){return this._rotation}set rotation(t){this._rotation!==t&&(this._rotation=t,this._onUpdate(this._skew))}get angle(){return this.rotation*il}set angle(t){this.rotation=t*ol}get pivot(){return this._pivot===_r&&(this._pivot=new bt(this,0,0)),this._pivot}set pivot(t){this._pivot===_r&&(this._pivot=new bt(this,0,0)),typeof t=="number"?this._pivot.set(t):this._pivot.copyFrom(t)}get skew(){return this._skew===wr&&(this._skew=new bt(this,0,0)),this._skew}set skew(t){this._skew===wr&&(this._skew=new bt(this,0,0)),this._skew.copyFrom(t)}get scale(){return this._scale===vr&&(this._scale=new bt(this,1,1)),this._scale}set scale(t){this._scale===vr&&(this._scale=new bt(this,0,0)),typeof t=="number"?this._scale.set(t):this._scale.copyFrom(t)}get width(){return Math.abs(this.scale.x*this.getLocalBounds().width)}set width(t){const e=this.getLocalBounds().width;this._setWidth(t,e)}get height(){return Math.abs(this.scale.y*this.getLocalBounds().height)}set height(t){const e=this.getLocalBounds().height;this._setHeight(t,e)}getSize(t){t||(t={});const e=this.getLocalBounds();return t.width=Math.abs(this.scale.x*e.width),t.height=Math.abs(this.scale.y*e.height),t}setSize(t,e){const r=this.getLocalBounds();typeof t=="object"?(e=t.height??t.width,t=t.width):e??(e=t),t!==void 0&&this._setWidth(t,r.width),e!==void 0&&this._setHeight(e,r.height)}_updateSkew(){const t=this._rotation,e=this._skew;this._cx=Math.cos(t+e._y),this._sx=Math.sin(t+e._y),this._cy=-Math.sin(t-e._x),this._sy=Math.cos(t-e._x)}updateTransform(t){return this.position.set(typeof t.x=="number"?t.x:this.position.x,typeof t.y=="number"?t.y:this.position.y),this.scale.set(typeof t.scaleX=="number"?t.scaleX||1:this.scale.x,typeof t.scaleY=="number"?t.scaleY||1:this.scale.y),this.rotation=typeof t.rotation=="number"?t.rotation:this.rotation,this.skew.set(typeof t.skewX=="number"?t.skewX:this.skew.x,typeof t.skewY=="number"?t.skewY:this.skew.y),this.pivot.set(typeof t.pivotX=="number"?t.pivotX:this.pivot.x,typeof t.pivotY=="number"?t.pivotY:this.pivot.y),this}setFromMatrix(t){t.decompose(this)}updateLocalTransform(){const t=this._didContainerChangeTick;if(this._didLocalTransformChangeId===t)return;this._didLocalTransformChangeId=t;const e=this.localTransform,r=this._scale,n=this._pivot,i=this._position,o=r._x,a=r._y,c=n._x,h=n._y;e.a=this._cx*o,e.b=this._sx*o,e.c=this._cy*a,e.d=this._sy*a,e.tx=i._x-(c*e.a+h*e.c),e.ty=i._y-(c*e.b+h*e.d)}set alpha(t){t!==this.localAlpha&&(this.localAlpha=t,this._updateFlags|=mi,this._onUpdate())}get alpha(){return this.localAlpha}set tint(t){const r=ct.shared.setValue(t??16777215).toBgrNumber();r!==this.localColor&&(this.localColor=r,this._updateFlags|=mi,this._onUpdate())}get tint(){return js(this.localColor)}set blendMode(t){this.localBlendMode!==t&&(this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0),this._updateFlags|=Vl,this.localBlendMode=t,this._onUpdate())}get blendMode(){return this.localBlendMode}get visible(){return!!(this.localDisplayStatus&2)}set visible(t){const e=t?2:0;(this.localDisplayStatus&2)!==e&&(this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0),this._updateFlags|=Ar,this.localDisplayStatus^=2,this._onUpdate())}get culled(){return!(this.localDisplayStatus&4)}set culled(t){const e=t?0:4;(this.localDisplayStatus&4)!==e&&(this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0),this._updateFlags|=Ar,this.localDisplayStatus^=4,this._onUpdate())}get renderable(){return!!(this.localDisplayStatus&1)}set renderable(t){const e=t?1:0;(this.localDisplayStatus&1)!==e&&(this._updateFlags|=Ar,this.localDisplayStatus^=1,this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0),this._onUpdate())}get isRenderable(){return this.localDisplayStatus===7&&this.groupAlpha>0}destroy(t=!1){var n;if(this.destroyed)return;this.destroyed=!0;let e;if(this.children.length&&(e=this.removeChildren(0,this.children.length)),this.removeFromParent(),this.parent=null,this._maskEffect=null,this._filterEffect=null,this.effects=null,this._position=null,this._scale=null,this._pivot=null,this._skew=null,this.emit("destroyed",this),this.removeAllListeners(),(typeof t=="boolean"?t:t==null?void 0:t.children)&&e)for(let i=0;i<e.length;++i)e[i].destroy(t);(n=this.renderGroup)==null||n.destroy(),this.renderGroup=null}}ut.mixin(zt,Ml,Rl,Ul,Gl,zl,El,Il,Nl,Al,Cl,Fl,Pl);class Tn extends zt{constructor(t){super(t),this.canBundle=!0,this.allowChildren=!1,this._roundPixels=0,this._lastUsed=-1,this._gpuData=Object.create(null),this._bounds=new Dt(0,1,0,0),this._boundsDirty=!0}get bounds(){return this._boundsDirty?(this.updateBounds(),this._boundsDirty=!1,this._bounds):this._bounds}get roundPixels(){return!!this._roundPixels}set roundPixels(t){this._roundPixels=t?1:0}containsPoint(t){const e=this.bounds,{x:r,y:n}=t;return r>=e.minX&&r<=e.maxX&&n>=e.minY&&n<=e.maxY}onViewUpdate(){if(this._didViewChangeTick++,this._boundsDirty=!0,this.didViewUpdate)return;this.didViewUpdate=!0;const t=this.renderGroup||this.parentRenderGroup;t&&t.onChildViewUpdate(this)}destroy(t){var e,r;super.destroy(t),this._bounds=null;for(const n in this._gpuData)(r=(e=this._gpuData[n]).destroy)==null||r.call(e);this._gpuData=null}collectRenderablesSimple(t,e,r){const{renderPipes:n}=e;n.blendMode.setBlendMode(this,this.groupBlendMode,t),n[this.renderPipeId].addRenderable(this,t),this.didViewUpdate=!1;const o=this.children,a=o.length;for(let c=0;c<a;c++)o[c].collectRenderables(t,e,r)}}class Ht extends Tn{constructor(t=$.EMPTY){t instanceof $&&(t={texture:t});const{texture:e=$.EMPTY,anchor:r,roundPixels:n,width:i,height:o,...a}=t;super({label:"Sprite",...a}),this.renderPipeId="sprite",this.batched=!0,this._visualBounds={minX:0,maxX:1,minY:0,maxY:0},this._anchor=new bt({_onUpdate:()=>{this.onViewUpdate()}}),r?this.anchor=r:e.defaultAnchor&&(this.anchor=e.defaultAnchor),this.texture=e,this.allowChildren=!1,this.roundPixels=n??!1,i!==void 0&&(this.width=i),o!==void 0&&(this.height=o)}static from(t,e=!1){return t instanceof $?new Ht(t):new Ht($.from(t,e))}set texture(t){t||(t=$.EMPTY);const e=this._texture;e!==t&&(e&&e.dynamic&&e.off("update",this.onViewUpdate,this),t.dynamic&&t.on("update",this.onViewUpdate,this),this._texture=t,this._width&&this._setWidth(this._width,this._texture.orig.width),this._height&&this._setHeight(this._height,this._texture.orig.height),this.onViewUpdate())}get texture(){return this._texture}get visualBounds(){return fl(this._visualBounds,this._anchor,this._texture),this._visualBounds}get sourceBounds(){return Y("8.6.1","Sprite.sourceBounds is deprecated, use visualBounds instead."),this.visualBounds}updateBounds(){const t=this._anchor,e=this._texture,r=this._bounds,{width:n,height:i}=e.orig;r.minX=-t._x*n,r.maxX=r.minX+n,r.minY=-t._y*i,r.maxY=r.minY+i}destroy(t=!1){if(super.destroy(t),typeof t=="boolean"?t:t==null?void 0:t.texture){const r=typeof t=="boolean"?t:t==null?void 0:t.textureSource;this._texture.destroy(r)}this._texture=null,this._visualBounds=null,this._bounds=null,this._anchor=null,this._gpuData=null}get anchor(){return this._anchor}set anchor(t){typeof t=="number"?this._anchor.set(t):this._anchor.copyFrom(t)}get width(){return Math.abs(this.scale.x)*this._texture.orig.width}set width(t){this._setWidth(t,this._texture.orig.width),this._width=t}get height(){return Math.abs(this.scale.y)*this._texture.orig.height}set height(t){this._setHeight(t,this._texture.orig.height),this._height=t}getSize(t){return t||(t={}),t.width=Math.abs(this.scale.x)*this._texture.orig.width,t.height=Math.abs(this.scale.y)*this._texture.orig.height,t}setSize(t,e){typeof t=="object"?(e=t.height??t.width,t=t.width):e??(e=t),t!==void 0&&this._setWidth(t,this._texture.orig.width),e!==void 0&&this._setHeight(e,this._texture.orig.height)}}const Yl=new Dt;function Jo(s,t,e){const r=Yl;s.measurable=!0,Vo(s,e,r),t.addBoundsMask(r),s.measurable=!1}let Sr=0;const gi=500;function it(...s){Sr!==gi&&(Sr++,Sr===gi?console.warn("PixiJS Warning: too many warnings, no more warnings will be reported to the console by PixiJS."):console.warn("PixiJS Warning: ",...s))}function ta(s,t,e){const r=ce.get();s.measurable=!0;const n=mt.get().identity(),i=ea(s,e,n);qo(s,r,i),s.measurable=!1,t.addBoundsMask(r),mt.return(n),ce.return(r)}function ea(s,t,e){return s?(s!==t&&(ea(s.parent,t,e),s.updateLocalTransform(),e.append(s.localTransform)),e):(it("Mask bounds, renderable is not inside the root container"),e)}class sa{constructor(t){this.priority=0,this.inverse=!1,this.pipe="alphaMask",t!=null&&t.mask&&this.init(t.mask)}init(t){this.mask=t,this.renderMaskToTexture=!(t instanceof Ht),this.mask.renderable=this.renderMaskToTexture,this.mask.includeInBuild=!this.renderMaskToTexture,this.mask.measurable=!1}reset(){this.mask.measurable=!0,this.mask=null}addBounds(t,e){this.inverse||Jo(this.mask,t,e)}addLocalBounds(t,e){ta(this.mask,t,e)}containsPoint(t,e){const r=this.mask;return e(r,t)}destroy(){this.reset()}static test(t){return t instanceof Ht}}sa.extension=O.MaskEffect;class ra{constructor(t){this.priority=0,this.pipe="colorMask",t!=null&&t.mask&&this.init(t.mask)}init(t){this.mask=t}destroy(){}static test(t){return typeof t=="number"}}ra.extension=O.MaskEffect;class na{constructor(t){this.priority=0,this.pipe="stencilMask",t!=null&&t.mask&&this.init(t.mask)}init(t){this.mask=t,this.mask.includeInBuild=!1,this.mask.measurable=!1}reset(){this.mask.measurable=!0,this.mask.includeInBuild=!0,this.mask=null}addBounds(t,e){Jo(this.mask,t,e)}addLocalBounds(t,e){ta(this.mask,t,e)}containsPoint(t,e){const r=this.mask;return e(r,t)}destroy(){this.reset()}static test(t){return t instanceof zt}}na.extension=O.MaskEffect;const Xl={createCanvas:(s,t)=>{const e=document.createElement("canvas");return e.width=s,e.height=t,e},getCanvasRenderingContext2D:()=>CanvasRenderingContext2D,getWebGLRenderingContext:()=>WebGLRenderingContext,getNavigator:()=>navigator,getBaseUrl:()=>document.baseURI??window.location.href,getFontFaceSet:()=>document.fonts,fetch:(s,t)=>fetch(s,t),parseXML:s=>new DOMParser().parseFromString(s,"text/xml")};let xi=Xl;const ot={get(){return xi},set(s){xi=s}};class ia extends jt{constructor(t){t.resource||(t.resource=ot.get().createCanvas()),t.width||(t.width=t.resource.width,t.autoDensity||(t.width/=t.resolution)),t.height||(t.height=t.resource.height,t.autoDensity||(t.height/=t.resolution)),super(t),this.uploadMethodId="image",this.autoDensity=t.autoDensity,this.resizeCanvas(),this.transparent=!!t.transparent}resizeCanvas(){this.autoDensity&&"style"in this.resource&&(this.resource.style.width=`${this.width}px`,this.resource.style.height=`${this.height}px`),(this.resource.width!==this.pixelWidth||this.resource.height!==this.pixelHeight)&&(this.resource.width=this.pixelWidth,this.resource.height=this.pixelHeight)}resize(t=this.width,e=this.height,r=this._resolution){const n=super.resize(t,e,r);return n&&this.resizeCanvas(),n}static test(t){return globalThis.HTMLCanvasElement&&t instanceof HTMLCanvasElement||globalThis.OffscreenCanvas&&t instanceof OffscreenCanvas}get context2D(){return this._context2D||(this._context2D=this.resource.getContext("2d"))}}ia.extension=O.TextureSource;class Fe extends jt{constructor(t){super(t),this.uploadMethodId="image",this.autoGarbageCollect=!0}static test(t){return globalThis.HTMLImageElement&&t instanceof HTMLImageElement||typeof ImageBitmap<"u"&&t instanceof ImageBitmap||globalThis.VideoFrame&&t instanceof VideoFrame}}Fe.extension=O.TextureSource;var Xs=(s=>(s[s.INTERACTION=50]="INTERACTION",s[s.HIGH=25]="HIGH",s[s.NORMAL=0]="NORMAL",s[s.LOW=-25]="LOW",s[s.UTILITY=-50]="UTILITY",s))(Xs||{});class Cr{constructor(t,e=null,r=0,n=!1){this.next=null,this.previous=null,this._destroyed=!1,this._fn=t,this._context=e,this.priority=r,this._once=n}match(t,e=null){return this._fn===t&&this._context===e}emit(t){this._fn&&(this._context?this._fn.call(this._context,t):this._fn(t));const e=this.next;return this._once&&this.destroy(!0),this._destroyed&&(this.next=null),e}connect(t){this.previous=t,t.next&&(t.next.previous=this),this.next=t.next,t.next=this}destroy(t=!1){this._destroyed=!0,this._fn=null,this._context=null,this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous);const e=this.next;return this.next=t?null:e,this.previous=null,e}}const oa=class At{constructor(){this.autoStart=!1,this.deltaTime=1,this.lastTime=-1,this.speed=1,this.started=!1,this._requestId=null,this._maxElapsedMS=100,this._minElapsedMS=0,this._protected=!1,this._lastFrame=-1,this._head=new Cr(null,null,1/0),this.deltaMS=1/At.targetFPMS,this.elapsedMS=1/At.targetFPMS,this._tick=t=>{this._requestId=null,this.started&&(this.update(t),this.started&&this._requestId===null&&this._head.next&&(this._requestId=requestAnimationFrame(this._tick)))}}_requestIfNeeded(){this._requestId===null&&this._head.next&&(this.lastTime=performance.now(),this._lastFrame=this.lastTime,this._requestId=requestAnimationFrame(this._tick))}_cancelIfNeeded(){this._requestId!==null&&(cancelAnimationFrame(this._requestId),this._requestId=null)}_startIfPossible(){this.started?this._requestIfNeeded():this.autoStart&&this.start()}add(t,e,r=Xs.NORMAL){return this._addListener(new Cr(t,e,r))}addOnce(t,e,r=Xs.NORMAL){return this._addListener(new Cr(t,e,r,!0))}_addListener(t){let e=this._head.next,r=this._head;if(!e)t.connect(r);else{for(;e;){if(t.priority>e.priority){t.connect(r);break}r=e,e=e.next}t.previous||t.connect(r)}return this._startIfPossible(),this}remove(t,e){let r=this._head.next;for(;r;)r.match(t,e)?r=r.destroy():r=r.next;return this._head.next||this._cancelIfNeeded(),this}get count(){if(!this._head)return 0;let t=0,e=this._head;for(;e=e.next;)t++;return t}start(){this.started||(this.started=!0,this._requestIfNeeded())}stop(){this.started&&(this.started=!1,this._cancelIfNeeded())}destroy(){if(!this._protected){this.stop();let t=this._head.next;for(;t;)t=t.destroy(!0);this._head.destroy(),this._head=null}}update(t=performance.now()){let e;if(t>this.lastTime){if(e=this.elapsedMS=t-this.lastTime,e>this._maxElapsedMS&&(e=this._maxElapsedMS),e*=this.speed,this._minElapsedMS){const i=t-this._lastFrame|0;if(i<this._minElapsedMS)return;this._lastFrame=t-i%this._minElapsedMS}this.deltaMS=e,this.deltaTime=this.deltaMS*At.targetFPMS;const r=this._head;let n=r.next;for(;n;)n=n.emit(this);r.next||this._cancelIfNeeded()}else this.deltaTime=this.deltaMS=this.elapsedMS=0;this.lastTime=t}get FPS(){return 1e3/this.elapsedMS}get minFPS(){return 1e3/this._maxElapsedMS}set minFPS(t){const e=Math.min(this.maxFPS,t),r=Math.min(Math.max(0,e)/1e3,At.targetFPMS);this._maxElapsedMS=1/r}get maxFPS(){return this._minElapsedMS?Math.round(1e3/this._minElapsedMS):0}set maxFPS(t){if(t===0)this._minElapsedMS=0;else{const e=Math.max(this.minFPS,t);this._minElapsedMS=1/(e/1e3)}}static get shared(){if(!At._shared){const t=At._shared=new At;t.autoStart=!0,t._protected=!0}return At._shared}static get system(){if(!At._system){const t=At._system=new At;t.autoStart=!0,t._protected=!0}return At._system}};oa.targetFPMS=.06;let Ut=oa,kr;async function aa(){return kr??(kr=(async()=>{var o;const t=document.createElement("canvas").getContext("webgl");if(!t)return"premultiply-alpha-on-upload";const e=await new Promise(a=>{const c=document.createElement("video");c.onloadeddata=()=>a(c),c.onerror=()=>a(null),c.autoplay=!1,c.crossOrigin="anonymous",c.preload="auto",c.src="data:video/webm;base64,GkXfo59ChoEBQveBAULygQRC84EIQoKEd2VibUKHgQJChYECGFOAZwEAAAAAAAHTEU2bdLpNu4tTq4QVSalmU6yBoU27i1OrhBZUrmtTrIHGTbuMU6uEElTDZ1OsggEXTbuMU6uEHFO7a1OsggG97AEAAAAAAABZAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAVSalmoCrXsYMPQkBNgIRMYXZmV0GETGF2ZkSJiEBEAAAAAAAAFlSua8yuAQAAAAAAAEPXgQFzxYgAAAAAAAAAAZyBACK1nIN1bmSIgQCGhVZfVlA5g4EBI+ODhAJiWgDglLCBArqBApqBAlPAgQFVsIRVuYEBElTDZ9Vzc9JjwItjxYgAAAAAAAAAAWfInEWjh0VOQ09ERVJEh49MYXZjIGxpYnZweC12cDlnyKJFo4hEVVJBVElPTkSHlDAwOjAwOjAwLjA0MDAwMDAwMAAAH0O2dcfngQCgwqGggQAAAIJJg0IAABAAFgA4JBwYSgAAICAAEb///4r+AAB1oZ2mm+6BAaWWgkmDQgAAEAAWADgkHBhKAAAgIABIQBxTu2uRu4+zgQC3iveBAfGCAXHwgQM=",c.load()});if(!e)return"premultiply-alpha-on-upload";const r=t.createTexture();t.bindTexture(t.TEXTURE_2D,r);const n=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,n),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,r,0),t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),t.pixelStorei(t.UNPACK_COLORSPACE_CONVERSION_WEBGL,t.NONE),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,e);const i=new Uint8Array(4);return t.readPixels(0,0,1,1,t.RGBA,t.UNSIGNED_BYTE,i),t.deleteFramebuffer(n),t.deleteTexture(r),(o=t.getExtension("WEBGL_lose_context"))==null||o.loseContext(),i[0]<=i[3]?"premultiplied-alpha":"premultiply-alpha-on-upload"})()),kr}const ar=class ca extends jt{constructor(t){super(t),this.isReady=!1,this.uploadMethodId="video",t={...ca.defaultOptions,...t},this._autoUpdate=!0,this._isConnectedToTicker=!1,this._updateFPS=t.updateFPS||0,this._msToNextUpdate=0,this.autoPlay=t.autoPlay!==!1,this.alphaMode=t.alphaMode??"premultiply-alpha-on-upload",this._videoFrameRequestCallback=this._videoFrameRequestCallback.bind(this),this._videoFrameRequestCallbackHandle=null,this._load=null,this._resolve=null,this._reject=null,this._onCanPlay=this._onCanPlay.bind(this),this._onCanPlayThrough=this._onCanPlayThrough.bind(this),this._onError=this._onError.bind(this),this._onPlayStart=this._onPlayStart.bind(this),this._onPlayStop=this._onPlayStop.bind(this),this._onSeeked=this._onSeeked.bind(this),t.autoLoad!==!1&&this.load()}updateFrame(){if(!this.destroyed){if(this._updateFPS){const t=Ut.shared.elapsedMS*this.resource.playbackRate;this._msToNextUpdate=Math.floor(this._msToNextUpdate-t)}(!this._updateFPS||this._msToNextUpdate<=0)&&(this._msToNextUpdate=this._updateFPS?Math.floor(1e3/this._updateFPS):0),this.isValid&&this.update()}}_videoFrameRequestCallback(){this.updateFrame(),this.destroyed?this._videoFrameRequestCallbackHandle=null:this._videoFrameRequestCallbackHandle=this.resource.requestVideoFrameCallback(this._videoFrameRequestCallback)}get isValid(){return!!this.resource.videoWidth&&!!this.resource.videoHeight}async load(){if(this._load)return this._load;const t=this.resource,e=this.options;return(t.readyState===t.HAVE_ENOUGH_DATA||t.readyState===t.HAVE_FUTURE_DATA)&&t.width&&t.height&&(t.complete=!0),t.addEventListener("play",this._onPlayStart),t.addEventListener("pause",this._onPlayStop),t.addEventListener("seeked",this._onSeeked),this._isSourceReady()?this._mediaReady():(e.preload||t.addEventListener("canplay",this._onCanPlay),t.addEventListener("canplaythrough",this._onCanPlayThrough),t.addEventListener("error",this._onError,!0)),this.alphaMode=await aa(),this._load=new Promise((r,n)=>{this.isValid?r(this):(this._resolve=r,this._reject=n,e.preloadTimeoutMs!==void 0&&(this._preloadTimeout=setTimeout(()=>{this._onError(new ErrorEvent(`Preload exceeded timeout of ${e.preloadTimeoutMs}ms`))})),t.load())}),this._load}_onError(t){this.resource.removeEventListener("error",this._onError,!0),this.emit("error",t),this._reject&&(this._reject(t),this._reject=null,this._resolve=null)}_isSourcePlaying(){const t=this.resource;return!t.paused&&!t.ended}_isSourceReady(){return this.resource.readyState>2}_onPlayStart(){this.isValid||this._mediaReady(),this._configureAutoUpdate()}_onPlayStop(){this._configureAutoUpdate()}_onSeeked(){this._autoUpdate&&!this._isSourcePlaying()&&(this._msToNextUpdate=0,this.updateFrame(),this._msToNextUpdate=0)}_onCanPlay(){this.resource.removeEventListener("canplay",this._onCanPlay),this._mediaReady()}_onCanPlayThrough(){this.resource.removeEventListener("canplaythrough",this._onCanPlay),this._preloadTimeout&&(clearTimeout(this._preloadTimeout),this._preloadTimeout=void 0),this._mediaReady()}_mediaReady(){const t=this.resource;this.isValid&&(this.isReady=!0,this.resize(t.videoWidth,t.videoHeight)),this._msToNextUpdate=0,this.updateFrame(),this._msToNextUpdate=0,this._resolve&&(this._resolve(this),this._resolve=null,this._reject=null),this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&this.resource.play()}destroy(){this._configureAutoUpdate();const t=this.resource;t&&(t.removeEventListener("play",this._onPlayStart),t.removeEventListener("pause",this._onPlayStop),t.removeEventListener("seeked",this._onSeeked),t.removeEventListener("canplay",this._onCanPlay),t.removeEventListener("canplaythrough",this._onCanPlayThrough),t.removeEventListener("error",this._onError,!0),t.pause(),t.src="",t.load()),super.destroy()}get autoUpdate(){return this._autoUpdate}set autoUpdate(t){t!==this._autoUpdate&&(this._autoUpdate=t,this._configureAutoUpdate())}get updateFPS(){return this._updateFPS}set updateFPS(t){t!==this._updateFPS&&(this._updateFPS=t,this._configureAutoUpdate())}_configureAutoUpdate(){this._autoUpdate&&this._isSourcePlaying()?!this._updateFPS&&this.resource.requestVideoFrameCallback?(this._isConnectedToTicker&&(Ut.shared.remove(this.updateFrame,this),this._isConnectedToTicker=!1,this._msToNextUpdate=0),this._videoFrameRequestCallbackHandle===null&&(this._videoFrameRequestCallbackHandle=this.resource.requestVideoFrameCallback(this._videoFrameRequestCallback))):(this._videoFrameRequestCallbackHandle!==null&&(this.resource.cancelVideoFrameCallback(this._videoFrameRequestCallbackHandle),this._videoFrameRequestCallbackHandle=null),this._isConnectedToTicker||(Ut.shared.add(this.updateFrame,this),this._isConnectedToTicker=!0,this._msToNextUpdate=0)):(this._videoFrameRequestCallbackHandle!==null&&(this.resource.cancelVideoFrameCallback(this._videoFrameRequestCallbackHandle),this._videoFrameRequestCallbackHandle=null),this._isConnectedToTicker&&(Ut.shared.remove(this.updateFrame,this),this._isConnectedToTicker=!1,this._msToNextUpdate=0))}static test(t){return globalThis.HTMLVideoElement&&t instanceof HTMLVideoElement}};ar.extension=O.TextureSource;ar.defaultOptions={...jt.defaultOptions,autoLoad:!0,autoPlay:!0,updateFPS:0,crossorigin:!0,loop:!1,muted:!0,playsinline:!0,preload:!1};ar.MIME_TYPES={ogv:"video/ogg",mov:"video/quicktime",m4v:"video/mp4"};let $s=ar;const Ot=(s,t,e=!1)=>(Array.isArray(s)||(s=[s]),t?s.map(r=>typeof r=="string"||e?t(r):r):s);class ql{constructor(){this._parsers=[],this._cache=new Map,this._cacheMap=new Map}reset(){this._cacheMap.clear(),this._cache.clear()}has(t){return this._cache.has(t)}get(t){const e=this._cache.get(t);return e||it(`[Assets] Asset id ${t} was not found in the Cache`),e}set(t,e){const r=Ot(t);let n;for(let c=0;c<this.parsers.length;c++){const h=this.parsers[c];if(h.test(e)){n=h.getCacheableAssets(r,e);break}}const i=new Map(Object.entries(n||{}));n||r.forEach(c=>{i.set(c,e)});const o=[...i.keys()],a={cacheKeys:o,keys:r};r.forEach(c=>{this._cacheMap.set(c,a)}),o.forEach(c=>{const h=n?n[c]:e;this._cache.has(c)&&this._cache.get(c)!==h&&it("[Cache] already has key:",c),this._cache.set(c,i.get(c))})}remove(t){if(!this._cacheMap.has(t)){it(`[Assets] Asset id ${t} was not found in the Cache`);return}const e=this._cacheMap.get(t);e.cacheKeys.forEach(n=>{this._cache.delete(n)}),e.keys.forEach(n=>{this._cacheMap.delete(n)})}get parsers(){return this._parsers}}const nt=new ql,nn=[];ut.handleByList(O.TextureSource,nn);function la(s={}){const t=s&&s.resource,e=t?s.resource:s,r=t?s:{resource:s};for(let n=0;n<nn.length;n++){const i=nn[n];if(i.test(e))return new i(r)}throw new Error(`Could not find a source type for resource: ${r.resource}`)}function Kl(s={},t=!1){const e=s&&s.resource,r=e?s.resource:s,n=e?s:{resource:s};if(!t&&nt.has(r))return nt.get(r);const i=new $({source:la(n)});return i.on("destroy",()=>{nt.has(r)&&nt.remove(r)}),t||nt.set(r,i),i}function Zl(s,t=!1){return typeof s=="string"?nt.get(s):s instanceof jt?new $({source:s}):Kl(s,t)}$.from=Zl;jt.from=la;ut.add(sa,ra,na,$s,Fe,ia,kn);var xe=(s=>(s[s.Low=0]="Low",s[s.Normal=1]="Normal",s[s.High=2]="High",s))(xe||{});function Gt(s){if(typeof s!="string")throw new TypeError(`Path must be a string. Received ${JSON.stringify(s)}`)}function es(s){return s.split("?")[0].split("#")[0]}function Ql(s){return s.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function Jl(s,t,e){return s.replace(new RegExp(Ql(t),"g"),e)}function th(s,t){let e="",r=0,n=-1,i=0,o=-1;for(let a=0;a<=s.length;++a){if(a<s.length)o=s.charCodeAt(a);else{if(o===47)break;o=47}if(o===47){if(!(n===a-1||i===1))if(n!==a-1&&i===2){if(e.length<2||r!==2||e.charCodeAt(e.length-1)!==46||e.charCodeAt(e.length-2)!==46){if(e.length>2){const c=e.lastIndexOf("/");if(c!==e.length-1){c===-1?(e="",r=0):(e=e.slice(0,c),r=e.length-1-e.lastIndexOf("/")),n=a,i=0;continue}}else if(e.length===2||e.length===1){e="",r=0,n=a,i=0;continue}}}else e.length>0?e+=`/${s.slice(n+1,a)}`:e=s.slice(n+1,a),r=a-n-1;n=a,i=0}else o===46&&i!==-1?++i:i=-1}return e}const Ct={toPosix(s){return Jl(s,"\\","/")},isUrl(s){return/^https?:/.test(this.toPosix(s))},isDataUrl(s){return/^data:([a-z]+\/[a-z0-9-+.]+(;[a-z0-9-.!#$%*+.{}|~`]+=[a-z0-9-.!#$%*+.{}()_|~`]+)*)?(;base64)?,([a-z0-9!$&',()*+;=\-._~:@\/?%\s<>]*?)$/i.test(s)},isBlobUrl(s){return s.startsWith("blob:")},hasProtocol(s){return/^[^/:]+:/.test(this.toPosix(s))},getProtocol(s){Gt(s),s=this.toPosix(s);const t=/^file:\/\/\//.exec(s);if(t)return t[0];const e=/^[^/:]+:\/{0,2}/.exec(s);return e?e[0]:""},toAbsolute(s,t,e){if(Gt(s),this.isDataUrl(s)||this.isBlobUrl(s))return s;const r=es(this.toPosix(t??ot.get().getBaseUrl())),n=es(this.toPosix(e??this.rootname(r)));return s=this.toPosix(s),s.startsWith("/")?Ct.join(n,s.slice(1)):this.isAbsolute(s)?s:this.join(r,s)},normalize(s){if(Gt(s),s.length===0)return".";if(this.isDataUrl(s)||this.isBlobUrl(s))return s;s=this.toPosix(s);let t="";const e=s.startsWith("/");this.hasProtocol(s)&&(t=this.rootname(s),s=s.slice(t.length));const r=s.endsWith("/");return s=th(s),s.length>0&&r&&(s+="/"),e?`/${s}`:t+s},isAbsolute(s){return Gt(s),s=this.toPosix(s),this.hasProtocol(s)?!0:s.startsWith("/")},join(...s){if(s.length===0)return".";let t;for(let e=0;e<s.length;++e){const r=s[e];if(Gt(r),r.length>0)if(t===void 0)t=r;else{const n=s[e-1]??"";this.joinExtensions.includes(this.extname(n).toLowerCase())?t+=`/../${r}`:t+=`/${r}`}}return t===void 0?".":this.normalize(t)},dirname(s){if(Gt(s),s.length===0)return".";s=this.toPosix(s);let t=s.charCodeAt(0);const e=t===47;let r=-1,n=!0;const i=this.getProtocol(s),o=s;s=s.slice(i.length);for(let a=s.length-1;a>=1;--a)if(t=s.charCodeAt(a),t===47){if(!n){r=a;break}}else n=!1;return r===-1?e?"/":this.isUrl(o)?i+s:i:e&&r===1?"//":i+s.slice(0,r)},rootname(s){Gt(s),s=this.toPosix(s);let t="";if(s.startsWith("/")?t="/":t=this.getProtocol(s),this.isUrl(s)){const e=s.indexOf("/",t.length);e!==-1?t=s.slice(0,e):t=s,t.endsWith("/")||(t+="/")}return t},basename(s,t){Gt(s),t&&Gt(t),s=es(this.toPosix(s));let e=0,r=-1,n=!0,i;if(t!==void 0&&t.length>0&&t.length<=s.length){if(t.length===s.length&&t===s)return"";let o=t.length-1,a=-1;for(i=s.length-1;i>=0;--i){const c=s.charCodeAt(i);if(c===47){if(!n){e=i+1;break}}else a===-1&&(n=!1,a=i+1),o>=0&&(c===t.charCodeAt(o)?--o===-1&&(r=i):(o=-1,r=a))}return e===r?r=a:r===-1&&(r=s.length),s.slice(e,r)}for(i=s.length-1;i>=0;--i)if(s.charCodeAt(i)===47){if(!n){e=i+1;break}}else r===-1&&(n=!1,r=i+1);return r===-1?"":s.slice(e,r)},extname(s){Gt(s),s=es(this.toPosix(s));let t=-1,e=0,r=-1,n=!0,i=0;for(let o=s.length-1;o>=0;--o){const a=s.charCodeAt(o);if(a===47){if(!n){e=o+1;break}continue}r===-1&&(n=!1,r=o+1),a===46?t===-1?t=o:i!==1&&(i=1):t!==-1&&(i=-1)}return t===-1||r===-1||i===0||i===1&&t===r-1&&t===e+1?"":s.slice(t,r)},parse(s){Gt(s);const t={root:"",dir:"",base:"",ext:"",name:""};if(s.length===0)return t;s=es(this.toPosix(s));let e=s.charCodeAt(0);const r=this.isAbsolute(s);let n;t.root=this.rootname(s),r||this.hasProtocol(s)?n=1:n=0;let i=-1,o=0,a=-1,c=!0,h=s.length-1,l=0;for(;h>=n;--h){if(e=s.charCodeAt(h),e===47){if(!c){o=h+1;break}continue}a===-1&&(c=!1,a=h+1),e===46?i===-1?i=h:l!==1&&(l=1):i!==-1&&(l=-1)}return i===-1||a===-1||l===0||l===1&&i===a-1&&i===o+1?a!==-1&&(o===0&&r?t.base=t.name=s.slice(1,a):t.base=t.name=s.slice(o,a)):(o===0&&r?(t.name=s.slice(1,i),t.base=s.slice(1,a)):(t.name=s.slice(o,i),t.base=s.slice(o,a)),t.ext=s.slice(i,a)),t.dir=this.dirname(s),t},sep:"/",delimiter:":",joinExtensions:[".html"]};function ha(s,t,e,r,n){const i=t[e];for(let o=0;o<i.length;o++){const a=i[o];e<t.length-1?ha(s.replace(r[e],a),t,e+1,r,n):n.push(s.replace(r[e],a))}}function eh(s){const t=/\{(.*?)\}/g,e=s.match(t),r=[];if(e){const n=[];e.forEach(i=>{const o=i.substring(1,i.length-1).split(",");n.push(o)}),ha(s,n,0,e,r)}else r.push(s);return r}const qs=s=>!Array.isArray(s);class Ke{constructor(){this._defaultBundleIdentifierOptions={connector:"-",createBundleAssetId:(t,e)=>`${t}${this._bundleIdConnector}${e}`,extractAssetIdFromBundle:(t,e)=>e.replace(`${t}${this._bundleIdConnector}`,"")},this._bundleIdConnector=this._defaultBundleIdentifierOptions.connector,this._createBundleAssetId=this._defaultBundleIdentifierOptions.createBundleAssetId,this._extractAssetIdFromBundle=this._defaultBundleIdentifierOptions.extractAssetIdFromBundle,this._assetMap={},this._preferredOrder=[],this._parsers=[],this._resolverHash={},this._bundles={}}setBundleIdentifier(t){if(this._bundleIdConnector=t.connector??this._bundleIdConnector,this._createBundleAssetId=t.createBundleAssetId??this._createBundleAssetId,this._extractAssetIdFromBundle=t.extractAssetIdFromBundle??this._extractAssetIdFromBundle,this._extractAssetIdFromBundle("foo",this._createBundleAssetId("foo","bar"))!=="bar")throw new Error("[Resolver] GenerateBundleAssetId are not working correctly")}prefer(...t){t.forEach(e=>{this._preferredOrder.push(e),e.priority||(e.priority=Object.keys(e.params))}),this._resolverHash={}}set basePath(t){this._basePath=t}get basePath(){return this._basePath}set rootPath(t){this._rootPath=t}get rootPath(){return this._rootPath}get parsers(){return this._parsers}reset(){this.setBundleIdentifier(this._defaultBundleIdentifierOptions),this._assetMap={},this._preferredOrder=[],this._resolverHash={},this._rootPath=null,this._basePath=null,this._manifest=null,this._bundles={},this._defaultSearchParams=null}setDefaultSearchParams(t){if(typeof t=="string")this._defaultSearchParams=t;else{const e=t;this._defaultSearchParams=Object.keys(e).map(r=>`${encodeURIComponent(r)}=${encodeURIComponent(e[r])}`).join("&")}}getAlias(t){const{alias:e,src:r}=t;return Ot(e||r,i=>typeof i=="string"?i:Array.isArray(i)?i.map(o=>(o==null?void 0:o.src)??o):i!=null&&i.src?i.src:i,!0)}addManifest(t){this._manifest&&it("[Resolver] Manifest already exists, this will be overwritten"),this._manifest=t,t.bundles.forEach(e=>{this.addBundle(e.name,e.assets)})}addBundle(t,e){const r=[];let n=e;Array.isArray(e)||(n=Object.entries(e).map(([i,o])=>typeof o=="string"||Array.isArray(o)?{alias:i,src:o}:{alias:i,...o})),n.forEach(i=>{const o=i.src,a=i.alias;let c;if(typeof a=="string"){const h=this._createBundleAssetId(t,a);r.push(h),c=[a,h]}else{const h=a.map(l=>this._createBundleAssetId(t,l));r.push(...h),c=[...a,...h]}this.add({...i,alias:c,src:o})}),this._bundles[t]=r}add(t){const e=[];Array.isArray(t)?e.push(...t):e.push(t);let r;r=i=>{this.hasKey(i)&&it(`[Resolver] already has key: ${i} overwriting`)},Ot(e).forEach(i=>{const{src:o}=i;let{data:a,format:c,loadParser:h}=i;const l=Ot(o).map(u=>typeof u=="string"?eh(u):Array.isArray(u)?u:[u]),d=this.getAlias(i);Array.isArray(d)?d.forEach(r):r(d);const f=[];l.forEach(u=>{u.forEach(p=>{let g={};if(typeof p!="object"){g.src=p;for(let m=0;m<this._parsers.length;m++){const y=this._parsers[m];if(y.test(p)){g=y.parse(p);break}}}else a=p.data??a,c=p.format??c,h=p.loadParser??h,g={...g,...p};if(!d)throw new Error(`[Resolver] alias is undefined for this asset: ${g.src}`);g=this._buildResolvedAsset(g,{aliases:d,data:a,format:c,loadParser:h}),f.push(g)})}),d.forEach(u=>{this._assetMap[u]=f})})}resolveBundle(t){const e=qs(t);t=Ot(t);const r={};return t.forEach(n=>{const i=this._bundles[n];if(i){const o=this.resolve(i),a={};for(const c in o){const h=o[c];a[this._extractAssetIdFromBundle(n,c)]=h}r[n]=a}}),e?r[t[0]]:r}resolveUrl(t){const e=this.resolve(t);if(typeof t!="string"){const r={};for(const n in e)r[n]=e[n].src;return r}return e.src}resolve(t){const e=qs(t);t=Ot(t);const r={};return t.forEach(n=>{if(!this._resolverHash[n])if(this._assetMap[n]){let i=this._assetMap[n];const o=this._getPreferredOrder(i);o==null||o.priority.forEach(a=>{o.params[a].forEach(c=>{const h=i.filter(l=>l[a]?l[a]===c:!1);h.length&&(i=h)})}),this._resolverHash[n]=i[0]}else this._resolverHash[n]=this._buildResolvedAsset({alias:[n],src:n},{});r[n]=this._resolverHash[n]}),e?r[t[0]]:r}hasKey(t){return!!this._assetMap[t]}hasBundle(t){return!!this._bundles[t]}_getPreferredOrder(t){for(let e=0;e<t.length;e++){const r=t[e],n=this._preferredOrder.find(i=>i.params.format.includes(r.format));if(n)return n}return this._preferredOrder[0]}_appendDefaultSearchParams(t){if(!this._defaultSearchParams)return t;const e=/\?/.test(t)?"&":"?";return`${t}${e}${this._defaultSearchParams}`}_buildResolvedAsset(t,e){const{aliases:r,data:n,loadParser:i,format:o}=e;return(this._basePath||this._rootPath)&&(t.src=Ct.toAbsolute(t.src,this._basePath,this._rootPath)),t.alias=r??t.alias??[t.src],t.src=this._appendDefaultSearchParams(t.src),t.data={...n||{},...t.data},t.loadParser=i??t.loadParser,t.format=o??t.format??sh(t.src),t}}Ke.RETINA_PREFIX=/@([0-9\.]+)x/;function sh(s){return s.split(".").pop().split("?").shift().split("#").shift()}const on=(s,t)=>{const e=t.split("?")[1];return e&&(s+=`?${e}`),s},da=class cs{constructor(t,e){this.linkedSheets=[];let r=t;(t==null?void 0:t.source)instanceof jt&&(r={texture:t,data:e});const{texture:n,data:i,cachePrefix:o=""}=r;this.cachePrefix=o,this._texture=n instanceof $?n:null,this.textureSource=n.source,this.textures={},this.animations={},this.data=i;const a=parseFloat(i.meta.scale);a?(this.resolution=a,n.source.resolution=this.resolution):this.resolution=n.source._resolution,this._frames=this.data.frames,this._frameKeys=Object.keys(this._frames),this._batchIndex=0,this._callback=null}parse(){return new Promise(t=>{this._callback=t,this._batchIndex=0,this._frameKeys.length<=cs.BATCH_SIZE?(this._processFrames(0),this._processAnimations(),this._parseComplete()):this._nextBatch()})}_processFrames(t){let e=t;const r=cs.BATCH_SIZE;for(;e-t<r&&e<this._frameKeys.length;){const n=this._frameKeys[e],i=this._frames[n],o=i.frame;if(o){let a=null,c=null;const h=i.trimmed!==!1&&i.sourceSize?i.sourceSize:i.frame,l=new q(0,0,Math.floor(h.w)/this.resolution,Math.floor(h.h)/this.resolution);i.rotated?a=new q(Math.floor(o.x)/this.resolution,Math.floor(o.y)/this.resolution,Math.floor(o.h)/this.resolution,Math.floor(o.w)/this.resolution):a=new q(Math.floor(o.x)/this.resolution,Math.floor(o.y)/this.resolution,Math.floor(o.w)/this.resolution,Math.floor(o.h)/this.resolution),i.trimmed!==!1&&i.spriteSourceSize&&(c=new q(Math.floor(i.spriteSourceSize.x)/this.resolution,Math.floor(i.spriteSourceSize.y)/this.resolution,Math.floor(o.w)/this.resolution,Math.floor(o.h)/this.resolution)),this.textures[n]=new $({source:this.textureSource,frame:a,orig:l,trim:c,rotate:i.rotated?2:0,defaultAnchor:i.anchor,defaultBorders:i.borders,label:n.toString()})}e++}}_processAnimations(){const t=this.data.animations||{};for(const e in t){this.animations[e]=[];for(let r=0;r<t[e].length;r++){const n=t[e][r];this.animations[e].push(this.textures[n])}}}_parseComplete(){const t=this._callback;this._callback=null,this._batchIndex=0,t.call(this,this.textures)}_nextBatch(){this._processFrames(this._batchIndex*cs.BATCH_SIZE),this._batchIndex++,setTimeout(()=>{this._batchIndex*cs.BATCH_SIZE<this._frameKeys.length?this._nextBatch():(this._processAnimations(),this._parseComplete())},0)}destroy(t=!1){var e;for(const r in this.textures)this.textures[r].destroy();this._frames=null,this._frameKeys=null,this.data=null,this.textures=null,t&&((e=this._texture)==null||e.destroy(),this.textureSource.destroy()),this._texture=null,this.textureSource=null,this.linkedSheets=[]}};da.BATCH_SIZE=1e3;let yi=da;const rh=["jpg","png","jpeg","avif","webp","basis","etc2","bc7","bc6h","bc5","bc4","bc3","bc2","bc1","eac","astc"];function ua(s,t,e){const r={};if(s.forEach(n=>{r[n]=t}),Object.keys(t.textures).forEach(n=>{r[`${t.cachePrefix}${n}`]=t.textures[n]}),!e){const n=Ct.dirname(s[0]);t.linkedSheets.forEach((i,o)=>{const a=ua([`${n}/${t.data.meta.related_multi_packs[o]}`],i,!0);Object.assign(r,a)})}return r}const nh={extension:O.Asset,cache:{test:s=>s instanceof yi,getCacheableAssets:(s,t)=>ua(s,t,!1)},resolver:{extension:{type:O.ResolveParser,name:"resolveSpritesheet"},test:s=>{const e=s.split("?")[0].split("."),r=e.pop(),n=e.pop();return r==="json"&&rh.includes(n)},parse:s=>{var e;const t=s.split(".");return{resolution:parseFloat(((e=Ke.RETINA_PREFIX.exec(s))==null?void 0:e[1])??"1"),format:t[t.length-2],src:s}}},loader:{name:"spritesheetLoader",extension:{type:O.LoadParser,priority:xe.Normal,name:"spritesheetLoader"},async testParse(s,t){return Ct.extname(t.src).toLowerCase()===".json"&&!!s.frames},async parse(s,t,e){var d,f;const{texture:r,imageFilename:n,textureOptions:i,cachePrefix:o}=(t==null?void 0:t.data)??{};let a=Ct.dirname(t.src);a&&a.lastIndexOf("/")!==a.length-1&&(a+="/");let c;if(r instanceof $)c=r;else{const u=on(a+(n??s.meta.image),t.src);c=(await e.load([{src:u,data:i}]))[u]}const h=new yi({texture:c.source,data:s,cachePrefix:o});await h.parse();const l=(d=s==null?void 0:s.meta)==null?void 0:d.related_multi_packs;if(Array.isArray(l)){const u=[];for(const g of l){if(typeof g!="string")continue;let m=a+g;(f=t.data)!=null&&f.ignoreMultiPack||(m=on(m,t.src),u.push(e.load({src:m,data:{textureOptions:i,ignoreMultiPack:!0}})))}const p=await Promise.all(u);h.linkedSheets=p,p.forEach(g=>{g.linkedSheets=[h].concat(h.linkedSheets.filter(m=>m!==g))})}return h},async unload(s,t,e){await e.unload(s.textureSource._sourceOrigin),s.destroy(!1)}}};ut.add(nh);const Mr=Object.create(null),bi=Object.create(null);function En(s,t){let e=bi[s];return e===void 0&&(Mr[t]===void 0&&(Mr[t]=1),bi[s]=e=Mr[t]++),e}let ze;function fa(){return(!ze||ze!=null&&ze.isContextLost())&&(ze=ot.get().createCanvas().getContext("webgl",{})),ze}let Ps;function ih(){if(!Ps){Ps="mediump";const s=fa();s&&s.getShaderPrecisionFormat&&(Ps=s.getShaderPrecisionFormat(s.FRAGMENT_SHADER,s.HIGH_FLOAT).precision?"highp":"mediump")}return Ps}function oh(s,t,e){return t?s:e?(s=s.replace("out vec4 finalColor;",""),`

        #ifdef GL_ES // This checks if it is WebGL1
        #define in varying
        #define finalColor gl_FragColor
        #define texture texture2D
        #endif
        ${s}
        `):`

        #ifdef GL_ES // This checks if it is WebGL1
        #define in attribute
        #define out varying
        #endif
        ${s}
        `}function ah(s,t,e){const r=e?t.maxSupportedFragmentPrecision:t.maxSupportedVertexPrecision;if(s.substring(0,9)!=="precision"){let n=e?t.requestedFragmentPrecision:t.requestedVertexPrecision;return n==="highp"&&r!=="highp"&&(n="mediump"),`precision ${n} float;
${s}`}else if(r!=="highp"&&s.substring(0,15)==="precision highp")return s.replace("precision highp","precision mediump");return s}function ch(s,t){return t?`#version 300 es
${s}`:s}const lh={},hh={};function dh(s,{name:t="pixi-program"},e=!0){t=t.replace(/\s+/g,"-"),t+=e?"-fragment":"-vertex";const r=e?lh:hh;return r[t]?(r[t]++,t+=`-${r[t]}`):r[t]=1,s.indexOf("#define SHADER_NAME")!==-1?s:`${`#define SHADER_NAME ${t}`}
${s}`}function uh(s,t){return t?s.replace("#version 300 es",""):s}const Pr={stripVersion:uh,ensurePrecision:ah,addProgramDefines:oh,setProgramName:dh,insertVersion:ch},Tr=Object.create(null),pa=class an{constructor(t){t={...an.defaultOptions,...t};const e=t.fragment.indexOf("#version 300 es")!==-1,r={stripVersion:e,ensurePrecision:{requestedFragmentPrecision:t.preferredFragmentPrecision,requestedVertexPrecision:t.preferredVertexPrecision,maxSupportedVertexPrecision:"highp",maxSupportedFragmentPrecision:ih()},setProgramName:{name:t.name},addProgramDefines:e,insertVersion:e};let n=t.fragment,i=t.vertex;Object.keys(Pr).forEach(o=>{const a=r[o];n=Pr[o](n,a,!0),i=Pr[o](i,a,!1)}),this.fragment=n,this.vertex=i,this.transformFeedbackVaryings=t.transformFeedbackVaryings,this._key=En(`${this.vertex}:${this.fragment}`,"gl-program")}destroy(){this.fragment=null,this.vertex=null,this._attributeData=null,this._uniformData=null,this._uniformBlockData=null,this.transformFeedbackVaryings=null}static from(t){const e=`${t.vertex}:${t.fragment}`;return Tr[e]||(Tr[e]=new an(t)),Tr[e]}};pa.defaultOptions={preferredVertexPrecision:"highp",preferredFragmentPrecision:"mediump"};let ma=pa;const wi={uint8x2:{size:2,stride:2,normalised:!1},uint8x4:{size:4,stride:4,normalised:!1},sint8x2:{size:2,stride:2,normalised:!1},sint8x4:{size:4,stride:4,normalised:!1},unorm8x2:{size:2,stride:2,normalised:!0},unorm8x4:{size:4,stride:4,normalised:!0},snorm8x2:{size:2,stride:2,normalised:!0},snorm8x4:{size:4,stride:4,normalised:!0},uint16x2:{size:2,stride:4,normalised:!1},uint16x4:{size:4,stride:8,normalised:!1},sint16x2:{size:2,stride:4,normalised:!1},sint16x4:{size:4,stride:8,normalised:!1},unorm16x2:{size:2,stride:4,normalised:!0},unorm16x4:{size:4,stride:8,normalised:!0},snorm16x2:{size:2,stride:4,normalised:!0},snorm16x4:{size:4,stride:8,normalised:!0},float16x2:{size:2,stride:4,normalised:!1},float16x4:{size:4,stride:8,normalised:!1},float32:{size:1,stride:4,normalised:!1},float32x2:{size:2,stride:8,normalised:!1},float32x3:{size:3,stride:12,normalised:!1},float32x4:{size:4,stride:16,normalised:!1},uint32:{size:1,stride:4,normalised:!1},uint32x2:{size:2,stride:8,normalised:!1},uint32x3:{size:3,stride:12,normalised:!1},uint32x4:{size:4,stride:16,normalised:!1},sint32:{size:1,stride:4,normalised:!1},sint32x2:{size:2,stride:8,normalised:!1},sint32x3:{size:3,stride:12,normalised:!1},sint32x4:{size:4,stride:16,normalised:!1}};function fh(s){return wi[s]??wi.float32}const ph={f32:"float32","vec2<f32>":"float32x2","vec3<f32>":"float32x3","vec4<f32>":"float32x4",vec2f:"float32x2",vec3f:"float32x3",vec4f:"float32x4",i32:"sint32","vec2<i32>":"sint32x2","vec3<i32>":"sint32x3","vec4<i32>":"sint32x4",u32:"uint32","vec2<u32>":"uint32x2","vec3<u32>":"uint32x3","vec4<u32>":"uint32x4",bool:"uint32","vec2<bool>":"uint32x2","vec3<bool>":"uint32x3","vec4<bool>":"uint32x4"};function mh({source:s,entryPoint:t}){const e={},r=s.indexOf(`fn ${t}`);if(r!==-1){const n=s.indexOf("->",r);if(n!==-1){const i=s.substring(r,n),o=/@location\((\d+)\)\s+([a-zA-Z0-9_]+)\s*:\s*([a-zA-Z0-9_<>]+)(?:,|\s|$)/g;let a;for(;(a=o.exec(i))!==null;){const c=ph[a[3]]??"float32";e[a[2]]={location:parseInt(a[1],10),format:c,stride:fh(c).stride,offset:0,instance:!1,start:0}}}}return e}function Er(s){var d,f;const t=/(^|[^/])@(group|binding)\(\d+\)[^;]+;/g,e=/@group\((\d+)\)/,r=/@binding\((\d+)\)/,n=/var(<[^>]+>)? (\w+)/,i=/:\s*(\w+)/,o=/struct\s+(\w+)\s*{([^}]+)}/g,a=/(\w+)\s*:\s*([\w\<\>]+)/g,c=/struct\s+(\w+)/,h=(d=s.match(t))==null?void 0:d.map(u=>({group:parseInt(u.match(e)[1],10),binding:parseInt(u.match(r)[1],10),name:u.match(n)[2],isUniform:u.match(n)[1]==="<uniform>",type:u.match(i)[1]}));if(!h)return{groups:[],structs:[]};const l=((f=s.match(o))==null?void 0:f.map(u=>{const p=u.match(c)[1],g=u.match(a).reduce((m,y)=>{const[x,b]=y.split(":");return m[x.trim()]=b.trim(),m},{});return g?{name:p,members:g}:null}).filter(({name:u})=>h.some(p=>p.type===u)))??[];return{groups:h,structs:l}}var ls=(s=>(s[s.VERTEX=1]="VERTEX",s[s.FRAGMENT=2]="FRAGMENT",s[s.COMPUTE=4]="COMPUTE",s))(ls||{});function gh({groups:s}){const t=[];for(let e=0;e<s.length;e++){const r=s[e];t[r.group]||(t[r.group]=[]),r.isUniform?t[r.group].push({binding:r.binding,visibility:ls.VERTEX|ls.FRAGMENT,buffer:{type:"uniform"}}):r.type==="sampler"?t[r.group].push({binding:r.binding,visibility:ls.FRAGMENT,sampler:{type:"filtering"}}):r.type==="texture_2d"&&t[r.group].push({binding:r.binding,visibility:ls.FRAGMENT,texture:{sampleType:"float",viewDimension:"2d",multisampled:!1}})}return t}function xh({groups:s}){const t=[];for(let e=0;e<s.length;e++){const r=s[e];t[r.group]||(t[r.group]={}),t[r.group][r.name]=r.binding}return t}function yh(s,t){const e=new Set,r=new Set,n=[...s.structs,...t.structs].filter(o=>e.has(o.name)?!1:(e.add(o.name),!0)),i=[...s.groups,...t.groups].filter(o=>{const a=`${o.name}-${o.binding}`;return r.has(a)?!1:(r.add(a),!0)});return{structs:n,groups:i}}const Ir=Object.create(null);class cr{constructor(t){var a,c;this._layoutKey=0,this._attributeLocationsKey=0;const{fragment:e,vertex:r,layout:n,gpuLayout:i,name:o}=t;if(this.name=o,this.fragment=e,this.vertex=r,e.source===r.source){const h=Er(e.source);this.structsAndGroups=h}else{const h=Er(r.source),l=Er(e.source);this.structsAndGroups=yh(h,l)}this.layout=n??xh(this.structsAndGroups),this.gpuLayout=i??gh(this.structsAndGroups),this.autoAssignGlobalUniforms=((a=this.layout[0])==null?void 0:a.globalUniforms)!==void 0,this.autoAssignLocalUniforms=((c=this.layout[1])==null?void 0:c.localUniforms)!==void 0,this._generateProgramKey()}_generateProgramKey(){const{vertex:t,fragment:e}=this,r=t.source+e.source+t.entryPoint+e.entryPoint;this._layoutKey=En(r,"program")}get attributeData(){return this._attributeData??(this._attributeData=mh(this.vertex)),this._attributeData}destroy(){this.gpuLayout=null,this.layout=null,this.structsAndGroups=null,this.fragment=null,this.vertex=null}static from(t){const e=`${t.vertex.source}:${t.fragment.source}:${t.fragment.entryPoint}:${t.vertex.entryPoint}`;return Ir[e]||(Ir[e]=new cr(t)),Ir[e]}}const ga=["f32","i32","vec2<f32>","vec3<f32>","vec4<f32>","mat2x2<f32>","mat3x3<f32>","mat4x4<f32>","mat3x2<f32>","mat4x2<f32>","mat2x3<f32>","mat4x3<f32>","mat2x4<f32>","mat3x4<f32>","vec2<i32>","vec3<i32>","vec4<i32>"],bh=ga.reduce((s,t)=>(s[t]=!0,s),{});function wh(s,t){switch(s){case"f32":return 0;case"vec2<f32>":return new Float32Array(2*t);case"vec3<f32>":return new Float32Array(3*t);case"vec4<f32>":return new Float32Array(4*t);case"mat2x2<f32>":return new Float32Array([1,0,0,1]);case"mat3x3<f32>":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4x4<f32>":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}return null}const xa=class ya{constructor(t,e){this._touched=0,this.uid=at("uniform"),this._resourceType="uniformGroup",this._resourceId=at("resource"),this.isUniformGroup=!0,this._dirtyId=0,this.destroyed=!1,e={...ya.defaultOptions,...e},this.uniformStructures=t;const r={};for(const n in t){const i=t[n];if(i.name=n,i.size=i.size??1,!bh[i.type])throw new Error(`Uniform type ${i.type} is not supported. Supported uniform types are: ${ga.join(", ")}`);i.value??(i.value=wh(i.type,i.size)),r[n]=i.value}this.uniforms=r,this._dirtyId=1,this.ubo=e.ubo,this.isStatic=e.isStatic,this._signature=En(Object.keys(r).map(n=>`${n}-${t[n].type}`).join("-"),"uniform-group")}update(){this._dirtyId++}};xa.defaultOptions={ubo:!1,isStatic:!1};let ba=xa;class Vs{constructor(t){this.resources=Object.create(null),this._dirty=!0;let e=0;for(const r in t){const n=t[r];this.setResource(n,e++)}this._updateKey()}_updateKey(){if(!this._dirty)return;this._dirty=!1;const t=[];let e=0;for(const r in this.resources)t[e++]=this.resources[r]._resourceId;this._key=t.join("|")}setResource(t,e){var n,i;const r=this.resources[e];t!==r&&(r&&((n=t.off)==null||n.call(t,"change",this.onResourceChange,this)),(i=t.on)==null||i.call(t,"change",this.onResourceChange,this),this.resources[e]=t,this._dirty=!0)}getResource(t){return this.resources[t]}_touch(t){const e=this.resources;for(const r in e)e[r]._touched=t}destroy(){var e;const t=this.resources;for(const r in t){const n=t[r];(e=n.off)==null||e.call(n,"change",this.onResourceChange,this)}this.resources=null}onResourceChange(t){if(this._dirty=!0,t.destroyed){const e=this.resources;for(const r in e)e[r]===t&&(e[r]=null)}else this._updateKey()}}var cn=(s=>(s[s.WEBGL=1]="WEBGL",s[s.WEBGPU=2]="WEBGPU",s[s.BOTH=3]="BOTH",s))(cn||{});class In extends Wt{constructor(t){super(),this.uid=at("shader"),this._uniformBindMap=Object.create(null),this._ownedBindGroups=[];let{gpuProgram:e,glProgram:r,groups:n,resources:i,compatibleRenderers:o,groupMap:a}=t;this.gpuProgram=e,this.glProgram=r,o===void 0&&(o=0,e&&(o|=cn.WEBGPU),r&&(o|=cn.WEBGL)),this.compatibleRenderers=o;const c={};if(!i&&!n&&(i={}),i&&n)throw new Error("[Shader] Cannot have both resources and groups");if(!e&&n&&!a)throw new Error("[Shader] No group map or WebGPU shader provided - consider using resources instead.");if(!e&&n&&a)for(const h in a)for(const l in a[h]){const d=a[h][l];c[d]={group:h,binding:l,name:d}}else if(e&&n&&!a){const h=e.structsAndGroups.groups;a={},h.forEach(l=>{a[l.group]=a[l.group]||{},a[l.group][l.binding]=l.name,c[l.name]=l})}else if(i){n={},a={},e&&e.structsAndGroups.groups.forEach(d=>{a[d.group]=a[d.group]||{},a[d.group][d.binding]=d.name,c[d.name]=d});let h=0;for(const l in i)c[l]||(n[99]||(n[99]=new Vs,this._ownedBindGroups.push(n[99])),c[l]={group:99,binding:h,name:l},a[99]=a[99]||{},a[99][h]=l,h++);for(const l in i){const d=l;let f=i[l];!f.source&&!f._resourceType&&(f=new ba(f));const u=c[d];u&&(n[u.group]||(n[u.group]=new Vs,this._ownedBindGroups.push(n[u.group])),n[u.group].setResource(f,u.binding))}}this.groups=n,this._uniformBindMap=a,this.resources=this._buildResourceAccessor(n,c)}addResource(t,e,r){var n,i;(n=this._uniformBindMap)[e]||(n[e]={}),(i=this._uniformBindMap[e])[r]||(i[r]=t),this.groups[e]||(this.groups[e]=new Vs,this._ownedBindGroups.push(this.groups[e]))}_buildResourceAccessor(t,e){const r={};for(const n in e){const i=e[n];Object.defineProperty(r,i.name,{get(){return t[i.group].getResource(i.binding)},set(o){t[i.group].setResource(o,i.binding)}})}return r}destroy(t=!1){var e,r;this.emit("destroy",this),t&&((e=this.gpuProgram)==null||e.destroy(),(r=this.glProgram)==null||r.destroy()),this.gpuProgram=null,this.glProgram=null,this.removeAllListeners(),this._uniformBindMap=null,this._ownedBindGroups.forEach(n=>{n.destroy()}),this._ownedBindGroups=null,this.resources=null,this.groups=null}static from(t){const{gpu:e,gl:r,...n}=t;let i,o;return e&&(i=cr.from(e)),r&&(o=ma.from(r)),new In({gpuProgram:i,glProgram:o,...n})}}const ln=[];ut.handleByNamedList(O.Environment,ln);async function _h(s){if(!s)for(let t=0;t<ln.length;t++){const e=ln[t];if(e.value.test()){await e.value.load();return}}}let ss;function vh(){if(typeof ss=="boolean")return ss;try{ss=new Function("param1","param2","param3","return param1[param2] === param3;")({a:"b"},"a","b")===!0}catch{ss=!1}return ss}function _i(s,t,e=2){const r=t&&t.length,n=r?t[0]*e:s.length;let i=wa(s,0,n,e,!0);const o=[];if(!i||i.next===i.prev)return o;let a,c,h;if(r&&(i=Mh(s,t,i,e)),s.length>80*e){a=1/0,c=1/0;let l=-1/0,d=-1/0;for(let f=e;f<n;f+=e){const u=s[f],p=s[f+1];u<a&&(a=u),p<c&&(c=p),u>l&&(l=u),p>d&&(d=p)}h=Math.max(l-a,d-c),h=h!==0?32767/h:0}return ys(i,o,e,a,c,h,0),o}function wa(s,t,e,r,n){let i;if(n===Nh(s,t,e,r)>0)for(let o=t;o<e;o+=r)i=vi(o/r|0,s[o],s[o+1],i);else for(let o=e-r;o>=t;o-=r)i=vi(o/r|0,s[o],s[o+1],i);return i&&Ve(i,i.next)&&(ws(i),i=i.next),i}function Le(s,t){if(!s)return s;t||(t=s);let e=s,r;do if(r=!1,!e.steiner&&(Ve(e,e.next)||st(e.prev,e,e.next)===0)){if(ws(e),e=t=e.prev,e===e.next)break;r=!0}else e=e.next;while(r||e!==t);return t}function ys(s,t,e,r,n,i,o){if(!s)return;!o&&i&&Bh(s,r,n,i);let a=s;for(;s.prev!==s.next;){const c=s.prev,h=s.next;if(i?Sh(s,r,n,i):Ah(s)){t.push(c.i,s.i,h.i),ws(s),s=h.next,a=h.next;continue}if(s=h,s===a){o?o===1?(s=Ch(Le(s),t),ys(s,t,e,r,n,i,2)):o===2&&kh(s,t,e,r,n,i):ys(Le(s),t,e,r,n,i,1);break}}}function Ah(s){const t=s.prev,e=s,r=s.next;if(st(t,e,r)>=0)return!1;const n=t.x,i=e.x,o=r.x,a=t.y,c=e.y,h=r.y,l=Math.min(n,i,o),d=Math.min(a,c,h),f=Math.max(n,i,o),u=Math.max(a,c,h);let p=r.next;for(;p!==t;){if(p.x>=l&&p.x<=f&&p.y>=d&&p.y<=u&&hs(n,a,i,c,o,h,p.x,p.y)&&st(p.prev,p,p.next)>=0)return!1;p=p.next}return!0}function Sh(s,t,e,r){const n=s.prev,i=s,o=s.next;if(st(n,i,o)>=0)return!1;const a=n.x,c=i.x,h=o.x,l=n.y,d=i.y,f=o.y,u=Math.min(a,c,h),p=Math.min(l,d,f),g=Math.max(a,c,h),m=Math.max(l,d,f),y=hn(u,p,t,e,r),x=hn(g,m,t,e,r);let b=s.prevZ,w=s.nextZ;for(;b&&b.z>=y&&w&&w.z<=x;){if(b.x>=u&&b.x<=g&&b.y>=p&&b.y<=m&&b!==n&&b!==o&&hs(a,l,c,d,h,f,b.x,b.y)&&st(b.prev,b,b.next)>=0||(b=b.prevZ,w.x>=u&&w.x<=g&&w.y>=p&&w.y<=m&&w!==n&&w!==o&&hs(a,l,c,d,h,f,w.x,w.y)&&st(w.prev,w,w.next)>=0))return!1;w=w.nextZ}for(;b&&b.z>=y;){if(b.x>=u&&b.x<=g&&b.y>=p&&b.y<=m&&b!==n&&b!==o&&hs(a,l,c,d,h,f,b.x,b.y)&&st(b.prev,b,b.next)>=0)return!1;b=b.prevZ}for(;w&&w.z<=x;){if(w.x>=u&&w.x<=g&&w.y>=p&&w.y<=m&&w!==n&&w!==o&&hs(a,l,c,d,h,f,w.x,w.y)&&st(w.prev,w,w.next)>=0)return!1;w=w.nextZ}return!0}function Ch(s,t){let e=s;do{const r=e.prev,n=e.next.next;!Ve(r,n)&&va(r,e,e.next,n)&&bs(r,n)&&bs(n,r)&&(t.push(r.i,e.i,n.i),ws(e),ws(e.next),e=s=n),e=e.next}while(e!==s);return Le(e)}function kh(s,t,e,r,n,i){let o=s;do{let a=o.next.next;for(;a!==o.prev;){if(o.i!==a.i&&Lh(o,a)){let c=Aa(o,a);o=Le(o,o.next),c=Le(c,c.next),ys(o,t,e,r,n,i,0),ys(c,t,e,r,n,i,0);return}a=a.next}o=o.next}while(o!==s)}function Mh(s,t,e,r){const n=[];for(let i=0,o=t.length;i<o;i++){const a=t[i]*r,c=i<o-1?t[i+1]*r:s.length,h=wa(s,a,c,r,!1);h===h.next&&(h.steiner=!0),n.push(Fh(h))}n.sort(Ph);for(let i=0;i<n.length;i++)e=Th(n[i],e);return e}function Ph(s,t){let e=s.x-t.x;if(e===0&&(e=s.y-t.y,e===0)){const r=(s.next.y-s.y)/(s.next.x-s.x),n=(t.next.y-t.y)/(t.next.x-t.x);e=r-n}return e}function Th(s,t){const e=Eh(s,t);if(!e)return t;const r=Aa(e,s);return Le(r,r.next),Le(e,e.next)}function Eh(s,t){let e=t;const r=s.x,n=s.y;let i=-1/0,o;if(Ve(s,e))return e;do{if(Ve(s,e.next))return e.next;if(n<=e.y&&n>=e.next.y&&e.next.y!==e.y){const d=e.x+(n-e.y)*(e.next.x-e.x)/(e.next.y-e.y);if(d<=r&&d>i&&(i=d,o=e.x<e.next.x?e:e.next,d===r))return o}e=e.next}while(e!==t);if(!o)return null;const a=o,c=o.x,h=o.y;let l=1/0;e=o;do{if(r>=e.x&&e.x>=c&&r!==e.x&&_a(n<h?r:i,n,c,h,n<h?i:r,n,e.x,e.y)){const d=Math.abs(n-e.y)/(r-e.x);bs(e,s)&&(d<l||d===l&&(e.x>o.x||e.x===o.x&&Ih(o,e)))&&(o=e,l=d)}e=e.next}while(e!==a);return o}function Ih(s,t){return st(s.prev,s,t.prev)<0&&st(t.next,s,s.next)<0}function Bh(s,t,e,r){let n=s;do n.z===0&&(n.z=hn(n.x,n.y,t,e,r)),n.prevZ=n.prev,n.nextZ=n.next,n=n.next;while(n!==s);n.prevZ.nextZ=null,n.prevZ=null,Rh(n)}function Rh(s){let t,e=1;do{let r=s,n;s=null;let i=null;for(t=0;r;){t++;let o=r,a=0;for(let h=0;h<e&&(a++,o=o.nextZ,!!o);h++);let c=e;for(;a>0||c>0&&o;)a!==0&&(c===0||!o||r.z<=o.z)?(n=r,r=r.nextZ,a--):(n=o,o=o.nextZ,c--),i?i.nextZ=n:s=n,n.prevZ=i,i=n;r=o}i.nextZ=null,e*=2}while(t>1);return s}function hn(s,t,e,r,n){return s=(s-e)*n|0,t=(t-r)*n|0,s=(s|s<<8)&16711935,s=(s|s<<4)&252645135,s=(s|s<<2)&858993459,s=(s|s<<1)&1431655765,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,t=(t|t<<1)&1431655765,s|t<<1}function Fh(s){let t=s,e=s;do(t.x<e.x||t.x===e.x&&t.y<e.y)&&(e=t),t=t.next;while(t!==s);return e}function _a(s,t,e,r,n,i,o,a){return(n-o)*(t-a)>=(s-o)*(i-a)&&(s-o)*(r-a)>=(e-o)*(t-a)&&(e-o)*(i-a)>=(n-o)*(r-a)}function hs(s,t,e,r,n,i,o,a){return!(s===o&&t===a)&&_a(s,t,e,r,n,i,o,a)}function Lh(s,t){return s.next.i!==t.i&&s.prev.i!==t.i&&!zh(s,t)&&(bs(s,t)&&bs(t,s)&&Gh(s,t)&&(st(s.prev,s,t.prev)||st(s,t.prev,t))||Ve(s,t)&&st(s.prev,s,s.next)>0&&st(t.prev,t,t.next)>0)}function st(s,t,e){return(t.y-s.y)*(e.x-t.x)-(t.x-s.x)*(e.y-t.y)}function Ve(s,t){return s.x===t.x&&s.y===t.y}function va(s,t,e,r){const n=Es(st(s,t,e)),i=Es(st(s,t,r)),o=Es(st(e,r,s)),a=Es(st(e,r,t));return!!(n!==i&&o!==a||n===0&&Ts(s,e,t)||i===0&&Ts(s,r,t)||o===0&&Ts(e,s,r)||a===0&&Ts(e,t,r))}function Ts(s,t,e){return t.x<=Math.max(s.x,e.x)&&t.x>=Math.min(s.x,e.x)&&t.y<=Math.max(s.y,e.y)&&t.y>=Math.min(s.y,e.y)}function Es(s){return s>0?1:s<0?-1:0}function zh(s,t){let e=s;do{if(e.i!==s.i&&e.next.i!==s.i&&e.i!==t.i&&e.next.i!==t.i&&va(e,e.next,s,t))return!0;e=e.next}while(e!==s);return!1}function bs(s,t){return st(s.prev,s,s.next)<0?st(s,t,s.next)>=0&&st(s,s.prev,t)>=0:st(s,t,s.prev)<0||st(s,s.next,t)<0}function Gh(s,t){let e=s,r=!1;const n=(s.x+t.x)/2,i=(s.y+t.y)/2;do e.y>i!=e.next.y>i&&e.next.y!==e.y&&n<(e.next.x-e.x)*(i-e.y)/(e.next.y-e.y)+e.x&&(r=!r),e=e.next;while(e!==s);return r}function Aa(s,t){const e=dn(s.i,s.x,s.y),r=dn(t.i,t.x,t.y),n=s.next,i=t.prev;return s.next=t,t.prev=s,e.next=n,n.prev=e,r.next=e,e.prev=r,i.next=r,r.prev=i,r}function vi(s,t,e,r){const n=dn(s,t,e);return r?(n.next=r.next,n.prev=r,r.next.prev=n,r.next=n):(n.prev=n,n.next=n),n}function ws(s){s.next.prev=s.prev,s.prev.next=s.next,s.prevZ&&(s.prevZ.nextZ=s.nextZ),s.nextZ&&(s.nextZ.prevZ=s.prevZ)}function dn(s,t,e){return{i:s,x:t,y:e,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}function Nh(s,t,e,r){let n=0;for(let i=t,o=e-r;i<e;i+=r)n+=(s[o]-s[i])*(s[i+1]+s[o+1]),o=i;return n}const Oh=_i.default||_i;var Sa=(s=>(s[s.NONE=0]="NONE",s[s.COLOR=16384]="COLOR",s[s.STENCIL=1024]="STENCIL",s[s.DEPTH=256]="DEPTH",s[s.COLOR_DEPTH=16640]="COLOR_DEPTH",s[s.COLOR_STENCIL=17408]="COLOR_STENCIL",s[s.DEPTH_STENCIL=1280]="DEPTH_STENCIL",s[s.ALL=17664]="ALL",s))(Sa||{});class Uh{constructor(t){this.items=[],this._name=t}emit(t,e,r,n,i,o,a,c){const{name:h,items:l}=this;for(let d=0,f=l.length;d<f;d++)l[d][h](t,e,r,n,i,o,a,c);return this}add(t){return t[this._name]&&(this.remove(t),this.items.push(t)),this}remove(t){const e=this.items.indexOf(t);return e!==-1&&this.items.splice(e,1),this}contains(t){return this.items.indexOf(t)!==-1}removeAll(){return this.items.length=0,this}destroy(){this.removeAll(),this.items=null,this._name=null}get empty(){return this.items.length===0}get name(){return this._name}}const Dh=["init","destroy","contextChange","resolutionChange","resetState","renderEnd","renderStart","render","update","postrender","prerender"],Ca=class ka extends Wt{constructor(t){super(),this.uid=at("renderer"),this.runners=Object.create(null),this.renderPipes=Object.create(null),this._initOptions={},this._systemsHash=Object.create(null),this.type=t.type,this.name=t.name,this.config=t;const e=[...Dh,...this.config.runners??[]];this._addRunners(...e),this._unsafeEvalCheck()}async init(t={}){const e=t.skipExtensionImports===!0?!0:t.manageImports===!1;await _h(e),this._addSystems(this.config.systems),this._addPipes(this.config.renderPipes,this.config.renderPipeAdaptors);for(const r in this._systemsHash)t={...this._systemsHash[r].constructor.defaultOptions,...t};t={...ka.defaultOptions,...t},this._roundPixels=t.roundPixels?1:0;for(let r=0;r<this.runners.init.items.length;r++)await this.runners.init.items[r].init(t);this._initOptions=t}render(t,e){let r=t;if(r instanceof zt&&(r={container:r},e&&(Y(Z,"passing a second argument is deprecated, please use render options instead"),r.target=e.renderTexture)),r.target||(r.target=this.view.renderTarget),r.target===this.view.renderTarget&&(this._lastObjectRendered=r.container,r.clearColor??(r.clearColor=this.background.colorRgba),r.clear??(r.clear=this.background.clearBeforeRender)),r.clearColor){const n=Array.isArray(r.clearColor)&&r.clearColor.length===4;r.clearColor=n?r.clearColor:ct.shared.setValue(r.clearColor).toArray()}r.transform||(r.container.updateLocalTransform(),r.transform=r.container.localTransform),r.container.enableRenderGroup(),this.runners.prerender.emit(r),this.runners.renderStart.emit(r),this.runners.render.emit(r),this.runners.renderEnd.emit(r),this.runners.postrender.emit(r)}resize(t,e,r){const n=this.view.resolution;this.view.resize(t,e,r),this.emit("resize",this.view.screen.width,this.view.screen.height,this.view.resolution),r!==void 0&&r!==n&&this.runners.resolutionChange.emit(r)}clear(t={}){const e=this;t.target||(t.target=e.renderTarget.renderTarget),t.clearColor||(t.clearColor=this.background.colorRgba),t.clear??(t.clear=Sa.ALL);const{clear:r,clearColor:n,target:i}=t;ct.shared.setValue(n??this.background.colorRgba),e.renderTarget.clear(i,r,ct.shared.toArray())}get resolution(){return this.view.resolution}set resolution(t){this.view.resolution=t,this.runners.resolutionChange.emit(t)}get width(){return this.view.texture.frame.width}get height(){return this.view.texture.frame.height}get canvas(){return this.view.canvas}get lastObjectRendered(){return this._lastObjectRendered}get renderingToScreen(){return this.renderTarget.renderingToScreen}get screen(){return this.view.screen}_addRunners(...t){t.forEach(e=>{this.runners[e]=new Uh(e)})}_addSystems(t){let e;for(e in t){const r=t[e];this._addSystem(r.value,r.name)}}_addSystem(t,e){const r=new t(this);if(this[e])throw new Error(`Whoops! The name "${e}" is already in use`);this[e]=r,this._systemsHash[e]=r;for(const n in this.runners)this.runners[n].add(r);return this}_addPipes(t,e){const r=e.reduce((n,i)=>(n[i.name]=i.value,n),{});t.forEach(n=>{const i=n.value,o=n.name,a=r[o];this.renderPipes[o]=new i(this,a?new a:null)})}destroy(t=!1){this.runners.destroy.items.reverse(),this.runners.destroy.emit(t),Object.values(this.runners).forEach(e=>{e.destroy()}),this._systemsHash=null,this.renderPipes=null}generateTexture(t){return this.textureGenerator.generateTexture(t)}get roundPixels(){return!!this._roundPixels}_unsafeEvalCheck(){if(!vh())throw new Error("Current environment does not allow unsafe-eval, please use pixi.js/unsafe-eval module to enable support.")}resetState(){this.runners.resetState.emit()}};Ca.defaultOptions={resolution:1,failIfMajorPerformanceCaveat:!1,roundPixels:!1};let Ma=Ca,Is;function Hh(s){return Is!==void 0||(Is=(()=>{var e;const t={stencil:!0,failIfMajorPerformanceCaveat:s??Ma.defaultOptions.failIfMajorPerformanceCaveat};try{if(!ot.get().getWebGLRenderingContext())return!1;let n=ot.get().createCanvas().getContext("webgl",t);const i=!!((e=n==null?void 0:n.getContextAttributes())!=null&&e.stencil);if(n){const o=n.getExtension("WEBGL_lose_context");o&&o.loseContext()}return n=null,i}catch{return!1}})()),Is}let Bs;async function Wh(s={}){return Bs!==void 0||(Bs=await(async()=>{const t=ot.get().getNavigator().gpu;if(!t)return!1;try{return await(await t.requestAdapter(s)).requestDevice(),!0}catch{return!1}})()),Bs}const Ai=["webgl","webgpu","canvas"];async function jh(s){let t=[];s.preference?(t.push(s.preference),Ai.forEach(i=>{i!==s.preference&&t.push(i)})):t=Ai.slice();let e,r={};for(let i=0;i<t.length;i++){const o=t[i];if(o==="webgpu"&&await Wh()){const{WebGPURenderer:a}=await Ys(async()=>{const{WebGPURenderer:c}=await import("./WebGPURenderer-DFktIJE2.js");return{WebGPURenderer:c}},__vite__mapDeps([4,2,5,3]));e=a,r={...s,...s.webgpu};break}else if(o==="webgl"&&Hh(s.failIfMajorPerformanceCaveat??Ma.defaultOptions.failIfMajorPerformanceCaveat)){const{WebGLRenderer:a}=await Ys(async()=>{const{WebGLRenderer:c}=await import("./WebGLRenderer-D_nHCEk9.js");return{WebGLRenderer:c}},__vite__mapDeps([6,2,5,3]));e=a,r={...s,...s.webgl};break}else if(o==="canvas")throw r={...s},new Error("CanvasRenderer is not yet implemented")}if(delete r.webgpu,delete r.webgl,!e)throw new Error("No available renderer for the current environment");const n=new e;return await n.init(r),n}const Pa="8.10.1";class Ta{static init(){var t;(t=globalThis.__PIXI_APP_INIT__)==null||t.call(globalThis,this,Pa)}static destroy(){}}Ta.extension=O.Application;class $h{constructor(t){this._renderer=t}init(){var t;(t=globalThis.__PIXI_RENDERER_INIT__)==null||t.call(globalThis,this._renderer,Pa)}destroy(){this._renderer=null}}$h.extension={type:[O.WebGLSystem,O.WebGPUSystem],name:"initHook",priority:-10};const Ea=class un{constructor(...t){this.stage=new zt,t[0]!==void 0&&Y(Z,"Application constructor options are deprecated, please use Application.init() instead.")}async init(t){t={...t},this.renderer=await jh(t),un._plugins.forEach(e=>{e.init.call(this,t)})}render(){this.renderer.render({container:this.stage})}get canvas(){return this.renderer.canvas}get view(){return Y(Z,"Application.view is deprecated, please use Application.canvas instead."),this.renderer.canvas}get screen(){return this.renderer.screen}destroy(t=!1,e=!1){const r=un._plugins.slice(0);r.reverse(),r.forEach(n=>{n.destroy.call(this)}),this.stage.destroy(e),this.stage=null,this.renderer.destroy(t),this.renderer=null}};Ea._plugins=[];let Ia=Ea;ut.handleByList(O.Application,Ia._plugins);ut.add(Ta);class Ba extends Wt{constructor(){super(...arguments),this.chars=Object.create(null),this.lineHeight=0,this.fontFamily="",this.fontMetrics={fontSize:0,ascent:0,descent:0},this.baseLineOffset=0,this.distanceField={type:"none",range:0},this.pages=[],this.applyFillAsTint=!0,this.baseMeasurementFontSize=100,this.baseRenderedFontSize=100}get font(){return Y(Z,"BitmapFont.font is deprecated, please use BitmapFont.fontFamily instead."),this.fontFamily}get pageTextures(){return Y(Z,"BitmapFont.pageTextures is deprecated, please use BitmapFont.pages instead."),this.pages}get size(){return Y(Z,"BitmapFont.size is deprecated, please use BitmapFont.fontMetrics.fontSize instead."),this.fontMetrics.fontSize}get distanceFieldRange(){return Y(Z,"BitmapFont.distanceFieldRange is deprecated, please use BitmapFont.distanceField.range instead."),this.distanceField.range}get distanceFieldType(){return Y(Z,"BitmapFont.distanceFieldType is deprecated, please use BitmapFont.distanceField.type instead."),this.distanceField.type}destroy(t=!1){var e;this.emit("destroy",this),this.removeAllListeners();for(const r in this.chars)(e=this.chars[r].texture)==null||e.destroy();this.chars=null,t&&(this.pages.forEach(r=>r.texture.destroy(!0)),this.pages=null)}}const Vh=["serif","sans-serif","monospace","cursive","fantasy","system-ui"];function Ks(s){const t=typeof s.fontSize=="number"?`${s.fontSize}px`:s.fontSize;let e=s.fontFamily;Array.isArray(s.fontFamily)||(e=s.fontFamily.split(","));for(let r=e.length-1;r>=0;r--){let n=e[r].trim();!/([\"\'])[^\'\"]+\1/.test(n)&&!Vh.includes(n)&&(n=`"${n}"`),e[r]=n}return`${s.fontStyle} ${s.fontVariant} ${s.fontWeight} ${t} ${e.join(",")}`}const Br={willReadFrequently:!0},te=class N{static get experimentalLetterSpacingSupported(){let t=N._experimentalLetterSpacingSupported;if(t===void 0){const e=ot.get().getCanvasRenderingContext2D().prototype;t=N._experimentalLetterSpacingSupported="letterSpacing"in e||"textLetterSpacing"in e}return t}constructor(t,e,r,n,i,o,a,c,h){this.text=t,this.style=e,this.width=r,this.height=n,this.lines=i,this.lineWidths=o,this.lineHeight=a,this.maxLineWidth=c,this.fontProperties=h}static measureText(t=" ",e,r=N._canvas,n=e.wordWrap){var y;const i=Ks(e),o=N.measureFont(i);o.fontSize===0&&(o.fontSize=e.fontSize,o.ascent=e.fontSize);const a=N.__context;a.font=i;const h=(n?N._wordWrap(t,e,r):t).split(/(?:\r\n|\r|\n)/),l=new Array(h.length);let d=0;for(let x=0;x<h.length;x++){const b=N._measureText(h[x],e.letterSpacing,a);l[x]=b,d=Math.max(d,b)}const f=((y=e._stroke)==null?void 0:y.width)||0;let u=d+f;e.dropShadow&&(u+=e.dropShadow.distance);const p=e.lineHeight||o.fontSize;let g=Math.max(p,o.fontSize+f)+(h.length-1)*(p+e.leading);return e.dropShadow&&(g+=e.dropShadow.distance),new N(t,e,u,g,h,l,p+e.leading,d,o)}static _measureText(t,e,r){let n=!1;N.experimentalLetterSpacingSupported&&(N.experimentalLetterSpacing?(r.letterSpacing=`${e}px`,r.textLetterSpacing=`${e}px`,n=!0):(r.letterSpacing="0px",r.textLetterSpacing="0px"));const i=r.measureText(t);let o=i.width;const a=-i.actualBoundingBoxLeft;let h=i.actualBoundingBoxRight-a;if(o>0)if(n)o-=e,h-=e;else{const l=(N.graphemeSegmenter(t).length-1)*e;o+=l,h+=l}return Math.max(o,h)}static _wordWrap(t,e,r=N._canvas){const n=r.getContext("2d",Br);let i=0,o="",a="";const c=Object.create(null),{letterSpacing:h,whiteSpace:l}=e,d=N._collapseSpaces(l),f=N._collapseNewlines(l);let u=!d;const p=e.wordWrapWidth+h,g=N._tokenize(t);for(let m=0;m<g.length;m++){let y=g[m];if(N._isNewline(y)){if(!f){a+=N._addLine(o),u=!d,o="",i=0;continue}y=" "}if(d){const b=N.isBreakingSpace(y),w=N.isBreakingSpace(o[o.length-1]);if(b&&w)continue}const x=N._getFromCache(y,h,c,n);if(x>p)if(o!==""&&(a+=N._addLine(o),o="",i=0),N.canBreakWords(y,e.breakWords)){const b=N.wordWrapSplit(y);for(let w=0;w<b.length;w++){let _=b[w],S=_,C=1;for(;b[w+C];){const v=b[w+C];if(!N.canBreakChars(S,v,y,w,e.breakWords))_+=v;else break;S=v,C++}w+=C-1;const M=N._getFromCache(_,h,c,n);M+i>p&&(a+=N._addLine(o),u=!1,o="",i=0),o+=_,i+=M}}else{o.length>0&&(a+=N._addLine(o),o="",i=0);const b=m===g.length-1;a+=N._addLine(y,!b),u=!1,o="",i=0}else x+i>p&&(u=!1,a+=N._addLine(o),o="",i=0),(o.length>0||!N.isBreakingSpace(y)||u)&&(o+=y,i+=x)}return a+=N._addLine(o,!1),a}static _addLine(t,e=!0){return t=N._trimRight(t),t=e?`${t}
`:t,t}static _getFromCache(t,e,r,n){let i=r[t];return typeof i!="number"&&(i=N._measureText(t,e,n)+e,r[t]=i),i}static _collapseSpaces(t){return t==="normal"||t==="pre-line"}static _collapseNewlines(t){return t==="normal"}static _trimRight(t){if(typeof t!="string")return"";for(let e=t.length-1;e>=0;e--){const r=t[e];if(!N.isBreakingSpace(r))break;t=t.slice(0,-1)}return t}static _isNewline(t){return typeof t!="string"?!1:N._newlines.includes(t.charCodeAt(0))}static isBreakingSpace(t,e){return typeof t!="string"?!1:N._breakingSpaces.includes(t.charCodeAt(0))}static _tokenize(t){const e=[];let r="";if(typeof t!="string")return e;for(let n=0;n<t.length;n++){const i=t[n],o=t[n+1];if(N.isBreakingSpace(i,o)||N._isNewline(i)){r!==""&&(e.push(r),r=""),e.push(i);continue}r+=i}return r!==""&&e.push(r),e}static canBreakWords(t,e){return e}static canBreakChars(t,e,r,n,i){return!0}static wordWrapSplit(t){return N.graphemeSegmenter(t)}static measureFont(t){if(N._fonts[t])return N._fonts[t];const e=N._context;e.font=t;const r=e.measureText(N.METRICS_STRING+N.BASELINE_SYMBOL),n={ascent:r.actualBoundingBoxAscent,descent:r.actualBoundingBoxDescent,fontSize:r.actualBoundingBoxAscent+r.actualBoundingBoxDescent};return N._fonts[t]=n,n}static clearMetrics(t=""){t?delete N._fonts[t]:N._fonts={}}static get _canvas(){if(!N.__canvas){let t;try{const e=new OffscreenCanvas(0,0),r=e.getContext("2d",Br);if(r!=null&&r.measureText)return N.__canvas=e,e;t=ot.get().createCanvas()}catch{t=ot.get().createCanvas()}t.width=t.height=10,N.__canvas=t}return N.__canvas}static get _context(){return N.__context||(N.__context=N._canvas.getContext("2d",Br)),N.__context}};te.METRICS_STRING="|q";te.BASELINE_SYMBOL="M";te.BASELINE_MULTIPLIER=1.4;te.HEIGHT_MULTIPLIER=2;te.graphemeSegmenter=(()=>{if(typeof(Intl==null?void 0:Intl.Segmenter)=="function"){const s=new Intl.Segmenter;return t=>{const e=s.segment(t),r=[];let n=0;for(const i of e)r[n++]=i.segment;return r}}return s=>[...s]})();te.experimentalLetterSpacing=!1;te._fonts={};te._newlines=[10,13];te._breakingSpaces=[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288];let qt=te;const Si=[{offset:0,color:"white"},{offset:1,color:"black"}],Bn=class fn{constructor(...t){this.uid=at("fillGradient"),this.type="linear",this.colorStops=[];let e=Yh(t);e={...e.type==="radial"?fn.defaultRadialOptions:fn.defaultLinearOptions,...No(e)},this._textureSize=e.textureSize,this._wrapMode=e.wrapMode,e.type==="radial"?(this.center=e.center,this.outerCenter=e.outerCenter??this.center,this.innerRadius=e.innerRadius,this.outerRadius=e.outerRadius,this.scale=e.scale,this.rotation=e.rotation):(this.start=e.start,this.end=e.end),this.textureSpace=e.textureSpace,this.type=e.type,e.colorStops.forEach(n=>{this.addColorStop(n.offset,n.color)})}addColorStop(t,e){return this.colorStops.push({offset:t,color:ct.shared.setValue(e).toHexa()}),this}buildLinearGradient(){if(this.texture)return;let{x:t,y:e}=this.start,{x:r,y:n}=this.end,i=r-t,o=n-e;const a=i<0||o<0;if(this._wrapMode==="clamp-to-edge"){if(i<0){const m=t;t=r,r=m,i*=-1}if(o<0){const m=e;e=n,n=m,o*=-1}}const c=this.colorStops.length?this.colorStops:Si,h=this._textureSize,{canvas:l,context:d}=ki(h,1),f=a?d.createLinearGradient(this._textureSize,0,0,0):d.createLinearGradient(0,0,this._textureSize,0);Ci(f,c),d.fillStyle=f,d.fillRect(0,0,h,1),this.texture=new $({source:new Fe({resource:l,addressMode:this._wrapMode})});const u=Math.sqrt(i*i+o*o),p=Math.atan2(o,i),g=new X;g.scale(u/h,1),g.rotate(p),g.translate(t,e),this.textureSpace==="local"&&g.scale(h,h),this.transform=g}buildGradient(){this.type==="linear"?this.buildLinearGradient():this.buildRadialGradient()}buildRadialGradient(){if(this.texture)return;const t=this.colorStops.length?this.colorStops:Si,e=this._textureSize,{canvas:r,context:n}=ki(e,e),{x:i,y:o}=this.center,{x:a,y:c}=this.outerCenter,h=this.innerRadius,l=this.outerRadius,d=a-l,f=c-l,u=e/(l*2),p=(i-d)*u,g=(o-f)*u,m=n.createRadialGradient(p,g,h*u,(a-d)*u,(c-f)*u,l*u);Ci(m,t),n.fillStyle=t[t.length-1].color,n.fillRect(0,0,e,e),n.fillStyle=m,n.translate(p,g),n.rotate(this.rotation),n.scale(1,this.scale),n.translate(-p,-g),n.fillRect(0,0,e,e),this.texture=new $({source:new Fe({resource:r,addressMode:this._wrapMode})});const y=new X;y.scale(1/u,1/u),y.translate(d,f),this.textureSpace==="local"&&y.scale(e,e),this.transform=y}get styleKey(){return this.uid}destroy(){var t;(t=this.texture)==null||t.destroy(!0),this.texture=null}};Bn.defaultLinearOptions={start:{x:0,y:0},end:{x:0,y:1},colorStops:[],textureSpace:"local",type:"linear",textureSize:256,wrapMode:"clamp-to-edge"};Bn.defaultRadialOptions={center:{x:.5,y:.5},innerRadius:0,outerRadius:.5,colorStops:[],scale:1,textureSpace:"local",type:"radial",textureSize:256,wrapMode:"clamp-to-edge"};let le=Bn;function Ci(s,t){for(let e=0;e<t.length;e++){const r=t[e];s.addColorStop(r.offset,r.color)}}function ki(s,t){const e=ot.get().createCanvas(s,t),r=e.getContext("2d");return{canvas:e,context:r}}function Yh(s){let t=s[0]??{};return(typeof t=="number"||s[1])&&(Y("8.5.2","use options object instead"),t={type:"linear",start:{x:s[0],y:s[1]},end:{x:s[2],y:s[3]},textureSpace:s[4],textureSize:s[5]??le.defaultLinearOptions.textureSize}),t}const Mi={repeat:{addressModeU:"repeat",addressModeV:"repeat"},"repeat-x":{addressModeU:"repeat",addressModeV:"clamp-to-edge"},"repeat-y":{addressModeU:"clamp-to-edge",addressModeV:"repeat"},"no-repeat":{addressModeU:"clamp-to-edge",addressModeV:"clamp-to-edge"}};class lr{constructor(t,e){this.uid=at("fillPattern"),this.transform=new X,this._styleKey=null,this.texture=t,this.transform.scale(1/t.frame.width,1/t.frame.height),e&&(t.source.style.addressModeU=Mi[e].addressModeU,t.source.style.addressModeV=Mi[e].addressModeV)}setTransform(t){const e=this.texture;this.transform.copyFrom(t),this.transform.invert(),this.transform.scale(1/e.frame.width,1/e.frame.height),this._styleKey=null}get styleKey(){return this._styleKey?this._styleKey:(this._styleKey=`fill-pattern-${this.uid}-${this.texture.uid}-${this.transform.toArray().join("-")}`,this._styleKey)}}var Rr,Pi;function Xh(){if(Pi)return Rr;Pi=1,Rr=e;var s={a:7,c:6,h:1,l:2,m:2,q:4,s:4,t:2,v:1,z:0},t=/([astvzqmhlc])([^astvzqmhlc]*)/ig;function e(i){var o=[];return i.replace(t,function(a,c,h){var l=c.toLowerCase();for(h=n(h),l=="m"&&h.length>2&&(o.push([c].concat(h.splice(0,2))),l="l",c=c=="m"?"l":"L");;){if(h.length==s[l])return h.unshift(c),o.push(h);if(h.length<s[l])throw new Error("malformed path data");o.push([c].concat(h.splice(0,s[l])))}}),o}var r=/-?[0-9]*\.?[0-9]+(?:e[-+]?\d+)?/ig;function n(i){var o=i.match(r);return o?o.map(Number):[]}return Rr}var qh=Xh();const Kh=Fo(qh);function Zh(s,t){const e=Kh(s),r=[];let n=null,i=0,o=0;for(let a=0;a<e.length;a++){const c=e[a],h=c[0],l=c;switch(h){case"M":i=l[1],o=l[2],t.moveTo(i,o);break;case"m":i+=l[1],o+=l[2],t.moveTo(i,o);break;case"H":i=l[1],t.lineTo(i,o);break;case"h":i+=l[1],t.lineTo(i,o);break;case"V":o=l[1],t.lineTo(i,o);break;case"v":o+=l[1],t.lineTo(i,o);break;case"L":i=l[1],o=l[2],t.lineTo(i,o);break;case"l":i+=l[1],o+=l[2],t.lineTo(i,o);break;case"C":i=l[5],o=l[6],t.bezierCurveTo(l[1],l[2],l[3],l[4],i,o);break;case"c":t.bezierCurveTo(i+l[1],o+l[2],i+l[3],o+l[4],i+l[5],o+l[6]),i+=l[5],o+=l[6];break;case"S":i=l[3],o=l[4],t.bezierCurveToShort(l[1],l[2],i,o);break;case"s":t.bezierCurveToShort(i+l[1],o+l[2],i+l[3],o+l[4]),i+=l[3],o+=l[4];break;case"Q":i=l[3],o=l[4],t.quadraticCurveTo(l[1],l[2],i,o);break;case"q":t.quadraticCurveTo(i+l[1],o+l[2],i+l[3],o+l[4]),i+=l[3],o+=l[4];break;case"T":i=l[1],o=l[2],t.quadraticCurveToShort(i,o);break;case"t":i+=l[1],o+=l[2],t.quadraticCurveToShort(i,o);break;case"A":i=l[6],o=l[7],t.arcToSvg(l[1],l[2],l[3],l[4],l[5],i,o);break;case"a":i+=l[6],o+=l[7],t.arcToSvg(l[1],l[2],l[3],l[4],l[5],i,o);break;case"Z":case"z":t.closePath(),r.length>0&&(n=r.pop(),n?(i=n.startX,o=n.startY):(i=0,o=0)),n=null;break;default:it(`Unknown SVG path command: ${h}`)}h!=="Z"&&h!=="z"&&n===null&&(n={startX:i,startY:o},r.push(n))}return t}class Rn{constructor(t=0,e=0,r=0){this.type="circle",this.x=t,this.y=e,this.radius=r}clone(){return new Rn(this.x,this.y,this.radius)}contains(t,e){if(this.radius<=0)return!1;const r=this.radius*this.radius;let n=this.x-t,i=this.y-e;return n*=n,i*=i,n+i<=r}strokeContains(t,e,r,n=.5){if(this.radius===0)return!1;const i=this.x-t,o=this.y-e,a=this.radius,c=(1-n)*r,h=Math.sqrt(i*i+o*o);return h<=a+c&&h>a-(r-c)}getBounds(t){return t||(t=new q),t.x=this.x-this.radius,t.y=this.y-this.radius,t.width=this.radius*2,t.height=this.radius*2,t}copyFrom(t){return this.x=t.x,this.y=t.y,this.radius=t.radius,this}copyTo(t){return t.copyFrom(this),t}toString(){return`[pixi.js/math:Circle x=${this.x} y=${this.y} radius=${this.radius}]`}}class Fn{constructor(t=0,e=0,r=0,n=0){this.type="ellipse",this.x=t,this.y=e,this.halfWidth=r,this.halfHeight=n}clone(){return new Fn(this.x,this.y,this.halfWidth,this.halfHeight)}contains(t,e){if(this.halfWidth<=0||this.halfHeight<=0)return!1;let r=(t-this.x)/this.halfWidth,n=(e-this.y)/this.halfHeight;return r*=r,n*=n,r+n<=1}strokeContains(t,e,r,n=.5){const{halfWidth:i,halfHeight:o}=this;if(i<=0||o<=0)return!1;const a=r*(1-n),c=r-a,h=i-c,l=o-c,d=i+a,f=o+a,u=t-this.x,p=e-this.y,g=u*u/(h*h)+p*p/(l*l),m=u*u/(d*d)+p*p/(f*f);return g>1&&m<=1}getBounds(t){return t||(t=new q),t.x=this.x-this.halfWidth,t.y=this.y-this.halfHeight,t.width=this.halfWidth*2,t.height=this.halfHeight*2,t}copyFrom(t){return this.x=t.x,this.y=t.y,this.halfWidth=t.halfWidth,this.halfHeight=t.halfHeight,this}copyTo(t){return t.copyFrom(this),t}toString(){return`[pixi.js/math:Ellipse x=${this.x} y=${this.y} halfWidth=${this.halfWidth} halfHeight=${this.halfHeight}]`}}function Qh(s,t,e,r,n,i){const o=s-e,a=t-r,c=n-e,h=i-r,l=o*c+a*h,d=c*c+h*h;let f=-1;d!==0&&(f=l/d);let u,p;f<0?(u=e,p=r):f>1?(u=n,p=i):(u=e+f*c,p=r+f*h);const g=s-u,m=t-p;return g*g+m*m}let Jh,td;class us{constructor(...t){this.type="polygon";let e=Array.isArray(t[0])?t[0]:t;if(typeof e[0]!="number"){const r=[];for(let n=0,i=e.length;n<i;n++)r.push(e[n].x,e[n].y);e=r}this.points=e,this.closePath=!0}isClockwise(){let t=0;const e=this.points,r=e.length;for(let n=0;n<r;n+=2){const i=e[n],o=e[n+1],a=e[(n+2)%r],c=e[(n+3)%r];t+=(a-i)*(c+o)}return t<0}containsPolygon(t){const e=this.getBounds(Jh),r=t.getBounds(td);if(!e.containsRect(r))return!1;const n=t.points;for(let i=0;i<n.length;i+=2){const o=n[i],a=n[i+1];if(!this.contains(o,a))return!1}return!0}clone(){const t=this.points.slice(),e=new us(t);return e.closePath=this.closePath,e}contains(t,e){let r=!1;const n=this.points.length/2;for(let i=0,o=n-1;i<n;o=i++){const a=this.points[i*2],c=this.points[i*2+1],h=this.points[o*2],l=this.points[o*2+1];c>e!=l>e&&t<(h-a)*((e-c)/(l-c))+a&&(r=!r)}return r}strokeContains(t,e,r,n=.5){const i=r*r,o=i*(1-n),a=i-o,{points:c}=this,h=c.length-(this.closePath?0:2);for(let l=0;l<h;l+=2){const d=c[l],f=c[l+1],u=c[(l+2)%c.length],p=c[(l+3)%c.length],g=Qh(t,e,d,f,u,p),m=Math.sign((u-d)*(e-f)-(p-f)*(t-d));if(g<=(m<0?a:o))return!0}return!1}getBounds(t){t||(t=new q);const e=this.points;let r=1/0,n=-1/0,i=1/0,o=-1/0;for(let a=0,c=e.length;a<c;a+=2){const h=e[a],l=e[a+1];r=h<r?h:r,n=h>n?h:n,i=l<i?l:i,o=l>o?l:o}return t.x=r,t.width=n-r,t.y=i,t.height=o-i,t}copyFrom(t){return this.points=t.points.slice(),this.closePath=t.closePath,this}copyTo(t){return t.copyFrom(this),t}toString(){return`[pixi.js/math:PolygoncloseStroke=${this.closePath}points=${this.points.reduce((t,e)=>`${t}, ${e}`,"")}]`}get lastX(){return this.points[this.points.length-2]}get lastY(){return this.points[this.points.length-1]}get x(){return this.points[this.points.length-2]}get y(){return this.points[this.points.length-1]}}const Rs=(s,t,e,r,n,i,o)=>{const a=s-e,c=t-r,h=Math.sqrt(a*a+c*c);return h>=n-i&&h<=n+o};class Ln{constructor(t=0,e=0,r=0,n=0,i=20){this.type="roundedRectangle",this.x=t,this.y=e,this.width=r,this.height=n,this.radius=i}getBounds(t){return t||(t=new q),t.x=this.x,t.y=this.y,t.width=this.width,t.height=this.height,t}clone(){return new Ln(this.x,this.y,this.width,this.height,this.radius)}copyFrom(t){return this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height,this}copyTo(t){return t.copyFrom(this),t}contains(t,e){if(this.width<=0||this.height<=0)return!1;if(t>=this.x&&t<=this.x+this.width&&e>=this.y&&e<=this.y+this.height){const r=Math.max(0,Math.min(this.radius,Math.min(this.width,this.height)/2));if(e>=this.y+r&&e<=this.y+this.height-r||t>=this.x+r&&t<=this.x+this.width-r)return!0;let n=t-(this.x+r),i=e-(this.y+r);const o=r*r;if(n*n+i*i<=o||(n=t-(this.x+this.width-r),n*n+i*i<=o)||(i=e-(this.y+this.height-r),n*n+i*i<=o)||(n=t-(this.x+r),n*n+i*i<=o))return!0}return!1}strokeContains(t,e,r,n=.5){const{x:i,y:o,width:a,height:c,radius:h}=this,l=r*(1-n),d=r-l,f=i+h,u=o+h,p=a-h*2,g=c-h*2,m=i+a,y=o+c;return(t>=i-l&&t<=i+d||t>=m-d&&t<=m+l)&&e>=u&&e<=u+g||(e>=o-l&&e<=o+d||e>=y-d&&e<=y+l)&&t>=f&&t<=f+p?!0:t<f&&e<u&&Rs(t,e,f,u,h,d,l)||t>m-h&&e<u&&Rs(t,e,m-h,u,h,d,l)||t>m-h&&e>y-h&&Rs(t,e,m-h,y-h,h,d,l)||t<f&&e>y-h&&Rs(t,e,f,y-h,h,d,l)}toString(){return`[pixi.js/math:RoundedRectangle x=${this.x} y=${this.y}width=${this.width} height=${this.height} radius=${this.radius}]`}}const Ra={};function ed(s,t,e){let r=2166136261;for(let n=0;n<t;n++)r^=s[n].uid,r=Math.imul(r,16777619),r>>>=0;return Ra[r]||sd(s,t,r,e)}function sd(s,t,e,r){const n={};let i=0;for(let a=0;a<r;a++){const c=a<t?s[a]:$.EMPTY.source;n[i++]=c.source,n[i++]=c.style}const o=new Vs(n);return Ra[e]=o,o}class Ti{constructor(t){typeof t=="number"?this.rawBinaryData=new ArrayBuffer(t):t instanceof Uint8Array?this.rawBinaryData=t.buffer:this.rawBinaryData=t,this.uint32View=new Uint32Array(this.rawBinaryData),this.float32View=new Float32Array(this.rawBinaryData),this.size=this.rawBinaryData.byteLength}get int8View(){return this._int8View||(this._int8View=new Int8Array(this.rawBinaryData)),this._int8View}get uint8View(){return this._uint8View||(this._uint8View=new Uint8Array(this.rawBinaryData)),this._uint8View}get int16View(){return this._int16View||(this._int16View=new Int16Array(this.rawBinaryData)),this._int16View}get int32View(){return this._int32View||(this._int32View=new Int32Array(this.rawBinaryData)),this._int32View}get float64View(){return this._float64Array||(this._float64Array=new Float64Array(this.rawBinaryData)),this._float64Array}get bigUint64View(){return this._bigUint64Array||(this._bigUint64Array=new BigUint64Array(this.rawBinaryData)),this._bigUint64Array}view(t){return this[`${t}View`]}destroy(){this.rawBinaryData=null,this._int8View=null,this._uint8View=null,this._int16View=null,this.uint16View=null,this._int32View=null,this.uint32View=null,this.float32View=null}static sizeOf(t){switch(t){case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;default:throw new Error(`${t} isn't a valid view type`)}}}function Ei(s,t){const e=s.byteLength/8|0,r=new Float64Array(s,0,e);new Float64Array(t,0,e).set(r);const i=s.byteLength-e*8;if(i>0){const o=new Uint8Array(s,e*8,i);new Uint8Array(t,e*8,i).set(o)}}const rd={normal:"normal-npm",add:"add-npm",screen:"screen-npm"};var nd=(s=>(s[s.DISABLED=0]="DISABLED",s[s.RENDERING_MASK_ADD=1]="RENDERING_MASK_ADD",s[s.MASK_ACTIVE=2]="MASK_ACTIVE",s[s.INVERSE_MASK_ACTIVE=3]="INVERSE_MASK_ACTIVE",s[s.RENDERING_MASK_REMOVE=4]="RENDERING_MASK_REMOVE",s[s.NONE=5]="NONE",s))(nd||{});function Ii(s,t){return t.alphaMode==="no-premultiply-alpha"&&rd[s]||s}const id=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%","gl_FragColor = vec4(0.0);","}"].join(`
`);function od(s){let t="";for(let e=0;e<s;++e)e>0&&(t+=`
else `),e<s-1&&(t+=`if(test == ${e}.0){}`);return t}function ad(s,t){if(s===0)throw new Error("Invalid value of `0` passed to `checkMaxIfStatementsInShader`");const e=t.createShader(t.FRAGMENT_SHADER);try{for(;;){const r=id.replace(/%forloop%/gi,od(s));if(t.shaderSource(e,r),t.compileShader(e),!t.getShaderParameter(e,t.COMPILE_STATUS))s=s/2|0;else break}}finally{t.deleteShader(e)}return s}let Ge=null;function cd(){var t;if(Ge)return Ge;const s=fa();return Ge=s.getParameter(s.MAX_TEXTURE_IMAGE_UNITS),Ge=ad(Ge,s),(t=s.getExtension("WEBGL_lose_context"))==null||t.loseContext(),Ge}class ld{constructor(){this.ids=Object.create(null),this.textures=[],this.count=0}clear(){for(let t=0;t<this.count;t++){const e=this.textures[t];this.textures[t]=null,this.ids[e.uid]=null}this.count=0}}class hd{constructor(){this.renderPipeId="batch",this.action="startBatch",this.start=0,this.size=0,this.textures=new ld,this.blendMode="normal",this.topology="triangle-strip",this.canBundle=!0}destroy(){this.textures=null,this.gpuBindGroup=null,this.bindGroup=null,this.batcher=null}}const Fa=[];let pn=0;function Bi(){return pn>0?Fa[--pn]:new hd}function Ri(s){Fa[pn++]=s}let rs=0;const La=class za{constructor(t){this.uid=at("batcher"),this.dirty=!0,this.batchIndex=0,this.batches=[],this._elements=[],t={...za.defaultOptions,...t},t.maxTextures||(Y("v8.8.0","maxTextures is a required option for Batcher now, please pass it in the options"),t.maxTextures=cd());const{maxTextures:e,attributesInitialSize:r,indicesInitialSize:n}=t;this.attributeBuffer=new Ti(r*4),this.indexBuffer=new Uint16Array(n),this.maxTextures=e}begin(){this.elementSize=0,this.elementStart=0,this.indexSize=0,this.attributeSize=0;for(let t=0;t<this.batchIndex;t++)Ri(this.batches[t]);this.batchIndex=0,this._batchIndexStart=0,this._batchIndexSize=0,this.dirty=!0}add(t){this._elements[this.elementSize++]=t,t._indexStart=this.indexSize,t._attributeStart=this.attributeSize,t._batcher=this,this.indexSize+=t.indexSize,this.attributeSize+=t.attributeSize*this.vertexSize}checkAndUpdateTexture(t,e){const r=t._batch.textures.ids[e._source.uid];return!r&&r!==0?!1:(t._textureId=r,t.texture=e,!0)}updateElement(t){this.dirty=!0;const e=this.attributeBuffer;t.packAsQuad?this.packQuadAttributes(t,e.float32View,e.uint32View,t._attributeStart,t._textureId):this.packAttributes(t,e.float32View,e.uint32View,t._attributeStart,t._textureId)}break(t){const e=this._elements;if(!e[this.elementStart])return;let r=Bi(),n=r.textures;n.clear();const i=e[this.elementStart];let o=Ii(i.blendMode,i.texture._source),a=i.topology;this.attributeSize*4>this.attributeBuffer.size&&this._resizeAttributeBuffer(this.attributeSize*4),this.indexSize>this.indexBuffer.length&&this._resizeIndexBuffer(this.indexSize);const c=this.attributeBuffer.float32View,h=this.attributeBuffer.uint32View,l=this.indexBuffer;let d=this._batchIndexSize,f=this._batchIndexStart,u="startBatch";const p=this.maxTextures;for(let g=this.elementStart;g<this.elementSize;++g){const m=e[g];e[g]=null;const x=m.texture._source,b=Ii(m.blendMode,x),w=o!==b||a!==m.topology;if(x._batchTick===rs&&!w){m._textureId=x._textureBindLocation,d+=m.indexSize,m.packAsQuad?(this.packQuadAttributes(m,c,h,m._attributeStart,m._textureId),this.packQuadIndex(l,m._indexStart,m._attributeStart/this.vertexSize)):(this.packAttributes(m,c,h,m._attributeStart,m._textureId),this.packIndex(m,l,m._indexStart,m._attributeStart/this.vertexSize)),m._batch=r;continue}x._batchTick=rs,(n.count>=p||w)&&(this._finishBatch(r,f,d-f,n,o,a,t,u),u="renderBatch",f=d,o=b,a=m.topology,r=Bi(),n=r.textures,n.clear(),++rs),m._textureId=x._textureBindLocation=n.count,n.ids[x.uid]=n.count,n.textures[n.count++]=x,m._batch=r,d+=m.indexSize,m.packAsQuad?(this.packQuadAttributes(m,c,h,m._attributeStart,m._textureId),this.packQuadIndex(l,m._indexStart,m._attributeStart/this.vertexSize)):(this.packAttributes(m,c,h,m._attributeStart,m._textureId),this.packIndex(m,l,m._indexStart,m._attributeStart/this.vertexSize))}n.count>0&&(this._finishBatch(r,f,d-f,n,o,a,t,u),f=d,++rs),this.elementStart=this.elementSize,this._batchIndexStart=f,this._batchIndexSize=d}_finishBatch(t,e,r,n,i,o,a,c){t.gpuBindGroup=null,t.bindGroup=null,t.action=c,t.batcher=this,t.textures=n,t.blendMode=i,t.topology=o,t.start=e,t.size=r,++rs,this.batches[this.batchIndex++]=t,a.add(t)}finish(t){this.break(t)}ensureAttributeBuffer(t){t*4<=this.attributeBuffer.size||this._resizeAttributeBuffer(t*4)}ensureIndexBuffer(t){t<=this.indexBuffer.length||this._resizeIndexBuffer(t)}_resizeAttributeBuffer(t){const e=Math.max(t,this.attributeBuffer.size*2),r=new Ti(e);Ei(this.attributeBuffer.rawBinaryData,r.rawBinaryData),this.attributeBuffer=r}_resizeIndexBuffer(t){const e=this.indexBuffer;let r=Math.max(t,e.length*1.5);r+=r%2;const n=r>65535?new Uint32Array(r):new Uint16Array(r);if(n.BYTES_PER_ELEMENT!==e.BYTES_PER_ELEMENT)for(let i=0;i<e.length;i++)n[i]=e[i];else Ei(e.buffer,n.buffer);this.indexBuffer=n}packQuadIndex(t,e,r){t[e]=r+0,t[e+1]=r+1,t[e+2]=r+2,t[e+3]=r+0,t[e+4]=r+2,t[e+5]=r+3}packIndex(t,e,r,n){const i=t.indices,o=t.indexSize,a=t.indexOffset,c=t.attributeOffset;for(let h=0;h<o;h++)e[r++]=n+i[h+a]-c}destroy(){for(let t=0;t<this.batches.length;t++)Ri(this.batches[t]);this.batches=null;for(let t=0;t<this._elements.length;t++)this._elements[t]._batch=null;this._elements=null,this.indexBuffer=null,this.attributeBuffer.destroy(),this.attributeBuffer=null}};La.defaultOptions={maxTextures:null,attributesInitialSize:4,indicesInitialSize:6};let dd=La;var wt=(s=>(s[s.MAP_READ=1]="MAP_READ",s[s.MAP_WRITE=2]="MAP_WRITE",s[s.COPY_SRC=4]="COPY_SRC",s[s.COPY_DST=8]="COPY_DST",s[s.INDEX=16]="INDEX",s[s.VERTEX=32]="VERTEX",s[s.UNIFORM=64]="UNIFORM",s[s.STORAGE=128]="STORAGE",s[s.INDIRECT=256]="INDIRECT",s[s.QUERY_RESOLVE=512]="QUERY_RESOLVE",s[s.STATIC=1024]="STATIC",s))(wt||{});class _s extends Wt{constructor(t){let{data:e,size:r}=t;const{usage:n,label:i,shrinkToFit:o}=t;super(),this.uid=at("buffer"),this._resourceType="buffer",this._resourceId=at("resource"),this._touched=0,this._updateID=1,this._dataInt32=null,this.shrinkToFit=!0,this.destroyed=!1,e instanceof Array&&(e=new Float32Array(e)),this._data=e,r??(r=e==null?void 0:e.byteLength);const a=!!e;this.descriptor={size:r,usage:n,mappedAtCreation:a,label:i},this.shrinkToFit=o??!0}get data(){return this._data}set data(t){this.setDataWithSize(t,t.length,!0)}get dataInt32(){return this._dataInt32||(this._dataInt32=new Int32Array(this.data.buffer)),this._dataInt32}get static(){return!!(this.descriptor.usage&wt.STATIC)}set static(t){t?this.descriptor.usage|=wt.STATIC:this.descriptor.usage&=~wt.STATIC}setDataWithSize(t,e,r){if(this._updateID++,this._updateSize=e*t.BYTES_PER_ELEMENT,this._data===t){r&&this.emit("update",this);return}const n=this._data;if(this._data=t,this._dataInt32=null,!n||n.length!==t.length){!this.shrinkToFit&&n&&t.byteLength<n.byteLength?r&&this.emit("update",this):(this.descriptor.size=t.byteLength,this._resourceId=at("resource"),this.emit("change",this));return}r&&this.emit("update",this)}update(t){this._updateSize=t??this._updateSize,this._updateID++,this.emit("update",this)}destroy(){this.destroyed=!0,this.emit("destroy",this),this.emit("change",this),this._data=null,this.descriptor=null,this.removeAllListeners()}}function Ga(s,t){if(!(s instanceof _s)){let e=t?wt.INDEX:wt.VERTEX;s instanceof Array&&(t?(s=new Uint32Array(s),e=wt.INDEX|wt.COPY_DST):(s=new Float32Array(s),e=wt.VERTEX|wt.COPY_DST)),s=new _s({data:s,label:t?"index-mesh-buffer":"vertex-mesh-buffer",usage:e})}return s}function ud(s,t,e){const r=s.getAttribute(t);if(!r)return e.minX=0,e.minY=0,e.maxX=0,e.maxY=0,e;const n=r.buffer.data;let i=1/0,o=1/0,a=-1/0,c=-1/0;const h=n.BYTES_PER_ELEMENT,l=(r.offset||0)/h,d=(r.stride||2*4)/h;for(let f=l;f<n.length;f+=d){const u=n[f],p=n[f+1];u>a&&(a=u),p>c&&(c=p),u<i&&(i=u),p<o&&(o=p)}return e.minX=i,e.minY=o,e.maxX=a,e.maxY=c,e}function fd(s){return(s instanceof _s||Array.isArray(s)||s.BYTES_PER_ELEMENT)&&(s={buffer:s}),s.buffer=Ga(s.buffer,!1),s}class pd extends Wt{constructor(t={}){super(),this.uid=at("geometry"),this._layoutKey=0,this.instanceCount=1,this._bounds=new Dt,this._boundsDirty=!0;const{attributes:e,indexBuffer:r,topology:n}=t;if(this.buffers=[],this.attributes={},e)for(const i in e)this.addAttribute(i,e[i]);this.instanceCount=t.instanceCount??1,r&&this.addIndex(r),this.topology=n||"triangle-list"}onBufferUpdate(){this._boundsDirty=!0,this.emit("update",this)}getAttribute(t){return this.attributes[t]}getIndex(){return this.indexBuffer}getBuffer(t){return this.getAttribute(t).buffer}getSize(){for(const t in this.attributes){const e=this.attributes[t];return e.buffer.data.length/(e.stride/4||e.size)}return 0}addAttribute(t,e){const r=fd(e);this.buffers.indexOf(r.buffer)===-1&&(this.buffers.push(r.buffer),r.buffer.on("update",this.onBufferUpdate,this),r.buffer.on("change",this.onBufferUpdate,this)),this.attributes[t]=r}addIndex(t){this.indexBuffer=Ga(t,!0),this.buffers.push(this.indexBuffer)}get bounds(){return this._boundsDirty?(this._boundsDirty=!1,ud(this,"aPosition",this._bounds)):this._bounds}destroy(t=!1){this.emit("destroy",this),this.removeAllListeners(),t&&this.buffers.forEach(e=>e.destroy()),this.attributes=null,this.buffers=null,this.indexBuffer=null,this._bounds=null}}const md=new Float32Array(1),gd=new Uint32Array(1);class xd extends pd{constructor(){const e=new _s({data:md,label:"attribute-batch-buffer",usage:wt.VERTEX|wt.COPY_DST,shrinkToFit:!1}),r=new _s({data:gd,label:"index-batch-buffer",usage:wt.INDEX|wt.COPY_DST,shrinkToFit:!1}),n=6*4;super({attributes:{aPosition:{buffer:e,format:"float32x2",stride:n,offset:0},aUV:{buffer:e,format:"float32x2",stride:n,offset:2*4},aColor:{buffer:e,format:"unorm8x4",stride:n,offset:4*4},aTextureIdAndRound:{buffer:e,format:"uint16x2",stride:n,offset:5*4}},indexBuffer:r})}}function Fi(s,t,e){if(s)for(const r in s){const n=r.toLocaleLowerCase(),i=t[n];if(i){let o=s[r];r==="header"&&(o=o.replace(/@in\s+[^;]+;\s*/g,"").replace(/@out\s+[^;]+;\s*/g,"")),e&&i.push(`//----${e}----//`),i.push(o)}else it(`${r} placement hook does not exist in shader`)}}const yd=/\{\{(.*?)\}\}/g;function Li(s){var r;const t={};return(((r=s.match(yd))==null?void 0:r.map(n=>n.replace(/[{()}]/g,"")))??[]).forEach(n=>{t[n]=[]}),t}function zi(s,t){let e;const r=/@in\s+([^;]+);/g;for(;(e=r.exec(s))!==null;)t.push(e[1])}function Gi(s,t,e=!1){const r=[];zi(t,r),s.forEach(a=>{a.header&&zi(a.header,r)});const n=r;e&&n.sort();const i=n.map((a,c)=>`       @location(${c}) ${a},`).join(`
`);let o=t.replace(/@in\s+[^;]+;\s*/g,"");return o=o.replace("{{in}}",`
${i}
`),o}function Ni(s,t){let e;const r=/@out\s+([^;]+);/g;for(;(e=r.exec(s))!==null;)t.push(e[1])}function bd(s){const e=/\b(\w+)\s*:/g.exec(s);return e?e[1]:""}function wd(s){const t=/@.*?\s+/g;return s.replace(t,"")}function _d(s,t){const e=[];Ni(t,e),s.forEach(c=>{c.header&&Ni(c.header,e)});let r=0;const n=e.sort().map(c=>c.indexOf("builtin")>-1?c:`@location(${r++}) ${c}`).join(`,
`),i=e.sort().map(c=>`       var ${wd(c)};`).join(`
`),o=`return VSOutput(
            ${e.sort().map(c=>` ${bd(c)}`).join(`,
`)});`;let a=t.replace(/@out\s+[^;]+;\s*/g,"");return a=a.replace("{{struct}}",`
${n}
`),a=a.replace("{{start}}",`
${i}
`),a=a.replace("{{return}}",`
${o}
`),a}function Oi(s,t){let e=s;for(const r in t){const n=t[r];n.join(`
`).length?e=e.replace(`{{${r}}}`,`//-----${r} START-----//
${n.join(`
`)}
//----${r} FINISH----//`):e=e.replace(`{{${r}}}`,"")}return e}const me=Object.create(null),Fr=new Map;let vd=0;function Ad({template:s,bits:t}){const e=Na(s,t);if(me[e])return me[e];const{vertex:r,fragment:n}=Cd(s,t);return me[e]=Oa(r,n,t),me[e]}function Sd({template:s,bits:t}){const e=Na(s,t);return me[e]||(me[e]=Oa(s.vertex,s.fragment,t)),me[e]}function Cd(s,t){const e=t.map(o=>o.vertex).filter(o=>!!o),r=t.map(o=>o.fragment).filter(o=>!!o);let n=Gi(e,s.vertex,!0);n=_d(e,n);const i=Gi(r,s.fragment,!0);return{vertex:n,fragment:i}}function Na(s,t){return t.map(e=>(Fr.has(e)||Fr.set(e,vd++),Fr.get(e))).sort((e,r)=>e-r).join("-")+s.vertex+s.fragment}function Oa(s,t,e){const r=Li(s),n=Li(t);return e.forEach(i=>{Fi(i.vertex,r,i.name),Fi(i.fragment,n,i.name)}),{vertex:Oi(s,r),fragment:Oi(t,n)}}const kd=`
    @in aPosition: vec2<f32>;
    @in aUV: vec2<f32>;

    @out @builtin(position) vPosition: vec4<f32>;
    @out vUV : vec2<f32>;
    @out vColor : vec4<f32>;

    {{header}}

    struct VSOutput {
        {{struct}}
    };

    @vertex
    fn main( {{in}} ) -> VSOutput {

        var worldTransformMatrix = globalUniforms.uWorldTransformMatrix;
        var modelMatrix = mat3x3<f32>(
            1.0, 0.0, 0.0,
            0.0, 1.0, 0.0,
            0.0, 0.0, 1.0
          );
        var position = aPosition;
        var uv = aUV;

        {{start}}

        vColor = vec4<f32>(1., 1., 1., 1.);

        {{main}}

        vUV = uv;

        var modelViewProjectionMatrix = globalUniforms.uProjectionMatrix * worldTransformMatrix * modelMatrix;

        vPosition =  vec4<f32>((modelViewProjectionMatrix *  vec3<f32>(position, 1.0)).xy, 0.0, 1.0);

        vColor *= globalUniforms.uWorldColorAlpha;

        {{end}}

        {{return}}
    };
`,Md=`
    @in vUV : vec2<f32>;
    @in vColor : vec4<f32>;

    {{header}}

    @fragment
    fn main(
        {{in}}
      ) -> @location(0) vec4<f32> {

        {{start}}

        var outColor:vec4<f32>;

        {{main}}

        var finalColor:vec4<f32> = outColor * vColor;

        {{end}}

        return finalColor;
      };
`,Pd=`
    in vec2 aPosition;
    in vec2 aUV;

    out vec4 vColor;
    out vec2 vUV;

    {{header}}

    void main(void){

        mat3 worldTransformMatrix = uWorldTransformMatrix;
        mat3 modelMatrix = mat3(
            1.0, 0.0, 0.0,
            0.0, 1.0, 0.0,
            0.0, 0.0, 1.0
          );
        vec2 position = aPosition;
        vec2 uv = aUV;

        {{start}}

        vColor = vec4(1.);

        {{main}}

        vUV = uv;

        mat3 modelViewProjectionMatrix = uProjectionMatrix * worldTransformMatrix * modelMatrix;

        gl_Position = vec4((modelViewProjectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);

        vColor *= uWorldColorAlpha;

        {{end}}
    }
`,Td=`

    in vec4 vColor;
    in vec2 vUV;

    out vec4 finalColor;

    {{header}}

    void main(void) {

        {{start}}

        vec4 outColor;

        {{main}}

        finalColor = outColor * vColor;

        {{end}}
    }
`,Ed={name:"global-uniforms-bit",vertex:{header:`
        struct GlobalUniforms {
            uProjectionMatrix:mat3x3<f32>,
            uWorldTransformMatrix:mat3x3<f32>,
            uWorldColorAlpha: vec4<f32>,
            uResolution: vec2<f32>,
        }

        @group(0) @binding(0) var<uniform> globalUniforms : GlobalUniforms;
        `}},Id={name:"global-uniforms-bit",vertex:{header:`
          uniform mat3 uProjectionMatrix;
          uniform mat3 uWorldTransformMatrix;
          uniform vec4 uWorldColorAlpha;
          uniform vec2 uResolution;
        `}};function Bd({bits:s,name:t}){const e=Ad({template:{fragment:Md,vertex:kd},bits:[Ed,...s]});return cr.from({name:t,vertex:{source:e.vertex,entryPoint:"main"},fragment:{source:e.fragment,entryPoint:"main"}})}function Rd({bits:s,name:t}){return new ma({name:t,...Sd({template:{vertex:Pd,fragment:Td},bits:[Id,...s]})})}const Fd={name:"color-bit",vertex:{header:`
            @in aColor: vec4<f32>;
        `,main:`
            vColor *= vec4<f32>(aColor.rgb * aColor.a, aColor.a);
        `}},Ld={name:"color-bit",vertex:{header:`
            in vec4 aColor;
        `,main:`
            vColor *= vec4(aColor.rgb * aColor.a, aColor.a);
        `}},Lr={};function zd(s){const t=[];if(s===1)t.push("@group(1) @binding(0) var textureSource1: texture_2d<f32>;"),t.push("@group(1) @binding(1) var textureSampler1: sampler;");else{let e=0;for(let r=0;r<s;r++)t.push(`@group(1) @binding(${e++}) var textureSource${r+1}: texture_2d<f32>;`),t.push(`@group(1) @binding(${e++}) var textureSampler${r+1}: sampler;`)}return t.join(`
`)}function Gd(s){const t=[];if(s===1)t.push("outColor = textureSampleGrad(textureSource1, textureSampler1, vUV, uvDx, uvDy);");else{t.push("switch vTextureId {");for(let e=0;e<s;e++)e===s-1?t.push("  default:{"):t.push(`  case ${e}:{`),t.push(`      outColor = textureSampleGrad(textureSource${e+1}, textureSampler${e+1}, vUV, uvDx, uvDy);`),t.push("      break;}");t.push("}")}return t.join(`
`)}function Nd(s){return Lr[s]||(Lr[s]={name:"texture-batch-bit",vertex:{header:`
                @in aTextureIdAndRound: vec2<u32>;
                @out @interpolate(flat) vTextureId : u32;
            `,main:`
                vTextureId = aTextureIdAndRound.y;
            `,end:`
                if(aTextureIdAndRound.x == 1)
                {
                    vPosition = vec4<f32>(roundPixels(vPosition.xy, globalUniforms.uResolution), vPosition.zw);
                }
            `},fragment:{header:`
                @in @interpolate(flat) vTextureId: u32;

                ${zd(s)}
            `,main:`
                var uvDx = dpdx(vUV);
                var uvDy = dpdy(vUV);

                ${Gd(s)}
            `}}),Lr[s]}const zr={};function Od(s){const t=[];for(let e=0;e<s;e++)e>0&&t.push("else"),e<s-1&&t.push(`if(vTextureId < ${e}.5)`),t.push("{"),t.push(`	outColor = texture(uTextures[${e}], vUV);`),t.push("}");return t.join(`
`)}function Ud(s){return zr[s]||(zr[s]={name:"texture-batch-bit",vertex:{header:`
                in vec2 aTextureIdAndRound;
                out float vTextureId;

            `,main:`
                vTextureId = aTextureIdAndRound.y;
            `,end:`
                if(aTextureIdAndRound.x == 1.)
                {
                    gl_Position.xy = roundPixels(gl_Position.xy, uResolution);
                }
            `},fragment:{header:`
                in float vTextureId;

                uniform sampler2D uTextures[${s}];

            `,main:`

                ${Od(s)}
            `}}),zr[s]}const Dd={name:"round-pixels-bit",vertex:{header:`
            fn roundPixels(position: vec2<f32>, targetSize: vec2<f32>) -> vec2<f32>
            {
                return (floor(((position * 0.5 + 0.5) * targetSize) + 0.5) / targetSize) * 2.0 - 1.0;
            }
        `}},Hd={name:"round-pixels-bit",vertex:{header:`
            vec2 roundPixels(vec2 position, vec2 targetSize)
            {
                return (floor(((position * 0.5 + 0.5) * targetSize) + 0.5) / targetSize) * 2.0 - 1.0;
            }
        `}},Ui={};function Wd(s){let t=Ui[s];if(t)return t;const e=new Int32Array(s);for(let r=0;r<s;r++)e[r]=r;return t=Ui[s]=new ba({uTextures:{value:e,type:"i32",size:s}},{isStatic:!0}),t}class jd extends In{constructor(t){const e=Rd({name:"batch",bits:[Ld,Ud(t),Hd]}),r=Bd({name:"batch",bits:[Fd,Nd(t),Dd]});super({glProgram:e,gpuProgram:r,resources:{batchSamplers:Wd(t)}})}}let Gr=null;const Ua=class Da extends dd{constructor(t){super(t),this.geometry=new xd,this.name=Da.extension.name,this.vertexSize=6,Gr??(Gr=new jd(t.maxTextures)),this.shader=Gr}packAttributes(t,e,r,n,i){const o=i<<16|t.roundPixels&65535,a=t.transform,c=a.a,h=a.b,l=a.c,d=a.d,f=a.tx,u=a.ty,{positions:p,uvs:g}=t,m=t.color,y=t.attributeOffset,x=y+t.attributeSize;for(let b=y;b<x;b++){const w=b*2,_=p[w],S=p[w+1];e[n++]=c*_+l*S+f,e[n++]=d*S+h*_+u,e[n++]=g[w],e[n++]=g[w+1],r[n++]=m,r[n++]=o}}packQuadAttributes(t,e,r,n,i){const o=t.texture,a=t.transform,c=a.a,h=a.b,l=a.c,d=a.d,f=a.tx,u=a.ty,p=t.bounds,g=p.maxX,m=p.minX,y=p.maxY,x=p.minY,b=o.uvs,w=t.color,_=i<<16|t.roundPixels&65535;e[n+0]=c*m+l*x+f,e[n+1]=d*x+h*m+u,e[n+2]=b.x0,e[n+3]=b.y0,r[n+4]=w,r[n+5]=_,e[n+6]=c*g+l*x+f,e[n+7]=d*x+h*g+u,e[n+8]=b.x1,e[n+9]=b.y1,r[n+10]=w,r[n+11]=_,e[n+12]=c*g+l*y+f,e[n+13]=d*y+h*g+u,e[n+14]=b.x2,e[n+15]=b.y2,r[n+16]=w,r[n+17]=_,e[n+18]=c*m+l*y+f,e[n+19]=d*y+h*m+u,e[n+20]=b.x3,e[n+21]=b.y3,r[n+22]=w,r[n+23]=_}};Ua.extension={type:[O.Batcher],name:"default"};let $d=Ua;function Vd(s,t,e,r,n,i,o,a=null){let c=0;e*=t,n*=i;const h=a.a,l=a.b,d=a.c,f=a.d,u=a.tx,p=a.ty;for(;c<o;){const g=s[e],m=s[e+1];r[n]=h*g+d*m+u,r[n+1]=l*g+f*m+p,n+=i,e+=t,c++}}function Yd(s,t,e,r){let n=0;for(t*=e;n<r;)s[t]=0,s[t+1]=0,t+=e,n++}function Ha(s,t,e,r,n){const i=t.a,o=t.b,a=t.c,c=t.d,h=t.tx,l=t.ty;e||(e=0),r||(r=2),n||(n=s.length/r-e);let d=e*r;for(let f=0;f<n;f++){const u=s[d],p=s[d+1];s[d]=i*u+a*p+h,s[d+1]=o*u+c*p+l,d+=r}}const Xd=new X;class Wa{constructor(){this.packAsQuad=!1,this.batcherName="default",this.topology="triangle-list",this.applyTransform=!0,this.roundPixels=0,this._batcher=null,this._batch=null}get uvs(){return this.geometryData.uvs}get positions(){return this.geometryData.vertices}get indices(){return this.geometryData.indices}get blendMode(){return this.renderable&&this.applyTransform?this.renderable.groupBlendMode:"normal"}get color(){const t=this.baseColor,e=t>>16|t&65280|(t&255)<<16,r=this.renderable;return r?Xo(e,r.groupColor)+(this.alpha*r.groupAlpha*255<<24):e+(this.alpha*255<<24)}get transform(){var t;return((t=this.renderable)==null?void 0:t.groupTransform)||Xd}copyTo(t){t.indexOffset=this.indexOffset,t.indexSize=this.indexSize,t.attributeOffset=this.attributeOffset,t.attributeSize=this.attributeSize,t.baseColor=this.baseColor,t.alpha=this.alpha,t.texture=this.texture,t.geometryData=this.geometryData,t.topology=this.topology}reset(){this.applyTransform=!0,this.renderable=null,this.topology="triangle-list"}}const vs={extension:{type:O.ShapeBuilder,name:"circle"},build(s,t){let e,r,n,i,o,a;if(s.type==="circle"){const w=s;if(o=a=w.radius,o<=0)return!1;e=w.x,r=w.y,n=i=0}else if(s.type==="ellipse"){const w=s;if(o=w.halfWidth,a=w.halfHeight,o<=0||a<=0)return!1;e=w.x,r=w.y,n=i=0}else{const w=s,_=w.width/2,S=w.height/2;e=w.x+_,r=w.y+S,o=a=Math.max(0,Math.min(w.radius,Math.min(_,S))),n=_-o,i=S-a}if(n<0||i<0)return!1;const c=Math.ceil(2.3*Math.sqrt(o+a)),h=c*8+(n?4:0)+(i?4:0);if(h===0)return!1;if(c===0)return t[0]=t[6]=e+n,t[1]=t[3]=r+i,t[2]=t[4]=e-n,t[5]=t[7]=r-i,!0;let l=0,d=c*4+(n?2:0)+2,f=d,u=h,p=n+o,g=i,m=e+p,y=e-p,x=r+g;if(t[l++]=m,t[l++]=x,t[--d]=x,t[--d]=y,i){const w=r-g;t[f++]=y,t[f++]=w,t[--u]=w,t[--u]=m}for(let w=1;w<c;w++){const _=Math.PI/2*(w/c),S=n+Math.cos(_)*o,C=i+Math.sin(_)*a,M=e+S,v=e-S,k=r+C,A=r-C;t[l++]=M,t[l++]=k,t[--d]=k,t[--d]=v,t[f++]=v,t[f++]=A,t[--u]=A,t[--u]=M}p=n,g=i+a,m=e+p,y=e-p,x=r+g;const b=r-g;return t[l++]=m,t[l++]=x,t[--u]=b,t[--u]=m,n&&(t[l++]=y,t[l++]=x,t[--u]=b,t[--u]=y),!0},triangulate(s,t,e,r,n,i){if(s.length===0)return;let o=0,a=0;for(let l=0;l<s.length;l+=2)o+=s[l],a+=s[l+1];o/=s.length/2,a/=s.length/2;let c=r;t[c*e]=o,t[c*e+1]=a;const h=c++;for(let l=0;l<s.length;l+=2)t[c*e]=s[l],t[c*e+1]=s[l+1],l>0&&(n[i++]=c,n[i++]=h,n[i++]=c-1),c++;n[i++]=h+1,n[i++]=h,n[i++]=c-1}},qd={...vs,extension:{...vs.extension,name:"ellipse"}},Kd={...vs,extension:{...vs.extension,name:"roundedRectangle"}},ja=1e-4,Di=1e-4;function Zd(s){const t=s.length;if(t<6)return 1;let e=0;for(let r=0,n=s[t-2],i=s[t-1];r<t;r+=2){const o=s[r],a=s[r+1];e+=(o-n)*(a+i),n=o,i=a}return e<0?-1:1}function Hi(s,t,e,r,n,i,o,a){const c=s-e*n,h=t-r*n,l=s+e*i,d=t+r*i;let f,u;o?(f=r,u=-e):(f=-r,u=e);const p=c+f,g=h+u,m=l+f,y=d+u;return a.push(p,g),a.push(m,y),2}function _e(s,t,e,r,n,i,o,a){const c=e-s,h=r-t;let l=Math.atan2(c,h),d=Math.atan2(n-s,i-t);a&&l<d?l+=Math.PI*2:!a&&l>d&&(d+=Math.PI*2);let f=l;const u=d-l,p=Math.abs(u),g=Math.sqrt(c*c+h*h),m=(15*p*Math.sqrt(g)/Math.PI>>0)+1,y=u/m;if(f+=y,a){o.push(s,t),o.push(e,r);for(let x=1,b=f;x<m;x++,b+=y)o.push(s,t),o.push(s+Math.sin(b)*g,t+Math.cos(b)*g);o.push(s,t),o.push(n,i)}else{o.push(e,r),o.push(s,t);for(let x=1,b=f;x<m;x++,b+=y)o.push(s+Math.sin(b)*g,t+Math.cos(b)*g),o.push(s,t);o.push(n,i),o.push(s,t)}return m*2}function Qd(s,t,e,r,n,i){const o=ja;if(s.length===0)return;const a=t;let c=a.alignment;if(t.alignment!==.5){let D=Zd(s);c=(c-.5)*D+.5}const h=new ft(s[0],s[1]),l=new ft(s[s.length-2],s[s.length-1]),d=r,f=Math.abs(h.x-l.x)<o&&Math.abs(h.y-l.y)<o;if(d){s=s.slice(),f&&(s.pop(),s.pop(),l.set(s[s.length-2],s[s.length-1]));const D=(h.x+l.x)*.5,W=(l.y+h.y)*.5;s.unshift(D,W),s.push(D,W)}const u=n,p=s.length/2;let g=s.length;const m=u.length/2,y=a.width/2,x=y*y,b=a.miterLimit*a.miterLimit;let w=s[0],_=s[1],S=s[2],C=s[3],M=0,v=0,k=-(_-C),A=w-S,P=0,E=0,R=Math.sqrt(k*k+A*A);k/=R,A/=R,k*=y,A*=y;const F=c,T=(1-F)*2,I=F*2;d||(a.cap==="round"?g+=_e(w-k*(T-I)*.5,_-A*(T-I)*.5,w-k*T,_-A*T,w+k*I,_+A*I,u,!0)+2:a.cap==="square"&&(g+=Hi(w,_,k,A,T,I,!0,u))),u.push(w-k*T,_-A*T),u.push(w+k*I,_+A*I);for(let D=1;D<p-1;++D){w=s[(D-1)*2],_=s[(D-1)*2+1],S=s[D*2],C=s[D*2+1],M=s[(D+1)*2],v=s[(D+1)*2+1],k=-(_-C),A=w-S,R=Math.sqrt(k*k+A*A),k/=R,A/=R,k*=y,A*=y,P=-(C-v),E=S-M,R=Math.sqrt(P*P+E*E),P/=R,E/=R,P*=y,E*=y;const W=S-w,U=_-C,Q=S-M,H=v-C,K=W*Q+U*H,V=U*Q-H*W,tt=V<0;if(Math.abs(V)<.001*Math.abs(K)){u.push(S-k*T,C-A*T),u.push(S+k*I,C+A*I),K>=0&&(a.join==="round"?g+=_e(S,C,S-k*T,C-A*T,S-P*T,C-E*T,u,!1)+4:g+=2,u.push(S-P*I,C-E*I),u.push(S+P*T,C+E*T));continue}const J=(-k+w)*(-A+C)-(-k+S)*(-A+_),Mt=(-P+M)*(-E+C)-(-P+S)*(-E+v),dt=(W*Mt-Q*J)/V,vt=(H*J-U*Mt)/V,xt=(dt-S)*(dt-S)+(vt-C)*(vt-C),Pt=S+(dt-S)*T,ye=C+(vt-C)*T,be=S-(dt-S)*I,we=C-(vt-C)*I,$c=Math.min(W*W+U*U,Q*Q+H*H),Zn=tt?T:I,Vc=$c+Zn*Zn*x;xt<=Vc?a.join==="bevel"||xt/x>b?(tt?(u.push(Pt,ye),u.push(S+k*I,C+A*I),u.push(Pt,ye),u.push(S+P*I,C+E*I)):(u.push(S-k*T,C-A*T),u.push(be,we),u.push(S-P*T,C-E*T),u.push(be,we)),g+=2):a.join==="round"?tt?(u.push(Pt,ye),u.push(S+k*I,C+A*I),g+=_e(S,C,S+k*I,C+A*I,S+P*I,C+E*I,u,!0)+4,u.push(Pt,ye),u.push(S+P*I,C+E*I)):(u.push(S-k*T,C-A*T),u.push(be,we),g+=_e(S,C,S-k*T,C-A*T,S-P*T,C-E*T,u,!1)+4,u.push(S-P*T,C-E*T),u.push(be,we)):(u.push(Pt,ye),u.push(be,we)):(u.push(S-k*T,C-A*T),u.push(S+k*I,C+A*I),a.join==="round"?tt?g+=_e(S,C,S+k*I,C+A*I,S+P*I,C+E*I,u,!0)+2:g+=_e(S,C,S-k*T,C-A*T,S-P*T,C-E*T,u,!1)+2:a.join==="miter"&&xt/x<=b&&(tt?(u.push(be,we),u.push(be,we)):(u.push(Pt,ye),u.push(Pt,ye)),g+=2),u.push(S-P*T,C-E*T),u.push(S+P*I,C+E*I),g+=2)}w=s[(p-2)*2],_=s[(p-2)*2+1],S=s[(p-1)*2],C=s[(p-1)*2+1],k=-(_-C),A=w-S,R=Math.sqrt(k*k+A*A),k/=R,A/=R,k*=y,A*=y,u.push(S-k*T,C-A*T),u.push(S+k*I,C+A*I),d||(a.cap==="round"?g+=_e(S-k*(T-I)*.5,C-A*(T-I)*.5,S-k*T,C-A*T,S+k*I,C+A*I,u,!1)+2:a.cap==="square"&&(g+=Hi(S,C,k,A,T,I,!1,u)));const B=Di*Di;for(let D=m;D<g+m-2;++D)w=u[D*2],_=u[D*2+1],S=u[(D+1)*2],C=u[(D+1)*2+1],M=u[(D+2)*2],v=u[(D+2)*2+1],!(Math.abs(w*(C-v)+S*(v-_)+M*(_-C))<B)&&i.push(D,D+1,D+2)}function Jd(s,t,e,r){const n=ja;if(s.length===0)return;const i=s[0],o=s[1],a=s[s.length-2],c=s[s.length-1],h=t||Math.abs(i-a)<n&&Math.abs(o-c)<n,l=e,d=s.length/2,f=l.length/2;for(let u=0;u<d;u++)l.push(s[u*2]),l.push(s[u*2+1]);for(let u=0;u<d-1;u++)r.push(f+u,f+u+1);h&&r.push(f+d-1,f)}function $a(s,t,e,r,n,i,o){const a=Oh(s,t,2);if(!a)return;for(let h=0;h<a.length;h+=3)i[o++]=a[h]+n,i[o++]=a[h+1]+n,i[o++]=a[h+2]+n;let c=n*r;for(let h=0;h<s.length;h+=2)e[c]=s[h],e[c+1]=s[h+1],c+=r}const tu=[],eu={extension:{type:O.ShapeBuilder,name:"polygon"},build(s,t){for(let e=0;e<s.points.length;e++)t[e]=s.points[e];return!0},triangulate(s,t,e,r,n,i){$a(s,tu,t,e,r,n,i)}},su={extension:{type:O.ShapeBuilder,name:"rectangle"},build(s,t){const e=s,r=e.x,n=e.y,i=e.width,o=e.height;return i>0&&o>0?(t[0]=r,t[1]=n,t[2]=r+i,t[3]=n,t[4]=r+i,t[5]=n+o,t[6]=r,t[7]=n+o,!0):!1},triangulate(s,t,e,r,n,i){let o=0;r*=e,t[r+o]=s[0],t[r+o+1]=s[1],o+=e,t[r+o]=s[2],t[r+o+1]=s[3],o+=e,t[r+o]=s[6],t[r+o+1]=s[7],o+=e,t[r+o]=s[4],t[r+o+1]=s[5],o+=e;const a=r/e;n[i++]=a,n[i++]=a+1,n[i++]=a+2,n[i++]=a+1,n[i++]=a+3,n[i++]=a+2}},ru={extension:{type:O.ShapeBuilder,name:"triangle"},build(s,t){return t[0]=s.x,t[1]=s.y,t[2]=s.x2,t[3]=s.y2,t[4]=s.x3,t[5]=s.y3,!0},triangulate(s,t,e,r,n,i){let o=0;r*=e,t[r+o]=s[0],t[r+o+1]=s[1],o+=e,t[r+o]=s[2],t[r+o+1]=s[3],o+=e,t[r+o]=s[4],t[r+o+1]=s[5];const a=r/e;n[i++]=a,n[i++]=a+1,n[i++]=a+2}},nu=new X,iu=new q;function ou(s,t,e,r){const n=t.matrix?s.copyFrom(t.matrix).invert():s.identity();if(t.textureSpace==="local"){const o=e.getBounds(iu);t.width&&o.pad(t.width);const{x:a,y:c}=o,h=1/o.width,l=1/o.height,d=-a*h,f=-c*l,u=n.a,p=n.b,g=n.c,m=n.d;n.a*=h,n.b*=h,n.c*=l,n.d*=l,n.tx=d*u+f*g+n.tx,n.ty=d*p+f*m+n.ty}else n.translate(t.texture.frame.x,t.texture.frame.y),n.scale(1/t.texture.source.width,1/t.texture.source.height);const i=t.texture.source.style;return!(t.fill instanceof le)&&i.addressMode==="clamp-to-edge"&&(i.addressMode="repeat",i.update()),r&&n.append(nu.copyFrom(r).invert()),n}const hr={};ut.handleByMap(O.ShapeBuilder,hr);ut.add(su,eu,ru,vs,qd,Kd);const au=new q,cu=new X;function lu(s,t){const{geometryData:e,batches:r}=t;r.length=0,e.indices.length=0,e.vertices.length=0,e.uvs.length=0;for(let n=0;n<s.instructions.length;n++){const i=s.instructions[n];if(i.action==="texture")hu(i.data,r,e);else if(i.action==="fill"||i.action==="stroke"){const o=i.action==="stroke",a=i.data.path.shapePath,c=i.data.style,h=i.data.hole;o&&h&&Wi(h.shapePath,c,!0,r,e),h&&(a.shapePrimitives[a.shapePrimitives.length-1].holes=h.shapePath.shapePrimitives),Wi(a,c,o,r,e)}}}function hu(s,t,e){const r=[],n=hr.rectangle,i=au;i.x=s.dx,i.y=s.dy,i.width=s.dw,i.height=s.dh;const o=s.transform;if(!n.build(i,r))return;const{vertices:a,uvs:c,indices:h}=e,l=h.length,d=a.length/2;o&&Ha(r,o),n.triangulate(r,a,2,d,h,l);const f=s.image,u=f.uvs;c.push(u.x0,u.y0,u.x1,u.y1,u.x3,u.y3,u.x2,u.y2);const p=ae.get(Wa);p.indexOffset=l,p.indexSize=h.length-l,p.attributeOffset=d,p.attributeSize=a.length/2-d,p.baseColor=s.style,p.alpha=s.alpha,p.texture=f,p.geometryData=e,t.push(p)}function Wi(s,t,e,r,n){const{vertices:i,uvs:o,indices:a}=n;s.shapePrimitives.forEach(({shape:c,transform:h,holes:l})=>{const d=[],f=hr[c.type];if(!f.build(c,d))return;const u=a.length,p=i.length/2;let g="triangle-list";if(h&&Ha(d,h),e){const b=c.closePath??!0,w=t;w.pixelLine?(Jd(d,b,i,a),g="line-list"):Qd(d,w,!1,b,i,a)}else if(l){const b=[],w=d.slice();du(l).forEach(S=>{b.push(w.length/2),w.push(...S)}),$a(w,b,i,2,p,a,u)}else f.triangulate(d,i,2,p,a,u);const m=o.length/2,y=t.texture;if(y!==$.WHITE){const b=ou(cu,t,c,h);Vd(i,2,p,o,m,2,i.length/2-p,b)}else Yd(o,m,2,i.length/2-p);const x=ae.get(Wa);x.indexOffset=u,x.indexSize=a.length-u,x.attributeOffset=p,x.attributeSize=i.length/2-p,x.baseColor=t.color,x.alpha=t.alpha,x.texture=y,x.geometryData=n,x.topology=g,r.push(x)})}function du(s){const t=[];for(let e=0;e<s.length;e++){const r=s[e].shape,n=[];hr[r.type].build(r,n)&&t.push(n)}return t}class uu{constructor(){this.batches=[],this.geometryData={vertices:[],uvs:[],indices:[]}}}class fu{constructor(){this.instructions=new Qo}init(t){this.batcher=new $d({maxTextures:t}),this.instructions.reset()}get geometry(){return Y(hl,"GraphicsContextRenderData#geometry is deprecated, please use batcher.geometry instead."),this.batcher.geometry}}const zn=class mn{constructor(t){this._gpuContextHash={},this._graphicsDataContextHash=Object.create(null),this._renderer=t,t.renderableGC.addManagedHash(this,"_gpuContextHash"),t.renderableGC.addManagedHash(this,"_graphicsDataContextHash")}init(t){mn.defaultOptions.bezierSmoothness=(t==null?void 0:t.bezierSmoothness)??mn.defaultOptions.bezierSmoothness}getContextRenderData(t){return this._graphicsDataContextHash[t.uid]||this._initContextRenderData(t)}updateGpuContext(t){let e=this._gpuContextHash[t.uid]||this._initContext(t);if(t.dirty){e?this._cleanGraphicsContextData(t):e=this._initContext(t),lu(t,e);const r=t.batchMode;t.customShader||r==="no-batch"?e.isBatchable=!1:r==="auto"?e.isBatchable=e.geometryData.vertices.length<400:e.isBatchable=!0,t.dirty=!1}return e}getGpuContext(t){return this._gpuContextHash[t.uid]||this._initContext(t)}_initContextRenderData(t){const e=ae.get(fu,{maxTextures:this._renderer.limits.maxBatchableTextures}),{batches:r,geometryData:n}=this._gpuContextHash[t.uid],i=n.vertices.length,o=n.indices.length;for(let l=0;l<r.length;l++)r[l].applyTransform=!1;const a=e.batcher;a.ensureAttributeBuffer(i),a.ensureIndexBuffer(o),a.begin();for(let l=0;l<r.length;l++){const d=r[l];a.add(d)}a.finish(e.instructions);const c=a.geometry;c.indexBuffer.setDataWithSize(a.indexBuffer,a.indexSize,!0),c.buffers[0].setDataWithSize(a.attributeBuffer.float32View,a.attributeSize,!0);const h=a.batches;for(let l=0;l<h.length;l++){const d=h[l];d.bindGroup=ed(d.textures.textures,d.textures.count,this._renderer.limits.maxBatchableTextures)}return this._graphicsDataContextHash[t.uid]=e,e}_initContext(t){const e=new uu;return e.context=t,this._gpuContextHash[t.uid]=e,t.on("destroy",this.onGraphicsContextDestroy,this),this._gpuContextHash[t.uid]}onGraphicsContextDestroy(t){this._cleanGraphicsContextData(t),t.off("destroy",this.onGraphicsContextDestroy,this),this._gpuContextHash[t.uid]=null}_cleanGraphicsContextData(t){const e=this._gpuContextHash[t.uid];e.isBatchable||this._graphicsDataContextHash[t.uid]&&(ae.return(this.getContextRenderData(t)),this._graphicsDataContextHash[t.uid]=null),e.batches&&e.batches.forEach(r=>{ae.return(r)})}destroy(){for(const t in this._gpuContextHash)this._gpuContextHash[t]&&this.onGraphicsContextDestroy(this._gpuContextHash[t].context)}};zn.extension={type:[O.WebGLSystem,O.WebGPUSystem,O.CanvasSystem],name:"graphicsContext"};zn.defaultOptions={bezierSmoothness:.5};let Va=zn;const pu=8,Fs=11920929e-14,mu=1;function Ya(s,t,e,r,n,i,o,a,c,h){const d=Math.min(.99,Math.max(0,h??Va.defaultOptions.bezierSmoothness));let f=(mu-d)/1;return f*=f,gu(t,e,r,n,i,o,a,c,s,f),s}function gu(s,t,e,r,n,i,o,a,c,h){gn(s,t,e,r,n,i,o,a,c,h,0),c.push(o,a)}function gn(s,t,e,r,n,i,o,a,c,h,l){if(l>pu)return;const d=(s+e)/2,f=(t+r)/2,u=(e+n)/2,p=(r+i)/2,g=(n+o)/2,m=(i+a)/2,y=(d+u)/2,x=(f+p)/2,b=(u+g)/2,w=(p+m)/2,_=(y+b)/2,S=(x+w)/2;if(l>0){let C=o-s,M=a-t;const v=Math.abs((e-o)*M-(r-a)*C),k=Math.abs((n-o)*M-(i-a)*C);if(v>Fs&&k>Fs){if((v+k)*(v+k)<=h*(C*C+M*M)){c.push(_,S);return}}else if(v>Fs){if(v*v<=h*(C*C+M*M)){c.push(_,S);return}}else if(k>Fs){if(k*k<=h*(C*C+M*M)){c.push(_,S);return}}else if(C=_-(s+o)/2,M=S-(t+a)/2,C*C+M*M<=h){c.push(_,S);return}}gn(s,t,d,f,y,x,_,S,c,h,l+1),gn(_,S,b,w,g,m,o,a,c,h,l+1)}const xu=8,yu=11920929e-14,bu=1;function wu(s,t,e,r,n,i,o,a){const h=Math.min(.99,Math.max(0,a??Va.defaultOptions.bezierSmoothness));let l=(bu-h)/1;return l*=l,_u(t,e,r,n,i,o,s,l),s}function _u(s,t,e,r,n,i,o,a){xn(o,s,t,e,r,n,i,a,0),o.push(n,i)}function xn(s,t,e,r,n,i,o,a,c){if(c>xu)return;const h=(t+r)/2,l=(e+n)/2,d=(r+i)/2,f=(n+o)/2,u=(h+d)/2,p=(l+f)/2;let g=i-t,m=o-e;const y=Math.abs((r-i)*m-(n-o)*g);if(y>yu){if(y*y<=a*(g*g+m*m)){s.push(u,p);return}}else if(g=u-(t+i)/2,m=p-(e+o)/2,g*g+m*m<=a){s.push(u,p);return}xn(s,t,e,h,l,u,p,a,c+1),xn(s,u,p,d,f,i,o,a,c+1)}function Xa(s,t,e,r,n,i,o,a){let c=Math.abs(n-i);(!o&&n>i||o&&i>n)&&(c=2*Math.PI-c),a||(a=Math.max(6,Math.floor(6*Math.pow(r,1/3)*(c/Math.PI)))),a=Math.max(a,3);let h=c/a,l=n;h*=o?-1:1;for(let d=0;d<a+1;d++){const f=Math.cos(l),u=Math.sin(l),p=t+f*r,g=e+u*r;s.push(p,g),l+=h}}function vu(s,t,e,r,n,i){const o=s[s.length-2],c=s[s.length-1]-e,h=o-t,l=n-e,d=r-t,f=Math.abs(c*d-h*l);if(f<1e-8||i===0){(s[s.length-2]!==t||s[s.length-1]!==e)&&s.push(t,e);return}const u=c*c+h*h,p=l*l+d*d,g=c*l+h*d,m=i*Math.sqrt(u)/f,y=i*Math.sqrt(p)/f,x=m*g/u,b=y*g/p,w=m*d+y*h,_=m*l+y*c,S=h*(y+x),C=c*(y+x),M=d*(m+b),v=l*(m+b),k=Math.atan2(C-_,S-w),A=Math.atan2(v-_,M-w);Xa(s,w+t,_+e,i,k,A,h*l>d*c)}const fs=Math.PI*2,Nr={centerX:0,centerY:0,ang1:0,ang2:0},Or=({x:s,y:t},e,r,n,i,o,a,c)=>{s*=e,t*=r;const h=n*s-i*t,l=i*s+n*t;return c.x=h+o,c.y=l+a,c};function Au(s,t){const e=t===-1.5707963267948966?-.551915024494:1.3333333333333333*Math.tan(t/4),r=t===1.5707963267948966?.551915024494:e,n=Math.cos(s),i=Math.sin(s),o=Math.cos(s+t),a=Math.sin(s+t);return[{x:n-i*r,y:i+n*r},{x:o+a*r,y:a-o*r},{x:o,y:a}]}const ji=(s,t,e,r)=>{const n=s*r-t*e<0?-1:1;let i=s*e+t*r;return i>1&&(i=1),i<-1&&(i=-1),n*Math.acos(i)},Su=(s,t,e,r,n,i,o,a,c,h,l,d,f)=>{const u=Math.pow(n,2),p=Math.pow(i,2),g=Math.pow(l,2),m=Math.pow(d,2);let y=u*p-u*m-p*g;y<0&&(y=0),y/=u*m+p*g,y=Math.sqrt(y)*(o===a?-1:1);const x=y*n/i*d,b=y*-i/n*l,w=h*x-c*b+(s+e)/2,_=c*x+h*b+(t+r)/2,S=(l-x)/n,C=(d-b)/i,M=(-l-x)/n,v=(-d-b)/i,k=ji(1,0,S,C);let A=ji(S,C,M,v);a===0&&A>0&&(A-=fs),a===1&&A<0&&(A+=fs),f.centerX=w,f.centerY=_,f.ang1=k,f.ang2=A};function Cu(s,t,e,r,n,i,o,a=0,c=0,h=0){if(i===0||o===0)return;const l=Math.sin(a*fs/360),d=Math.cos(a*fs/360),f=d*(t-r)/2+l*(e-n)/2,u=-l*(t-r)/2+d*(e-n)/2;if(f===0&&u===0)return;i=Math.abs(i),o=Math.abs(o);const p=Math.pow(f,2)/Math.pow(i,2)+Math.pow(u,2)/Math.pow(o,2);p>1&&(i*=Math.sqrt(p),o*=Math.sqrt(p)),Su(t,e,r,n,i,o,c,h,l,d,f,u,Nr);let{ang1:g,ang2:m}=Nr;const{centerX:y,centerY:x}=Nr;let b=Math.abs(m)/(fs/4);Math.abs(1-b)<1e-7&&(b=1);const w=Math.max(Math.ceil(b),1);m/=w;let _=s[s.length-2],S=s[s.length-1];const C={x:0,y:0};for(let M=0;M<w;M++){const v=Au(g,m),{x:k,y:A}=Or(v[0],i,o,d,l,y,x,C),{x:P,y:E}=Or(v[1],i,o,d,l,y,x,C),{x:R,y:F}=Or(v[2],i,o,d,l,y,x,C);Ya(s,_,S,k,A,P,E,R,F),_=R,S=F,g+=m}}function ku(s,t,e){const r=(o,a)=>{const c=a.x-o.x,h=a.y-o.y,l=Math.sqrt(c*c+h*h),d=c/l,f=h/l;return{len:l,nx:d,ny:f}},n=(o,a)=>{o===0?s.moveTo(a.x,a.y):s.lineTo(a.x,a.y)};let i=t[t.length-1];for(let o=0;o<t.length;o++){const a=t[o%t.length],c=a.radius??e;if(c<=0){n(o,a),i=a;continue}const h=t[(o+1)%t.length],l=r(a,i),d=r(a,h);if(l.len<1e-4||d.len<1e-4){n(o,a),i=a;continue}let f=Math.asin(l.nx*d.ny-l.ny*d.nx),u=1,p=!1;l.nx*d.nx-l.ny*-d.ny<0?f<0?f=Math.PI+f:(f=Math.PI-f,u=-1,p=!0):f>0&&(u=-1,p=!0);const g=f/2;let m,y=Math.abs(Math.cos(g)*c/Math.sin(g));y>Math.min(l.len/2,d.len/2)?(y=Math.min(l.len/2,d.len/2),m=Math.abs(y*Math.sin(g)/Math.cos(g))):m=c;const x=a.x+d.nx*y+-d.ny*m*u,b=a.y+d.ny*y+d.nx*m*u,w=Math.atan2(l.ny,l.nx)+Math.PI/2*u,_=Math.atan2(d.ny,d.nx)-Math.PI/2*u;o===0&&s.moveTo(x+Math.cos(w)*m,b+Math.sin(w)*m),s.arc(x,b,m,w,_,p),i=a}}function Mu(s,t,e,r){const n=(a,c)=>Math.sqrt((a.x-c.x)**2+(a.y-c.y)**2),i=(a,c,h)=>({x:a.x+(c.x-a.x)*h,y:a.y+(c.y-a.y)*h}),o=t.length;for(let a=0;a<o;a++){const c=t[(a+1)%o],h=c.radius??e;if(h<=0){a===0?s.moveTo(c.x,c.y):s.lineTo(c.x,c.y);continue}const l=t[a],d=t[(a+2)%o],f=n(l,c);let u;if(f<1e-4)u=c;else{const m=Math.min(f/2,h);u=i(c,l,m/f)}const p=n(d,c);let g;if(p<1e-4)g=c;else{const m=Math.min(p/2,h);g=i(c,d,m/p)}a===0?s.moveTo(u.x,u.y):s.lineTo(u.x,u.y),s.quadraticCurveTo(c.x,c.y,g.x,g.y,r)}}const Pu=new q;class Tu{constructor(t){this.shapePrimitives=[],this._currentPoly=null,this._bounds=new Dt,this._graphicsPath2D=t,this.signed=t.checkForHoles}moveTo(t,e){return this.startPoly(t,e),this}lineTo(t,e){this._ensurePoly();const r=this._currentPoly.points,n=r[r.length-2],i=r[r.length-1];return(n!==t||i!==e)&&r.push(t,e),this}arc(t,e,r,n,i,o){this._ensurePoly(!1);const a=this._currentPoly.points;return Xa(a,t,e,r,n,i,o),this}arcTo(t,e,r,n,i){this._ensurePoly();const o=this._currentPoly.points;return vu(o,t,e,r,n,i),this}arcToSvg(t,e,r,n,i,o,a){const c=this._currentPoly.points;return Cu(c,this._currentPoly.lastX,this._currentPoly.lastY,o,a,t,e,r,n,i),this}bezierCurveTo(t,e,r,n,i,o,a){this._ensurePoly();const c=this._currentPoly;return Ya(this._currentPoly.points,c.lastX,c.lastY,t,e,r,n,i,o,a),this}quadraticCurveTo(t,e,r,n,i){this._ensurePoly();const o=this._currentPoly;return wu(this._currentPoly.points,o.lastX,o.lastY,t,e,r,n,i),this}closePath(){return this.endPoly(!0),this}addPath(t,e){this.endPoly(),e&&!e.isIdentity()&&(t=t.clone(!0),t.transform(e));const r=this.shapePrimitives,n=r.length;for(let i=0;i<t.instructions.length;i++){const o=t.instructions[i];this[o.action](...o.data)}if(t.checkForHoles&&r.length-n>1){let i=null;for(let o=n;o<r.length;o++){const a=r[o];if(a.shape.type==="polygon"){const c=a.shape,h=i==null?void 0:i.shape;h&&h.containsPolygon(c)?(i.holes||(i.holes=[]),i.holes.push(a),r.copyWithin(o,o+1),r.length--,o--):i=a}}}return this}finish(t=!1){this.endPoly(t)}rect(t,e,r,n,i){return this.drawShape(new q(t,e,r,n),i),this}circle(t,e,r,n){return this.drawShape(new Rn(t,e,r),n),this}poly(t,e,r){const n=new us(t);return n.closePath=e,this.drawShape(n,r),this}regularPoly(t,e,r,n,i=0,o){n=Math.max(n|0,3);const a=-1*Math.PI/2+i,c=Math.PI*2/n,h=[];for(let l=0;l<n;l++){const d=a-l*c;h.push(t+r*Math.cos(d),e+r*Math.sin(d))}return this.poly(h,!0,o),this}roundPoly(t,e,r,n,i,o=0,a){if(n=Math.max(n|0,3),i<=0)return this.regularPoly(t,e,r,n,o);const c=r*Math.sin(Math.PI/n)-.001;i=Math.min(i,c);const h=-1*Math.PI/2+o,l=Math.PI*2/n,d=(n-2)*Math.PI/n/2;for(let f=0;f<n;f++){const u=f*l+h,p=t+r*Math.cos(u),g=e+r*Math.sin(u),m=u+Math.PI+d,y=u-Math.PI-d,x=p+i*Math.cos(m),b=g+i*Math.sin(m),w=p+i*Math.cos(y),_=g+i*Math.sin(y);f===0?this.moveTo(x,b):this.lineTo(x,b),this.quadraticCurveTo(p,g,w,_,a)}return this.closePath()}roundShape(t,e,r=!1,n){return t.length<3?this:(r?Mu(this,t,e,n):ku(this,t,e),this.closePath())}filletRect(t,e,r,n,i){if(i===0)return this.rect(t,e,r,n);const o=Math.min(r,n)/2,a=Math.min(o,Math.max(-o,i)),c=t+r,h=e+n,l=a<0?-a:0,d=Math.abs(a);return this.moveTo(t,e+d).arcTo(t+l,e+l,t+d,e,d).lineTo(c-d,e).arcTo(c-l,e+l,c,e+d,d).lineTo(c,h-d).arcTo(c-l,h-l,t+r-d,h,d).lineTo(t+d,h).arcTo(t+l,h-l,t,h-d,d).closePath()}chamferRect(t,e,r,n,i,o){if(i<=0)return this.rect(t,e,r,n);const a=Math.min(i,Math.min(r,n)/2),c=t+r,h=e+n,l=[t+a,e,c-a,e,c,e+a,c,h-a,c-a,h,t+a,h,t,h-a,t,e+a];for(let d=l.length-1;d>=2;d-=2)l[d]===l[d-2]&&l[d-1]===l[d-3]&&l.splice(d-1,2);return this.poly(l,!0,o)}ellipse(t,e,r,n,i){return this.drawShape(new Fn(t,e,r,n),i),this}roundRect(t,e,r,n,i,o){return this.drawShape(new Ln(t,e,r,n,i),o),this}drawShape(t,e){return this.endPoly(),this.shapePrimitives.push({shape:t,transform:e}),this}startPoly(t,e){let r=this._currentPoly;return r&&this.endPoly(),r=new us,r.points.push(t,e),this._currentPoly=r,this}endPoly(t=!1){const e=this._currentPoly;return e&&e.points.length>2&&(e.closePath=t,this.shapePrimitives.push({shape:e})),this._currentPoly=null,this}_ensurePoly(t=!0){if(!this._currentPoly&&(this._currentPoly=new us,t)){const e=this.shapePrimitives[this.shapePrimitives.length-1];if(e){let r=e.shape.x,n=e.shape.y;if(e.transform&&!e.transform.isIdentity()){const i=e.transform,o=r;r=i.a*r+i.c*n+i.tx,n=i.b*o+i.d*n+i.ty}this._currentPoly.points.push(r,n)}else this._currentPoly.points.push(0,0)}}buildPath(){const t=this._graphicsPath2D;this.shapePrimitives.length=0,this._currentPoly=null;for(let e=0;e<t.instructions.length;e++){const r=t.instructions[e];this[r.action](...r.data)}this.finish()}get bounds(){const t=this._bounds;t.clear();const e=this.shapePrimitives;for(let r=0;r<e.length;r++){const n=e[r],i=n.shape.getBounds(Pu);n.transform?t.addRect(i,n.transform):t.addRect(i)}return t}}class Ye{constructor(t,e=!1){this.instructions=[],this.uid=at("graphicsPath"),this._dirty=!0,this.checkForHoles=e,typeof t=="string"?Zh(t,this):this.instructions=(t==null?void 0:t.slice())??[]}get shapePath(){return this._shapePath||(this._shapePath=new Tu(this)),this._dirty&&(this._dirty=!1,this._shapePath.buildPath()),this._shapePath}addPath(t,e){return t=t.clone(),this.instructions.push({action:"addPath",data:[t,e]}),this._dirty=!0,this}arc(...t){return this.instructions.push({action:"arc",data:t}),this._dirty=!0,this}arcTo(...t){return this.instructions.push({action:"arcTo",data:t}),this._dirty=!0,this}arcToSvg(...t){return this.instructions.push({action:"arcToSvg",data:t}),this._dirty=!0,this}bezierCurveTo(...t){return this.instructions.push({action:"bezierCurveTo",data:t}),this._dirty=!0,this}bezierCurveToShort(t,e,r,n,i){const o=this.instructions[this.instructions.length-1],a=this.getLastPoint(ft.shared);let c=0,h=0;if(!o||o.action!=="bezierCurveTo")c=a.x,h=a.y;else{c=o.data[2],h=o.data[3];const l=a.x,d=a.y;c=l+(l-c),h=d+(d-h)}return this.instructions.push({action:"bezierCurveTo",data:[c,h,t,e,r,n,i]}),this._dirty=!0,this}closePath(){return this.instructions.push({action:"closePath",data:[]}),this._dirty=!0,this}ellipse(...t){return this.instructions.push({action:"ellipse",data:t}),this._dirty=!0,this}lineTo(...t){return this.instructions.push({action:"lineTo",data:t}),this._dirty=!0,this}moveTo(...t){return this.instructions.push({action:"moveTo",data:t}),this}quadraticCurveTo(...t){return this.instructions.push({action:"quadraticCurveTo",data:t}),this._dirty=!0,this}quadraticCurveToShort(t,e,r){const n=this.instructions[this.instructions.length-1],i=this.getLastPoint(ft.shared);let o=0,a=0;if(!n||n.action!=="quadraticCurveTo")o=i.x,a=i.y;else{o=n.data[0],a=n.data[1];const c=i.x,h=i.y;o=c+(c-o),a=h+(h-a)}return this.instructions.push({action:"quadraticCurveTo",data:[o,a,t,e,r]}),this._dirty=!0,this}rect(t,e,r,n,i){return this.instructions.push({action:"rect",data:[t,e,r,n,i]}),this._dirty=!0,this}circle(t,e,r,n){return this.instructions.push({action:"circle",data:[t,e,r,n]}),this._dirty=!0,this}roundRect(...t){return this.instructions.push({action:"roundRect",data:t}),this._dirty=!0,this}poly(...t){return this.instructions.push({action:"poly",data:t}),this._dirty=!0,this}regularPoly(...t){return this.instructions.push({action:"regularPoly",data:t}),this._dirty=!0,this}roundPoly(...t){return this.instructions.push({action:"roundPoly",data:t}),this._dirty=!0,this}roundShape(...t){return this.instructions.push({action:"roundShape",data:t}),this._dirty=!0,this}filletRect(...t){return this.instructions.push({action:"filletRect",data:t}),this._dirty=!0,this}chamferRect(...t){return this.instructions.push({action:"chamferRect",data:t}),this._dirty=!0,this}star(t,e,r,n,i,o,a){i||(i=n/2);const c=-1*Math.PI/2+o,h=r*2,l=Math.PI*2/h,d=[];for(let f=0;f<h;f++){const u=f%2?i:n,p=f*l+c;d.push(t+u*Math.cos(p),e+u*Math.sin(p))}return this.poly(d,!0,a),this}clone(t=!1){const e=new Ye;if(e.checkForHoles=this.checkForHoles,!t)e.instructions=this.instructions.slice();else for(let r=0;r<this.instructions.length;r++){const n=this.instructions[r];e.instructions.push({action:n.action,data:n.data.slice()})}return e}clear(){return this.instructions.length=0,this._dirty=!0,this}transform(t){if(t.isIdentity())return this;const e=t.a,r=t.b,n=t.c,i=t.d,o=t.tx,a=t.ty;let c=0,h=0,l=0,d=0,f=0,u=0,p=0,g=0;for(let m=0;m<this.instructions.length;m++){const y=this.instructions[m],x=y.data;switch(y.action){case"moveTo":case"lineTo":c=x[0],h=x[1],x[0]=e*c+n*h+o,x[1]=r*c+i*h+a;break;case"bezierCurveTo":l=x[0],d=x[1],f=x[2],u=x[3],c=x[4],h=x[5],x[0]=e*l+n*d+o,x[1]=r*l+i*d+a,x[2]=e*f+n*u+o,x[3]=r*f+i*u+a,x[4]=e*c+n*h+o,x[5]=r*c+i*h+a;break;case"quadraticCurveTo":l=x[0],d=x[1],c=x[2],h=x[3],x[0]=e*l+n*d+o,x[1]=r*l+i*d+a,x[2]=e*c+n*h+o,x[3]=r*c+i*h+a;break;case"arcToSvg":c=x[5],h=x[6],p=x[0],g=x[1],x[0]=e*p+n*g,x[1]=r*p+i*g,x[5]=e*c+n*h+o,x[6]=r*c+i*h+a;break;case"circle":x[4]=ns(x[3],t);break;case"rect":x[4]=ns(x[4],t);break;case"ellipse":x[8]=ns(x[8],t);break;case"roundRect":x[5]=ns(x[5],t);break;case"addPath":x[0].transform(t);break;case"poly":x[2]=ns(x[2],t);break;default:it("unknown transform action",y.action);break}}return this._dirty=!0,this}get bounds(){return this.shapePath.bounds}getLastPoint(t){let e=this.instructions.length-1,r=this.instructions[e];if(!r)return t.x=0,t.y=0,t;for(;r.action==="closePath";){if(e--,e<0)return t.x=0,t.y=0,t;r=this.instructions[e]}switch(r.action){case"moveTo":case"lineTo":t.x=r.data[0],t.y=r.data[1];break;case"quadraticCurveTo":t.x=r.data[2],t.y=r.data[3];break;case"bezierCurveTo":t.x=r.data[4],t.y=r.data[5];break;case"arc":case"arcToSvg":t.x=r.data[5],t.y=r.data[6];break;case"addPath":r.data[0].getLastPoint(t);break}return t}}function ns(s,t){return s?s.prepend(t):t.clone()}function rt(s,t,e){const r=s.getAttribute(t);return r?Number(r):e}function Eu(s,t){const e=s.querySelectorAll("defs");for(let r=0;r<e.length;r++){const n=e[r];for(let i=0;i<n.children.length;i++){const o=n.children[i];switch(o.nodeName.toLowerCase()){case"lineargradient":t.defs[o.id]=Iu(o);break;case"radialgradient":t.defs[o.id]=Bu();break}}}}function Iu(s){const t=rt(s,"x1",0),e=rt(s,"y1",0),r=rt(s,"x2",1),n=rt(s,"y2",0),i=s.getAttribute("gradientUnits")||"objectBoundingBox",o=new le(t,e,r,n,i==="objectBoundingBox"?"local":"global");for(let a=0;a<s.children.length;a++){const c=s.children[a],h=rt(c,"offset",0),l=ct.shared.setValue(c.getAttribute("stop-color")).toNumber();o.addColorStop(h,l)}return o}function Bu(s){return it("[SVG Parser] Radial gradients are not yet supported"),new le(0,0,1,0)}function $i(s){const t=s.match(/url\s*\(\s*['"]?\s*#([^'"\s)]+)\s*['"]?\s*\)/i);return t?t[1]:""}const Vi={fill:{type:"paint",default:0},"fill-opacity":{type:"number",default:1},stroke:{type:"paint",default:0},"stroke-width":{type:"number",default:1},"stroke-opacity":{type:"number",default:1},"stroke-linecap":{type:"string",default:"butt"},"stroke-linejoin":{type:"string",default:"miter"},"stroke-miterlimit":{type:"number",default:10},"stroke-dasharray":{type:"string",default:"none"},"stroke-dashoffset":{type:"number",default:0},opacity:{type:"number",default:1}};function qa(s,t){const e=s.getAttribute("style"),r={},n={},i={strokeStyle:r,fillStyle:n,useFill:!1,useStroke:!1};for(const o in Vi){const a=s.getAttribute(o);a&&Yi(t,i,o,a.trim())}if(e){const o=e.split(";");for(let a=0;a<o.length;a++){const c=o[a].trim(),[h,l]=c.split(":");Vi[h]&&Yi(t,i,h,l.trim())}}return{strokeStyle:i.useStroke?r:null,fillStyle:i.useFill?n:null,useFill:i.useFill,useStroke:i.useStroke}}function Yi(s,t,e,r){switch(e){case"stroke":if(r!=="none"){if(r.startsWith("url(")){const n=$i(r);t.strokeStyle.fill=s.defs[n]}else t.strokeStyle.color=ct.shared.setValue(r).toNumber();t.useStroke=!0}break;case"stroke-width":t.strokeStyle.width=Number(r);break;case"fill":if(r!=="none"){if(r.startsWith("url(")){const n=$i(r);t.fillStyle.fill=s.defs[n]}else t.fillStyle.color=ct.shared.setValue(r).toNumber();t.useFill=!0}break;case"fill-opacity":t.fillStyle.alpha=Number(r);break;case"stroke-opacity":t.strokeStyle.alpha=Number(r);break;case"opacity":t.fillStyle.alpha=Number(r),t.strokeStyle.alpha=Number(r);break}}function Ru(s,t){if(typeof s=="string"){const o=document.createElement("div");o.innerHTML=s.trim(),s=o.querySelector("svg")}const e={context:t,defs:{},path:new Ye};Eu(s,e);const r=s.children,{fillStyle:n,strokeStyle:i}=qa(s,e);for(let o=0;o<r.length;o++){const a=r[o];a.nodeName.toLowerCase()!=="defs"&&Ka(a,e,n,i)}return t}function Ka(s,t,e,r){const n=s.children,{fillStyle:i,strokeStyle:o}=qa(s,t);i&&e?e={...e,...i}:i&&(e=i),o&&r?r={...r,...o}:o&&(r=o);const a=!e&&!r;a&&(e={color:0});let c,h,l,d,f,u,p,g,m,y,x,b,w,_,S,C,M;switch(s.nodeName.toLowerCase()){case"path":_=s.getAttribute("d"),s.getAttribute("fill-rule")==="evenodd"&&it("SVG Evenodd fill rule not supported, your svg may render incorrectly"),S=new Ye(_,!0),t.context.path(S),e&&t.context.fill(e),r&&t.context.stroke(r);break;case"circle":p=rt(s,"cx",0),g=rt(s,"cy",0),m=rt(s,"r",0),t.context.ellipse(p,g,m,m),e&&t.context.fill(e),r&&t.context.stroke(r);break;case"rect":c=rt(s,"x",0),h=rt(s,"y",0),C=rt(s,"width",0),M=rt(s,"height",0),y=rt(s,"rx",0),x=rt(s,"ry",0),y||x?t.context.roundRect(c,h,C,M,y||x):t.context.rect(c,h,C,M),e&&t.context.fill(e),r&&t.context.stroke(r);break;case"ellipse":p=rt(s,"cx",0),g=rt(s,"cy",0),y=rt(s,"rx",0),x=rt(s,"ry",0),t.context.beginPath(),t.context.ellipse(p,g,y,x),e&&t.context.fill(e),r&&t.context.stroke(r);break;case"line":l=rt(s,"x1",0),d=rt(s,"y1",0),f=rt(s,"x2",0),u=rt(s,"y2",0),t.context.beginPath(),t.context.moveTo(l,d),t.context.lineTo(f,u),r&&t.context.stroke(r);break;case"polygon":w=s.getAttribute("points"),b=w.match(/\d+/g).map(v=>parseInt(v,10)),t.context.poly(b,!0),e&&t.context.fill(e),r&&t.context.stroke(r);break;case"polyline":w=s.getAttribute("points"),b=w.match(/\d+/g).map(v=>parseInt(v,10)),t.context.poly(b,!1),r&&t.context.stroke(r);break;case"g":case"svg":break;default:{it(`[SVG parser] <${s.nodeName}> elements unsupported`);break}}a&&(e=null);for(let v=0;v<n.length;v++)Ka(n[v],t,e,r)}function Fu(s){return ct.isColorLike(s)}function Xi(s){return s instanceof lr}function qi(s){return s instanceof le}function Lu(s){return s instanceof $}function zu(s,t,e){const r=ct.shared.setValue(t??0);return s.color=r.toNumber(),s.alpha=r.alpha===1?e.alpha:r.alpha,s.texture=$.WHITE,{...e,...s}}function Gu(s,t,e){return s.texture=t,{...e,...s}}function Ki(s,t,e){return s.fill=t,s.color=16777215,s.texture=t.texture,s.matrix=t.transform,{...e,...s}}function Zi(s,t,e){return t.buildGradient(),s.fill=t,s.color=16777215,s.texture=t.texture,s.matrix=t.transform,s.textureSpace=t.textureSpace,{...e,...s}}function Nu(s,t){const e={...t,...s},r=ct.shared.setValue(e.color);return e.alpha*=r.alpha,e.color=r.toNumber(),e}function Te(s,t){if(s==null)return null;const e={},r=s;return Fu(s)?zu(e,s,t):Lu(s)?Gu(e,s,t):Xi(s)?Ki(e,s,t):qi(s)?Zi(e,s,t):r.fill&&Xi(r.fill)?Ki(r,r.fill,t):r.fill&&qi(r.fill)?Zi(r,r.fill,t):Nu(r,t)}function Zs(s,t){const{width:e,alignment:r,miterLimit:n,cap:i,join:o,pixelLine:a,...c}=t,h=Te(s,c);return h?{width:e,alignment:r,miterLimit:n,cap:i,join:o,pixelLine:a,...h}:null}const Ou=new ft,Qi=new X,Gn=class Yt extends Wt{constructor(){super(...arguments),this.uid=at("graphicsContext"),this.dirty=!0,this.batchMode="auto",this.instructions=[],this._activePath=new Ye,this._transform=new X,this._fillStyle={...Yt.defaultFillStyle},this._strokeStyle={...Yt.defaultStrokeStyle},this._stateStack=[],this._tick=0,this._bounds=new Dt,this._boundsDirty=!0}clone(){const t=new Yt;return t.batchMode=this.batchMode,t.instructions=this.instructions.slice(),t._activePath=this._activePath.clone(),t._transform=this._transform.clone(),t._fillStyle={...this._fillStyle},t._strokeStyle={...this._strokeStyle},t._stateStack=this._stateStack.slice(),t._bounds=this._bounds.clone(),t._boundsDirty=!0,t}get fillStyle(){return this._fillStyle}set fillStyle(t){this._fillStyle=Te(t,Yt.defaultFillStyle)}get strokeStyle(){return this._strokeStyle}set strokeStyle(t){this._strokeStyle=Zs(t,Yt.defaultStrokeStyle)}setFillStyle(t){return this._fillStyle=Te(t,Yt.defaultFillStyle),this}setStrokeStyle(t){return this._strokeStyle=Te(t,Yt.defaultStrokeStyle),this}texture(t,e,r,n,i,o){return this.instructions.push({action:"texture",data:{image:t,dx:r||0,dy:n||0,dw:i||t.frame.width,dh:o||t.frame.height,transform:this._transform.clone(),alpha:this._fillStyle.alpha,style:e?ct.shared.setValue(e).toNumber():16777215}}),this.onUpdate(),this}beginPath(){return this._activePath=new Ye,this}fill(t,e){let r;const n=this.instructions[this.instructions.length-1];return this._tick===0&&n&&n.action==="stroke"?r=n.data.path:r=this._activePath.clone(),r?(t!=null&&(e!==void 0&&typeof t=="number"&&(Y(Z,"GraphicsContext.fill(color, alpha) is deprecated, use GraphicsContext.fill({ color, alpha }) instead"),t={color:t,alpha:e}),this._fillStyle=Te(t,Yt.defaultFillStyle)),this.instructions.push({action:"fill",data:{style:this.fillStyle,path:r}}),this.onUpdate(),this._initNextPathLocation(),this._tick=0,this):this}_initNextPathLocation(){const{x:t,y:e}=this._activePath.getLastPoint(ft.shared);this._activePath.clear(),this._activePath.moveTo(t,e)}stroke(t){let e;const r=this.instructions[this.instructions.length-1];return this._tick===0&&r&&r.action==="fill"?e=r.data.path:e=this._activePath.clone(),e?(t!=null&&(this._strokeStyle=Zs(t,Yt.defaultStrokeStyle)),this.instructions.push({action:"stroke",data:{style:this.strokeStyle,path:e}}),this.onUpdate(),this._initNextPathLocation(),this._tick=0,this):this}cut(){for(let t=0;t<2;t++){const e=this.instructions[this.instructions.length-1-t],r=this._activePath.clone();if(e&&(e.action==="stroke"||e.action==="fill"))if(e.data.hole)e.data.hole.addPath(r);else{e.data.hole=r;break}}return this._initNextPathLocation(),this}arc(t,e,r,n,i,o){this._tick++;const a=this._transform;return this._activePath.arc(a.a*t+a.c*e+a.tx,a.b*t+a.d*e+a.ty,r,n,i,o),this}arcTo(t,e,r,n,i){this._tick++;const o=this._transform;return this._activePath.arcTo(o.a*t+o.c*e+o.tx,o.b*t+o.d*e+o.ty,o.a*r+o.c*n+o.tx,o.b*r+o.d*n+o.ty,i),this}arcToSvg(t,e,r,n,i,o,a){this._tick++;const c=this._transform;return this._activePath.arcToSvg(t,e,r,n,i,c.a*o+c.c*a+c.tx,c.b*o+c.d*a+c.ty),this}bezierCurveTo(t,e,r,n,i,o,a){this._tick++;const c=this._transform;return this._activePath.bezierCurveTo(c.a*t+c.c*e+c.tx,c.b*t+c.d*e+c.ty,c.a*r+c.c*n+c.tx,c.b*r+c.d*n+c.ty,c.a*i+c.c*o+c.tx,c.b*i+c.d*o+c.ty,a),this}closePath(){var t;return this._tick++,(t=this._activePath)==null||t.closePath(),this}ellipse(t,e,r,n){return this._tick++,this._activePath.ellipse(t,e,r,n,this._transform.clone()),this}circle(t,e,r){return this._tick++,this._activePath.circle(t,e,r,this._transform.clone()),this}path(t){return this._tick++,this._activePath.addPath(t,this._transform.clone()),this}lineTo(t,e){this._tick++;const r=this._transform;return this._activePath.lineTo(r.a*t+r.c*e+r.tx,r.b*t+r.d*e+r.ty),this}moveTo(t,e){this._tick++;const r=this._transform,n=this._activePath.instructions,i=r.a*t+r.c*e+r.tx,o=r.b*t+r.d*e+r.ty;return n.length===1&&n[0].action==="moveTo"?(n[0].data[0]=i,n[0].data[1]=o,this):(this._activePath.moveTo(i,o),this)}quadraticCurveTo(t,e,r,n,i){this._tick++;const o=this._transform;return this._activePath.quadraticCurveTo(o.a*t+o.c*e+o.tx,o.b*t+o.d*e+o.ty,o.a*r+o.c*n+o.tx,o.b*r+o.d*n+o.ty,i),this}rect(t,e,r,n){return this._tick++,this._activePath.rect(t,e,r,n,this._transform.clone()),this}roundRect(t,e,r,n,i){return this._tick++,this._activePath.roundRect(t,e,r,n,i,this._transform.clone()),this}poly(t,e){return this._tick++,this._activePath.poly(t,e,this._transform.clone()),this}regularPoly(t,e,r,n,i=0,o){return this._tick++,this._activePath.regularPoly(t,e,r,n,i,o),this}roundPoly(t,e,r,n,i,o){return this._tick++,this._activePath.roundPoly(t,e,r,n,i,o),this}roundShape(t,e,r,n){return this._tick++,this._activePath.roundShape(t,e,r,n),this}filletRect(t,e,r,n,i){return this._tick++,this._activePath.filletRect(t,e,r,n,i),this}chamferRect(t,e,r,n,i,o){return this._tick++,this._activePath.chamferRect(t,e,r,n,i,o),this}star(t,e,r,n,i=0,o=0){return this._tick++,this._activePath.star(t,e,r,n,i,o,this._transform.clone()),this}svg(t){return this._tick++,Ru(t,this),this}restore(){const t=this._stateStack.pop();return t&&(this._transform=t.transform,this._fillStyle=t.fillStyle,this._strokeStyle=t.strokeStyle),this}save(){return this._stateStack.push({transform:this._transform.clone(),fillStyle:{...this._fillStyle},strokeStyle:{...this._strokeStyle}}),this}getTransform(){return this._transform}resetTransform(){return this._transform.identity(),this}rotate(t){return this._transform.rotate(t),this}scale(t,e=t){return this._transform.scale(t,e),this}setTransform(t,e,r,n,i,o){return t instanceof X?(this._transform.set(t.a,t.b,t.c,t.d,t.tx,t.ty),this):(this._transform.set(t,e,r,n,i,o),this)}transform(t,e,r,n,i,o){return t instanceof X?(this._transform.append(t),this):(Qi.set(t,e,r,n,i,o),this._transform.append(Qi),this)}translate(t,e=t){return this._transform.translate(t,e),this}clear(){return this._activePath.clear(),this.instructions.length=0,this.resetTransform(),this.onUpdate(),this}onUpdate(){this.dirty||(this.emit("update",this,16),this.dirty=!0,this._boundsDirty=!0)}get bounds(){if(!this._boundsDirty)return this._bounds;const t=this._bounds;t.clear();for(let e=0;e<this.instructions.length;e++){const r=this.instructions[e],n=r.action;if(n==="fill"){const i=r.data;t.addBounds(i.path.bounds)}else if(n==="texture"){const i=r.data;t.addFrame(i.dx,i.dy,i.dx+i.dw,i.dy+i.dh,i.transform)}if(n==="stroke"){const i=r.data,o=i.style.alignment,a=i.style.width*(1-o),c=i.path.bounds;t.addFrame(c.minX-a,c.minY-a,c.maxX+a,c.maxY+a)}}return t}containsPoint(t){var n;if(!this.bounds.containsPoint(t.x,t.y))return!1;const e=this.instructions;let r=!1;for(let i=0;i<e.length;i++){const o=e[i],a=o.data,c=a.path;if(!o.action||!c)continue;const h=a.style,l=c.shapePath.shapePrimitives;for(let d=0;d<l.length;d++){const f=l[d].shape;if(!h||!f)continue;const u=l[d].transform,p=u?u.applyInverse(t,Ou):t;if(o.action==="fill")r=f.contains(p.x,p.y);else{const m=h;r=f.strokeContains(p.x,p.y,m.width,m.alignment)}const g=a.hole;if(g){const m=(n=g.shapePath)==null?void 0:n.shapePrimitives;if(m)for(let y=0;y<m.length;y++)m[y].shape.contains(p.x,p.y)&&(r=!1)}if(r)return!0}}return r}destroy(t=!1){if(this._stateStack.length=0,this._transform=null,this.emit("destroy",this),this.removeAllListeners(),typeof t=="boolean"?t:t==null?void 0:t.texture){const r=typeof t=="boolean"?t:t==null?void 0:t.textureSource;this._fillStyle.texture&&this._fillStyle.texture.destroy(r),this._strokeStyle.texture&&this._strokeStyle.texture.destroy(r)}this._fillStyle=null,this._strokeStyle=null,this.instructions=null,this._activePath=null,this._bounds=null,this._stateStack=null,this.customShader=null,this._transform=null}};Gn.defaultFillStyle={color:16777215,alpha:1,texture:$.WHITE,matrix:null,fill:null,textureSpace:"local"};Gn.defaultStrokeStyle={width:1,color:16777215,alpha:1,alignment:.5,miterLimit:10,cap:"butt",join:"miter",texture:$.WHITE,matrix:null,fill:null,textureSpace:"local",pixelLine:!1};let Bt=Gn;const Ji=["align","breakWords","cssOverrides","fontVariant","fontWeight","leading","letterSpacing","lineHeight","padding","textBaseline","trim","whiteSpace","wordWrap","wordWrapWidth","fontFamily","fontStyle","fontSize"];function Uu(s){const t=[];let e=0;for(let r=0;r<Ji.length;r++){const n=`_${Ji[r]}`;t[e++]=s[n]}return e=Za(s._fill,t,e),e=Hu(s._stroke,t,e),e=Wu(s.dropShadow,t,e),e=Du(s.filters,t,e),t.join("-")}function Du(s,t,e){if(!s)return e;for(const r of s)t[e++]=r.uid;return e}function Za(s,t,e){var r;return s&&(t[e++]=s.color,t[e++]=s.alpha,t[e++]=(r=s.fill)==null?void 0:r.styleKey),e}function Hu(s,t,e){return s&&(e=Za(s,t,e),t[e++]=s.width,t[e++]=s.alignment,t[e++]=s.cap,t[e++]=s.join,t[e++]=s.miterLimit),e}function Wu(s,t,e){return s&&(t[e++]=s.alpha,t[e++]=s.angle,t[e++]=s.blur,t[e++]=s.distance,t[e++]=ct.shared.setValue(s.color).toNumber()),e}const Nn=class Ue extends Wt{constructor(t={}){super(),ju(t);const e={...Ue.defaultTextStyle,...t};for(const r in e){const n=r;this[n]=e[r]}this.update()}get align(){return this._align}set align(t){this._align=t,this.update()}get breakWords(){return this._breakWords}set breakWords(t){this._breakWords=t,this.update()}get dropShadow(){return this._dropShadow}set dropShadow(t){t!==null&&typeof t=="object"?this._dropShadow=this._createProxy({...Ue.defaultDropShadow,...t}):this._dropShadow=t?this._createProxy({...Ue.defaultDropShadow}):null,this.update()}get fontFamily(){return this._fontFamily}set fontFamily(t){this._fontFamily=t,this.update()}get fontSize(){return this._fontSize}set fontSize(t){typeof t=="string"?this._fontSize=parseInt(t,10):this._fontSize=t,this.update()}get fontStyle(){return this._fontStyle}set fontStyle(t){this._fontStyle=t.toLowerCase(),this.update()}get fontVariant(){return this._fontVariant}set fontVariant(t){this._fontVariant=t,this.update()}get fontWeight(){return this._fontWeight}set fontWeight(t){this._fontWeight=t,this.update()}get leading(){return this._leading}set leading(t){this._leading=t,this.update()}get letterSpacing(){return this._letterSpacing}set letterSpacing(t){this._letterSpacing=t,this.update()}get lineHeight(){return this._lineHeight}set lineHeight(t){this._lineHeight=t,this.update()}get padding(){return this._padding}set padding(t){this._padding=t,this.update()}get filters(){return this._filters}set filters(t){this._filters=t,this.update()}get trim(){return this._trim}set trim(t){this._trim=t,this.update()}get textBaseline(){return this._textBaseline}set textBaseline(t){this._textBaseline=t,this.update()}get whiteSpace(){return this._whiteSpace}set whiteSpace(t){this._whiteSpace=t,this.update()}get wordWrap(){return this._wordWrap}set wordWrap(t){this._wordWrap=t,this.update()}get wordWrapWidth(){return this._wordWrapWidth}set wordWrapWidth(t){this._wordWrapWidth=t,this.update()}get fill(){return this._originalFill}set fill(t){t!==this._originalFill&&(this._originalFill=t,this._isFillStyle(t)&&(this._originalFill=this._createProxy({...Bt.defaultFillStyle,...t},()=>{this._fill=Te({...this._originalFill},Bt.defaultFillStyle)})),this._fill=Te(t===0?"black":t,Bt.defaultFillStyle),this.update())}get stroke(){return this._originalStroke}set stroke(t){t!==this._originalStroke&&(this._originalStroke=t,this._isFillStyle(t)&&(this._originalStroke=this._createProxy({...Bt.defaultStrokeStyle,...t},()=>{this._stroke=Zs({...this._originalStroke},Bt.defaultStrokeStyle)})),this._stroke=Zs(t,Bt.defaultStrokeStyle),this.update())}_generateKey(){return this._styleKey=Uu(this),this._styleKey}update(){this._styleKey=null,this.emit("update",this)}reset(){const t=Ue.defaultTextStyle;for(const e in t)this[e]=t[e]}get styleKey(){return this._styleKey||this._generateKey()}clone(){return new Ue({align:this.align,breakWords:this.breakWords,dropShadow:this._dropShadow?{...this._dropShadow}:null,fill:this._fill,fontFamily:this.fontFamily,fontSize:this.fontSize,fontStyle:this.fontStyle,fontVariant:this.fontVariant,fontWeight:this.fontWeight,leading:this.leading,letterSpacing:this.letterSpacing,lineHeight:this.lineHeight,padding:this.padding,stroke:this._stroke,textBaseline:this.textBaseline,whiteSpace:this.whiteSpace,wordWrap:this.wordWrap,wordWrapWidth:this.wordWrapWidth,filters:this._filters?[...this._filters]:void 0})}_getFinalPadding(){let t=0;if(this._filters)for(let e=0;e<this._filters.length;e++)t+=this._filters[e].padding;return Math.max(this._padding,t)}destroy(t=!1){var r,n,i,o;if(this.removeAllListeners(),typeof t=="boolean"?t:t==null?void 0:t.texture){const a=typeof t=="boolean"?t:t==null?void 0:t.textureSource;(r=this._fill)!=null&&r.texture&&this._fill.texture.destroy(a),(n=this._originalFill)!=null&&n.texture&&this._originalFill.texture.destroy(a),(i=this._stroke)!=null&&i.texture&&this._stroke.texture.destroy(a),(o=this._originalStroke)!=null&&o.texture&&this._originalStroke.texture.destroy(a)}this._fill=null,this._stroke=null,this.dropShadow=null,this._originalStroke=null,this._originalFill=null}_createProxy(t,e){return new Proxy(t,{set:(r,n,i)=>(r[n]=i,e==null||e(n,i),this.update(),!0)})}_isFillStyle(t){return(t??null)!==null&&!(ct.isColorLike(t)||t instanceof le||t instanceof lr)}};Nn.defaultDropShadow={alpha:1,angle:Math.PI/6,blur:0,color:"black",distance:5};Nn.defaultTextStyle={align:"left",breakWords:!1,dropShadow:null,fill:"black",fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",leading:0,letterSpacing:0,lineHeight:0,padding:0,stroke:null,textBaseline:"alphabetic",trim:!1,whiteSpace:"pre",wordWrap:!1,wordWrapWidth:100};let kt=Nn;function ju(s){const t=s;if(typeof t.dropShadow=="boolean"&&t.dropShadow){const e=kt.defaultDropShadow;s.dropShadow={alpha:t.dropShadowAlpha??e.alpha,angle:t.dropShadowAngle??e.angle,blur:t.dropShadowBlur??e.blur,color:t.dropShadowColor??e.color,distance:t.dropShadowDistance??e.distance}}if(t.strokeThickness!==void 0){Y(Z,"strokeThickness is now a part of stroke");const e=t.stroke;let r={};if(ct.isColorLike(e))r.color=e;else if(e instanceof le||e instanceof lr)r.fill=e;else if(Object.hasOwnProperty.call(e,"color")||Object.hasOwnProperty.call(e,"fill"))r=e;else throw new Error("Invalid stroke value.");s.stroke={...r,width:t.strokeThickness}}if(Array.isArray(t.fillGradientStops)){Y(Z,"gradient fill is now a fill pattern: `new FillGradient(...)`");let e;s.fontSize==null?s.fontSize=kt.defaultTextStyle.fontSize:typeof s.fontSize=="string"?e=parseInt(s.fontSize,10):e=s.fontSize;const r=new le({start:{x:0,y:0},end:{x:0,y:(e||0)*1.7}}),n=t.fillGradientStops.map(i=>ct.shared.setValue(i).toNumber());n.forEach((i,o)=>{const a=o/(n.length-1);r.addColorStop(a,i)}),s.fill={fill:r}}}class $u{constructor(t){this._canvasPool=Object.create(null),this.canvasOptions=t||{},this.enableFullScreen=!1}_createCanvasAndContext(t,e){const r=ot.get().createCanvas();r.width=t,r.height=e;const n=r.getContext("2d");return{canvas:r,context:n}}getOptimalCanvasAndContext(t,e,r=1){t=Math.ceil(t*r-1e-6),e=Math.ceil(e*r-1e-6),t=We(t),e=We(e);const n=(t<<17)+(e<<1);this._canvasPool[n]||(this._canvasPool[n]=[]);let i=this._canvasPool[n].pop();return i||(i=this._createCanvasAndContext(t,e)),i}returnCanvasAndContext(t){const e=t.canvas,{width:r,height:n}=e,i=(r<<17)+(n<<1);t.context.clearRect(0,0,r,n),this._canvasPool[i].push(t)}clear(){this._canvasPool={}}}const Qs=new $u,to=1e5;function Js(s,t,e,r=0){if(s.texture===$.WHITE&&!s.fill)return ct.shared.setValue(s.color).setAlpha(s.alpha??1).toHexa();if(s.fill){if(s.fill instanceof lr){const n=s.fill,i=t.createPattern(n.texture.source.resource,"repeat"),o=n.transform.copyTo(X.shared);return o.scale(n.texture.frame.width,n.texture.frame.height),i.setTransform(o),i}else if(s.fill instanceof le){const n=s.fill,i=n.type==="linear",o=n.textureSpace==="local";let a=1,c=1;o&&e&&(a=e.width+r,c=e.height+r);let h,l=!1;if(i){const{start:d,end:f}=n;h=t.createLinearGradient(d.x*a,d.y*c,f.x*a,f.y*c),l=Math.abs(f.x-d.x)<Math.abs((f.y-d.y)*.1)}else{const{center:d,innerRadius:f,outerCenter:u,outerRadius:p}=n;h=t.createRadialGradient(d.x*a,d.y*c,f*a,u.x*a,u.y*c,p*a)}if(l&&o&&e){const d=e.lineHeight/c;for(let f=0;f<e.lines.length;f++){const u=(f*e.lineHeight+r/2)/c;n.colorStops.forEach(p=>{const g=u+p.offset*d;h.addColorStop(Math.floor(g*to)/to,ct.shared.setValue(p.color).toHex())})}}else n.colorStops.forEach(d=>{h.addColorStop(d.offset,ct.shared.setValue(d.color).toHex())});return h}}else{const n=t.createPattern(s.texture.source.resource,"repeat"),i=s.matrix.copyTo(X.shared);return i.scale(s.texture.frame.width,s.texture.frame.height),n.setTransform(i),n}return it("FillStyle not recognised",s),"red"}const Qa=class Ja extends Ba{constructor(t){super(),this.resolution=1,this.pages=[],this._padding=0,this._measureCache=Object.create(null),this._currentChars=[],this._currentX=0,this._currentY=0,this._currentMaxCharHeight=0,this._currentPageIndex=-1,this._skipKerning=!1;const e={...Ja.defaultOptions,...t};this._textureSize=e.textureSize,this._mipmap=e.mipmap;const r=e.style.clone();e.overrideFill&&(r._fill.color=16777215,r._fill.alpha=1,r._fill.texture=$.WHITE,r._fill.fill=null),this.applyFillAsTint=e.overrideFill;const n=r.fontSize;r.fontSize=this.baseMeasurementFontSize;const i=Ks(r);e.overrideSize?r._stroke&&(r._stroke.width*=this.baseRenderedFontSize/n):r.fontSize=this.baseRenderedFontSize=n,this._style=r,this._skipKerning=e.skipKerning??!1,this.resolution=e.resolution??1,this._padding=e.padding??4,e.textureStyle&&(this._textureStyle=e.textureStyle instanceof je?e.textureStyle:new je(e.textureStyle)),this.fontMetrics=qt.measureFont(i),this.lineHeight=r.lineHeight||this.fontMetrics.fontSize||r.fontSize}ensureCharacters(t){var m,y;const e=qt.graphemeSegmenter(t).filter(x=>!this._currentChars.includes(x)).filter((x,b,w)=>w.indexOf(x)===b);if(!e.length)return;this._currentChars=[...this._currentChars,...e];let r;this._currentPageIndex===-1?r=this._nextPage():r=this.pages[this._currentPageIndex];let{canvas:n,context:i}=r.canvasAndContext,o=r.texture.source;const a=this._style;let c=this._currentX,h=this._currentY,l=this._currentMaxCharHeight;const d=this.baseRenderedFontSize/this.baseMeasurementFontSize,f=this._padding*d;let u=!1;const p=n.width/this.resolution,g=n.height/this.resolution;for(let x=0;x<e.length;x++){const b=e[x],w=qt.measureText(b,a,n,!1);w.lineHeight=w.height;const _=w.width*d,S=Math.ceil((a.fontStyle==="italic"?2:1)*_),C=w.height*d,M=S+f*2,v=C+f*2;if(u=!1,b!==`
`&&b!=="\r"&&b!=="	"&&b!==" "&&(u=!0,l=Math.ceil(Math.max(v,l))),c+M>p&&(h+=l,l=v,c=0,h+l>g)){o.update();const A=this._nextPage();n=A.canvasAndContext.canvas,i=A.canvasAndContext.context,o=A.texture.source,c=0,h=0,l=0}const k=_/d-(((m=a.dropShadow)==null?void 0:m.distance)??0)-(((y=a._stroke)==null?void 0:y.width)??0);if(this.chars[b]={id:b.codePointAt(0),xOffset:-this._padding,yOffset:-this._padding,xAdvance:k,kerning:{}},u){this._drawGlyph(i,w,c+f,h+f,d,a);const A=o.width*d,P=o.height*d,E=new q(c/A*o.width,h/P*o.height,M/A*o.width,v/P*o.height);this.chars[b].texture=new $({source:o,frame:E}),c+=Math.ceil(M)}}o.update(),this._currentX=c,this._currentY=h,this._currentMaxCharHeight=l,this._skipKerning&&this._applyKerning(e,i)}get pageTextures(){return Y(Z,"BitmapFont.pageTextures is deprecated, please use BitmapFont.pages instead."),this.pages}_applyKerning(t,e){const r=this._measureCache;for(let n=0;n<t.length;n++){const i=t[n];for(let o=0;o<this._currentChars.length;o++){const a=this._currentChars[o];let c=r[i];c||(c=r[i]=e.measureText(i).width);let h=r[a];h||(h=r[a]=e.measureText(a).width);let l=e.measureText(i+a).width,d=l-(c+h);d&&(this.chars[i].kerning[a]=d),l=e.measureText(i+a).width,d=l-(c+h),d&&(this.chars[a].kerning[i]=d)}}}_nextPage(){this._currentPageIndex++;const t=this.resolution,e=Qs.getOptimalCanvasAndContext(this._textureSize,this._textureSize,t);this._setupContext(e.context,this._style,t);const r=t*(this.baseRenderedFontSize/this.baseMeasurementFontSize),n=new $({source:new Fe({resource:e.canvas,resolution:r,alphaMode:"premultiply-alpha-on-upload",autoGenerateMipmaps:this._mipmap})});this._textureStyle&&(n.source.style=this._textureStyle);const i={canvasAndContext:e,texture:n};return this.pages[this._currentPageIndex]=i,i}_setupContext(t,e,r){e.fontSize=this.baseRenderedFontSize,t.scale(r,r),t.font=Ks(e),e.fontSize=this.baseMeasurementFontSize,t.textBaseline=e.textBaseline;const n=e._stroke,i=(n==null?void 0:n.width)??0;if(n&&(t.lineWidth=i,t.lineJoin=n.join,t.miterLimit=n.miterLimit,t.strokeStyle=Js(n,t)),e._fill&&(t.fillStyle=Js(e._fill,t)),e.dropShadow){const o=e.dropShadow,a=ct.shared.setValue(o.color).toArray(),c=o.blur*r,h=o.distance*r;t.shadowColor=`rgba(${a[0]*255},${a[1]*255},${a[2]*255},${o.alpha})`,t.shadowBlur=c,t.shadowOffsetX=Math.cos(o.angle)*h,t.shadowOffsetY=Math.sin(o.angle)*h}else t.shadowColor="black",t.shadowBlur=0,t.shadowOffsetX=0,t.shadowOffsetY=0}_drawGlyph(t,e,r,n,i,o){const a=e.text,c=e.fontProperties,h=o._stroke,l=((h==null?void 0:h.width)??0)*i,d=r+l/2,f=n-l/2,u=c.descent*i,p=e.lineHeight*i;o.stroke&&l&&t.strokeText(a,d,f+p-u),o._fill&&t.fillText(a,d,f+p-u)}destroy(){super.destroy();for(let t=0;t<this.pages.length;t++){const{canvasAndContext:e,texture:r}=this.pages[t];Qs.returnCanvasAndContext(e),r.destroy(!0)}this.pages=null}};Qa.defaultOptions={textureSize:512,style:new kt,mipmap:!0};let eo=Qa;function Vu(s,t,e,r){const n={width:0,height:0,offsetY:0,scale:t.fontSize/e.baseMeasurementFontSize,lines:[{width:0,charPositions:[],spaceWidth:0,spacesIndex:[],chars:[]}]};n.offsetY=e.baseLineOffset;let i=n.lines[0],o=null,a=!0;const c={width:0,start:0,index:0,positions:[],chars:[]},h=p=>{const g=i.width;for(let m=0;m<c.index;m++){const y=p.positions[m];i.chars.push(p.chars[m]),i.charPositions.push(y+g)}i.width+=p.width,a=!1,c.width=0,c.index=0,c.chars.length=0},l=()=>{let p=i.chars.length-1;if(r){let g=i.chars[p];for(;g===" ";)i.width-=e.chars[g].xAdvance,g=i.chars[--p]}n.width=Math.max(n.width,i.width),i={width:0,charPositions:[],chars:[],spaceWidth:0,spacesIndex:[]},a=!0,n.lines.push(i),n.height+=e.lineHeight},d=e.baseMeasurementFontSize/t.fontSize,f=t.letterSpacing*d,u=t.wordWrapWidth*d;for(let p=0;p<s.length+1;p++){let g;const m=p===s.length;m||(g=s[p]);const y=e.chars[g]||e.chars[" "];if(/(?:\s)/.test(g)||g==="\r"||g===`
`||m){if(!a&&t.wordWrap&&i.width+c.width-f>u?(l(),h(c),m||i.charPositions.push(0)):(c.start=i.width,h(c),m||i.charPositions.push(0)),g==="\r"||g===`
`)i.width!==0&&l();else if(!m){const _=y.xAdvance+(y.kerning[o]||0)+f;i.width+=_,i.spaceWidth=_,i.spacesIndex.push(i.charPositions.length),i.chars.push(g)}}else{const w=y.kerning[o]||0,_=y.xAdvance+w+f;c.positions[c.index++]=c.width+w,c.chars.push(g),c.width+=_}o=g}return l(),t.align==="center"?Yu(n):t.align==="right"?Xu(n):t.align==="justify"&&qu(n),n}function Yu(s){for(let t=0;t<s.lines.length;t++){const e=s.lines[t],r=s.width/2-e.width/2;for(let n=0;n<e.charPositions.length;n++)e.charPositions[n]+=r}}function Xu(s){for(let t=0;t<s.lines.length;t++){const e=s.lines[t],r=s.width-e.width;for(let n=0;n<e.charPositions.length;n++)e.charPositions[n]+=r}}function qu(s){const t=s.width;for(let e=0;e<s.lines.length;e++){const r=s.lines[e];let n=0,i=r.spacesIndex[n++],o=0;const a=r.spacesIndex.length,h=(t-r.width)/a;for(let l=0;l<r.charPositions.length;l++)l===i&&(i=r.spacesIndex[n++],o+=h),r.charPositions[l]+=o}}function Ku(s){if(s==="")return[];typeof s=="string"&&(s=[s]);const t=[];for(let e=0,r=s.length;e<r;e++){const n=s[e];if(Array.isArray(n)){if(n.length!==2)throw new Error(`[BitmapFont]: Invalid character range length, expecting 2 got ${n.length}.`);if(n[0].length===0||n[1].length===0)throw new Error("[BitmapFont]: Invalid character delimiter.");const i=n[0].charCodeAt(0),o=n[1].charCodeAt(0);if(o<i)throw new Error("[BitmapFont]: Invalid character range.");for(let a=i,c=o;a<=c;a++)t.push(String.fromCharCode(a))}else t.push(...Array.from(n))}if(t.length===0)throw new Error("[BitmapFont]: Empty set when resolving characters.");return t}let Ls=0;class Zu{constructor(){this.ALPHA=[["a","z"],["A","Z"]," "],this.NUMERIC=[["0","9"]],this.ALPHANUMERIC=[["a","z"],["A","Z"],["0","9"]," "],this.ASCII=[[" ","~"]],this.defaultOptions={chars:this.ALPHANUMERIC,resolution:1,padding:4,skipKerning:!1,textureStyle:null}}getFont(t,e){var o;let r=`${e.fontFamily}-bitmap`,n=!0;if(e._fill.fill&&!e._stroke)r+=e._fill.fill.styleKey,n=!1;else if(e._stroke||e.dropShadow){let a=e.styleKey;a=a.substring(0,a.lastIndexOf("-")),r=`${a}-bitmap`,n=!1}if(!nt.has(r)){const a=new eo({style:e,overrideFill:n,overrideSize:!0,...this.defaultOptions});Ls++,Ls>50&&it("BitmapText",`You have dynamically created ${Ls} bitmap fonts, this can be inefficient. Try pre installing your font styles using \`BitmapFont.install({name:"style1", style})\``),a.once("destroy",()=>{Ls--,nt.remove(r)}),nt.set(r,a)}const i=nt.get(r);return(o=i.ensureCharacters)==null||o.call(i,t),i}getLayout(t,e,r=!0){const n=this.getFont(t,e),i=qt.graphemeSegmenter(t);return Vu(i,e,n,r)}measureText(t,e,r=!0){return this.getLayout(t,e,r)}install(...t){var h,l,d,f;let e=t[0];typeof e=="string"&&(e={name:e,style:t[1],chars:(h=t[2])==null?void 0:h.chars,resolution:(l=t[2])==null?void 0:l.resolution,padding:(d=t[2])==null?void 0:d.padding,skipKerning:(f=t[2])==null?void 0:f.skipKerning},Y(Z,"BitmapFontManager.install(name, style, options) is deprecated, use BitmapFontManager.install({name, style, ...options})"));const r=e==null?void 0:e.name;if(!r)throw new Error("[BitmapFontManager] Property `name` is required.");e={...this.defaultOptions,...e};const n=e.style,i=n instanceof kt?n:new kt(n),o=i._fill.fill!==null&&i._fill.fill!==void 0,a=new eo({style:i,overrideFill:o,skipKerning:e.skipKerning,padding:e.padding,resolution:e.resolution,overrideSize:!1,textureStyle:e.textureStyle}),c=Ku(e.chars);return a.ensureCharacters(c.join("")),nt.set(`${r}-bitmap`,a),a.once("destroy",()=>nt.remove(`${r}-bitmap`)),a}uninstall(t){const e=`${t}-bitmap`,r=nt.get(e);r&&r.destroy()}}const so=new Zu;class tc extends Ba{constructor(t,e){super();const{textures:r,data:n}=t;Object.keys(n.pages).forEach(i=>{const o=n.pages[parseInt(i,10)],a=r[o.id];this.pages.push({texture:a})}),Object.keys(n.chars).forEach(i=>{const o=n.chars[i],{frame:a,source:c}=r[o.page],h=new q(o.x+a.x,o.y+a.y,o.width,o.height),l=new $({source:c,frame:h});this.chars[i]={id:i.codePointAt(0),xOffset:o.xOffset,yOffset:o.yOffset,xAdvance:o.xAdvance,kerning:o.kerning??{},texture:l}}),this.baseRenderedFontSize=n.fontSize,this.baseMeasurementFontSize=n.fontSize,this.fontMetrics={ascent:0,descent:0,fontSize:n.fontSize},this.baseLineOffset=n.baseLineOffset,this.lineHeight=n.lineHeight,this.fontFamily=n.fontFamily,this.distanceField=n.distanceField??{type:"none",range:0},this.url=e}destroy(){super.destroy();for(let t=0;t<this.pages.length;t++){const{texture:e}=this.pages[t];e.destroy(!0)}this.pages=null}static install(t){so.install(t)}static uninstall(t){so.uninstall(t)}}const Ur={test(s){return typeof s=="string"&&s.startsWith("info face=")},parse(s){const t=s.match(/^[a-z]+\s+.+$/gm),e={info:[],common:[],page:[],char:[],chars:[],kerning:[],kernings:[],distanceField:[]};for(const d in t){const f=t[d].match(/^[a-z]+/gm)[0],u=t[d].match(/[a-zA-Z]+=([^\s"']+|"([^"]*)")/gm),p={};for(const g in u){const m=u[g].split("="),y=m[0],x=m[1].replace(/"/gm,""),b=parseFloat(x),w=isNaN(b)?x:b;p[y]=w}e[f].push(p)}const r={chars:{},pages:[],lineHeight:0,fontSize:0,fontFamily:"",distanceField:null,baseLineOffset:0},[n]=e.info,[i]=e.common,[o]=e.distanceField??[];o&&(r.distanceField={range:parseInt(o.distanceRange,10),type:o.fieldType}),r.fontSize=parseInt(n.size,10),r.fontFamily=n.face,r.lineHeight=parseInt(i.lineHeight,10);const a=e.page;for(let d=0;d<a.length;d++)r.pages.push({id:parseInt(a[d].id,10)||0,file:a[d].file});const c={};r.baseLineOffset=r.lineHeight-parseInt(i.base,10);const h=e.char;for(let d=0;d<h.length;d++){const f=h[d],u=parseInt(f.id,10);let p=f.letter??f.char??String.fromCharCode(u);p==="space"&&(p=" "),c[u]=p,r.chars[p]={id:u,page:parseInt(f.page,10)||0,x:parseInt(f.x,10),y:parseInt(f.y,10),width:parseInt(f.width,10),height:parseInt(f.height,10),xOffset:parseInt(f.xoffset,10),yOffset:parseInt(f.yoffset,10),xAdvance:parseInt(f.xadvance,10),kerning:{}}}const l=e.kerning||[];for(let d=0;d<l.length;d++){const f=parseInt(l[d].first,10),u=parseInt(l[d].second,10),p=parseInt(l[d].amount,10);r.chars[c[u]].kerning[c[f]]=p}return r}},ro={test(s){const t=s;return typeof t!="string"&&"getElementsByTagName"in t&&t.getElementsByTagName("page").length&&t.getElementsByTagName("info")[0].getAttribute("face")!==null},parse(s){const t={chars:{},pages:[],lineHeight:0,fontSize:0,fontFamily:"",distanceField:null,baseLineOffset:0},e=s.getElementsByTagName("info")[0],r=s.getElementsByTagName("common")[0],n=s.getElementsByTagName("distanceField")[0];n&&(t.distanceField={type:n.getAttribute("fieldType"),range:parseInt(n.getAttribute("distanceRange"),10)});const i=s.getElementsByTagName("page"),o=s.getElementsByTagName("char"),a=s.getElementsByTagName("kerning");t.fontSize=parseInt(e.getAttribute("size"),10),t.fontFamily=e.getAttribute("face"),t.lineHeight=parseInt(r.getAttribute("lineHeight"),10);for(let h=0;h<i.length;h++)t.pages.push({id:parseInt(i[h].getAttribute("id"),10)||0,file:i[h].getAttribute("file")});const c={};t.baseLineOffset=t.lineHeight-parseInt(r.getAttribute("base"),10);for(let h=0;h<o.length;h++){const l=o[h],d=parseInt(l.getAttribute("id"),10);let f=l.getAttribute("letter")??l.getAttribute("char")??String.fromCharCode(d);f==="space"&&(f=" "),c[d]=f,t.chars[f]={id:d,page:parseInt(l.getAttribute("page"),10)||0,x:parseInt(l.getAttribute("x"),10),y:parseInt(l.getAttribute("y"),10),width:parseInt(l.getAttribute("width"),10),height:parseInt(l.getAttribute("height"),10),xOffset:parseInt(l.getAttribute("xoffset"),10),yOffset:parseInt(l.getAttribute("yoffset"),10),xAdvance:parseInt(l.getAttribute("xadvance"),10),kerning:{}}}for(let h=0;h<a.length;h++){const l=parseInt(a[h].getAttribute("first"),10),d=parseInt(a[h].getAttribute("second"),10),f=parseInt(a[h].getAttribute("amount"),10);t.chars[c[d]].kerning[c[l]]=f}return t}},no={test(s){return typeof s=="string"&&s.includes("<font>")?ro.test(ot.get().parseXML(s)):!1},parse(s){return ro.parse(ot.get().parseXML(s))}},Qu=[".xml",".fnt"],Ju={extension:{type:O.CacheParser,name:"cacheBitmapFont"},test:s=>s instanceof tc,getCacheableAssets(s,t){const e={};return s.forEach(r=>{e[r]=t,e[`${r}-bitmap`]=t}),e[`${t.fontFamily}-bitmap`]=t,e}},tf={extension:{type:O.LoadParser,priority:xe.Normal},name:"loadBitmapFont",test(s){return Qu.includes(Ct.extname(s).toLowerCase())},async testParse(s){return Ur.test(s)||no.test(s)},async parse(s,t,e){const r=Ur.test(s)?Ur.parse(s):no.parse(s),{src:n}=t,{pages:i}=r,o=[],a=r.distanceField?{scaleMode:"linear",alphaMode:"premultiply-alpha-on-upload",autoGenerateMipmaps:!1,resolution:1}:{};for(let d=0;d<i.length;++d){const f=i[d].file;let u=Ct.join(Ct.dirname(n),f);u=on(u,n),o.push({src:u,data:a})}const c=await e.load(o),h=o.map(d=>c[d.src]);return new tc({data:r,textures:h},n)},async load(s,t){return await(await ot.get().fetch(s)).text()},async unload(s,t,e){await Promise.all(s.pages.map(r=>e.unload(r.texture.source._sourceOrigin))),s.destroy()}};class ef{constructor(t,e=!1){this._loader=t,this._assetList=[],this._isLoading=!1,this._maxConcurrent=1,this.verbose=e}add(t){t.forEach(e=>{this._assetList.push(e)}),this.verbose&&console.log("[BackgroundLoader] assets: ",this._assetList),this._isActive&&!this._isLoading&&this._next()}async _next(){if(this._assetList.length&&this._isActive){this._isLoading=!0;const t=[],e=Math.min(this._assetList.length,this._maxConcurrent);for(let r=0;r<e;r++)t.push(this._assetList.pop());await this._loader.load(t),this._isLoading=!1,this._next()}}get active(){return this._isActive}set active(t){this._isActive!==t&&(this._isActive=t,t&&!this._isLoading&&this._next())}}const sf={extension:{type:O.CacheParser,name:"cacheTextureArray"},test:s=>Array.isArray(s)&&s.every(t=>t instanceof $),getCacheableAssets:(s,t)=>{const e={};return s.forEach(r=>{t.forEach((n,i)=>{e[r+(i===0?"":i+1)]=n})}),e}};async function ec(s){if("Image"in globalThis)return new Promise(t=>{const e=new Image;e.onload=()=>{t(!0)},e.onerror=()=>{t(!1)},e.src=s});if("createImageBitmap"in globalThis&&"fetch"in globalThis){try{const t=await(await fetch(s)).blob();await createImageBitmap(t)}catch{return!1}return!0}return!1}const rf={extension:{type:O.DetectionParser,priority:1},test:async()=>ec("data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAAB0AAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAIAAAACAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQ0MAAAAABNjb2xybmNseAACAAIAAYAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAACVtZGF0EgAKCBgANogQEAwgMg8f8D///8WfhwB8+ErK42A="),add:async s=>[...s,"avif"],remove:async s=>s.filter(t=>t!=="avif")},io=["png","jpg","jpeg"],nf={extension:{type:O.DetectionParser,priority:-1},test:()=>Promise.resolve(!0),add:async s=>[...s,...io],remove:async s=>s.filter(t=>!io.includes(t))},of="WorkerGlobalScope"in globalThis&&globalThis instanceof globalThis.WorkerGlobalScope;function On(s){return of?!1:document.createElement("video").canPlayType(s)!==""}const af={extension:{type:O.DetectionParser,priority:0},test:async()=>On("video/mp4"),add:async s=>[...s,"mp4","m4v"],remove:async s=>s.filter(t=>t!=="mp4"&&t!=="m4v")},cf={extension:{type:O.DetectionParser,priority:0},test:async()=>On("video/ogg"),add:async s=>[...s,"ogv"],remove:async s=>s.filter(t=>t!=="ogv")},lf={extension:{type:O.DetectionParser,priority:0},test:async()=>On("video/webm"),add:async s=>[...s,"webm"],remove:async s=>s.filter(t=>t!=="webm")},hf={extension:{type:O.DetectionParser,priority:0},test:async()=>ec("data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAAAAAAfQ//73v/+BiOh/AAA="),add:async s=>[...s,"webp"],remove:async s=>s.filter(t=>t!=="webp")};class df{constructor(){this._parsers=[],this._parsersValidated=!1,this.parsers=new Proxy(this._parsers,{set:(t,e,r)=>(this._parsersValidated=!1,t[e]=r,!0)}),this.promiseCache={}}reset(){this._parsersValidated=!1,this.promiseCache={}}_getLoadPromiseAndParser(t,e){const r={promise:null,parser:null};return r.promise=(async()=>{var o,a;let n=null,i=null;if(e.loadParser&&(i=this._parserHash[e.loadParser],i||it(`[Assets] specified load parser "${e.loadParser}" not found while loading ${t}`)),!i){for(let c=0;c<this.parsers.length;c++){const h=this.parsers[c];if(h.load&&((o=h.test)!=null&&o.call(h,t,e,this))){i=h;break}}if(!i)return it(`[Assets] ${t} could not be loaded as we don't know how to parse it, ensure the correct parser has been added`),null}n=await i.load(t,e,this),r.parser=i;for(let c=0;c<this.parsers.length;c++){const h=this.parsers[c];h.parse&&h.parse&&await((a=h.testParse)==null?void 0:a.call(h,n,e,this))&&(n=await h.parse(n,e,this)||n,r.parser=h)}return n})(),r}async load(t,e){this._parsersValidated||this._validateParsers();let r=0;const n={},i=qs(t),o=Ot(t,h=>({alias:[h],src:h,data:{}})),a=o.length,c=o.map(async h=>{const l=Ct.toAbsolute(h.src);if(!n[h.src])try{this.promiseCache[l]||(this.promiseCache[l]=this._getLoadPromiseAndParser(l,h)),n[h.src]=await this.promiseCache[l].promise,e&&e(++r/a)}catch(d){throw delete this.promiseCache[l],delete n[h.src],new Error(`[Loader.load] Failed to load ${l}.
${d}`)}});return await Promise.all(c),i?n[o[0].src]:n}async unload(t){const r=Ot(t,n=>({alias:[n],src:n})).map(async n=>{var a,c;const i=Ct.toAbsolute(n.src),o=this.promiseCache[i];if(o){const h=await o.promise;delete this.promiseCache[i],await((c=(a=o.parser)==null?void 0:a.unload)==null?void 0:c.call(a,h,n,this))}});await Promise.all(r)}_validateParsers(){this._parsersValidated=!0,this._parserHash=this._parsers.filter(t=>t.name).reduce((t,e)=>(e.name?t[e.name]&&it(`[Assets] loadParser name conflict "${e.name}"`):it("[Assets] loadParser should have a name"),{...t,[e.name]:e}),{})}}function Ze(s,t){if(Array.isArray(t)){for(const e of t)if(s.startsWith(`data:${e}`))return!0;return!1}return s.startsWith(`data:${t}`)}function Qe(s,t){const e=s.split("?")[0],r=Ct.extname(e).toLowerCase();return Array.isArray(t)?t.includes(r):r===t}const uf=".json",ff="application/json",pf={extension:{type:O.LoadParser,priority:xe.Low},name:"loadJson",test(s){return Ze(s,ff)||Qe(s,uf)},async load(s){return await(await ot.get().fetch(s)).json()}},mf=".txt",gf="text/plain",xf={name:"loadTxt",extension:{type:O.LoadParser,priority:xe.Low,name:"loadTxt"},test(s){return Ze(s,gf)||Qe(s,mf)},async load(s){return await(await ot.get().fetch(s)).text()}},yf=["normal","bold","100","200","300","400","500","600","700","800","900"],bf=[".ttf",".otf",".woff",".woff2"],wf=["font/ttf","font/otf","font/woff","font/woff2"],_f=/^(--|-?[A-Z_])[0-9A-Z_-]*$/i;function vf(s){const t=Ct.extname(s),n=Ct.basename(s,t).replace(/(-|_)/g," ").toLowerCase().split(" ").map(a=>a.charAt(0).toUpperCase()+a.slice(1));let i=n.length>0;for(const a of n)if(!a.match(_f)){i=!1;break}let o=n.join(" ");return i||(o=`"${o.replace(/[\\"]/g,"\\$&")}"`),o}const Af=/^[0-9A-Za-z%:/?#\[\]@!\$&'()\*\+,;=\-._~]*$/;function Sf(s){return Af.test(s)?s:encodeURI(s)}const Cf={extension:{type:O.LoadParser,priority:xe.Low},name:"loadWebFont",test(s){return Ze(s,wf)||Qe(s,bf)},async load(s,t){var r,n,i;const e=ot.get().getFontFaceSet();if(e){const o=[],a=((r=t.data)==null?void 0:r.family)??vf(s),c=((i=(n=t.data)==null?void 0:n.weights)==null?void 0:i.filter(l=>yf.includes(l)))??["normal"],h=t.data??{};for(let l=0;l<c.length;l++){const d=c[l],f=new FontFace(a,`url(${Sf(s)})`,{...h,weight:d});await f.load(),e.add(f),o.push(f)}return nt.set(`${a}-and-url`,{url:s,fontFaces:o}),o.length===1?o[0]:o}return it("[loadWebFont] FontFace API is not supported. Skipping loading font"),null},unload(s){(Array.isArray(s)?s:[s]).forEach(t=>{nt.remove(`${t.family}-and-url`),ot.get().getFontFaceSet().delete(t)})}};function Un(s,t=1){var r;const e=(r=Ke.RETINA_PREFIX)==null?void 0:r.exec(s);return e?parseFloat(e[1]):t}function Dn(s,t,e){s.label=e,s._sourceOrigin=e;const r=new $({source:s,label:e}),n=()=>{delete t.promiseCache[e],nt.has(e)&&nt.remove(e)};return r.source.once("destroy",()=>{t.promiseCache[e]&&(it("[Assets] A TextureSource managed by Assets was destroyed instead of unloaded! Use Assets.unload() instead of destroying the TextureSource."),n())}),r.once("destroy",()=>{s.destroyed||(it("[Assets] A Texture managed by Assets was destroyed instead of unloaded! Use Assets.unload() instead of destroying the Texture."),n())}),r}const kf=".svg",Mf="image/svg+xml",Pf={extension:{type:O.LoadParser,priority:xe.Low,name:"loadSVG"},name:"loadSVG",config:{crossOrigin:"anonymous",parseAsGraphicsContext:!1},test(s){return Ze(s,Mf)||Qe(s,kf)},async load(s,t,e){var r;return((r=t.data)==null?void 0:r.parseAsGraphicsContext)??this.config.parseAsGraphicsContext?Ef(s):Tf(s,t,e,this.config.crossOrigin)},unload(s){s.destroy(!0)}};async function Tf(s,t,e,r){var m,y,x;const i=await(await ot.get().fetch(s)).blob(),o=URL.createObjectURL(i),a=new Image;a.src=o,a.crossOrigin=r,await a.decode(),URL.revokeObjectURL(o);const c=document.createElement("canvas"),h=c.getContext("2d"),l=((m=t.data)==null?void 0:m.resolution)||Un(s),d=((y=t.data)==null?void 0:y.width)??a.width,f=((x=t.data)==null?void 0:x.height)??a.height;c.width=d*l,c.height=f*l,h.drawImage(a,0,0,d*l,f*l);const{parseAsGraphicsContext:u,...p}=t.data??{},g=new Fe({resource:c,alphaMode:"premultiply-alpha-on-upload",resolution:l,...p});return Dn(g,e,s)}async function Ef(s){const e=await(await ot.get().fetch(s)).text(),r=new Bt;return r.svg(e),r}const If=`(function () {
    'use strict';

    const WHITE_PNG = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mP8/x8AAwMCAO+ip1sAAAAASUVORK5CYII=";
    async function checkImageBitmap() {
      try {
        if (typeof createImageBitmap !== "function")
          return false;
        const response = await fetch(WHITE_PNG);
        const imageBlob = await response.blob();
        const imageBitmap = await createImageBitmap(imageBlob);
        return imageBitmap.width === 1 && imageBitmap.height === 1;
      } catch (_e) {
        return false;
      }
    }
    void checkImageBitmap().then((result) => {
      self.postMessage(result);
    });

})();
`;let De=null,yn=class{constructor(){De||(De=URL.createObjectURL(new Blob([If],{type:"application/javascript"}))),this.worker=new Worker(De)}};yn.revokeObjectURL=function(){De&&(URL.revokeObjectURL(De),De=null)};const Bf=`(function () {
    'use strict';

    async function loadImageBitmap(url, alphaMode) {
      const response = await fetch(url);
      if (!response.ok) {
        throw new Error(\`[WorkerManager.loadImageBitmap] Failed to fetch \${url}: \${response.status} \${response.statusText}\`);
      }
      const imageBlob = await response.blob();
      return alphaMode === "premultiplied-alpha" ? createImageBitmap(imageBlob, { premultiplyAlpha: "none" }) : createImageBitmap(imageBlob);
    }
    self.onmessage = async (event) => {
      try {
        const imageBitmap = await loadImageBitmap(event.data.data[0], event.data.data[1]);
        self.postMessage({
          data: imageBitmap,
          uuid: event.data.uuid,
          id: event.data.id
        }, [imageBitmap]);
      } catch (e) {
        self.postMessage({
          error: e,
          uuid: event.data.uuid,
          id: event.data.id
        });
      }
    };

})();
`;let He=null;class sc{constructor(){He||(He=URL.createObjectURL(new Blob([Bf],{type:"application/javascript"}))),this.worker=new Worker(He)}}sc.revokeObjectURL=function(){He&&(URL.revokeObjectURL(He),He=null)};let oo=0,Dr;class Rf{constructor(){this._initialized=!1,this._createdWorkers=0,this._workerPool=[],this._queue=[],this._resolveHash={}}isImageBitmapSupported(){return this._isImageBitmapSupported!==void 0?this._isImageBitmapSupported:(this._isImageBitmapSupported=new Promise(t=>{const{worker:e}=new yn;e.addEventListener("message",r=>{e.terminate(),yn.revokeObjectURL(),t(r.data)})}),this._isImageBitmapSupported)}loadImageBitmap(t,e){var r;return this._run("loadImageBitmap",[t,(r=e==null?void 0:e.data)==null?void 0:r.alphaMode])}async _initWorkers(){this._initialized||(this._initialized=!0)}_getWorker(){Dr===void 0&&(Dr=navigator.hardwareConcurrency||4);let t=this._workerPool.pop();return!t&&this._createdWorkers<Dr&&(this._createdWorkers++,t=new sc().worker,t.addEventListener("message",e=>{this._complete(e.data),this._returnWorker(e.target),this._next()})),t}_returnWorker(t){this._workerPool.push(t)}_complete(t){t.error!==void 0?this._resolveHash[t.uuid].reject(t.error):this._resolveHash[t.uuid].resolve(t.data),this._resolveHash[t.uuid]=null}async _run(t,e){await this._initWorkers();const r=new Promise((n,i)=>{this._queue.push({id:t,arguments:e,resolve:n,reject:i})});return this._next(),r}_next(){if(!this._queue.length)return;const t=this._getWorker();if(!t)return;const e=this._queue.pop(),r=e.id;this._resolveHash[oo]={resolve:e.resolve,reject:e.reject},t.postMessage({data:e.arguments,uuid:oo++,id:r})}}const ao=new Rf,Ff=[".jpeg",".jpg",".png",".webp",".avif"],Lf=["image/jpeg","image/png","image/webp","image/avif"];async function zf(s,t){var n;const e=await ot.get().fetch(s);if(!e.ok)throw new Error(`[loadImageBitmap] Failed to fetch ${s}: ${e.status} ${e.statusText}`);const r=await e.blob();return((n=t==null?void 0:t.data)==null?void 0:n.alphaMode)==="premultiplied-alpha"?createImageBitmap(r,{premultiplyAlpha:"none"}):createImageBitmap(r)}const rc={name:"loadTextures",extension:{type:O.LoadParser,priority:xe.High,name:"loadTextures"},config:{preferWorkers:!0,preferCreateImageBitmap:!0,crossOrigin:"anonymous"},test(s){return Ze(s,Lf)||Qe(s,Ff)},async load(s,t,e){var i;let r=null;globalThis.createImageBitmap&&this.config.preferCreateImageBitmap?this.config.preferWorkers&&await ao.isImageBitmapSupported()?r=await ao.loadImageBitmap(s,t):r=await zf(s,t):r=await new Promise((o,a)=>{r=new Image,r.crossOrigin=this.config.crossOrigin,r.src=s,r.complete?o(r):(r.onload=()=>{o(r)},r.onerror=a)});const n=new Fe({resource:r,alphaMode:"premultiply-alpha-on-upload",resolution:((i=t.data)==null?void 0:i.resolution)||Un(s),...t.data});return Dn(n,e,s)},unload(s){s.destroy(!0)}},nc=[".mp4",".m4v",".webm",".ogg",".ogv",".h264",".avi",".mov"],Gf=nc.map(s=>`video/${s.substring(1)}`);function Nf(s,t,e){e===void 0&&!t.startsWith("data:")?s.crossOrigin=Uf(t):e!==!1&&(s.crossOrigin=typeof e=="string"?e:"anonymous")}function Of(s){return new Promise((t,e)=>{s.addEventListener("canplaythrough",r),s.addEventListener("error",n),s.load();function r(){i(),t()}function n(o){i(),e(o)}function i(){s.removeEventListener("canplaythrough",r),s.removeEventListener("error",n)}})}function Uf(s,t=globalThis.location){if(s.startsWith("data:"))return"";t||(t=globalThis.location);const e=new URL(s,document.baseURI);return e.hostname!==t.hostname||e.port!==t.port||e.protocol!==t.protocol?"anonymous":""}const Df={name:"loadVideo",extension:{type:O.LoadParser,name:"loadVideo"},test(s){const t=Ze(s,Gf),e=Qe(s,nc);return t||e},async load(s,t,e){var c,h;const r={...$s.defaultOptions,resolution:((c=t.data)==null?void 0:c.resolution)||Un(s),alphaMode:((h=t.data)==null?void 0:h.alphaMode)||await aa(),...t.data},n=document.createElement("video"),i={preload:r.autoLoad!==!1?"auto":void 0,"webkit-playsinline":r.playsinline!==!1?"":void 0,playsinline:r.playsinline!==!1?"":void 0,muted:r.muted===!0?"":void 0,loop:r.loop===!0?"":void 0,autoplay:r.autoPlay!==!1?"":void 0};Object.keys(i).forEach(l=>{const d=i[l];d!==void 0&&n.setAttribute(l,d)}),r.muted===!0&&(n.muted=!0),Nf(n,s,r.crossorigin);const o=document.createElement("source");let a;if(s.startsWith("data:"))a=s.slice(5,s.indexOf(";"));else if(!s.startsWith("blob:")){const l=s.split("?")[0].slice(s.lastIndexOf(".")+1).toLowerCase();a=$s.MIME_TYPES[l]||`video/${l}`}return o.src=s,a&&(o.type=a),new Promise(l=>{const d=async()=>{const f=new $s({...r,resource:n});n.removeEventListener("canplay",d),t.data.preload&&await Of(n),l(Dn(f,e,s))};r.preload&&!r.autoPlay&&n.load(),n.addEventListener("canplay",d),n.appendChild(o)})},unload(s){s.destroy(!0)}},ic={extension:{type:O.ResolveParser,name:"resolveTexture"},test:rc.test,parse:s=>{var t;return{resolution:parseFloat(((t=Ke.RETINA_PREFIX.exec(s))==null?void 0:t[1])??"1"),format:s.split(".").pop(),src:s}}},Hf={extension:{type:O.ResolveParser,priority:-2,name:"resolveJson"},test:s=>Ke.RETINA_PREFIX.test(s)&&s.endsWith(".json"),parse:ic.parse};class Wf{constructor(){this._detections=[],this._initialized=!1,this.resolver=new Ke,this.loader=new df,this.cache=nt,this._backgroundLoader=new ef(this.loader),this._backgroundLoader.active=!0,this.reset()}async init(t={}){var i,o;if(this._initialized){it("[Assets]AssetManager already initialized, did you load before calling this Assets.init()?");return}if(this._initialized=!0,t.defaultSearchParams&&this.resolver.setDefaultSearchParams(t.defaultSearchParams),t.basePath&&(this.resolver.basePath=t.basePath),t.bundleIdentifier&&this.resolver.setBundleIdentifier(t.bundleIdentifier),t.manifest){let a=t.manifest;typeof a=="string"&&(a=await this.load(a)),this.resolver.addManifest(a)}const e=((i=t.texturePreference)==null?void 0:i.resolution)??1,r=typeof e=="number"?[e]:e,n=await this._detectFormats({preferredFormats:(o=t.texturePreference)==null?void 0:o.format,skipDetections:t.skipDetections,detections:this._detections});this.resolver.prefer({params:{format:n,resolution:r}}),t.preferences&&this.setPreferences(t.preferences)}add(t){this.resolver.add(t)}async load(t,e){this._initialized||await this.init();const r=qs(t),n=Ot(t).map(a=>{if(typeof a!="string"){const c=this.resolver.getAlias(a);return c.some(h=>!this.resolver.hasKey(h))&&this.add(a),Array.isArray(c)?c[0]:c}return this.resolver.hasKey(a)||this.add({alias:a,src:a}),a}),i=this.resolver.resolve(n),o=await this._mapLoadToResolve(i,e);return r?o[n[0]]:o}addBundle(t,e){this.resolver.addBundle(t,e)}async loadBundle(t,e){this._initialized||await this.init();let r=!1;typeof t=="string"&&(r=!0,t=[t]);const n=this.resolver.resolveBundle(t),i={},o=Object.keys(n);let a=0,c=0;const h=()=>{e==null||e(++a/c)},l=o.map(d=>{const f=n[d];return c+=Object.keys(f).length,this._mapLoadToResolve(f,h).then(u=>{i[d]=u})});return await Promise.all(l),r?i[t[0]]:i}async backgroundLoad(t){this._initialized||await this.init(),typeof t=="string"&&(t=[t]);const e=this.resolver.resolve(t);this._backgroundLoader.add(Object.values(e))}async backgroundLoadBundle(t){this._initialized||await this.init(),typeof t=="string"&&(t=[t]);const e=this.resolver.resolveBundle(t);Object.values(e).forEach(r=>{this._backgroundLoader.add(Object.values(r))})}reset(){this.resolver.reset(),this.loader.reset(),this.cache.reset(),this._initialized=!1}get(t){if(typeof t=="string")return nt.get(t);const e={};for(let r=0;r<t.length;r++)e[r]=nt.get(t[r]);return e}async _mapLoadToResolve(t,e){const r=[...new Set(Object.values(t))];this._backgroundLoader.active=!1;const n=await this.loader.load(r,e);this._backgroundLoader.active=!0;const i={};return r.forEach(o=>{const a=n[o.src],c=[o.src];o.alias&&c.push(...o.alias),c.forEach(h=>{i[h]=a}),nt.set(c,a)}),i}async unload(t){this._initialized||await this.init();const e=Ot(t).map(n=>typeof n!="string"?n.src:n),r=this.resolver.resolve(e);await this._unloadFromResolved(r)}async unloadBundle(t){this._initialized||await this.init(),t=Ot(t);const e=this.resolver.resolveBundle(t),r=Object.keys(e).map(n=>this._unloadFromResolved(e[n]));await Promise.all(r)}async _unloadFromResolved(t){const e=Object.values(t);e.forEach(r=>{nt.remove(r.src)}),await this.loader.unload(e)}async _detectFormats(t){let e=[];t.preferredFormats&&(e=Array.isArray(t.preferredFormats)?t.preferredFormats:[t.preferredFormats]);for(const r of t.detections)t.skipDetections||await r.test()?e=await r.add(e):t.skipDetections||(e=await r.remove(e));return e=e.filter((r,n)=>e.indexOf(r)===n),e}get detections(){return this._detections}setPreferences(t){this.loader.parsers.forEach(e=>{e.config&&Object.keys(e.config).filter(r=>r in t).forEach(r=>{e.config[r]=t[r]})})}}const St=new Wf;ut.handleByList(O.LoadParser,St.loader.parsers).handleByList(O.ResolveParser,St.resolver.parsers).handleByList(O.CacheParser,St.cache.parsers).handleByList(O.DetectionParser,St.detections);ut.add(sf,nf,rf,hf,af,cf,lf,pf,xf,Cf,Pf,rc,Df,tf,Ju,ic,Hf);const co={loader:O.LoadParser,resolver:O.ResolveParser,cache:O.CacheParser,detection:O.DetectionParser};ut.handle(O.Asset,s=>{const t=s.ref;Object.entries(co).filter(([e])=>!!t[e]).forEach(([e,r])=>ut.add(Object.assign(t[e],{extension:t[e].extension??r})))},s=>{const t=s.ref;Object.keys(co).filter(e=>!!t[e]).forEach(e=>ut.remove(t[e]))});class Jt extends Tn{constructor(t){t instanceof Bt&&(t={context:t});const{context:e,roundPixels:r,...n}=t||{};super({label:"Graphics",...n}),this.renderPipeId="graphics",e?this._context=e:this._context=this._ownedContext=new Bt,this._context.on("update",this.onViewUpdate,this),this.didViewUpdate=!0,this.allowChildren=!1,this.roundPixels=r??!1}set context(t){t!==this._context&&(this._context.off("update",this.onViewUpdate,this),this._context=t,this._context.on("update",this.onViewUpdate,this),this.onViewUpdate())}get context(){return this._context}get bounds(){return this._context.bounds}updateBounds(){}containsPoint(t){return this._context.containsPoint(t)}destroy(t){this._ownedContext&&!t?this._ownedContext.destroy(t):(t===!0||(t==null?void 0:t.context)===!0)&&this._context.destroy(t),this._ownedContext=null,this._context=null,super.destroy(t)}_callContextMethod(t,e){return this.context[t](...e),this}setFillStyle(...t){return this._callContextMethod("setFillStyle",t)}setStrokeStyle(...t){return this._callContextMethod("setStrokeStyle",t)}fill(...t){return this._callContextMethod("fill",t)}stroke(...t){return this._callContextMethod("stroke",t)}texture(...t){return this._callContextMethod("texture",t)}beginPath(){return this._callContextMethod("beginPath",[])}cut(){return this._callContextMethod("cut",[])}arc(...t){return this._callContextMethod("arc",t)}arcTo(...t){return this._callContextMethod("arcTo",t)}arcToSvg(...t){return this._callContextMethod("arcToSvg",t)}bezierCurveTo(...t){return this._callContextMethod("bezierCurveTo",t)}closePath(){return this._callContextMethod("closePath",[])}ellipse(...t){return this._callContextMethod("ellipse",t)}circle(...t){return this._callContextMethod("circle",t)}path(...t){return this._callContextMethod("path",t)}lineTo(...t){return this._callContextMethod("lineTo",t)}moveTo(...t){return this._callContextMethod("moveTo",t)}quadraticCurveTo(...t){return this._callContextMethod("quadraticCurveTo",t)}rect(...t){return this._callContextMethod("rect",t)}roundRect(...t){return this._callContextMethod("roundRect",t)}poly(...t){return this._callContextMethod("poly",t)}regularPoly(...t){return this._callContextMethod("regularPoly",t)}roundPoly(...t){return this._callContextMethod("roundPoly",t)}roundShape(...t){return this._callContextMethod("roundShape",t)}filletRect(...t){return this._callContextMethod("filletRect",t)}chamferRect(...t){return this._callContextMethod("chamferRect",t)}star(...t){return this._callContextMethod("star",t)}svg(...t){return this._callContextMethod("svg",t)}restore(...t){return this._callContextMethod("restore",t)}save(){return this._callContextMethod("save",[])}getTransform(){return this.context.getTransform()}resetTransform(){return this._callContextMethod("resetTransform",[])}rotateTransform(...t){return this._callContextMethod("rotate",t)}scaleTransform(...t){return this._callContextMethod("scale",t)}setTransform(...t){return this._callContextMethod("setTransform",t)}transform(...t){return this._callContextMethod("transform",t)}translateTransform(...t){return this._callContextMethod("translate",t)}clear(){return this._callContextMethod("clear",[])}get fillStyle(){return this._context.fillStyle}set fillStyle(t){this._context.fillStyle=t}get strokeStyle(){return this._context.strokeStyle}set strokeStyle(t){this._context.strokeStyle=t}clone(t=!1){return t?new Jt(this._context.clone()):(this._ownedContext=null,new Jt(this._context))}lineStyle(t,e,r){Y(Z,"Graphics#lineStyle is no longer needed. Use Graphics#setStrokeStyle to set the stroke style.");const n={};return t&&(n.width=t),e&&(n.color=e),r&&(n.alpha=r),this.context.strokeStyle=n,this}beginFill(t,e){Y(Z,"Graphics#beginFill is no longer needed. Use Graphics#fill to fill the shape with the desired style.");const r={};return t!==void 0&&(r.color=t),e!==void 0&&(r.alpha=e),this.context.fillStyle=r,this}endFill(){Y(Z,"Graphics#endFill is no longer needed. Use Graphics#fill to fill the shape with the desired style."),this.context.fill();const t=this.context.strokeStyle;return(t.width!==Bt.defaultStrokeStyle.width||t.color!==Bt.defaultStrokeStyle.color||t.alpha!==Bt.defaultStrokeStyle.alpha)&&this.context.stroke(),this}drawCircle(...t){return Y(Z,"Graphics#drawCircle has been renamed to Graphics#circle"),this._callContextMethod("circle",t)}drawEllipse(...t){return Y(Z,"Graphics#drawEllipse has been renamed to Graphics#ellipse"),this._callContextMethod("ellipse",t)}drawPolygon(...t){return Y(Z,"Graphics#drawPolygon has been renamed to Graphics#poly"),this._callContextMethod("poly",t)}drawRect(...t){return Y(Z,"Graphics#drawRect has been renamed to Graphics#rect"),this._callContextMethod("rect",t)}drawRoundedRect(...t){return Y(Z,"Graphics#drawRoundedRect has been renamed to Graphics#roundRect"),this._callContextMethod("roundRect",t)}drawStar(...t){return Y(Z,"Graphics#drawStar has been renamed to Graphics#star"),this._callContextMethod("star",t)}}class tr extends Ht{constructor(...t){let e=t[0];Array.isArray(t[0])&&(e={textures:t[0],autoUpdate:t[1]});const{animationSpeed:r=1,autoPlay:n=!1,autoUpdate:i=!0,loop:o=!0,onComplete:a=null,onFrameChange:c=null,onLoop:h=null,textures:l,updateAnchor:d=!1,...f}=e,[u]=l;super({...f,texture:u instanceof $?u:u.texture}),this._textures=null,this._durations=null,this._autoUpdate=i,this._isConnectedToTicker=!1,this.animationSpeed=r,this.loop=o,this.updateAnchor=d,this.onComplete=a,this.onFrameChange=c,this.onLoop=h,this._currentTime=0,this._playing=!1,this._previousFrame=null,this.textures=l,n&&this.play()}stop(){this._playing&&(this._playing=!1,this._autoUpdate&&this._isConnectedToTicker&&(Ut.shared.remove(this.update,this),this._isConnectedToTicker=!1))}play(){this._playing||(this._playing=!0,this._autoUpdate&&!this._isConnectedToTicker&&(Ut.shared.add(this.update,this,Xs.HIGH),this._isConnectedToTicker=!0))}gotoAndStop(t){this.stop(),this.currentFrame=t}gotoAndPlay(t){this.currentFrame=t,this.play()}update(t){if(!this._playing)return;const e=t.deltaTime,r=this.animationSpeed*e,n=this.currentFrame;if(this._durations!==null){let i=this._currentTime%1*this._durations[this.currentFrame];for(i+=r/60*1e3;i<0;)this._currentTime--,i+=this._durations[this.currentFrame];const o=Math.sign(this.animationSpeed*e);for(this._currentTime=Math.floor(this._currentTime);i>=this._durations[this.currentFrame];)i-=this._durations[this.currentFrame]*o,this._currentTime+=o;this._currentTime+=i/this._durations[this.currentFrame]}else this._currentTime+=r;this._currentTime<0&&!this.loop?(this.gotoAndStop(0),this.onComplete&&this.onComplete()):this._currentTime>=this._textures.length&&!this.loop?(this.gotoAndStop(this._textures.length-1),this.onComplete&&this.onComplete()):n!==this.currentFrame&&(this.loop&&this.onLoop&&(this.animationSpeed>0&&this.currentFrame<n||this.animationSpeed<0&&this.currentFrame>n)&&this.onLoop(),this._updateTexture())}_updateTexture(){const t=this.currentFrame;this._previousFrame!==t&&(this._previousFrame=t,this.texture=this._textures[t],this.updateAnchor&&this.texture.defaultAnchor&&this.anchor.copyFrom(this.texture.defaultAnchor),this.onFrameChange&&this.onFrameChange(this.currentFrame))}destroy(){this.stop(),super.destroy(),this.onComplete=null,this.onFrameChange=null,this.onLoop=null}static fromFrames(t){const e=[];for(let r=0;r<t.length;++r)e.push($.from(t[r]));return new tr(e)}static fromImages(t){const e=[];for(let r=0;r<t.length;++r)e.push($.from(t[r]));return new tr(e)}get totalFrames(){return this._textures.length}get textures(){return this._textures}set textures(t){if(t[0]instanceof $)this._textures=t,this._durations=null;else{this._textures=[],this._durations=[];for(let e=0;e<t.length;e++)this._textures.push(t[e].texture),this._durations.push(t[e].time)}this._previousFrame=null,this.gotoAndStop(0),this._updateTexture()}get currentFrame(){let t=Math.floor(this._currentTime)%this._textures.length;return t<0&&(t+=this._textures.length),t}set currentFrame(t){if(t<0||t>this.totalFrames-1)throw new Error(`[AnimatedSprite]: Invalid frame index value ${t}, expected to be between 0 and totalFrames ${this.totalFrames}.`);const e=this.currentFrame;this._currentTime=t,e!==this.currentFrame&&this._updateTexture()}get playing(){return this._playing}get autoUpdate(){return this._autoUpdate}set autoUpdate(t){t!==this._autoUpdate&&(this._autoUpdate=t,!this._autoUpdate&&this._isConnectedToTicker?(Ut.shared.remove(this.update,this),this._isConnectedToTicker=!1):this._autoUpdate&&!this._isConnectedToTicker&&this._playing&&(Ut.shared.add(this.update,this),this._isConnectedToTicker=!0))}}class jf extends Tn{constructor(t,e){const{text:r,resolution:n,style:i,anchor:o,width:a,height:c,roundPixels:h,...l}=t;super({...l}),this.batched=!0,this._resolution=null,this._autoResolution=!0,this._didTextUpdate=!0,this._styleClass=e,this.text=r??"",this.style=i,this.resolution=n??null,this.allowChildren=!1,this._anchor=new bt({_onUpdate:()=>{this.onViewUpdate()}}),o&&(this.anchor=o),this.roundPixels=h??!1,a!==void 0&&(this.width=a),c!==void 0&&(this.height=c)}get anchor(){return this._anchor}set anchor(t){typeof t=="number"?this._anchor.set(t):this._anchor.copyFrom(t)}set text(t){t=t.toString(),this._text!==t&&(this._text=t,this.onViewUpdate())}get text(){return this._text}set resolution(t){this._autoResolution=t===null,this._resolution=t,this.onViewUpdate()}get resolution(){return this._resolution}get style(){return this._style}set style(t){var e;t||(t={}),(e=this._style)==null||e.off("update",this.onViewUpdate,this),t instanceof this._styleClass?this._style=t:this._style=new this._styleClass(t),this._style.on("update",this.onViewUpdate,this),this.onViewUpdate()}get width(){return Math.abs(this.scale.x)*this.bounds.width}set width(t){this._setWidth(t,this.bounds.width)}get height(){return Math.abs(this.scale.y)*this.bounds.height}set height(t){this._setHeight(t,this.bounds.height)}getSize(t){return t||(t={}),t.width=Math.abs(this.scale.x)*this.bounds.width,t.height=Math.abs(this.scale.y)*this.bounds.height,t}setSize(t,e){typeof t=="object"?(e=t.height??t.width,t=t.width):e??(e=t),t!==void 0&&this._setWidth(t,this.bounds.width),e!==void 0&&this._setHeight(e,this.bounds.height)}containsPoint(t){const e=this.bounds.width,r=this.bounds.height,n=-e*this.anchor.x;let i=0;return t.x>=n&&t.x<=n+e&&(i=-r*this.anchor.y,t.y>=i&&t.y<=i+r)}onViewUpdate(){this.didViewUpdate||(this._didTextUpdate=!0),super.onViewUpdate()}destroy(t=!1){super.destroy(t),this.owner=null,this._bounds=null,this._anchor=null,(typeof t=="boolean"?t:t!=null&&t.style)&&this._style.destroy(t),this._style=null,this._text=null}}function $f(s,t){let e=s[0]??{};return(typeof e=="string"||s[1])&&(Y(Z,`use new ${t}({ text: "hi!", style }) instead`),e={text:e,style:s[1]}),e}let ve=null,ie=null;function Vf(s,t){ve||(ve=ot.get().createCanvas(256,128),ie=ve.getContext("2d",{willReadFrequently:!0}),ie.globalCompositeOperation="copy",ie.globalAlpha=1),(ve.width<s||ve.height<t)&&(ve.width=We(s),ve.height=We(t))}function lo(s,t,e){for(let r=0,n=4*e*t;r<t;++r,n+=4)if(s[n+3]!==0)return!1;return!0}function ho(s,t,e,r,n){const i=4*t;for(let o=r,a=r*i+4*e;o<=n;++o,a+=i)if(s[a+3]!==0)return!1;return!0}function Yf(...s){let t=s[0];t.canvas||(t={canvas:s[0],resolution:s[1]});const{canvas:e}=t,r=Math.min(t.resolution??1,1),n=t.width??e.width,i=t.height??e.height;let o=t.output;if(Vf(n,i),!ie)throw new TypeError("Failed to get canvas 2D context");ie.drawImage(e,0,0,n,i,0,0,n*r,i*r);const c=ie.getImageData(0,0,n,i).data;let h=0,l=0,d=n-1,f=i-1;for(;l<i&&lo(c,n,l);)++l;if(l===i)return q.EMPTY;for(;lo(c,n,f);)--f;for(;ho(c,n,h,l,f);)++h;for(;ho(c,n,d,l,f);)--d;return++d,++f,ie.globalCompositeOperation="source-over",ie.strokeRect(h,l,d-h,f-l),ie.globalCompositeOperation="copy",o??(o=new q),o.set(h/r,l/r,(d-h)/r,(f-l)/r),o}const uo=new q;class Xf{getCanvasAndContext(t){const{text:e,style:r,resolution:n=1}=t,i=r._getFinalPadding(),o=qt.measureText(e||" ",r),a=Math.ceil(Math.ceil(Math.max(1,o.width)+i*2)*n),c=Math.ceil(Math.ceil(Math.max(1,o.height)+i*2)*n),h=Qs.getOptimalCanvasAndContext(a,c);this._renderTextToCanvas(e,r,i,n,h);const l=r.trim?Yf({canvas:h.canvas,width:a,height:c,resolution:1,output:uo}):uo.set(0,0,a,c);return{canvasAndContext:h,frame:l}}returnCanvasAndContext(t){Qs.returnCanvasAndContext(t)}_renderTextToCanvas(t,e,r,n,i){var b,w,_,S;const{canvas:o,context:a}=i,c=Ks(e),h=qt.measureText(t||" ",e),l=h.lines,d=h.lineHeight,f=h.lineWidths,u=h.maxLineWidth,p=h.fontProperties,g=o.height;if(a.resetTransform(),a.scale(n,n),a.textBaseline=e.textBaseline,(b=e._stroke)!=null&&b.width){const C=e._stroke;a.lineWidth=C.width,a.miterLimit=C.miterLimit,a.lineJoin=C.join,a.lineCap=C.cap}a.font=c;let m,y;const x=e.dropShadow?2:1;for(let C=0;C<x;++C){const M=e.dropShadow&&C===0,v=M?Math.ceil(Math.max(1,g)+r*2):0,k=v*n;if(M){a.fillStyle="black",a.strokeStyle="black";const E=e.dropShadow,R=E.color,F=E.alpha;a.shadowColor=ct.shared.setValue(R).setAlpha(F).toRgbaString();const T=E.blur*n,I=E.distance*n;a.shadowBlur=T,a.shadowOffsetX=Math.cos(E.angle)*I,a.shadowOffsetY=Math.sin(E.angle)*I+k}else{if(a.fillStyle=e._fill?Js(e._fill,a,h):null,(w=e._stroke)!=null&&w.width){const E=e._stroke.width*e._stroke.alignment;a.strokeStyle=Js(e._stroke,a,h,E)}a.shadowColor="black"}let A=(d-p.fontSize)/2;d-p.fontSize<0&&(A=0);const P=((_=e._stroke)==null?void 0:_.width)??0;for(let E=0;E<l.length;E++)m=P/2,y=P/2+E*d+p.ascent+A,e.align==="right"?m+=u-f[E]:e.align==="center"&&(m+=(u-f[E])/2),(S=e._stroke)!=null&&S.width&&this._drawLetterSpacing(l[E],e,i,m+r,y+r-v,!0),e._fill!==void 0&&this._drawLetterSpacing(l[E],e,i,m+r,y+r-v)}}_drawLetterSpacing(t,e,r,n,i,o=!1){const{context:a}=r,c=e.letterSpacing;let h=!1;if(qt.experimentalLetterSpacingSupported&&(qt.experimentalLetterSpacing?(a.letterSpacing=`${c}px`,a.textLetterSpacing=`${c}px`,h=!0):(a.letterSpacing="0px",a.textLetterSpacing="0px")),c===0||h){o?a.strokeText(t,n,i):a.fillText(t,n,i);return}let l=n;const d=qt.graphemeSegmenter(t);let f=a.measureText(t).width,u=0;for(let p=0;p<d.length;++p){const g=d[p];o?a.strokeText(g,l,i):a.fillText(g,l,i);let m="";for(let y=p+1;y<d.length;++y)m+=d[y];u=a.measureText(m).width,l+=f-u+c,f=u}}}const fo=new Xf;class Qt extends jf{constructor(...t){const e=$f(t,"Text");super(e,kt),this.renderPipeId="text",e.textureStyle&&(this.textureStyle=e.textureStyle instanceof je?e.textureStyle:new je(e.textureStyle))}updateBounds(){const t=this._bounds,e=this._anchor;let r=0,n=0;if(this._style.trim){const{frame:i,canvasAndContext:o}=fo.getCanvasAndContext({text:this.text,style:this._style,resolution:1});fo.returnCanvasAndContext(o),r=i.width,n=i.height}else{const i=qt.measureText(this._text,this._style);r=i.width,n=i.height}t.minX=-e._x*r,t.maxX=t.minX+r,t.minY=-e._y*n,t.maxY=t.minY+n}}ut.add(tl,el);const qf="game-imgs/btc-net-sim",po=["circle-btn","ctx-option","reset","zoom-btn-up","zoom-btn-dn","ms-default","ms-grabbing","ms-grab","ms-pointer","server-anim-coin","server-off"],Kf=()=>{const s={};return{createSprite:e=>new Ht(s[e]),getTexture:e=>s[e],load:async()=>{St.reset();for(const r of po)St.add({alias:r,src:`${qf}/${r}.png`});const e=await St.load(po);for(const r of Object.keys(e))s[r]=e[r],s[r].source.scaleMode="nearest"}}},Zf=()=>{const s={x:0,y:0},t=854,e=480;let r=1,n=1,i=1;return{getAppZeroPos:()=>s,virtWidth:t,virtHeight:e,getBaseScale:()=>r,updateBaseScaleFromScreen:({screenWidth:f,screenHeight:u})=>{const p=f/u,g=t/e;if(p>g){r=u/t;const m=(f-t*r)/2;s.x=m,s.y=0}else{r=f/t;const m=(u-e*r)/2;s.x=0,s.y=m}i=r*n},getGameScale:()=>i,zoom:f=>{const u=1+f;n=n*u,n<.4&&(n=.4),n>1.75&&(n=1.75)},setZoom:f=>{n=f,n<.4&&(n=.4),n>1.75&&(n=1.75)}}},Qf=s=>({resize:(t,e)=>{const{width:r,height:n}=t.screen;s.updateBaseScaleFromScreen({screenWidth:r,screenHeight:n});const i=s.getGameScale(),o=s.getAppZeroPos();e.scale.set(i,i),e.position.set(o.x,o.y)}}),Jf=s=>{const{gameVars:t,bounds:e,clampCamera:r=!0}=s,{app:n,game:i,scaler:o}=t,a={width:0,height:0};let c=0;return{lookAt:p=>{try{if(!p)return;a.width=n.screen.width,a.height=n.screen.height;let g=-p.x+a.width*.5,m=-p.y+a.height*.5;if(r){const x=-(e.width*o.getGameScale()-a.width);g=Math.min(Math.max(g,x),0);const _=-(e.height*o.getGameScale()-a.height);m=Math.min(Math.max(m,_),0)}i.position.set(g,m)}catch{}},viewport:a,zoom:p=>{c=p},resetZoom:()=>o.setZoom(1),update:p=>{c!==0&&(o.zoom(c*p.deltaMS),c=0)},setZoom:p=>o.setZoom(p)}};var As=(s=>(s[s.bottom=0]="bottom",s[s.mid=1]="mid",s[s.top=2]="top",s))(As||{});const tp=s=>{const t=new Map;return{connect:a=>{a.ip()!==s&&(t.has(a.ip())||t.set(a.ip(),a))},disconnect:()=>{t.clear()},connectCount:()=>t.size,isConnectedTo:a=>t.has(a.ip()),getAll:()=>{const a=[];for(const c of t.values())a.push(c);return a}}},ep=()=>{const s=[];return{clearTxs:()=>{s.length=0},hasTx:t=>s.some(e=>e.hash===t.hash),getAllTxs:()=>s,add:t=>s.push(t),displayJsonData:()=>sp()}},sp=()=>`{
  "inputs": [
    {
      "id": "utxo-abc123def456",
      "value": "50000000",
      "owner": "alice_address_xyz"
    },
    {
      "id": "utxo-ghi789jkl012",
      "value": "20000000",
      "owner": "alice_address_xyz"
    }
  ],
  "outputs": [
    {
      "id": "utxo-newTx123_0",
      "value": "60000000",
      "owner": "bob_address_pqr"
    },
    {
      "id": "utxo-newTx123_1",
      "value": "9990000",
      "owner": "alice_address_xyz"
    }
  ],
  "pubKey": "038e88e88e88e88e88e88e88e88e88e88e88e88e88e88e88e88e88e88e88e88e88",
  "fee": "10000",
  "sig": "3045022100a7b8f9d0c2e1d4b6a7c8e9f0a1b2c3d4e5f6a7b8c9d0e1f2a3b4c5d6e7f8a9b02200a7b8f9d0c2e1d4b6a7c8e9f0a1b2c3d4e5f6a7b8c9d0e1f2a3b4c5d6e7f8a9b0",
  "hash": "a1b2c3d4e5f6a7b8c9d0e1f2a3b4c5d6e7f8a9b0c1d2e3f4a5b6c7d8e9f0a1b2"
}`,Ne=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */function Hn(s){return s instanceof Uint8Array||ArrayBuffer.isView(s)&&s.constructor.name==="Uint8Array"}function bn(s){if(!Number.isSafeInteger(s)||s<0)throw new Error("positive integer expected, got "+s)}function he(s,...t){if(!Hn(s))throw new Error("Uint8Array expected");if(t.length>0&&!t.includes(s.length))throw new Error("Uint8Array expected of length "+t+", got length="+s.length)}function rp(s){if(typeof s!="function"||typeof s.create!="function")throw new Error("Hash should be wrapped by utils.createHasher");bn(s.outputLen),bn(s.blockLen)}function er(s,t=!0){if(s.destroyed)throw new Error("Hash instance has been destroyed");if(t&&s.finished)throw new Error("Hash#digest() has already been called")}function np(s,t){he(s);const e=t.outputLen;if(s.length<e)throw new Error("digestInto() expects output buffer of length at least "+e)}function Xe(...s){for(let t=0;t<s.length;t++)s[t].fill(0)}function Hr(s){return new DataView(s.buffer,s.byteOffset,s.byteLength)}function $t(s,t){return s<<32-t|s>>>t}function zs(s,t){return s<<t|s>>>32-t>>>0}const oc=typeof Uint8Array.from([]).toHex=="function"&&typeof Uint8Array.fromHex=="function",ip=Array.from({length:256},(s,t)=>t.toString(16).padStart(2,"0"));function ge(s){if(he(s),oc)return s.toHex();let t="";for(let e=0;e<s.length;e++)t+=ip[s[e]];return t}const se={_0:48,_9:57,A:65,F:70,a:97,f:102};function mo(s){if(s>=se._0&&s<=se._9)return s-se._0;if(s>=se.A&&s<=se.F)return s-(se.A-10);if(s>=se.a&&s<=se.f)return s-(se.a-10)}function Wn(s){if(typeof s!="string")throw new Error("hex string expected, got "+typeof s);if(oc)return Uint8Array.fromHex(s);const t=s.length,e=t/2;if(t%2)throw new Error("hex string expected, got unpadded hex of length "+t);const r=new Uint8Array(e);for(let n=0,i=0;n<e;n++,i+=2){const o=mo(s.charCodeAt(i)),a=mo(s.charCodeAt(i+1));if(o===void 0||a===void 0){const c=s[i]+s[i+1];throw new Error('hex string expected, got non-hex character "'+c+'" at index '+i)}r[n]=o*16+a}return r}function op(s){if(typeof s!="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(s))}function jn(s){return typeof s=="string"&&(s=op(s)),he(s),s}function Ee(...s){let t=0;for(let r=0;r<s.length;r++){const n=s[r];he(n),t+=n.length}const e=new Uint8Array(t);for(let r=0,n=0;r<s.length;r++){const i=s[r];e.set(i,n),n+=i.length}return e}class ac{}function cc(s){const t=r=>s().update(jn(r)).digest(),e=s();return t.outputLen=e.outputLen,t.blockLen=e.blockLen,t.create=()=>s(),t}function ap(s=32){if(Ne&&typeof Ne.getRandomValues=="function")return Ne.getRandomValues(new Uint8Array(s));if(Ne&&typeof Ne.randomBytes=="function")return Uint8Array.from(Ne.randomBytes(s));throw new Error("crypto.getRandomValues must be defined")}function cp(s,t,e,r){if(typeof s.setBigUint64=="function")return s.setBigUint64(t,e,r);const n=BigInt(32),i=BigInt(4294967295),o=Number(e>>n&i),a=Number(e&i),c=r?4:0,h=r?0:4;s.setUint32(t+c,o,r),s.setUint32(t+h,a,r)}function lp(s,t,e){return s&t^~s&e}function hp(s,t,e){return s&t^s&e^t&e}class lc extends ac{constructor(t,e,r,n){super(),this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.blockLen=t,this.outputLen=e,this.padOffset=r,this.isLE=n,this.buffer=new Uint8Array(t),this.view=Hr(this.buffer)}update(t){er(this),t=jn(t),he(t);const{view:e,buffer:r,blockLen:n}=this,i=t.length;for(let o=0;o<i;){const a=Math.min(n-this.pos,i-o);if(a===n){const c=Hr(t);for(;n<=i-o;o+=n)this.process(c,o);continue}r.set(t.subarray(o,o+a),this.pos),this.pos+=a,o+=a,this.pos===n&&(this.process(e,0),this.pos=0)}return this.length+=t.length,this.roundClean(),this}digestInto(t){er(this),np(t,this),this.finished=!0;const{buffer:e,view:r,blockLen:n,isLE:i}=this;let{pos:o}=this;e[o++]=128,Xe(this.buffer.subarray(o)),this.padOffset>n-o&&(this.process(r,0),o=0);for(let d=o;d<n;d++)e[d]=0;cp(r,n-8,BigInt(this.length*8),i),this.process(r,0);const a=Hr(t),c=this.outputLen;if(c%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const h=c/4,l=this.get();if(h>l.length)throw new Error("_sha2: outputLen bigger than state");for(let d=0;d<h;d++)a.setUint32(4*d,l[d],i)}digest(){const{buffer:t,outputLen:e}=this;this.digestInto(t);const r=t.slice(0,e);return this.destroy(),r}_cloneInto(t){t||(t=new this.constructor),t.set(...this.get());const{blockLen:e,buffer:r,length:n,finished:i,destroyed:o,pos:a}=this;return t.destroyed=o,t.finished=i,t.length=n,t.pos=a,n%e&&t.buffer.set(r),t}clone(){return this._cloneInto()}}const de=Uint32Array.from([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),dp=Uint32Array.from([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),ue=new Uint32Array(64);class up extends lc{constructor(t=32){super(64,t,8,!1),this.A=de[0]|0,this.B=de[1]|0,this.C=de[2]|0,this.D=de[3]|0,this.E=de[4]|0,this.F=de[5]|0,this.G=de[6]|0,this.H=de[7]|0}get(){const{A:t,B:e,C:r,D:n,E:i,F:o,G:a,H:c}=this;return[t,e,r,n,i,o,a,c]}set(t,e,r,n,i,o,a,c){this.A=t|0,this.B=e|0,this.C=r|0,this.D=n|0,this.E=i|0,this.F=o|0,this.G=a|0,this.H=c|0}process(t,e){for(let d=0;d<16;d++,e+=4)ue[d]=t.getUint32(e,!1);for(let d=16;d<64;d++){const f=ue[d-15],u=ue[d-2],p=$t(f,7)^$t(f,18)^f>>>3,g=$t(u,17)^$t(u,19)^u>>>10;ue[d]=g+ue[d-7]+p+ue[d-16]|0}let{A:r,B:n,C:i,D:o,E:a,F:c,G:h,H:l}=this;for(let d=0;d<64;d++){const f=$t(a,6)^$t(a,11)^$t(a,25),u=l+f+lp(a,c,h)+dp[d]+ue[d]|0,g=($t(r,2)^$t(r,13)^$t(r,22))+hp(r,n,i)|0;l=h,h=c,c=a,a=o+u|0,o=i,i=n,n=r,r=u+g|0}r=r+this.A|0,n=n+this.B|0,i=i+this.C|0,o=o+this.D|0,a=a+this.E|0,c=c+this.F|0,h=h+this.G|0,l=l+this.H|0,this.set(r,n,i,o,a,c,h,l)}roundClean(){Xe(ue)}destroy(){this.set(0,0,0,0,0,0,0,0),Xe(this.buffer)}}const sr=cc(()=>new up);class hc extends ac{constructor(t,e){super(),this.finished=!1,this.destroyed=!1,rp(t);const r=jn(e);if(this.iHash=t.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const n=this.blockLen,i=new Uint8Array(n);i.set(r.length>n?t.create().update(r).digest():r);for(let o=0;o<i.length;o++)i[o]^=54;this.iHash.update(i),this.oHash=t.create();for(let o=0;o<i.length;o++)i[o]^=106;this.oHash.update(i),Xe(i)}update(t){return er(this),this.iHash.update(t),this}digestInto(t){er(this),he(t,this.outputLen),this.finished=!0,this.iHash.digestInto(t),this.oHash.update(t),this.oHash.digestInto(t),this.destroy()}digest(){const t=new Uint8Array(this.oHash.outputLen);return this.digestInto(t),t}_cloneInto(t){t||(t=Object.create(Object.getPrototypeOf(this),{}));const{oHash:e,iHash:r,finished:n,destroyed:i,blockLen:o,outputLen:a}=this;return t=t,t.finished=n,t.destroyed=i,t.blockLen=o,t.outputLen=a,t.oHash=e._cloneInto(t.oHash),t.iHash=r._cloneInto(t.iHash),t}clone(){return this._cloneInto()}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}const dc=(s,t,e)=>new hc(s,t).update(e).digest();dc.create=(s,t)=>new hc(s,t);/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const $n=BigInt(0),wn=BigInt(1);function rr(s,t){if(typeof t!="boolean")throw new Error(s+" boolean expected, got "+t)}function Gs(s){const t=s.toString(16);return t.length&1?"0"+t:t}function uc(s){if(typeof s!="string")throw new Error("hex string expected, got "+typeof s);return s===""?$n:BigInt("0x"+s)}function dr(s){return uc(ge(s))}function fc(s){return he(s),uc(ge(Uint8Array.from(s).reverse()))}function Vn(s,t){return Wn(s.toString(16).padStart(t*2,"0"))}function pc(s,t){return Vn(s,t).reverse()}function Et(s,t,e){let r;if(typeof t=="string")try{r=Wn(t)}catch(i){throw new Error(s+" must be hex string or Uint8Array, cause: "+i)}else if(Hn(t))r=Uint8Array.from(t);else throw new Error(s+" must be hex string or Uint8Array");const n=r.length;if(typeof e=="number"&&n!==e)throw new Error(s+" of length "+e+" expected, got "+n);return r}const Wr=s=>typeof s=="bigint"&&$n<=s;function fp(s,t,e){return Wr(s)&&Wr(t)&&Wr(e)&&t<=s&&s<e}function pp(s,t,e,r){if(!fp(t,e,r))throw new Error("expected valid "+s+": "+e+" <= n < "+r+", got "+t)}function mp(s){let t;for(t=0;s>$n;s>>=wn,t+=1);return t}const ur=s=>(wn<<BigInt(s))-wn;function gp(s,t,e){if(typeof s!="number"||s<2)throw new Error("hashLen must be a number");if(typeof t!="number"||t<2)throw new Error("qByteLen must be a number");if(typeof e!="function")throw new Error("hmacFn must be a function");const r=u=>new Uint8Array(u),n=u=>Uint8Array.of(u);let i=r(s),o=r(s),a=0;const c=()=>{i.fill(1),o.fill(0),a=0},h=(...u)=>e(o,i,...u),l=(u=r(0))=>{o=h(n(0),u),i=h(),u.length!==0&&(o=h(n(1),u),i=h())},d=()=>{if(a++>=1e3)throw new Error("drbg: tried 1000 values");let u=0;const p=[];for(;u<t;){i=h();const g=i.slice();p.push(g),u+=i.length}return Ee(...p)};return(u,p)=>{c(),l(u);let g;for(;!(g=p(d()));)l();return c(),g}}function Yn(s,t,e={}){if(!s||typeof s!="object")throw new Error("expected valid options object");function r(n,i,o){const a=s[n];if(o&&a===void 0)return;const c=typeof a;if(c!==i||a===null)throw new Error(`param "${n}" is invalid: expected ${i}, got ${c}`)}Object.entries(t).forEach(([n,i])=>r(n,i,!1)),Object.entries(e).forEach(([n,i])=>r(n,i,!0))}function go(s){const t=new WeakMap;return(e,...r)=>{const n=t.get(e);if(n!==void 0)return n;const i=s(e,...r);return t.set(e,i),i}}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const _t=BigInt(0),gt=BigInt(1),Ie=BigInt(2),xp=BigInt(3),mc=BigInt(4),gc=BigInt(5),xc=BigInt(8);function It(s,t){const e=s%t;return e>=_t?e:t+e}function Tt(s,t,e){let r=s;for(;t-- >_t;)r*=r,r%=e;return r}function xo(s,t){if(s===_t)throw new Error("invert: expected non-zero number");if(t<=_t)throw new Error("invert: expected positive modulus, got "+t);let e=It(s,t),r=t,n=_t,i=gt;for(;e!==_t;){const a=r/e,c=r%e,h=n-i*a;r=e,e=c,n=i,i=h}if(r!==gt)throw new Error("invert: does not exist");return It(n,t)}function yc(s,t){const e=(s.ORDER+gt)/mc,r=s.pow(t,e);if(!s.eql(s.sqr(r),t))throw new Error("Cannot find square root");return r}function yp(s,t){const e=(s.ORDER-gc)/xc,r=s.mul(t,Ie),n=s.pow(r,e),i=s.mul(t,n),o=s.mul(s.mul(i,Ie),n),a=s.mul(i,s.sub(o,s.ONE));if(!s.eql(s.sqr(a),t))throw new Error("Cannot find square root");return a}function bp(s){if(s<BigInt(3))throw new Error("sqrt is not defined for small field");let t=s-gt,e=0;for(;t%Ie===_t;)t/=Ie,e++;let r=Ie;const n=fr(s);for(;yo(n,r)===1;)if(r++>1e3)throw new Error("Cannot find square root: probably non-prime P");if(e===1)return yc;let i=n.pow(r,t);const o=(t+gt)/Ie;return function(c,h){if(c.is0(h))return h;if(yo(c,h)!==1)throw new Error("Cannot find square root");let l=e,d=c.mul(c.ONE,i),f=c.pow(h,t),u=c.pow(h,o);for(;!c.eql(f,c.ONE);){if(c.is0(f))return c.ZERO;let p=1,g=c.sqr(f);for(;!c.eql(g,c.ONE);)if(p++,g=c.sqr(g),p===l)throw new Error("Cannot find square root");const m=gt<<BigInt(l-p-1),y=c.pow(d,m);l=p,d=c.sqr(y),f=c.mul(f,d),u=c.mul(u,y)}return u}}function wp(s){return s%mc===xp?yc:s%xc===gc?yp:bp(s)}const _p=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function vp(s){const t={ORDER:"bigint",MASK:"bigint",BYTES:"number",BITS:"number"},e=_p.reduce((r,n)=>(r[n]="function",r),t);return Yn(s,e),s}function Ap(s,t,e){if(e<_t)throw new Error("invalid exponent, negatives unsupported");if(e===_t)return s.ONE;if(e===gt)return t;let r=s.ONE,n=t;for(;e>_t;)e&gt&&(r=s.mul(r,n)),n=s.sqr(n),e>>=gt;return r}function bc(s,t,e=!1){const r=new Array(t.length).fill(e?s.ZERO:void 0),n=t.reduce((o,a,c)=>s.is0(a)?o:(r[c]=o,s.mul(o,a)),s.ONE),i=s.inv(n);return t.reduceRight((o,a,c)=>s.is0(a)?o:(r[c]=s.mul(o,r[c]),s.mul(o,a)),i),r}function yo(s,t){const e=(s.ORDER-gt)/Ie,r=s.pow(t,e),n=s.eql(r,s.ONE),i=s.eql(r,s.ZERO),o=s.eql(r,s.neg(s.ONE));if(!n&&!i&&!o)throw new Error("invalid Legendre symbol result");return n?1:i?0:-1}function Sp(s,t){t!==void 0&&bn(t);const e=t!==void 0?t:s.toString(2).length,r=Math.ceil(e/8);return{nBitLength:e,nByteLength:r}}function fr(s,t,e=!1,r={}){if(s<=_t)throw new Error("invalid field: expected ORDER > 0, got "+s);let n,i;if(typeof t=="object"&&t!=null){if(r.sqrt||e)throw new Error("cannot specify opts in two arguments");const l=t;l.BITS&&(n=l.BITS),l.sqrt&&(i=l.sqrt),typeof l.isLE=="boolean"&&(e=l.isLE)}else typeof t=="number"&&(n=t),r.sqrt&&(i=r.sqrt);const{nBitLength:o,nByteLength:a}=Sp(s,n);if(a>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");let c;const h=Object.freeze({ORDER:s,isLE:e,BITS:o,BYTES:a,MASK:ur(o),ZERO:_t,ONE:gt,create:l=>It(l,s),isValid:l=>{if(typeof l!="bigint")throw new Error("invalid field element: expected bigint, got "+typeof l);return _t<=l&&l<s},is0:l=>l===_t,isValidNot0:l=>!h.is0(l)&&h.isValid(l),isOdd:l=>(l&gt)===gt,neg:l=>It(-l,s),eql:(l,d)=>l===d,sqr:l=>It(l*l,s),add:(l,d)=>It(l+d,s),sub:(l,d)=>It(l-d,s),mul:(l,d)=>It(l*d,s),pow:(l,d)=>Ap(h,l,d),div:(l,d)=>It(l*xo(d,s),s),sqrN:l=>l*l,addN:(l,d)=>l+d,subN:(l,d)=>l-d,mulN:(l,d)=>l*d,inv:l=>xo(l,s),sqrt:i||(l=>(c||(c=wp(s)),c(h,l))),toBytes:l=>e?pc(l,a):Vn(l,a),fromBytes:l=>{if(l.length!==a)throw new Error("Field.fromBytes: expected "+a+" bytes, got "+l.length);return e?fc(l):dr(l)},invertBatch:l=>bc(h,l),cmov:(l,d,f)=>f?d:l});return Object.freeze(h)}function wc(s){if(typeof s!="bigint")throw new Error("field order must be bigint");const t=s.toString(2).length;return Math.ceil(t/8)}function _c(s){const t=wc(s);return t+Math.ceil(t/2)}function Cp(s,t,e=!1){const r=s.length,n=wc(t),i=_c(t);if(r<16||r<i||r>1024)throw new Error("expected "+i+"-1024 bytes of input, got "+r);const o=e?fc(s):dr(s),a=It(o,t-gt)+gt;return e?pc(a,n):Vn(a,n)}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const qe=BigInt(0),Be=BigInt(1);function ps(s,t){const e=t.negate();return s?e:t}function kp(s,t,e){const r=o=>o.pz,n=bc(s.Fp,e.map(r));return e.map((o,a)=>o.toAffine(n[a])).map(s.fromAffine)}function vc(s,t){if(!Number.isSafeInteger(s)||s<=0||s>t)throw new Error("invalid window size, expected [1.."+t+"], got W="+s)}function jr(s,t){vc(s,t);const e=Math.ceil(t/s)+1,r=2**(s-1),n=2**s,i=ur(s),o=BigInt(s);return{windows:e,windowSize:r,mask:i,maxNumber:n,shiftBy:o}}function bo(s,t,e){const{windowSize:r,mask:n,maxNumber:i,shiftBy:o}=e;let a=Number(s&n),c=s>>o;a>r&&(a-=i,c+=Be);const h=t*r,l=h+Math.abs(a)-1,d=a===0,f=a<0,u=t%2!==0;return{nextN:c,offset:l,isZero:d,isNeg:f,isNegF:u,offsetF:h}}function Mp(s,t){if(!Array.isArray(s))throw new Error("array expected");s.forEach((e,r)=>{if(!(e instanceof t))throw new Error("invalid point at index "+r)})}function Pp(s,t){if(!Array.isArray(s))throw new Error("array of scalars expected");s.forEach((e,r)=>{if(!t.isValid(e))throw new Error("invalid scalar at index "+r)})}const $r=new WeakMap,Ac=new WeakMap;function Vr(s){return Ac.get(s)||1}function wo(s){if(s!==qe)throw new Error("invalid wNAF")}function Tp(s,t){return{constTimeNegate:ps,hasPrecomputes(e){return Vr(e)!==1},unsafeLadder(e,r,n=s.ZERO){let i=e;for(;r>qe;)r&Be&&(n=n.add(i)),i=i.double(),r>>=Be;return n},precomputeWindow(e,r){const{windows:n,windowSize:i}=jr(r,t),o=[];let a=e,c=a;for(let h=0;h<n;h++){c=a,o.push(c);for(let l=1;l<i;l++)c=c.add(a),o.push(c);a=c.double()}return o},wNAF(e,r,n){let i=s.ZERO,o=s.BASE;const a=jr(e,t);for(let c=0;c<a.windows;c++){const{nextN:h,offset:l,isZero:d,isNeg:f,isNegF:u,offsetF:p}=bo(n,c,a);n=h,d?o=o.add(ps(u,r[p])):i=i.add(ps(f,r[l]))}return wo(n),{p:i,f:o}},wNAFUnsafe(e,r,n,i=s.ZERO){const o=jr(e,t);for(let a=0;a<o.windows&&n!==qe;a++){const{nextN:c,offset:h,isZero:l,isNeg:d}=bo(n,a,o);if(n=c,!l){const f=r[h];i=i.add(d?f.negate():f)}}return wo(n),i},getPrecomputes(e,r,n){let i=$r.get(r);return i||(i=this.precomputeWindow(r,e),e!==1&&(typeof n=="function"&&(i=n(i)),$r.set(r,i))),i},wNAFCached(e,r,n){const i=Vr(e);return this.wNAF(i,this.getPrecomputes(i,e,n),r)},wNAFCachedUnsafe(e,r,n,i){const o=Vr(e);return o===1?this.unsafeLadder(e,r,i):this.wNAFUnsafe(o,this.getPrecomputes(o,e,n),r,i)},setWindowSize(e,r){vc(r,t),Ac.set(e,r),$r.delete(e)}}}function Ep(s,t,e,r){let n=t,i=s.ZERO,o=s.ZERO;for(;e>qe||r>qe;)e&Be&&(i=i.add(n)),r&Be&&(o=o.add(n)),n=n.double(),e>>=Be,r>>=Be;return{p1:i,p2:o}}function Ip(s,t,e,r){Mp(e,s),Pp(r,t);const n=e.length,i=r.length;if(n!==i)throw new Error("arrays of points and scalars must have equal length");const o=s.ZERO,a=mp(BigInt(n));let c=1;a>12?c=a-3:a>4?c=a-2:a>0&&(c=2);const h=ur(c),l=new Array(Number(h)+1).fill(o),d=Math.floor((t.BITS-1)/c)*c;let f=o;for(let u=d;u>=0;u-=c){l.fill(o);for(let g=0;g<i;g++){const m=r[g],y=Number(m>>BigInt(u)&h);l[y]=l[y].add(e[g])}let p=o;for(let g=l.length-1,m=o;g>0;g--)m=m.add(l[g]),p=p.add(m);if(f=f.add(p),u!==0)for(let g=0;g<c;g++)f=f.double()}return f}function _o(s,t){if(t){if(t.ORDER!==s)throw new Error("Field.ORDER must match order: Fp == p, Fn == n");return vp(t),t}else return fr(s)}function Bp(s,t,e={}){if(!t||typeof t!="object")throw new Error(`expected valid ${s} CURVE object`);for(const a of["p","n","h"]){const c=t[a];if(!(typeof c=="bigint"&&c>qe))throw new Error(`CURVE.${a} must be positive bigint`)}const r=_o(t.p,e.Fp),n=_o(t.n,e.Fn),o=["Gx","Gy","a","b"];for(const a of o)if(!r.isValid(t[a]))throw new Error(`CURVE.${a} must be valid field element of CURVE.Fp`);return{Fp:r,Fn:n}}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */function vo(s){s.lowS!==void 0&&rr("lowS",s.lowS),s.prehash!==void 0&&rr("prehash",s.prehash)}class Rp extends Error{constructor(t=""){super(t)}}const oe={Err:Rp,_tlv:{encode:(s,t)=>{const{Err:e}=oe;if(s<0||s>256)throw new e("tlv.encode: wrong tag");if(t.length&1)throw new e("tlv.encode: unpadded data");const r=t.length/2,n=Gs(r);if(n.length/2&128)throw new e("tlv.encode: long form length too big");const i=r>127?Gs(n.length/2|128):"";return Gs(s)+i+n+t},decode(s,t){const{Err:e}=oe;let r=0;if(s<0||s>256)throw new e("tlv.encode: wrong tag");if(t.length<2||t[r++]!==s)throw new e("tlv.decode: wrong tlv");const n=t[r++],i=!!(n&128);let o=0;if(!i)o=n;else{const c=n&127;if(!c)throw new e("tlv.decode(long): indefinite length not supported");if(c>4)throw new e("tlv.decode(long): byte length is too big");const h=t.subarray(r,r+c);if(h.length!==c)throw new e("tlv.decode: length bytes not complete");if(h[0]===0)throw new e("tlv.decode(long): zero leftmost byte");for(const l of h)o=o<<8|l;if(r+=c,o<128)throw new e("tlv.decode(long): not minimal encoding")}const a=t.subarray(r,r+o);if(a.length!==o)throw new e("tlv.decode: wrong value length");return{v:a,l:t.subarray(r+o)}}},_int:{encode(s){const{Err:t}=oe;if(s<ms)throw new t("integer: negative integers are not allowed");let e=Gs(s);if(Number.parseInt(e[0],16)&8&&(e="00"+e),e.length&1)throw new t("unexpected DER parsing assertion: unpadded hex");return e},decode(s){const{Err:t}=oe;if(s[0]&128)throw new t("invalid signature integer: negative");if(s[0]===0&&!(s[1]&128))throw new t("invalid signature integer: unnecessary leading zero");return dr(s)}},toSig(s){const{Err:t,_int:e,_tlv:r}=oe,n=Et("signature",s),{v:i,l:o}=r.decode(48,n);if(o.length)throw new t("invalid signature: left bytes after parsing");const{v:a,l:c}=r.decode(2,i),{v:h,l}=r.decode(2,c);if(l.length)throw new t("invalid signature: left bytes after parsing");return{r:e.decode(a),s:e.decode(h)}},hexFromSig(s){const{_tlv:t,_int:e}=oe,r=t.encode(2,e.encode(s.r)),n=t.encode(2,e.encode(s.s)),i=r+n;return t.encode(48,i)}},ms=BigInt(0),gs=BigInt(1),Fp=BigInt(2),Ns=BigInt(3),Lp=BigInt(4);function zp(s,t,e){function r(n){const i=s.sqr(n),o=s.mul(i,n);return s.add(s.add(o,s.mul(n,t)),e)}return r}function Sc(s,t,e){const{BYTES:r}=s;function n(i){let o;if(typeof i=="bigint")o=i;else{let a=Et("private key",i);if(t){if(!t.includes(a.length*2))throw new Error("invalid private key");const c=new Uint8Array(r);c.set(a,c.length-a.length),a=c}try{o=s.fromBytes(a)}catch{throw new Error(`invalid private key: expected ui8a of size ${r}, got ${typeof i}`)}}if(e&&(o=s.create(o)),!s.isValidNot0(o))throw new Error("invalid private key: out of range [1..N-1]");return o}return n}function Gp(s,t={}){const{Fp:e,Fn:r}=Bp("weierstrass",s,t),{h:n,n:i}=s;Yn(t,{},{allowInfinityPoint:"boolean",clearCofactor:"function",isTorsionFree:"function",fromBytes:"function",toBytes:"function",endo:"object",wrapPrivateKey:"boolean"});const{endo:o}=t;if(o&&(!e.is0(s.a)||typeof o.beta!="bigint"||typeof o.splitScalar!="function"))throw new Error('invalid endo: expected "beta": bigint and "splitScalar": function');function a(){if(!e.isOdd)throw new Error("compression is not supported: Field does not have .isOdd()")}function c(M,v,k){const{x:A,y:P}=v.toAffine(),E=e.toBytes(A);if(rr("isCompressed",k),k){a();const R=!e.isOdd(P);return Ee(Cc(R),E)}else return Ee(Uint8Array.of(4),E,e.toBytes(P))}function h(M){he(M);const v=e.BYTES,k=v+1,A=2*v+1,P=M.length,E=M[0],R=M.subarray(1);if(P===k&&(E===2||E===3)){const F=e.fromBytes(R);if(!e.isValid(F))throw new Error("bad point: is not on curve, wrong x");const T=f(F);let I;try{I=e.sqrt(T)}catch(W){const U=W instanceof Error?": "+W.message:"";throw new Error("bad point: is not on curve, sqrt error"+U)}a();const B=e.isOdd(I);return(E&1)===1!==B&&(I=e.neg(I)),{x:F,y:I}}else if(P===A&&E===4){const F=e.fromBytes(R.subarray(v*0,v*1)),T=e.fromBytes(R.subarray(v*1,v*2));if(!u(F,T))throw new Error("bad point: is not on curve");return{x:F,y:T}}else throw new Error(`bad point: got length ${P}, expected compressed=${k} or uncompressed=${A}`)}const l=t.toBytes||c,d=t.fromBytes||h,f=zp(e,s.a,s.b);function u(M,v){const k=e.sqr(v),A=f(M);return e.eql(k,A)}if(!u(s.Gx,s.Gy))throw new Error("bad curve params: generator point");const p=e.mul(e.pow(s.a,Ns),Lp),g=e.mul(e.sqr(s.b),BigInt(27));if(e.is0(e.add(p,g)))throw new Error("bad curve params: a or b");function m(M,v,k=!1){if(!e.isValid(v)||k&&e.is0(v))throw new Error(`bad point coordinate ${M}`);return v}function y(M){if(!(M instanceof _))throw new Error("ProjectivePoint expected")}const x=go((M,v)=>{const{px:k,py:A,pz:P}=M;if(e.eql(P,e.ONE))return{x:k,y:A};const E=M.is0();v==null&&(v=E?e.ONE:e.inv(P));const R=e.mul(k,v),F=e.mul(A,v),T=e.mul(P,v);if(E)return{x:e.ZERO,y:e.ZERO};if(!e.eql(T,e.ONE))throw new Error("invZ was invalid");return{x:R,y:F}}),b=go(M=>{if(M.is0()){if(t.allowInfinityPoint&&!e.is0(M.py))return;throw new Error("bad point: ZERO")}const{x:v,y:k}=M.toAffine();if(!e.isValid(v)||!e.isValid(k))throw new Error("bad point: x or y not field elements");if(!u(v,k))throw new Error("bad point: equation left != right");if(!M.isTorsionFree())throw new Error("bad point: not in prime-order subgroup");return!0});function w(M,v,k,A,P){return k=new _(e.mul(k.px,M),k.py,k.pz),v=ps(A,v),k=ps(P,k),v.add(k)}class _{constructor(v,k,A){this.px=m("x",v),this.py=m("y",k,!0),this.pz=m("z",A),Object.freeze(this)}static fromAffine(v){const{x:k,y:A}=v||{};if(!v||!e.isValid(k)||!e.isValid(A))throw new Error("invalid affine point");if(v instanceof _)throw new Error("projective point not allowed");return e.is0(k)&&e.is0(A)?_.ZERO:new _(k,A,e.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(v){return kp(_,"pz",v)}static fromBytes(v){return he(v),_.fromHex(v)}static fromHex(v){const k=_.fromAffine(d(Et("pointHex",v)));return k.assertValidity(),k}static fromPrivateKey(v){const k=Sc(r,t.allowedPrivateKeyLengths,t.wrapPrivateKey);return _.BASE.multiply(k(v))}static msm(v,k){return Ip(_,r,v,k)}precompute(v=8,k=!0){return C.setWindowSize(this,v),k||this.multiply(Ns),this}_setWindowSize(v){this.precompute(v)}assertValidity(){b(this)}hasEvenY(){const{y:v}=this.toAffine();if(!e.isOdd)throw new Error("Field doesn't support isOdd");return!e.isOdd(v)}equals(v){y(v);const{px:k,py:A,pz:P}=this,{px:E,py:R,pz:F}=v,T=e.eql(e.mul(k,F),e.mul(E,P)),I=e.eql(e.mul(A,F),e.mul(R,P));return T&&I}negate(){return new _(this.px,e.neg(this.py),this.pz)}double(){const{a:v,b:k}=s,A=e.mul(k,Ns),{px:P,py:E,pz:R}=this;let F=e.ZERO,T=e.ZERO,I=e.ZERO,B=e.mul(P,P),D=e.mul(E,E),W=e.mul(R,R),U=e.mul(P,E);return U=e.add(U,U),I=e.mul(P,R),I=e.add(I,I),F=e.mul(v,I),T=e.mul(A,W),T=e.add(F,T),F=e.sub(D,T),T=e.add(D,T),T=e.mul(F,T),F=e.mul(U,F),I=e.mul(A,I),W=e.mul(v,W),U=e.sub(B,W),U=e.mul(v,U),U=e.add(U,I),I=e.add(B,B),B=e.add(I,B),B=e.add(B,W),B=e.mul(B,U),T=e.add(T,B),W=e.mul(E,R),W=e.add(W,W),B=e.mul(W,U),F=e.sub(F,B),I=e.mul(W,D),I=e.add(I,I),I=e.add(I,I),new _(F,T,I)}add(v){y(v);const{px:k,py:A,pz:P}=this,{px:E,py:R,pz:F}=v;let T=e.ZERO,I=e.ZERO,B=e.ZERO;const D=s.a,W=e.mul(s.b,Ns);let U=e.mul(k,E),Q=e.mul(A,R),H=e.mul(P,F),K=e.add(k,A),V=e.add(E,R);K=e.mul(K,V),V=e.add(U,Q),K=e.sub(K,V),V=e.add(k,P);let tt=e.add(E,F);return V=e.mul(V,tt),tt=e.add(U,H),V=e.sub(V,tt),tt=e.add(A,P),T=e.add(R,F),tt=e.mul(tt,T),T=e.add(Q,H),tt=e.sub(tt,T),B=e.mul(D,V),T=e.mul(W,H),B=e.add(T,B),T=e.sub(Q,B),B=e.add(Q,B),I=e.mul(T,B),Q=e.add(U,U),Q=e.add(Q,U),H=e.mul(D,H),V=e.mul(W,V),Q=e.add(Q,H),H=e.sub(U,H),H=e.mul(D,H),V=e.add(V,H),U=e.mul(Q,V),I=e.add(I,U),U=e.mul(tt,V),T=e.mul(K,T),T=e.sub(T,U),U=e.mul(K,Q),B=e.mul(tt,B),B=e.add(B,U),new _(T,I,B)}subtract(v){return this.add(v.negate())}is0(){return this.equals(_.ZERO)}multiply(v){const{endo:k}=t;if(!r.isValidNot0(v))throw new Error("invalid scalar: out of range");let A,P;const E=R=>C.wNAFCached(this,R,_.normalizeZ);if(k){const{k1neg:R,k1:F,k2neg:T,k2:I}=k.splitScalar(v),{p:B,f:D}=E(F),{p:W,f:U}=E(I);P=D.add(U),A=w(k.beta,B,W,R,T)}else{const{p:R,f:F}=E(v);A=R,P=F}return _.normalizeZ([A,P])[0]}multiplyUnsafe(v){const{endo:k}=t,A=this;if(!r.isValid(v))throw new Error("invalid scalar: out of range");if(v===ms||A.is0())return _.ZERO;if(v===gs)return A;if(C.hasPrecomputes(this))return this.multiply(v);if(k){const{k1neg:P,k1:E,k2neg:R,k2:F}=k.splitScalar(v),{p1:T,p2:I}=Ep(_,A,E,F);return w(k.beta,T,I,P,R)}else return C.wNAFCachedUnsafe(A,v)}multiplyAndAddUnsafe(v,k,A){const P=this.multiplyUnsafe(k).add(v.multiplyUnsafe(A));return P.is0()?void 0:P}toAffine(v){return x(this,v)}isTorsionFree(){const{isTorsionFree:v}=t;return n===gs?!0:v?v(_,this):C.wNAFCachedUnsafe(this,i).is0()}clearCofactor(){const{clearCofactor:v}=t;return n===gs?this:v?v(_,this):this.multiplyUnsafe(n)}toBytes(v=!0){return rr("isCompressed",v),this.assertValidity(),l(_,this,v)}toRawBytes(v=!0){return this.toBytes(v)}toHex(v=!0){return ge(this.toBytes(v))}toString(){return`<Point ${this.is0()?"ZERO":this.toHex()}>`}}_.BASE=new _(s.Gx,s.Gy,e.ONE),_.ZERO=new _(e.ZERO,e.ONE,e.ZERO),_.Fp=e,_.Fn=r;const S=r.BITS,C=Tp(_,t.endo?Math.ceil(S/2):S);return _}function Cc(s){return Uint8Array.of(s?2:3)}function Np(s,t,e={}){Yn(t,{hash:"function"},{hmac:"function",lowS:"boolean",randomBytes:"function",bits2int:"function",bits2int_modN:"function"});const r=t.randomBytes||ap,n=t.hmac||((A,...P)=>dc(t.hash,A,Ee(...P))),{Fp:i,Fn:o}=s,{ORDER:a,BITS:c}=o;function h(A){const P=a>>gs;return A>P}function l(A){return h(A)?o.neg(A):A}function d(A,P){if(!o.isValidNot0(P))throw new Error(`invalid signature ${A}: out of range 1..CURVE.n`)}class f{constructor(P,E,R){d("r",P),d("s",E),this.r=P,this.s=E,R!=null&&(this.recovery=R),Object.freeze(this)}static fromCompact(P){const E=o.BYTES,R=Et("compactSignature",P,E*2);return new f(o.fromBytes(R.subarray(0,E)),o.fromBytes(R.subarray(E,E*2)))}static fromDER(P){const{r:E,s:R}=oe.toSig(Et("DER",P));return new f(E,R)}assertValidity(){}addRecoveryBit(P){return new f(this.r,this.s,P)}recoverPublicKey(P){const E=i.ORDER,{r:R,s:F,recovery:T}=this;if(T==null||![0,1,2,3].includes(T))throw new Error("recovery id invalid");if(a*Fp<E&&T>1)throw new Error("recovery id is ambiguous for h>1 curve");const B=T===2||T===3?R+a:R;if(!i.isValid(B))throw new Error("recovery id 2 or 3 invalid");const D=i.toBytes(B),W=s.fromHex(Ee(Cc((T&1)===0),D)),U=o.inv(B),Q=b(Et("msgHash",P)),H=o.create(-Q*U),K=o.create(F*U),V=s.BASE.multiplyUnsafe(H).add(W.multiplyUnsafe(K));if(V.is0())throw new Error("point at infinify");return V.assertValidity(),V}hasHighS(){return h(this.s)}normalizeS(){return this.hasHighS()?new f(this.r,o.neg(this.s),this.recovery):this}toBytes(P){if(P==="compact")return Ee(o.toBytes(this.r),o.toBytes(this.s));if(P==="der")return Wn(oe.hexFromSig(this));throw new Error("invalid format")}toDERRawBytes(){return this.toBytes("der")}toDERHex(){return ge(this.toBytes("der"))}toCompactRawBytes(){return this.toBytes("compact")}toCompactHex(){return ge(this.toBytes("compact"))}}const u=Sc(o,e.allowedPrivateKeyLengths,e.wrapPrivateKey),p={isValidPrivateKey(A){try{return u(A),!0}catch{return!1}},normPrivateKeyToScalar:u,randomPrivateKey:()=>{const A=a;return Cp(r(_c(A)),A)},precompute(A=8,P=s.BASE){return P.precompute(A,!1)}};function g(A,P=!0){return s.fromPrivateKey(A).toBytes(P)}function m(A){if(typeof A=="bigint")return!1;if(A instanceof s)return!0;const E=Et("key",A).length,R=i.BYTES,F=R+1,T=2*R+1;if(!(e.allowedPrivateKeyLengths||o.BYTES===F))return E===F||E===T}function y(A,P,E=!0){if(m(A)===!0)throw new Error("first arg must be private key");if(m(P)===!1)throw new Error("second arg must be public key");return s.fromHex(P).multiply(u(A)).toBytes(E)}const x=t.bits2int||function(A){if(A.length>8192)throw new Error("input is too large");const P=dr(A),E=A.length*8-c;return E>0?P>>BigInt(E):P},b=t.bits2int_modN||function(A){return o.create(x(A))},w=ur(c);function _(A){return pp("num < 2^"+c,A,ms,w),o.toBytes(A)}function S(A,P,E=C){if(["recovered","canonical"].some(K=>K in E))throw new Error("sign() legacy options not supported");const{hash:R}=t;let{lowS:F,prehash:T,extraEntropy:I}=E;F==null&&(F=!0),A=Et("msgHash",A),vo(E),T&&(A=Et("prehashed msgHash",R(A)));const B=b(A),D=u(P),W=[_(D),_(B)];if(I!=null&&I!==!1){const K=I===!0?r(i.BYTES):I;W.push(Et("extraEntropy",K))}const U=Ee(...W),Q=B;function H(K){const V=x(K);if(!o.isValidNot0(V))return;const tt=o.inv(V),J=s.BASE.multiply(V).toAffine(),Mt=o.create(J.x);if(Mt===ms)return;const dt=o.create(tt*o.create(Q+Mt*D));if(dt===ms)return;let vt=(J.x===Mt?0:2)|Number(J.y&gs),xt=dt;return F&&h(dt)&&(xt=l(dt),vt^=1),new f(Mt,xt,vt)}return{seed:U,k2sig:H}}const C={lowS:t.lowS,prehash:!1},M={lowS:t.lowS,prehash:!1};function v(A,P,E=C){const{seed:R,k2sig:F}=S(A,P,E);return gp(t.hash.outputLen,o.BYTES,n)(R,F)}s.BASE.precompute(8);function k(A,P,E,R=M){const F=A;P=Et("msgHash",P),E=Et("publicKey",E),vo(R);const{lowS:T,prehash:I,format:B}=R;if("strict"in R)throw new Error("options.strict was renamed to lowS");if(B!==void 0&&!["compact","der","js"].includes(B))throw new Error('format must be "compact", "der" or "js"');const D=typeof F=="string"||Hn(F),W=!D&&!B&&typeof F=="object"&&F!==null&&typeof F.r=="bigint"&&typeof F.s=="bigint";if(!D&&!W)throw new Error("invalid signature, expected Uint8Array, hex string or Signature instance");let U,Q;try{if(W)if(B===void 0||B==="js")U=new f(F.r,F.s);else throw new Error("invalid format");if(D){try{B!=="compact"&&(U=f.fromDER(F))}catch(xt){if(!(xt instanceof oe.Err))throw xt}!U&&B!=="der"&&(U=f.fromCompact(F))}Q=s.fromHex(E)}catch{return!1}if(!U||T&&U.hasHighS())return!1;I&&(P=t.hash(P));const{r:H,s:K}=U,V=b(P),tt=o.inv(K),J=o.create(V*tt),Mt=o.create(H*tt),dt=s.BASE.multiplyUnsafe(J).add(Q.multiplyUnsafe(Mt));return dt.is0()?!1:o.create(dt.x)===H}return Object.freeze({getPublicKey:g,getSharedSecret:y,sign:v,verify:k,utils:p,Point:s,Signature:f})}function Op(s){const t={a:s.a,b:s.b,p:s.Fp.ORDER,n:s.n,h:s.h,Gx:s.Gx,Gy:s.Gy},e=s.Fp,r=fr(t.n,s.nBitLength),n={Fp:e,Fn:r,allowedPrivateKeyLengths:s.allowedPrivateKeyLengths,allowInfinityPoint:s.allowInfinityPoint,endo:s.endo,wrapPrivateKey:s.wrapPrivateKey,isTorsionFree:s.isTorsionFree,clearCofactor:s.clearCofactor,fromBytes:s.fromBytes,toBytes:s.toBytes};return{CURVE:t,curveOpts:n}}function Up(s){const{CURVE:t,curveOpts:e}=Op(s),r={hash:s.hash,hmac:s.hmac,randomBytes:s.randomBytes,lowS:s.lowS,bits2int:s.bits2int,bits2int_modN:s.bits2int_modN};return{CURVE:t,curveOpts:e,ecdsaOpts:r}}function Dp(s,t){return Object.assign({},t,{ProjectivePoint:t.Point,CURVE:s})}function Hp(s){const{CURVE:t,curveOpts:e,ecdsaOpts:r}=Up(s),n=Gp(t,e),i=Np(n,r,e);return Dp(s,i)}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */function Wp(s,t){const e=r=>Hp({...s,hash:r});return{...e(t),create:e}}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const nr={p:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),n:BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),h:BigInt(1),a:BigInt(0),b:BigInt(7),Gx:BigInt("0x79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798"),Gy:BigInt("0x483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8")};BigInt(0);const jp=BigInt(1),_n=BigInt(2),Ao=(s,t)=>(s+t/_n)/t;function $p(s){const t=nr.p,e=BigInt(3),r=BigInt(6),n=BigInt(11),i=BigInt(22),o=BigInt(23),a=BigInt(44),c=BigInt(88),h=s*s*s%t,l=h*h*s%t,d=Tt(l,e,t)*l%t,f=Tt(d,e,t)*l%t,u=Tt(f,_n,t)*h%t,p=Tt(u,n,t)*u%t,g=Tt(p,i,t)*p%t,m=Tt(g,a,t)*g%t,y=Tt(m,c,t)*m%t,x=Tt(y,a,t)*g%t,b=Tt(x,e,t)*l%t,w=Tt(b,o,t)*p%t,_=Tt(w,r,t)*h%t,S=Tt(_,_n,t);if(!vn.eql(vn.sqr(S),s))throw new Error("Cannot find square root");return S}const vn=fr(nr.p,void 0,void 0,{sqrt:$p}),Yr=Wp({...nr,Fp:vn,lowS:!0,endo:{beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar:s=>{const t=nr.n,e=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),r=-jp*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),n=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),i=e,o=BigInt("0x100000000000000000000000000000000"),a=Ao(i*s,t),c=Ao(-r*s,t);let h=It(s-a*e-c*n,t),l=It(-a*r-c*i,t);const d=h>o,f=l>o;if(d&&(h=t-h),f&&(l=t-l),h>o||l>o)throw new Error("splitScalar: Endomorphism failed, k="+s);return{k1neg:d,k1:h,k2neg:f,k2:l}}}},sr),Vp=Uint8Array.from([7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8]),kc=Uint8Array.from(new Array(16).fill(0).map((s,t)=>t)),Yp=kc.map(s=>(9*s+5)%16),Mc=(()=>{const e=[[kc],[Yp]];for(let r=0;r<4;r++)for(let n of e)n.push(n[r].map(i=>Vp[i]));return e})(),Pc=Mc[0],Tc=Mc[1],Ec=[[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8],[12,13,11,15,6,9,9,7,12,15,11,13,7,8,7,7],[13,15,14,11,7,7,6,8,13,14,13,12,5,5,6,9],[14,11,12,14,8,6,5,5,15,12,15,14,9,9,8,6],[15,12,13,13,9,5,8,6,14,11,12,11,8,6,5,5]].map(s=>Uint8Array.from(s)),Xp=Pc.map((s,t)=>s.map(e=>Ec[t][e])),qp=Tc.map((s,t)=>s.map(e=>Ec[t][e])),Kp=Uint32Array.from([0,1518500249,1859775393,2400959708,2840853838]),Zp=Uint32Array.from([1352829926,1548603684,1836072691,2053994217,0]);function So(s,t,e,r){return s===0?t^e^r:s===1?t&e|~t&r:s===2?(t|~e)^r:s===3?t&r|e&~r:t^(e|~r)}const Os=new Uint32Array(16);class Qp extends lc{constructor(){super(64,20,8,!0),this.h0=1732584193,this.h1=-271733879,this.h2=-1732584194,this.h3=271733878,this.h4=-1009589776}get(){const{h0:t,h1:e,h2:r,h3:n,h4:i}=this;return[t,e,r,n,i]}set(t,e,r,n,i){this.h0=t|0,this.h1=e|0,this.h2=r|0,this.h3=n|0,this.h4=i|0}process(t,e){for(let u=0;u<16;u++,e+=4)Os[u]=t.getUint32(e,!0);let r=this.h0|0,n=r,i=this.h1|0,o=i,a=this.h2|0,c=a,h=this.h3|0,l=h,d=this.h4|0,f=d;for(let u=0;u<5;u++){const p=4-u,g=Kp[u],m=Zp[u],y=Pc[u],x=Tc[u],b=Xp[u],w=qp[u];for(let _=0;_<16;_++){const S=zs(r+So(u,i,a,h)+Os[y[_]]+g,b[_])+d|0;r=d,d=h,h=zs(a,10)|0,a=i,i=S}for(let _=0;_<16;_++){const S=zs(n+So(p,o,c,l)+Os[x[_]]+m,w[_])+f|0;n=f,f=l,l=zs(c,10)|0,c=o,o=S}}this.set(this.h1+a+l|0,this.h2+h+f|0,this.h3+d+n|0,this.h4+r+o|0,this.h0+i+c|0)}roundClean(){Xe(Os)}destroy(){this.destroyed=!0,Xe(this.buffer),this.set(0,0,0,0,0)}}const Jp=cc(()=>new Qp);var Ae={},Co;function tm(){if(Co)return Ae;Co=1,Object.defineProperty(Ae,"__esModule",{value:!0}),Ae.bech32m=Ae.bech32=void 0;const s="qpzry9x8gf2tvdw0s3jn54khce6mua7l",t={};for(let h=0;h<s.length;h++){const l=s.charAt(h);t[l]=h}function e(h){const l=h>>25;return(h&33554431)<<5^-(l>>0&1)&996825010^-(l>>1&1)&642813549^-(l>>2&1)&513874426^-(l>>3&1)&1027748829^-(l>>4&1)&705979059}function r(h){let l=1;for(let d=0;d<h.length;++d){const f=h.charCodeAt(d);if(f<33||f>126)return"Invalid prefix ("+h+")";l=e(l)^f>>5}l=e(l);for(let d=0;d<h.length;++d){const f=h.charCodeAt(d);l=e(l)^f&31}return l}function n(h,l,d,f){let u=0,p=0;const g=(1<<d)-1,m=[];for(let y=0;y<h.length;++y)for(u=u<<l|h[y],p+=l;p>=d;)p-=d,m.push(u>>p&g);if(f)p>0&&m.push(u<<d-p&g);else{if(p>=l)return"Excess padding";if(u<<d-p&g)return"Non-zero padding"}return m}function i(h){return n(h,8,5,!0)}function o(h){const l=n(h,5,8,!1);if(Array.isArray(l))return l}function a(h){const l=n(h,5,8,!1);if(Array.isArray(l))return l;throw new Error(l)}function c(h){let l;h==="bech32"?l=1:l=734539939;function d(g,m,y){if(y=y||90,g.length+7+m.length>y)throw new TypeError("Exceeds length limit");g=g.toLowerCase();let x=r(g);if(typeof x=="string")throw new Error(x);let b=g+"1";for(let w=0;w<m.length;++w){const _=m[w];if(_>>5!==0)throw new Error("Non 5-bit word");x=e(x)^_,b+=s.charAt(_)}for(let w=0;w<6;++w)x=e(x);x^=l;for(let w=0;w<6;++w){const _=x>>(5-w)*5&31;b+=s.charAt(_)}return b}function f(g,m){if(m=m||90,g.length<8)return g+" too short";if(g.length>m)return"Exceeds length limit";const y=g.toLowerCase(),x=g.toUpperCase();if(g!==y&&g!==x)return"Mixed-case string "+g;g=y;const b=g.lastIndexOf("1");if(b===-1)return"No separator character for "+g;if(b===0)return"Missing prefix for "+g;const w=g.slice(0,b),_=g.slice(b+1);if(_.length<6)return"Data too short";let S=r(w);if(typeof S=="string")return S;const C=[];for(let M=0;M<_.length;++M){const v=_.charAt(M),k=t[v];if(k===void 0)return"Unknown character "+v;S=e(S)^k,!(M+6>=_.length)&&C.push(k)}return S!==l?"Invalid checksum for "+g:{prefix:w,words:C}}function u(g,m){const y=f(g,m);if(typeof y=="object")return y}function p(g,m){const y=f(g,m);if(typeof y=="object")return y;throw new Error(y)}return{decodeUnsafe:u,decode:p,encode:d,toWords:i,fromWordsUnsafe:o,fromWords:a}}return Ae.bech32=c("bech32"),Ae.bech32m=c("bech32m"),Ae}var ko=tm();const Nt={idStr:()=>crypto.randomUUID().replaceAll("-","").slice(0,25),numAsStr:s=>s.toFixed(8),hash:s=>{const t=typeof s=="object"?JSON.stringify(s):`${s}`,e=new TextEncoder().encode(t),r=sr(e);return ge(r)},round:s=>Math.round(s*1e9)/1e9,randomIp:()=>{const s=r=>{const[n,i]=r.split(".").map(Number);return n===10||n===172&&i>=16&&i<=31||n===192&&i===168},t=()=>{const r=Kt({min:65,max:172}),n=Kt({min:20,max:256}),i=Kt({min:20,max:256}),o=Kt({min:20,max:256});return`${r}.${n}.${i}.${o}`};let e;do e=t();while(s(e));return e}},Kt=s=>{const{min:t,max:e,decimal:r=!1}=s,n=Math.random()*(e-t+1)+t;return r?n:Math.floor(n)},em=()=>{const s=Yr.utils.randomPrivateKey(),t=Yr.getPublicKey(s,!0),e=ge(t);let r=[];const n=l=>{let d=0;for(let f=0;f<l.length;f++)d+=l[f];return Nt.round(d)},i=()=>n(r.map(l=>Number(l.value))),o=(()=>{const l=Jp(sr(t)),d=ko.bech32.toWords(l);return d.unshift(0),`addr${ko.bech32.encode("tb",d)}`})(),a=l=>{let d;for(const f of r){if(!d){d=f;continue}const u=Math.abs(l-Number(d.value));Math.abs(l-Number(f.value))<u&&(d=f)}return d},c=({units:l,recAddr:d})=>{const f=l*.0012345;if(i()<l+f){const S=`NSF ERROR
addr: ${o}
 balance: ${i()}`;throw new Error(S)}r.sort((S,C)=>Number(S.value)-Number(C.value));const u=[],p=()=>n(u.map(S=>Number(S.value)));for(;p()<l+f;){const S=l-p(),C=a(S);if(!C)throw new Error("unknown reason utxo not found :(");r=r.filter(M=>M.id!==C.id),u.push(C)}const g=S=>{const C=JSON.stringify(S),M=sr(new TextEncoder().encode(C)),v=Yr.sign(M,s).toDERRawBytes();return ge(v)},m={inputs:u,outputs:[{id:Nt.idStr(),value:Nt.numAsStr(l),owner:d}],pubKey:e,fee:Nt.numAsStr(f)},x=u.map(S=>Number(S.value)).reduce((S,C)=>S+C)-(l+f);x>0&&m.outputs.push({id:Nt.idStr(),value:Nt.numAsStr(x),owner:o});const b=g(m),w={...m,sig:b},_=Nt.hash(w);return{...w,hash:_}},h=l=>{r.length=0,l.map(d=>{d.owner=o,r.push(d)})};return h(Array.from({length:1e3}).map(()=>({id:Nt.idStr(),value:Nt.numAsStr(Math.random()*(1-.001+1)+.001),owner:""}))),{addr:()=>o,pubKey:()=>e,utxos:()=>r,setNewUTXOs:h,balance:i,createTx:c}},sm=s=>{const{gameVars:t,pos:e}=s,{game:r,assets:n}=t,i=new Date,o=Nt.randomIp(),a=em(),c=ep(),h=tp(o),l=37,d=43,f=5,u=1.25,p=n.getTexture("server-anim-coin"),g=n.createSprite("server-off");g.texture.source.scaleMode="nearest",g.visible=!1,g.scale.set(u);let m=0;const y=Array.from({length:f},(M,v)=>{const k=new $({source:p.source,frame:new q(l*v+m,0,l,d)});return m+=1,k.source.scaleMode="nearest",k}),x=new tr({textures:y});return x.scale.set(u),x.animationSpeed=.07,x.play(),x.currentFrame=Kt({min:0,max:f-1}),x.zIndex=As.mid,g.zIndex=As.mid,r.addChild(x),r.addChild(g),x.x=e?e.x-x.width*.5:0,x.y=e?e.y-x.height*.5:0,{setRunning:M=>{x.visible=M,g.visible=!M,M===!0?x.position.set(x.x,x.y):g.position.set(x.x,x.y)},anim:x,createdAt:()=>i,ip:()=>o,destroy:()=>{x.parent&&x.parent.removeChild(x),x.destroy(),g.parent&&g.parent.removeChild(g),g.destroy()},toRect:()=>new q(x.x,x.y,x.width,x.height),connections:()=>h,sendBtc:M=>{const{units:v,node:k}=M,A=k.wallet.addr(),P=a.createTx({units:v,recAddr:A});c.add(P),Rt.fire("newTx",{originId:o,tx:P})},receiveTx:M=>c.hasTx(M)?!1:(c.add(M),!0),wallet:a,mempool:c,pos:()=>({x:x.x+x.width*.5,y:x.y+x.height*.5})}},rm=s=>{const{gameVars:t,store:e}=s,{game:r,scaler:n}=t,i=()=>({width:r.width/n.getGameScale(),height:r.height/n.getGameScale()});return{create:()=>{const a=om(e.data(),i());return sm({gameVars:t,pos:a})}}},nm=s=>{const t={top:new q,topLeft:new q,topRight:new q,bottom:new q,bottomLeft:new q,bottomRight:new q},e=2,r=175,n=s.anim.x+s.anim.width*.5,i=s.anim.y+s.anim.height*.5;return[{key:"top",angle:Math.PI*1.5},{key:"topRight",angle:Math.PI*1.85},{key:"bottomRight",angle:Math.PI*.15},{key:"bottom",angle:Math.PI*.5},{key:"bottomLeft",angle:Math.PI*.85},{key:"topLeft",angle:Math.PI*1.15}].map(a=>{const c=a.angle,h=n+Math.cos(c)*r,l=i+Math.sin(c)*r;t[a.key]=new q(h-e*.5,l-e*.5,e,e)}),t},im=s=>{const{rectA:t,rectB:e,buffer:r=0}=s,n=new q(t.x-r,t.y-r,t.width+r*2,t.height+r*2),i=new q(e.x-r,e.y-r,e.width+r*2,e.height+r*2);return!(!(n.x<i.x+i.width)||!(n.x+n.width>i.x)||!(n.y<i.y+i.height)||!(n.y+n.height>i.y))},om=(s,t)=>{if(s.length===0)return{x:t.width*.5-25,y:t.height*.5-25};const e=50;for(let r=0;r<s.length;r++){const n=s[r],i=nm(n),o=["top","topRight","bottomRight","bottom","bottomLeft","topLeft"];for(const a of o){const c=i[a];if(!(c.x<10||c.y<10||c.x+c.width+e>t.width||c.y+c.height+e>t.height||s.some(l=>im({rectA:c,rectB:l.toRect(),buffer:e}))))return{x:c.x+c.width*.5,y:c.y+c.height*.5}}}return console.warn("No open position found around any existing nodes."),{x:-1,y:-1}},am=(s,t,e)=>{const r=Zf(),n=()=>({width:t.width/r.getGameScale(),height:t.height/r.getGameScale()});return{app:s,game:t,assets:e,resizer:Qf(r),scaler:r,getWindowSize:n}},cm=()=>{const s=[];return{push:t=>s.push(t),pop:()=>s.pop(),count:()=>s.length,data:()=>s}},lm=s=>{const t=[];return{displayMovement:n=>{const{fromNode:i,toNode:o,txMsg:a}=n,c=hm({start:i,end:o,container:s.game,txMsg:a});t.push(c)},update:n=>{for(let i=t.length-1;i>=0;i--){const o=t[i];if(o.update(n)){o.destroy(),t.splice(i,1);const c={originId:o.endId(),tx:o.txMsg()};Rt.fire("newTx",c)}}}}},hm=s=>{const{container:t,start:e,end:r,txMsg:n,speed:i=7.5}=s,o=e.pos(),a=r.pos(),c=new Jt().circle(0,0,5).fill({color:"#ff8f45"});c.x=o.x,c.y=o.y,t.addChild(c);const h=a.x-o.x,l=a.y-o.y,d=Math.sqrt(h*h+l*l),f=d===0?0:h/d,u=d===0?0:l/d;return{update:m=>{if(d===0)return!0;const y=a.x-c.x,x=a.y-c.y,b=Math.sqrt(y*y+x*x),w=i*m.deltaTime;return w>=b?(c.x=a.x,c.y=a.y,!0):(c.x+=f*w,c.y+=u*w,!1)},destroy:()=>{c.parent&&c.parent.removeChild(c),c.destroy()},txMsg:()=>n,startId:()=>e.ip(),endId:()=>r.ip()}},dm=s=>{const{gameVars:t,store:e}=s,{game:r}=t,n=c=>{const{node1:h,node2:l}=c,d={x:h.anim.x+h.anim.width*.5,y:h.anim.y+h.anim.height*.5},f={x:l.anim.x+l.anim.width*.5,y:l.anim.y+l.anim.height*.5},u=new Jt,p=2,g=p*7.5,m="#FFFFFF",y=f.x-d.x,x=f.y-d.y,b=Math.sqrt(y*y+x*x),w=Math.atan2(x,y);for(let _=0;_<b;_+=g){const S=d.x+Math.cos(w)*_,C=d.y+Math.sin(w)*_;u.circle(S,C,p).fill({color:m})}return u.zIndex=As.bottom,u},i=[];return{setup:()=>{for(;i.length>0;){const c=i.pop();c&&r.removeChild(c),c==null||c.destroy()}for(const c of e.data())c.connections().disconnect();for(const c of e.data())c.connections().connectCount()>=8||um({node:c,count:6,store:e}).map(h=>{c.connections().connect(h),h.connections().connect(c);const l=n({node1:c,node2:h});i.push(l)});for(const c of i)r.addChild(c)},update:c=>{}}},um=s=>{const{node:t,count:e,store:r}=s,n=r.data(),i=[],o=(c,h)=>{const l=c.x-h.x,d=c.y-h.y;return Math.sqrt(l*l+d*d)};for(const c of n){if(c.connections().isConnectedTo(t)||c.ip()===t.ip()||c.connections().connectCount()>=6)continue;const h=o(t.anim,c.anim);h>=200||i.push({node:c,distance:h})}return i.sort((c,h)=>c.distance-h.distance),i.slice(0,e+1).map(c=>c.node)},fm=s=>{const{gameVars:t,bounds:e}=s,{app:r,game:n,scaler:i}=t;let o={x:r.screen.width*.5,y:r.screen.height*.5},a=!1,c=null,h=null;n.eventMode="static",n.on("pointerdown",u=>{a=!0,c=u.global.clone(),h={...o},n.cursor="grabbing"}),n.on("pointermove",u=>{if(!a||!c||!h)return;const p=u.global,g=p.x-c.x,m=p.y-c.y;o={x:h.x-g,y:h.y-m};const y=e.width*i.getGameScale();o.x=Math.min(o.x,y-r.screen.width*.5),o.x=Math.max(o.x,r.screen.width*.5);const x=e.height*i.getGameScale();o.y=Math.min(o.y,x-r.screen.height*.5),o.y=Math.max(o.y,r.screen.height*.5)});const l=()=>{a=!1,c=null,h=null,n.cursor="default"};return n.on("pointerup",l),n.on("pointerupoutside",l),{getFocusPoint:()=>o,setFocusPoint:u=>{u&&(o=u)},isDragging:()=>a}},pm=s=>{const{store:t}=s,e=()=>{const i=t.data(),o=Kt({min:0,max:i.length,decimal:!1});let a=Kt({min:0,max:i.length,decimal:!1});if(a===o&&a!==i.length-1)a++;else if(a===o&&a!==0)a--;else if(a===o)throw new Error("cant send btc to self");return{sendIdx:o,recIdx:a}},r=()=>{try{const i=t.data();if(i.length<2)return;const{sendIdx:o,recIdx:a}=e(),c=i[o],h=i[a],l=c.wallet.balance(),d=Kt({min:l*1e-5,max:l*.01,decimal:!0}),f=Nt.round(d);Rt.fire("randSend",{fromId:c.ip(),toId:h.ip(),units:f})}catch{}},n=(()=>{let i=Kt({min:1500,max:3e3}),o=0;return{update:a=>{o>=i&&(o=0,i=Kt({min:500,max:3e3}),r()),o+=a.deltaMS}}})();return{update:i=>{n.update(i)}}},mm=({rows:s,cols:t})=>{const r="#4E505F",n=new Jt;n.zIndex=As.bottom;const i=[],o=new kt({fontFamily:"GraphPix",fontSize:8});for(let h=0;h<s;h++)for(let l=0;l<t;l++){const d=l*50,f=h*50;n.rect(d,f,50,50).fill(r);const u=new Qt({style:o,text:`${h+1},${l+1}`});u.resolution=2,u.anchor.set(.5,.5),u.position.set(d+50*.5,f+50*.5),i.push(u)}const a=1,c="#b6cdd5";for(let h=0;h<=s;h++)for(let l=0;l<=t;l++){const d=l*50,f=h*50;n.circle(d,f,a).fill({color:c,alpha:.25})}return{size:{width:t*50,height:s*50},graphic:n,texts:i}},gm=s=>{const t="game-imgs/btc-net-sim",e=r=>`url(${t}/${r}.png),auto`;s.renderer.events.cursorStyles.default=e("ms-default"),s.renderer.events.cursorStyles.pointer=e("ms-pointer"),s.renderer.events.cursorStyles.grabbing=e("ms-grabbing"),s.renderer.events.cursorStyles.grab=e("ms-grab")},Ic={white:"#FFFFFF"};class Re{constructor(){yt(this,"on",!1);yt(this,"onOnce",!1);yt(this,"off",!1);yt(this,"offOnce",!1);yt(this,"lastReleaseMs",0);yt(this,"lastPressMs",0);yt(this,"press",()=>{this.on=!0,this.onOnce=!0,this.offOnce=!1,this.off=!1,this.lastPressMs=performance.now()});yt(this,"release",()=>{this.on=!1,this.onOnce=!1,this.offOnce=!0,this.off=!0,this.lastReleaseMs=performance.now()});yt(this,"pressHeldAfter",t=>this.on?performance.now()-this.lastPress>t:!1)}get lastPress(){return this.lastPressMs}get lastRelease(){return this.lastReleaseMs}get wasPressedOnce(){return this.onOnce?(this.onOnce=!1,this.on=!0,this.lastPressMs=performance.now(),!0):!1}get wasReleasedOnce(){return this.offOnce?(this.offOnce=!1,this.lastReleaseMs=performance.now(),!0):!1}get data(){return{pressed:this.on,released:this.off}}}const xm=()=>{const s=new Re,t=new Re,e=new Re,r=a=>{a.preventDefault(),a.ctrlKey&&(a.deltaY>0&&Rt.fire("zoom","out"),a.deltaY<0&&Rt.fire("zoom","in"))},n=a=>{switch(a.key){case"Control":a.preventDefault(),s.press();break;case"+":case"=":a.preventDefault(),t.press();break;case"-":a.preventDefault(),e.press();break}},i=a=>{switch(a.key){case"Control":s.release();break;case"+":case"=":t.release();break;case"-":e.release();break}};return window.addEventListener("keydown",n),window.addEventListener("keyup",i),window.addEventListener("wheel",r,{passive:!1}),{zoomIn:t,zoomOut:e,destroy:()=>{window.removeEventListener("keydown",n),window.removeEventListener("keyup",i),window.removeEventListener("wheel",r)}}},ym=s=>{const{gameVars:t}=s,{app:e,scaler:r}=t,n=new zt,i=new Jt,o=61,a=300;i.rect(0,0,o,a).fill({color:Ic.white,alpha:0});const c=5,h=bm(),l=Us({pixelSize:4.25,width:14,height:14,pos:{x:0,y:42},text:{value:"MAX",size:14}}),d=Us({pixelSize:4.25,width:14,height:14,pos:{x:0,y:l.ctr.y+l.ctr.height+c},text:{value:"+",size:20}}),f=Us({pixelSize:4.25,width:14,height:14,pos:{x:0,y:d.ctr.y+d.ctr.height+c},text:{value:"-",size:20}}),u=Us({pixelSize:4.25,width:14,height:14,pos:{x:0,y:f.ctr.y+f.ctr.height+c},text:{value:"MIN",size:14}}),p=new wm;l.onClick(p.max.press),l.onRelease(p.max.release),d.onClick(p.plus.press),d.onRelease(p.plus.release),f.onClick(p.minus.press),f.onRelease(p.minus.release),u.onClick(p.min.press),u.onRelease(p.min.release),n.addChild(i,h.nodes,h.count,l.ctr,d.ctr,f.ctr,u.ctr),e.stage.addChild(n);const g=()=>{n.width=o*r.getGameScale(),n.height=a*r.getGameScale(),n.x=e.screen.width-n.width,n.y=e.screen.height*.5-n.height*.5,n.y-=50};g();const m={min:1,max:127};let y=19,x=!1,b=!1;const w=()=>{const{count:S,nodes:C}=h;S.text=`${y}`,S.x=C.width*.5-S.width*.5,Rt.fire("node",{count:y})};return w(),{resize:g,update:S=>{if(x){if(y>=m.max){x=!1;return}y+=5,y=y>=m.max?m.max:y,w();return}if(b){if(y<=m.min){b=!1;return}y-=4,y=y<=m.min?m.min:y,w();return}if(p.max.wasPressedOnce&&(x=!0),p.plus.wasPressedOnce||p.plus.pressHeldAfter(500)){if(y>=m.max)return;y++,w()}if(p.minus.wasPressedOnce||p.minus.pressHeldAfter(500)){if(y<=m.min)return;y--,w()}p.min.wasPressedOnce&&(b=!0)}}},Us=s=>{const t={white:"#FFFFFF",outBorder:"#9D5322",inBorder:"#E88744",mainBg:"#D67130"},{pixelSize:e,width:r,height:n,pos:i}=s,o=new zt,a=new Jt;a.rect(e*2,0,e*(r-4),e).fill({color:t.outBorder}),a.rect(e*2,e,e*(r-4),e).fill({color:t.inBorder}),a.rect(e,e,e,e).fill({color:t.outBorder}),a.rect(e*(r-2),e,e,e).fill({color:t.outBorder}),a.rect(0,e*2,e,e*(n-4)).fill({color:t.outBorder}),a.rect(e,e*2,e,e*(n-4)).fill({color:t.inBorder}),a.rect(e,e*(n-2),e,e).fill({color:t.outBorder}),a.rect(e*2,e*(n-1),e*(r-4),e).fill({color:t.outBorder}),a.rect(e*2,e*(n-2),e*(r-4),e).fill({color:t.inBorder}),a.rect(e*(r-2),e*(n-2),e,e).fill({color:t.outBorder}),a.rect(e*(r-1),e*2,e,e*(n-4)).fill({color:t.outBorder}),a.rect(e*(r-2),e*2,e,e*(n-4)).fill({color:t.inBorder}),a.rect(e*2,e*2,e*(r-4),e*(n-4)).fill({color:t.mainBg});const c=new Qt({style:new kt({fontSize:s.text.size,fontFamily:"GraphPix",fill:t.white}),resolution:2,text:s.text.value});c.x=a.x+a.width*.5-c.width*.5,c.y=a.y+a.height*.5-c.height*.5,o.addChild(a,c),o.x=i.x,o.y=i.y,o.interactive=!0,o.alpha=.8,o.on("pointerenter",()=>{o.alpha=.93}),o.on("pointerleave",()=>{o.alpha=.8});let h,l;return o.on("pointerdown",()=>{o.alpha=1,h==null||h()}),o.on("pointerup",()=>{o.alpha=.85,l==null||l()}),{ctr:o,onClick:d=>{h=d},onRelease:d=>{l=d}}},bm=()=>{const s=new kt({fontFamily:"GraphPix",fontSize:14,fill:Ic.white}),t=new Qt({style:s,resolution:2,text:"NODES",alpha:.85}),e=new Qt({style:s,resolution:2,text:"1",y:t.y+t.height+6.5,alpha:.85});return e.x=t.width*.5-e.width*.5,{nodes:t,count:e}};class wm{constructor(){yt(this,"max",new Re);yt(this,"plus",new Re);yt(this,"minus",new Re);yt(this,"min",new Re)}}const Rt=Lo();async function _m(s){const t=new zt,e=Kf(),r=am(s,t,e);vm(r).next(()=>Am(r))}const vm=s=>{let t,e;const{game:r,app:n}=s;return n.stage.addChild(r),{next:async i=>{r.removeChildren(),r.removeAllListeners(),t&&t.destroy(),e=i();const o=a=>{e==null||e.update(a)};t=new Ut().add(o),await e.load(r),t.start()}}},Am=s=>{const{game:t,app:e,assets:r,resizer:n}=s;let i,o,a,c,h,l;const d=cm(),f=rm({gameVars:s,store:d}),u=xm(),p=mm({rows:30,cols:46}),g=()=>{window.dispatchEvent(new CustomEvent("windowResize"))},m=x=>x.preventDefault(),y=()=>{n.resize(e,t),l==null||l.resize()};return window.addEventListener("resize",()=>setTimeout(g,0)),window.addEventListener("windowResize",y),e.canvas.addEventListener("contextmenu",m),e.stage.interactive=!0,gm(e),window.addEventListener("gameModal",()=>{u.destroy(),Rt.clear();try{window.removeEventListener("resize",g),window.removeEventListener("windowResize",y),e.canvas.removeEventListener("contextmenu",m)}catch{}}),Rt.on("zoom",x=>{if(!i||!h)return;const b=.002;x==="in"&&h.zoom(b),x==="out"&&h.zoom(-b),x==="reset"&&h.resetZoom();const w=t.getSize();n.resize(e,t);const _=t.getSize(),S=_.height>w.height,C=Math.max(w.width,_.width),v=Math.min(w.width,_.width)/C,k=Math.max(w.height,_.height),P=Math.min(w.height,_.height)/k,E=i.getFocusPoint(),R={x:S?E.x/v:E.x*v,y:S?E.y/P:E.y*P};i.setFocusPoint(R),h==null||h.lookAt(i==null?void 0:i.getFocusPoint())}),Rt.on("node",x=>{if(x.count>d.count())for(;x.count>d.count();){const b=f.create();d.push(b),o==null||o.setup()}if(x.count<d.count()){for(;x.count<d.count();){const b=d.pop();b==null||b.destroy()}o==null||o.setup()}}),Rt.on("randSend",x=>{try{const b=d.data(),w=b.find(S=>S.ip()===x.toId),_=b.find(S=>S.ip()===x.fromId);if(!_||!w||w.ip()===x.fromId)return;_.sendBtc({units:x.units,node:w})}catch{}}),Rt.on("newTx",x=>{const b=d.data().find(_=>_.ip()===x.originId);if(!b)return;b.connections().getAll().map(_=>{_.receiveTx(x.tx)&&(a==null||a.displayMovement({fromNode:b,toNode:_,txMsg:x.tx}))})}),{load:async()=>{await r.load(),t.addChild(p.graphic),h=Jf({gameVars:s,bounds:p.size,clampCamera:!1}),i=fm({gameVars:s,bounds:p.size}),o=dm({gameVars:s,store:d}),a=lm(s),c=pm({store:d}),l=ym({gameVars:s}),setTimeout(()=>{if(!i||!h)return;const x={x:t.width*.5,y:t.height*.5};i.setFocusPoint(x),h.lookAt(i==null?void 0:i.getFocusPoint()),Rt.fire("node",{count:19}),h==null||h.setZoom(.6),i.setFocusPoint({x:e.screen.width*.8,y:e.screen.height*.92}),window.dispatchEvent(new CustomEvent("windowResize")),h==null||h.lookAt(i==null?void 0:i.getFocusPoint())},50)},update:x=>{l==null||l.update(x),h==null||h.update(x),i!=null&&i.isDragging()&&(h==null||h.lookAt(i==null?void 0:i.getFocusPoint())),o==null||o.update(x),a==null||a.update(x),c==null||c.update(x)}}},Xr=854,qr=480;let Xt=1;const Xn=s=>{const{width:t,height:e}=s.screen,r=t/e,n=Xr/qr;if(r>n){Xt=e/qr;const i=(t-Xr*Xt)/2;s.stage.scale.set(Xt,Xt),s.stage.position.set(i,0)}else{Xt=t/Xr;const i=(e-qr*Xt)/2;s.stage.scale.set(Xt,Xt),s.stage.position.set(0,i)}};let Kr=0;const Sm=150,Bc=s=>{try{Kr+=s.ticker.deltaMS,Kr>=Sm&&(Xn(s),Kr=0)}catch{}};var Lt=(s=>(s[s.bottom=0]="bottom",s[s.mid=1]="mid",s[s.top=2]="top",s))(Lt||{}),pe=(s=>(s[s.paused=0]="paused",s[s.play=1]="play",s))(pe||{});const Cm=s=>{const t=new Map,e=({game:o,pos:a})=>{const c=new Ht(s);c.zIndex=Lt.bottom,c.scale.set(qn),c.anchor.set(.5),c.x=a.x,c.y=a.y;const h=crypto.randomUUID().replaceAll("-","").slice(0,15),l={id:h,sprite:c};o.addChild(l.sprite),t.set(h,l)},r=()=>{const o=[];for(const[a,c]of t)o.push(c);return o},n=({game:o,id:a})=>{const c=t.get(a);c&&(o.removeChild(c.sprite),c.sprite.destroy(),t.delete(a))};return{list:r,createApple:e,remove:n,reset:o=>{for(const[a,c]of t)n({game:o,id:a})}}},km=async()=>{const s=await St.load(`${xs}/apple.png`);return s.source.scaleMode="nearest",Cm(s)},Mm=({gridSize:s,texture:t})=>{const e=[],{row:r,col:n}=s,i=new kt({fontFamily:"GraphPix",fontSize:6,fill:"#000000"});for(let h=0;h<r*n;h++){const l=new Ht(t);l.scale.set(qn),l.anchor.set(.5,.5);const d=Math.floor(h/n),f=h%n;l.x=f*l.width+l.width*.5,l.y=d*l.height+l.height*.5,l.zIndex=Lt.bottom;const u=Pm(l);e.push(u)}const o=h=>{const l=h.row*s.col+h.col;return e[l]},a=h=>{for(let l=0;l<e.length;l++){const d=e[l],f=new Qt({style:i,text:`${l}`});f.resolution=2;const{x:u,y:p}=d.sprite;f.position.set(u-18,p-18),f.zIndex=Lt.mid,h.addChild(f)}},c=h=>{for(const l of e){const d=l.getIndexPos(),f=new Qt({style:i,text:`${d.row}, ${d.col}`});f.resolution=2;const{x:u,y:p}=l.sprite;f.position.set(u-18,p-18),f.zIndex=Lt.mid,h.addChild(f)}};return{tiles:e,sizeIdx:s,size:{width:e[0].sprite.width*s.col,height:e[0].sprite.height*s.row},getTileFromIndexPos:o,displayIndexes:a,displayPosIndexes:c}},Pm=s=>({sprite:s,getIndexPos:()=>{const{x:e,y:r,width:n,height:i}=s,o=e-n*.5,a=r-i*.5,c=Math.floor(o/n),h=Math.floor(a/i);return{col:c,row:h}}}),Tm=async()=>{const s=`${xs}/game-tile.png`,t=await St.load(s);return t.source.scaleMode="nearest",t},Em=s=>{const{game:t,app:e,bounds:r}=s,n={x:0,y:0},i={width:0,height:0};return{posZero:n,lookAt:a=>{if(!a)return;i.width=e.screen.width/Xt,i.height=e.screen.height/Xt;let c=-a.x+i.width*.5,h=-a.y+i.height*.5;const l=-(r.width-i.width);c=Math.min(Math.max(c,l),0);const f=-(r.height-i.height);h=Math.min(Math.max(h,f),0),t.position.set(c,h),n.x=-t.position.x,n.y=-t.position.y},viewport:i}};var pt=(s=>(s[s.up=0]="up",s[s.right=1]="right",s[s.down=2]="down",s[s.left=3]="left",s))(pt||{});const Mo=s=>{const t={x:0,y:0},e=new Ht(s);e.zIndex=Lt.mid,e.scale.set(qn),e.anchor.set(.5);const r={faceUp:()=>{e.rotation=Math.PI},faceRight:()=>{e.rotation=Math.PI*1.5},faceDown:()=>{e.rotation=0},faceLeft:()=>{e.rotation=Math.PI*.5},isFacing:{up:()=>e.rotation===Math.PI,right:()=>e.rotation===Math.PI*1.5,down:()=>e.rotation===0,left:()=>e.rotation===Math.PI*.5}},n=()=>e.x===t.x&&e.y===t.y;return{nextPos:t,direction:r,moveTo:c=>{t.x=c.x,t.y=c.y},placeAt:c=>{t.x=c.x,t.y=c.y,e.x=c.x,e.y=c.y},sprite:e,update:c=>{n()||(e.y>t.y&&(e.y-=.125*c.deltaMS,e.y<t.y&&(e.y=t.y)),e.x<t.x&&(e.x+=.125*c.deltaMS,e.x>t.x&&(e.x=t.x)),e.y<t.y&&(e.y+=.125*c.deltaMS,e.y>t.y&&(e.y=t.y)),e.x>t.x&&(e.x-=.125*c.deltaMS,e.x<t.x&&(e.x=t.x)))},isIdle:n}},Im=s=>{const{head:t,dead:e,body:r}=s,n=Mo(t),i=[];return{head:n,body:i,update:l=>{n.update(l);for(let d=0;d<i.length;d++)i[d].update(l)},died:()=>{n.sprite.texture=e},addSegment:l=>{const d=Mo(r);if(i.length===0){const{x:f,y:u}=n.sprite;d.placeAt({x:f,y:u})}else{const{x:f,y:u}=i[i.length-1].sprite;d.placeAt({x:f,y:u})}i.push(d),l.addChild(d.sprite)},reset:l=>{n.sprite.texture=t,i.map(d=>{l.removeChild(d.sprite),d.sprite.destroy()}),i.length=0}}},Bm=async()=>{const s=St.load(`${xs}/snake-head.png`),t=St.load(`${xs}/snake-dead.png`),e=St.load(`${xs}/snake-body.png`),r=await Promise.all([s,t,e]);for(const n of r)n.source.scaleMode="nearest";return{head:r[0],dead:r[1],body:r[2]}},Po=s=>{const{snake:t,gameTiles:e,initPos:r}=s;let n={...r,direction:pt.down},i={...r,direction:pt.down};Rm(t).on(e).at(r),t.head.direction.faceDown(),is(t).on(e).to(r),Zt.on("keyPressed",h=>{if(t){if(h==="up"){if(t.head.direction.isFacing.down())return;i={...n,direction:pt.up,row:n.row-1}}if(h==="right"){if(t.head.direction.isFacing.left())return;i={...n,direction:pt.right,col:n.col+1}}if(h==="down"){if(t.head.direction.isFacing.up())return;i={...n,direction:pt.down,row:n.row+1}}if(h==="left"){if(t.head.direction.isFacing.right())return;i={...n,direction:pt.left,col:n.col-1}}}});let o=0;const a=h=>{if(o<2500){o+=h.elapsedMS;return}for(let l=0;l<t.body.length;l++){const d=t.body[l];if(or.circles(t.head.sprite,d.sprite))return!0}return!1};return{update:h=>{if(a(h)&&Zt.fire("gameEvent","gameOver"),!t.head.isIdle())return;let l=t.head;for(let d=0;d<t.body.length;d++){const{x:f,y:u}=l.sprite,p=t.body[d];p.moveTo({x:f,y:u}),l=p}n={...i},n.direction===pt.up&&(t.head.direction.faceUp(),is(t).on(e).to(n),i={...n,direction:pt.up,row:n.row-1}),n.direction===pt.right&&(t.head.direction.faceRight(),is(t).on(e).to(n),i={...n,direction:pt.right,col:n.col+1}),n.direction===pt.down&&(t.head.direction.faceDown(),is(t).on(e).to(n),i={...n,direction:pt.down,row:n.row+1}),n.direction===pt.left&&(t.head.direction.faceLeft(),is(t).on(e).to(n),i={...n,direction:pt.left,col:n.col-1})}}},Rm=s=>({on:e=>({at:n=>{const{row:i,col:o}=n,{x:a,y:c}=e.getTileFromIndexPos({row:i,col:o}).sprite;s.head.placeAt({x:a,y:c})}})}),is=s=>({on:e=>({to:n=>{const{row:i,col:o}=n,a=i<e.sizeIdx.row&&i>=0,c=o<e.sizeIdx.col&&o>=0;if(a&&c){const{x:h,y:l}=e.getTileFromIndexPos(n).sprite;s.head.moveTo({x:h,y:l})}if(o<0){const{y:h}=e.getTileFromIndexPos({row:i,col:0}).sprite,l=-e.tiles[0].sprite.width;s.head.moveTo({x:l,y:h})}if(i<0){const{x:h}=e.getTileFromIndexPos({row:0,col:o}).sprite,l=-e.tiles[0].sprite.height;s.head.moveTo({x:h,y:l})}if(i>=e.sizeIdx.row){const h=e.sizeIdx.row-1,{x:l,y:d}=e.getTileFromIndexPos({row:h,col:o}).sprite,f=d+e.tiles[0].sprite.height;s.head.moveTo({x:l,y:f})}if(o>=e.sizeIdx.col){const h=e.sizeIdx.col-1,{x:l,y:d}=e.getTileFromIndexPos({row:i,col:h}).sprite,f=l+e.tiles[0].sprite.width;s.head.moveTo({x:f,y:d})}}})}),xs="game-imgs/slither-slim";let ir=0;const qn=3.25,Zt=Lo();async function Fm(s){Lm(s).next((e,r)=>zm(e,r)),window.addEventListener("keydown",e=>{switch(e.code){case"ArrowUp":Zt.fire("keyPressed","up");break;case"ArrowRight":Zt.fire("keyPressed","right");break;case"ArrowDown":Zt.fire("keyPressed","down");break;case"ArrowLeft":Zt.fire("keyPressed","left");break;case"Enter":Zt.fire("keyPressed","enter");break}})}const Lm=s=>{let t,e;const r=new zt;return s.stage.addChild(r),setTimeout(()=>Xn(s),0),{next:async n=>{r.removeChildren(),r.removeAllListeners(),t&&t.destroy(),e=n(r,s);const i=o=>{Bc(s),e==null||e.update(o)};t=new Ut().add(i),await e.load(r),t.start()}}},zm=(s,t)=>{let e,r,n,i,o;const a=Gm(),c=Nm();let h=pe.paused;const l=()=>{if(!r||!e||!o)return;i=Po({snake:r,gameTiles:e,initPos:{row:5,col:5}}),r.reset(s),r.addSegment(s),a.setScore(r==null?void 0:r.body.length),o.reset(s),Array.from({length:12}).map(()=>d())},d=()=>{const f=Om({gameTiles:e,snake:r,apples:o}).getRandomTile(),u={x:f.sprite.x,y:f.sprite.y};o==null||o.createApple({game:s,pos:u})};return Zt.on("keyPressed",f=>{f==="enter"&&h===pe.paused&&(h=pe.play,a.setVisible(!0),c.setVisible(!1),l())}),Zt.on("gameEvent",f=>{f==="gameOver"&&h===pe.play&&(r==null||r.died(),h=pe.paused,a.setVisible(!1),c.setVisible(!0))}),{load:async()=>{const f=await Tm();if(e=Mm({texture:f,gridSize:{row:15,col:20}}),e.tiles.map(u=>s.addChild(u.sprite)),r=await Bm().then(u=>Im(u)),!(r!=null&&r.head))throw new Error("snake head did not load");s.addChild(r.head.sprite),o=await km(),i=Po({snake:r,gameTiles:e,initPos:{row:5,col:5}}),a.addToApp(t),c.addTo(s),n=Em({app:t,game:s,bounds:e.size})},update:f=>{if(!(!r||!e||!o)){if(h===pe.paused&&c.update(n),h===pe.play){r.update(f),i==null||i.update(f),Um({snake:r,bounds:e.size})&&Zt.fire("gameEvent","gameOver");for(const u of o.list())if(or.circles(r.head.sprite,u.sprite)){const{id:p}=u;o.remove({game:s,id:p}),r.addSegment(s),a.setScore(r==null?void 0:r.body.length),d()}}n==null||n.lookAt(r==null?void 0:r.head.sprite.position)}}}},Gm=()=>{const s=new Qt({style:new kt({fontFamily:"GraphPix",fontSize:10,fill:"#FFFFFF"}),text:"LENGTH: 0"});s.resolution=2,s.zIndex=Lt.top;const t=new Jt().roundRect(0,0,100,100,6).fill({color:"#000000",alpha:.5});t.zIndex=Lt.top;const e=o=>{o.addChild(t),o.addChild(s)},r=o=>{o.stage.addChild(t),o.stage.addChild(s),t.position.set(3,3),s.position.set(7,5)},n=o=>{s.visible=o,t.visible=o};return n(!1),{addTo:e,setVisible:n,setScore:o=>{const a=(o||0)+1;s.text=`LENGTH: ${a}`,ir=Math.max(a,ir),t.width=s.width+5,t.height=s.height+5},addToApp:r}},Nm=()=>{const s="GraphPix",t="#FFFFFF",e=new kt({fontFamily:s,fontSize:40,fill:t}),r=new Qt({style:e});r.resolution=2,r.text="SLITHER SLIM",r.zIndex=Lt.top;const n=new kt({fontFamily:s,fontSize:18,fill:t}),i=new Qt({style:n});i.resolution=2,i.text=`HIGH SCORE: ${ir}`,i.scale.set(.75),i.zIndex=Lt.top;const o=new Qt({style:n});o.resolution=2,o.text="Press ENTER to begin",o.zIndex=Lt.top;const a=new Jt().rect(0,0,100,100).fill({color:"#000000",alpha:.65});return a.zIndex=Lt.top,{addTo:d=>{d.addChild(a),d.addChild(r),d.addChild(o),d.addChild(i)},update:d=>{if(!d)return;const{posZero:f,viewport:u}=d,p=u.width===a.width,g=u.height===a.height;(!p||!g)&&(a.width=u.width+10,a.height=u.height+10),a.position.set(f.x-5,f.y-5);const m=u.width*.5-r.width*.5;r.position.set(f.x+m,f.y+50);const y=u.width*.5-i.width*.5;i.position.set(f.x+y,f.y+225);const x=u.width*.5-o.width*.5;o.position.set(f.x+x,f.y+400)},setVisible:d=>{a.visible=d,r.visible=d,i.visible=d,o.visible=d,i.text=`HIGH SCORE: ${ir}`}}},Om=({gameTiles:s,snake:t,apples:e})=>{if(!s)throw new Error("in fromOpenTiles(), gameTiles not defined");if(!t)throw new Error("in fromOpenTiles(), snake not defined");if(!e)throw new Error("in fromOpenTiles(), apples not defined");const r=[];for(let i=0;i<s.tiles.length;i++){const o=s.tiles[i];let a=!1;for(let h=0;h<t.body.length&&!a;h++){const l=t.body[h];or.squares(l.sprite,o.sprite)&&(a=!0)}const c=e.list();for(let h=0;h<c.length&&!a;h++){const l=c[h];or.squares(l.sprite,o.sprite)&&(a=!0)}a||r.push(o)}return{getRandomTile:()=>{if(r.length===0)throw new Error("empty game tiles");const i=Math.floor(Math.random()*r.length);return r[i]}}},or={circles:(s,t)=>{const r={x:s.x,y:s.y,radius:s.width*.5-8},n={x:t.x,y:t.y,radius:t.width*.5},i=r.x-n.x,o=r.y-n.y;return Math.sqrt(i*i+o*o)<r.radius+n.radius},squares:(s,t)=>{const e=s.getBounds(),r=t.getBounds(),n=e.left<r.right&&e.right>r.left,i=e.top<r.bottom&&e.bottom>r.top;return n&&i}},Um=s=>{const{snake:t,bounds:e}=s,r={x:t.head.sprite.x,y:t.head.sprite.y,width:t.head.sprite.width,height:t.head.sprite.height},n=r.width*.35;return r.x-n<0||r.y-n<0||r.x+n>e.width||r.y+n>e.height};async function Ds(s){Dm(s).next(Hm)}const Dm=s=>{let t,e;const r=new zt;return s.stage.addChild(r),setTimeout(()=>Xn(s),0),{next:async n=>{r.removeChildren(),r.removeAllListeners(),t&&t.destroy(),e=n(r);const i=o=>{Bc(s),e==null||e.update(o)};t=new Ut().add(i),await e.load(r),t.start()}}},Hm=s=>({load:async()=>{const t=await St.load("game-imgs/space-game.png"),e=new Ht(t);e.x=0,e.y=0,s.addChild(e)},update:t=>{}});function Rc(s){var t,e,r="";if(typeof s=="string"||typeof s=="number")r+=s;else if(typeof s=="object")if(Array.isArray(s)){var n=s.length;for(t=0;t<n;t++)s[t]&&(e=Rc(s[t]))&&(r&&(r+=" "),r+=e)}else for(e in s)s[e]&&(r&&(r+=" "),r+=e);return r}function Wm(){for(var s,t,e=0,r="",n=arguments.length;e<n;e++)(s=arguments[e])&&(t=Rc(s))&&(r&&(r+=" "),r+=t);return r}const Kn="-",jm=s=>{const t=Vm(s),{conflictingClassGroups:e,conflictingClassGroupModifiers:r}=s;return{getClassGroupId:o=>{const a=o.split(Kn);return a[0]===""&&a.length!==1&&a.shift(),Fc(a,t)||$m(o)},getConflictingClassGroupIds:(o,a)=>{const c=e[o]||[];return a&&r[o]?[...c,...r[o]]:c}}},Fc=(s,t)=>{var o;if(s.length===0)return t.classGroupId;const e=s[0],r=t.nextPart.get(e),n=r?Fc(s.slice(1),r):void 0;if(n)return n;if(t.validators.length===0)return;const i=s.join(Kn);return(o=t.validators.find(({validator:a})=>a(i)))==null?void 0:o.classGroupId},To=/^\[(.+)\]$/,$m=s=>{if(To.test(s)){const t=To.exec(s)[1],e=t==null?void 0:t.substring(0,t.indexOf(":"));if(e)return"arbitrary.."+e}},Vm=s=>{const{theme:t,classGroups:e}=s,r={nextPart:new Map,validators:[]};for(const n in e)An(e[n],r,n,t);return r},An=(s,t,e,r)=>{s.forEach(n=>{if(typeof n=="string"){const i=n===""?t:Eo(t,n);i.classGroupId=e;return}if(typeof n=="function"){if(Ym(n)){An(n(r),t,e,r);return}t.validators.push({validator:n,classGroupId:e});return}Object.entries(n).forEach(([i,o])=>{An(o,Eo(t,i),e,r)})})},Eo=(s,t)=>{let e=s;return t.split(Kn).forEach(r=>{e.nextPart.has(r)||e.nextPart.set(r,{nextPart:new Map,validators:[]}),e=e.nextPart.get(r)}),e},Ym=s=>s.isThemeGetter,Xm=s=>{if(s<1)return{get:()=>{},set:()=>{}};let t=0,e=new Map,r=new Map;const n=(i,o)=>{e.set(i,o),t++,t>s&&(t=0,r=e,e=new Map)};return{get(i){let o=e.get(i);if(o!==void 0)return o;if((o=r.get(i))!==void 0)return n(i,o),o},set(i,o){e.has(i)?e.set(i,o):n(i,o)}}},Sn="!",Cn=":",qm=Cn.length,Km=s=>{const{prefix:t,experimentalParseClassName:e}=s;let r=n=>{const i=[];let o=0,a=0,c=0,h;for(let p=0;p<n.length;p++){let g=n[p];if(o===0&&a===0){if(g===Cn){i.push(n.slice(c,p)),c=p+qm;continue}if(g==="/"){h=p;continue}}g==="["?o++:g==="]"?o--:g==="("?a++:g===")"&&a--}const l=i.length===0?n:n.substring(c),d=Zm(l),f=d!==l,u=h&&h>c?h-c:void 0;return{modifiers:i,hasImportantModifier:f,baseClassName:d,maybePostfixModifierPosition:u}};if(t){const n=t+Cn,i=r;r=o=>o.startsWith(n)?i(o.substring(n.length)):{isExternal:!0,modifiers:[],hasImportantModifier:!1,baseClassName:o,maybePostfixModifierPosition:void 0}}if(e){const n=r;r=i=>e({className:i,parseClassName:n})}return r},Zm=s=>s.endsWith(Sn)?s.substring(0,s.length-1):s.startsWith(Sn)?s.substring(1):s,Qm=s=>{const t=Object.fromEntries(s.orderSensitiveModifiers.map(r=>[r,!0]));return r=>{if(r.length<=1)return r;const n=[];let i=[];return r.forEach(o=>{o[0]==="["||t[o]?(n.push(...i.sort(),o),i=[]):i.push(o)}),n.push(...i.sort()),n}},Jm=s=>({cache:Xm(s.cacheSize),parseClassName:Km(s),sortModifiers:Qm(s),...jm(s)}),tg=/\s+/,eg=(s,t)=>{const{parseClassName:e,getClassGroupId:r,getConflictingClassGroupIds:n,sortModifiers:i}=t,o=[],a=s.trim().split(tg);let c="";for(let h=a.length-1;h>=0;h-=1){const l=a[h],{isExternal:d,modifiers:f,hasImportantModifier:u,baseClassName:p,maybePostfixModifierPosition:g}=e(l);if(d){c=l+(c.length>0?" "+c:c);continue}let m=!!g,y=r(m?p.substring(0,g):p);if(!y){if(!m){c=l+(c.length>0?" "+c:c);continue}if(y=r(p),!y){c=l+(c.length>0?" "+c:c);continue}m=!1}const x=i(f).join(":"),b=u?x+Sn:x,w=b+y;if(o.includes(w))continue;o.push(w);const _=n(y,m);for(let S=0;S<_.length;++S){const C=_[S];o.push(b+C)}c=l+(c.length>0?" "+c:c)}return c};function sg(){let s=0,t,e,r="";for(;s<arguments.length;)(t=arguments[s++])&&(e=Lc(t))&&(r&&(r+=" "),r+=e);return r}const Lc=s=>{if(typeof s=="string")return s;let t,e="";for(let r=0;r<s.length;r++)s[r]&&(t=Lc(s[r]))&&(e&&(e+=" "),e+=t);return e};function rg(s,...t){let e,r,n,i=o;function o(c){const h=t.reduce((l,d)=>d(l),s());return e=Jm(h),r=e.cache.get,n=e.cache.set,i=a,a(c)}function a(c){const h=r(c);if(h)return h;const l=eg(c,e);return n(c,l),l}return function(){return i(sg.apply(null,arguments))}}const lt=s=>{const t=e=>e[s]||[];return t.isThemeGetter=!0,t},zc=/^\[(?:(\w[\w-]*):)?(.+)\]$/i,Gc=/^\((?:(\w[\w-]*):)?(.+)\)$/i,ng=/^\d+\/\d+$/,ig=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,og=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,ag=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,cg=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,lg=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,Oe=s=>ng.test(s),j=s=>!!s&&!Number.isNaN(Number(s)),fe=s=>!!s&&Number.isInteger(Number(s)),Zr=s=>s.endsWith("%")&&j(s.slice(0,-1)),re=s=>ig.test(s),hg=()=>!0,dg=s=>og.test(s)&&!ag.test(s),Nc=()=>!1,ug=s=>cg.test(s),fg=s=>lg.test(s),pg=s=>!L(s)&&!z(s),mg=s=>Je(s,Dc,Nc),L=s=>zc.test(s),Se=s=>Je(s,Hc,dg),Qr=s=>Je(s,wg,j),Io=s=>Je(s,Oc,Nc),gg=s=>Je(s,Uc,fg),Hs=s=>Je(s,Wc,ug),z=s=>Gc.test(s),os=s=>ts(s,Hc),xg=s=>ts(s,_g),Bo=s=>ts(s,Oc),yg=s=>ts(s,Dc),bg=s=>ts(s,Uc),Ws=s=>ts(s,Wc,!0),Je=(s,t,e)=>{const r=zc.exec(s);return r?r[1]?t(r[1]):e(r[2]):!1},ts=(s,t,e=!1)=>{const r=Gc.exec(s);return r?r[1]?t(r[1]):e:!1},Oc=s=>s==="position"||s==="percentage",Uc=s=>s==="image"||s==="url",Dc=s=>s==="length"||s==="size"||s==="bg-size",Hc=s=>s==="length",wg=s=>s==="number",_g=s=>s==="family-name",Wc=s=>s==="shadow",vg=()=>{const s=lt("color"),t=lt("font"),e=lt("text"),r=lt("font-weight"),n=lt("tracking"),i=lt("leading"),o=lt("breakpoint"),a=lt("container"),c=lt("spacing"),h=lt("radius"),l=lt("shadow"),d=lt("inset-shadow"),f=lt("text-shadow"),u=lt("drop-shadow"),p=lt("blur"),g=lt("perspective"),m=lt("aspect"),y=lt("ease"),x=lt("animate"),b=()=>["auto","avoid","all","avoid-page","page","left","right","column"],w=()=>["center","top","bottom","left","right","top-left","left-top","top-right","right-top","bottom-right","right-bottom","bottom-left","left-bottom"],_=()=>[...w(),z,L],S=()=>["auto","hidden","clip","visible","scroll"],C=()=>["auto","contain","none"],M=()=>[z,L,c],v=()=>[Oe,"full","auto",...M()],k=()=>[fe,"none","subgrid",z,L],A=()=>["auto",{span:["full",fe,z,L]},fe,z,L],P=()=>[fe,"auto",z,L],E=()=>["auto","min","max","fr",z,L],R=()=>["start","end","center","between","around","evenly","stretch","baseline","center-safe","end-safe"],F=()=>["start","end","center","stretch","center-safe","end-safe"],T=()=>["auto",...M()],I=()=>[Oe,"auto","full","dvw","dvh","lvw","lvh","svw","svh","min","max","fit",...M()],B=()=>[s,z,L],D=()=>[...w(),Bo,Io,{position:[z,L]}],W=()=>["no-repeat",{repeat:["","x","y","space","round"]}],U=()=>["auto","cover","contain",yg,mg,{size:[z,L]}],Q=()=>[Zr,os,Se],H=()=>["","none","full",h,z,L],K=()=>["",j,os,Se],V=()=>["solid","dashed","dotted","double"],tt=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],J=()=>[j,Zr,Bo,Io],Mt=()=>["","none",p,z,L],dt=()=>["none",j,z,L],vt=()=>["none",j,z,L],xt=()=>[j,z,L],Pt=()=>[Oe,"full",...M()];return{cacheSize:500,theme:{animate:["spin","ping","pulse","bounce"],aspect:["video"],blur:[re],breakpoint:[re],color:[hg],container:[re],"drop-shadow":[re],ease:["in","out","in-out"],font:[pg],"font-weight":["thin","extralight","light","normal","medium","semibold","bold","extrabold","black"],"inset-shadow":[re],leading:["none","tight","snug","normal","relaxed","loose"],perspective:["dramatic","near","normal","midrange","distant","none"],radius:[re],shadow:[re],spacing:["px",j],text:[re],"text-shadow":[re],tracking:["tighter","tight","normal","wide","wider","widest"]},classGroups:{aspect:[{aspect:["auto","square",Oe,L,z,m]}],container:["container"],columns:[{columns:[j,L,z,a]}],"break-after":[{"break-after":b()}],"break-before":[{"break-before":b()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],sr:["sr-only","not-sr-only"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:_()}],overflow:[{overflow:S()}],"overflow-x":[{"overflow-x":S()}],"overflow-y":[{"overflow-y":S()}],overscroll:[{overscroll:C()}],"overscroll-x":[{"overscroll-x":C()}],"overscroll-y":[{"overscroll-y":C()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:v()}],"inset-x":[{"inset-x":v()}],"inset-y":[{"inset-y":v()}],start:[{start:v()}],end:[{end:v()}],top:[{top:v()}],right:[{right:v()}],bottom:[{bottom:v()}],left:[{left:v()}],visibility:["visible","invisible","collapse"],z:[{z:[fe,"auto",z,L]}],basis:[{basis:[Oe,"full","auto",a,...M()]}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["nowrap","wrap","wrap-reverse"]}],flex:[{flex:[j,Oe,"auto","initial","none",L]}],grow:[{grow:["",j,z,L]}],shrink:[{shrink:["",j,z,L]}],order:[{order:[fe,"first","last","none",z,L]}],"grid-cols":[{"grid-cols":k()}],"col-start-end":[{col:A()}],"col-start":[{"col-start":P()}],"col-end":[{"col-end":P()}],"grid-rows":[{"grid-rows":k()}],"row-start-end":[{row:A()}],"row-start":[{"row-start":P()}],"row-end":[{"row-end":P()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":E()}],"auto-rows":[{"auto-rows":E()}],gap:[{gap:M()}],"gap-x":[{"gap-x":M()}],"gap-y":[{"gap-y":M()}],"justify-content":[{justify:[...R(),"normal"]}],"justify-items":[{"justify-items":[...F(),"normal"]}],"justify-self":[{"justify-self":["auto",...F()]}],"align-content":[{content:["normal",...R()]}],"align-items":[{items:[...F(),{baseline:["","last"]}]}],"align-self":[{self:["auto",...F(),{baseline:["","last"]}]}],"place-content":[{"place-content":R()}],"place-items":[{"place-items":[...F(),"baseline"]}],"place-self":[{"place-self":["auto",...F()]}],p:[{p:M()}],px:[{px:M()}],py:[{py:M()}],ps:[{ps:M()}],pe:[{pe:M()}],pt:[{pt:M()}],pr:[{pr:M()}],pb:[{pb:M()}],pl:[{pl:M()}],m:[{m:T()}],mx:[{mx:T()}],my:[{my:T()}],ms:[{ms:T()}],me:[{me:T()}],mt:[{mt:T()}],mr:[{mr:T()}],mb:[{mb:T()}],ml:[{ml:T()}],"space-x":[{"space-x":M()}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":M()}],"space-y-reverse":["space-y-reverse"],size:[{size:I()}],w:[{w:[a,"screen",...I()]}],"min-w":[{"min-w":[a,"screen","none",...I()]}],"max-w":[{"max-w":[a,"screen","none","prose",{screen:[o]},...I()]}],h:[{h:["screen","lh",...I()]}],"min-h":[{"min-h":["screen","lh","none",...I()]}],"max-h":[{"max-h":["screen","lh",...I()]}],"font-size":[{text:["base",e,os,Se]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:[r,z,Qr]}],"font-stretch":[{"font-stretch":["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded",Zr,L]}],"font-family":[{font:[xg,L,t]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:[n,z,L]}],"line-clamp":[{"line-clamp":[j,"none",z,Qr]}],leading:[{leading:[i,...M()]}],"list-image":[{"list-image":["none",z,L]}],"list-style-position":[{list:["inside","outside"]}],"list-style-type":[{list:["disc","decimal","none",z,L]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"placeholder-color":[{placeholder:B()}],"text-color":[{text:B()}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...V(),"wavy"]}],"text-decoration-thickness":[{decoration:[j,"from-font","auto",z,Se]}],"text-decoration-color":[{decoration:B()}],"underline-offset":[{"underline-offset":[j,"auto",z,L]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:M()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",z,L]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],wrap:[{wrap:["break-word","anywhere","normal"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",z,L]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:D()}],"bg-repeat":[{bg:W()}],"bg-size":[{bg:U()}],"bg-image":[{bg:["none",{linear:[{to:["t","tr","r","br","b","bl","l","tl"]},fe,z,L],radial:["",z,L],conic:[fe,z,L]},bg,gg]}],"bg-color":[{bg:B()}],"gradient-from-pos":[{from:Q()}],"gradient-via-pos":[{via:Q()}],"gradient-to-pos":[{to:Q()}],"gradient-from":[{from:B()}],"gradient-via":[{via:B()}],"gradient-to":[{to:B()}],rounded:[{rounded:H()}],"rounded-s":[{"rounded-s":H()}],"rounded-e":[{"rounded-e":H()}],"rounded-t":[{"rounded-t":H()}],"rounded-r":[{"rounded-r":H()}],"rounded-b":[{"rounded-b":H()}],"rounded-l":[{"rounded-l":H()}],"rounded-ss":[{"rounded-ss":H()}],"rounded-se":[{"rounded-se":H()}],"rounded-ee":[{"rounded-ee":H()}],"rounded-es":[{"rounded-es":H()}],"rounded-tl":[{"rounded-tl":H()}],"rounded-tr":[{"rounded-tr":H()}],"rounded-br":[{"rounded-br":H()}],"rounded-bl":[{"rounded-bl":H()}],"border-w":[{border:K()}],"border-w-x":[{"border-x":K()}],"border-w-y":[{"border-y":K()}],"border-w-s":[{"border-s":K()}],"border-w-e":[{"border-e":K()}],"border-w-t":[{"border-t":K()}],"border-w-r":[{"border-r":K()}],"border-w-b":[{"border-b":K()}],"border-w-l":[{"border-l":K()}],"divide-x":[{"divide-x":K()}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":K()}],"divide-y-reverse":["divide-y-reverse"],"border-style":[{border:[...V(),"hidden","none"]}],"divide-style":[{divide:[...V(),"hidden","none"]}],"border-color":[{border:B()}],"border-color-x":[{"border-x":B()}],"border-color-y":[{"border-y":B()}],"border-color-s":[{"border-s":B()}],"border-color-e":[{"border-e":B()}],"border-color-t":[{"border-t":B()}],"border-color-r":[{"border-r":B()}],"border-color-b":[{"border-b":B()}],"border-color-l":[{"border-l":B()}],"divide-color":[{divide:B()}],"outline-style":[{outline:[...V(),"none","hidden"]}],"outline-offset":[{"outline-offset":[j,z,L]}],"outline-w":[{outline:["",j,os,Se]}],"outline-color":[{outline:B()}],shadow:[{shadow:["","none",l,Ws,Hs]}],"shadow-color":[{shadow:B()}],"inset-shadow":[{"inset-shadow":["none",d,Ws,Hs]}],"inset-shadow-color":[{"inset-shadow":B()}],"ring-w":[{ring:K()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:B()}],"ring-offset-w":[{"ring-offset":[j,Se]}],"ring-offset-color":[{"ring-offset":B()}],"inset-ring-w":[{"inset-ring":K()}],"inset-ring-color":[{"inset-ring":B()}],"text-shadow":[{"text-shadow":["none",f,Ws,Hs]}],"text-shadow-color":[{"text-shadow":B()}],opacity:[{opacity:[j,z,L]}],"mix-blend":[{"mix-blend":[...tt(),"plus-darker","plus-lighter"]}],"bg-blend":[{"bg-blend":tt()}],"mask-clip":[{"mask-clip":["border","padding","content","fill","stroke","view"]},"mask-no-clip"],"mask-composite":[{mask:["add","subtract","intersect","exclude"]}],"mask-image-linear-pos":[{"mask-linear":[j]}],"mask-image-linear-from-pos":[{"mask-linear-from":J()}],"mask-image-linear-to-pos":[{"mask-linear-to":J()}],"mask-image-linear-from-color":[{"mask-linear-from":B()}],"mask-image-linear-to-color":[{"mask-linear-to":B()}],"mask-image-t-from-pos":[{"mask-t-from":J()}],"mask-image-t-to-pos":[{"mask-t-to":J()}],"mask-image-t-from-color":[{"mask-t-from":B()}],"mask-image-t-to-color":[{"mask-t-to":B()}],"mask-image-r-from-pos":[{"mask-r-from":J()}],"mask-image-r-to-pos":[{"mask-r-to":J()}],"mask-image-r-from-color":[{"mask-r-from":B()}],"mask-image-r-to-color":[{"mask-r-to":B()}],"mask-image-b-from-pos":[{"mask-b-from":J()}],"mask-image-b-to-pos":[{"mask-b-to":J()}],"mask-image-b-from-color":[{"mask-b-from":B()}],"mask-image-b-to-color":[{"mask-b-to":B()}],"mask-image-l-from-pos":[{"mask-l-from":J()}],"mask-image-l-to-pos":[{"mask-l-to":J()}],"mask-image-l-from-color":[{"mask-l-from":B()}],"mask-image-l-to-color":[{"mask-l-to":B()}],"mask-image-x-from-pos":[{"mask-x-from":J()}],"mask-image-x-to-pos":[{"mask-x-to":J()}],"mask-image-x-from-color":[{"mask-x-from":B()}],"mask-image-x-to-color":[{"mask-x-to":B()}],"mask-image-y-from-pos":[{"mask-y-from":J()}],"mask-image-y-to-pos":[{"mask-y-to":J()}],"mask-image-y-from-color":[{"mask-y-from":B()}],"mask-image-y-to-color":[{"mask-y-to":B()}],"mask-image-radial":[{"mask-radial":[z,L]}],"mask-image-radial-from-pos":[{"mask-radial-from":J()}],"mask-image-radial-to-pos":[{"mask-radial-to":J()}],"mask-image-radial-from-color":[{"mask-radial-from":B()}],"mask-image-radial-to-color":[{"mask-radial-to":B()}],"mask-image-radial-shape":[{"mask-radial":["circle","ellipse"]}],"mask-image-radial-size":[{"mask-radial":[{closest:["side","corner"],farthest:["side","corner"]}]}],"mask-image-radial-pos":[{"mask-radial-at":w()}],"mask-image-conic-pos":[{"mask-conic":[j]}],"mask-image-conic-from-pos":[{"mask-conic-from":J()}],"mask-image-conic-to-pos":[{"mask-conic-to":J()}],"mask-image-conic-from-color":[{"mask-conic-from":B()}],"mask-image-conic-to-color":[{"mask-conic-to":B()}],"mask-mode":[{mask:["alpha","luminance","match"]}],"mask-origin":[{"mask-origin":["border","padding","content","fill","stroke","view"]}],"mask-position":[{mask:D()}],"mask-repeat":[{mask:W()}],"mask-size":[{mask:U()}],"mask-type":[{"mask-type":["alpha","luminance"]}],"mask-image":[{mask:["none",z,L]}],filter:[{filter:["","none",z,L]}],blur:[{blur:Mt()}],brightness:[{brightness:[j,z,L]}],contrast:[{contrast:[j,z,L]}],"drop-shadow":[{"drop-shadow":["","none",u,Ws,Hs]}],"drop-shadow-color":[{"drop-shadow":B()}],grayscale:[{grayscale:["",j,z,L]}],"hue-rotate":[{"hue-rotate":[j,z,L]}],invert:[{invert:["",j,z,L]}],saturate:[{saturate:[j,z,L]}],sepia:[{sepia:["",j,z,L]}],"backdrop-filter":[{"backdrop-filter":["","none",z,L]}],"backdrop-blur":[{"backdrop-blur":Mt()}],"backdrop-brightness":[{"backdrop-brightness":[j,z,L]}],"backdrop-contrast":[{"backdrop-contrast":[j,z,L]}],"backdrop-grayscale":[{"backdrop-grayscale":["",j,z,L]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[j,z,L]}],"backdrop-invert":[{"backdrop-invert":["",j,z,L]}],"backdrop-opacity":[{"backdrop-opacity":[j,z,L]}],"backdrop-saturate":[{"backdrop-saturate":[j,z,L]}],"backdrop-sepia":[{"backdrop-sepia":["",j,z,L]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":M()}],"border-spacing-x":[{"border-spacing-x":M()}],"border-spacing-y":[{"border-spacing-y":M()}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["","all","colors","opacity","shadow","transform","none",z,L]}],"transition-behavior":[{transition:["normal","discrete"]}],duration:[{duration:[j,"initial",z,L]}],ease:[{ease:["linear","initial",y,z,L]}],delay:[{delay:[j,z,L]}],animate:[{animate:["none",x,z,L]}],backface:[{backface:["hidden","visible"]}],perspective:[{perspective:[g,z,L]}],"perspective-origin":[{"perspective-origin":_()}],rotate:[{rotate:dt()}],"rotate-x":[{"rotate-x":dt()}],"rotate-y":[{"rotate-y":dt()}],"rotate-z":[{"rotate-z":dt()}],scale:[{scale:vt()}],"scale-x":[{"scale-x":vt()}],"scale-y":[{"scale-y":vt()}],"scale-z":[{"scale-z":vt()}],"scale-3d":["scale-3d"],skew:[{skew:xt()}],"skew-x":[{"skew-x":xt()}],"skew-y":[{"skew-y":xt()}],transform:[{transform:[z,L,"","none","gpu","cpu"]}],"transform-origin":[{origin:_()}],"transform-style":[{transform:["3d","flat"]}],translate:[{translate:Pt()}],"translate-x":[{"translate-x":Pt()}],"translate-y":[{"translate-y":Pt()}],"translate-z":[{"translate-z":Pt()}],"translate-none":["translate-none"],accent:[{accent:B()}],appearance:[{appearance:["none","auto"]}],"caret-color":[{caret:B()}],"color-scheme":[{scheme:["normal","dark","light","light-dark","only-dark","only-light"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",z,L]}],"field-sizing":[{"field-sizing":["fixed","content"]}],"pointer-events":[{"pointer-events":["auto","none"]}],resize:[{resize:["none","","y","x"]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":M()}],"scroll-mx":[{"scroll-mx":M()}],"scroll-my":[{"scroll-my":M()}],"scroll-ms":[{"scroll-ms":M()}],"scroll-me":[{"scroll-me":M()}],"scroll-mt":[{"scroll-mt":M()}],"scroll-mr":[{"scroll-mr":M()}],"scroll-mb":[{"scroll-mb":M()}],"scroll-ml":[{"scroll-ml":M()}],"scroll-p":[{"scroll-p":M()}],"scroll-px":[{"scroll-px":M()}],"scroll-py":[{"scroll-py":M()}],"scroll-ps":[{"scroll-ps":M()}],"scroll-pe":[{"scroll-pe":M()}],"scroll-pt":[{"scroll-pt":M()}],"scroll-pr":[{"scroll-pr":M()}],"scroll-pb":[{"scroll-pb":M()}],"scroll-pl":[{"scroll-pl":M()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",z,L]}],fill:[{fill:["none",...B()]}],"stroke-w":[{stroke:[j,os,Se,Qr]}],stroke:[{stroke:["none",...B()]}],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-x","border-w-y","border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-x","border-color-y","border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],translate:["translate-x","translate-y","translate-none"],"translate-none":["translate","translate-x","translate-y","translate-z"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]},orderSensitiveModifiers:["*","**","after","backdrop","before","details-content","file","first-letter","first-line","marker","placeholder","selection"]}},Ag=rg(vg);function jc(...s){return Ag(Wm(s))}function Lg({}){return[{title:"Canvas Games"},{name:"description",content:"Just here to learn making games with the canvas"}]}const Sg=[{id:"slither-slim",title:"Slither Slim",image:"game-imgs/slither-slim/game-img.png",init:Fm},{id:"bitcoin-sim",title:"Bitcoin Network Sim",image:"game-imgs/space-game.png",init:_m},{id:"placeholder3",title:"Placeholder",image:"game-imgs/space-game.png",init:Ds},{id:"placeholder4",title:"Placeholder",image:"game-imgs/space-game.png",init:Ds},{id:"placeholder5",title:"Placeholder",image:"game-imgs/space-game.png",init:Ds},{id:"placeholder6",title:"Placeholder",image:"game-imgs/space-game.png",init:Ds}],zg=qc(function(){const[t,e]=Kc(),r=t.get("game"),n=Zc();return G.jsxs("div",{className:"mx-auto max-w-[100rem]",children:[G.jsx(Cg,{}),G.jsx("div",{id:"about"}),G.jsxs("div",{className:"px-8",children:[G.jsxs("div",{className:"flex items-center mt-[8rem]",children:[G.jsx("img",{className:"mr-5",src:"assets/vr-boy.png",alt:"boy vr headset"}),G.jsx("h1",{className:"font-font md:text-xl sm:text-md font-bold text-white",children:"About"})]}),G.jsx("div",{className:"w-full flex justify-center mt-3",children:G.jsxs("div",{className:"max-w-[50rem] text-gray-200",children:[G.jsx("div",{children:"Welcome! This site is a personal project where I'm collecting and showcasing projects I've built as part of my learning journey. Think of it as my digital playground for exploring game development and various html canvas ideas."}),G.jsx("div",{className:"mt-8",children:"Thanks for stopping by!"})]})})]}),G.jsx("div",{id:"collection"}),G.jsxs("div",{className:"px-8",children:[G.jsxs("div",{className:"flex items-center mt-[8rem]",children:[G.jsx("img",{className:"mr-5",src:"assets/rocket.png",alt:"rocket ship"}),G.jsx("h1",{className:"font-font md:text-xl sm:text-md font-bold text-white",children:"Collection"})]}),G.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-8 mt-8",children:Sg.map(i=>G.jsxs("div",{onClick:()=>{r||n(`?game=${i.id}#collection`)},className:jc("relative overflow-hidden rounded-lg shadow-lg group border-3 border-transparent hover:border-sky-400 transition",{"cursor-pointer":!r}),children:[G.jsx("img",{src:i.image,alt:i.title,className:"w-full h-full object-cover opacity-70 group-hover:opacity-100 transition"}),G.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:G.jsx("span",{className:"text-white text-xl font-bold bg-black/40 px-4 py-2 rounded",children:i.title})}),G.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-4",children:[G.jsx(kg,{title:"Example Game",onClick:()=>e({game:i.id})},i.id),r===i.id&&G.jsx(Mg,{createGame:i.init,onClose:()=>{location.hash.includes("collection")?n("#collection"):e(""),window.dispatchEvent(new CustomEvent("gameModal"))}})]})]},i.id))})]}),G.jsx("div",{className:"my-14",children:G.jsx("img",{src:"assets/earth-large.png",alt:"Large Earth",className:"mx-auto md:w-[35rem] w-[20rem]"})}),G.jsx(Pg,{})]})});function Cg(){return G.jsxs("div",{children:[G.jsx("div",{id:"home"}),G.jsx("div",{className:"bg-gray-800 py-6 rounded-b-lg",children:G.jsxs("div",{className:"grid grid-cols-2 px-8",children:[G.jsxs("div",{className:"flex items-center col-start-1",children:[G.jsx("img",{className:"mr-5 w-8 h-8",src:"assets/pixel-earth.png",alt:"pixel earth"}),G.jsx("h1",{className:"font-font md:text-xl sm:text-md font-bold sm:block hidden text-white",children:"Canvas Game"})]}),G.jsxs("div",{className:"flex justify-end items-center col-start-2 sm:space-x-8 space-x-4 font-font md:text-md text-sm font-bold",children:[G.jsx("a",{href:"#home",className:"text-gray-300 hover:text-white",children:"Home"}),G.jsx("a",{href:"#about",className:"text-gray-300 hover:text-white",children:"About"}),G.jsx("a",{href:"#collection",className:"text-gray-300 hover:text-white",children:"Collection"})]})]})})]})}function kg({title:s,onClick:t}){return G.jsx("div",{onClick:t,className:"p-4 bg-gray-800 shadow rounded hover:scale-105 transition",children:G.jsx("h2",{className:"text-lg font-semibold",children:s})})}function Mg({createGame:s,onClose:t}){const e=ne.useRef(null),r=ne.useRef(null),n=ne.useRef(null),[i,o]=ne.useState({width:window.innerWidth,height:window.innerHeight}),a=window.innerWidth<768||Ro();ne.useEffect(()=>{const d=()=>{o({width:window.innerWidth,height:window.innerHeight}),window.dispatchEvent(new CustomEvent("windowResize"))};return window.addEventListener("resize",d),()=>window.removeEventListener("resize",d)},[n]),ne.useEffect(()=>((async()=>{if(!e.current)return;const f=new Ia;await f.init({resizeTo:e.current,backgroundColor:"#000000",antialias:!0,autoDensity:!0}),e.current&&(e.current.innerHTML="",e.current.appendChild(f.canvas)),n.current=f,s(f)})(),()=>{n.current&&(n.current.destroy(!0),n.current=null),e.current&&(e.current=null)}),[s,Ro,n]);const c=()=>{var d;document.fullscreenElement?document.exitFullscreen():(d=r.current)==null||d.requestFullscreen()},{isFullscreen:h}=Tg();Eg();const l=i.height*(16/9);return G.jsxs("div",{ref:r,className:"fixed inset-0 flex items-center justify-center z-50",children:[G.jsx("div",{className:"absolute inset-0 bg-black/40 backdrop-blur-sm",onClick:t}),G.jsxs("div",{style:{maxWidth:h?`${l}px`:void 0},className:jc("aspect-[16/9] relative bg-gray-800 z-10 w-[90vw] max-w-[1920px] rounded-lg shadow-lg",{"w-full max-w-full":h}),children:[!h&&G.jsx("div",{children:G.jsx("button",{onClick:c,title:"Toggle Fullscreen",className:"absolute bottom-2 right-3 text-gray-400 hover:text-gray-700 text-4xl cursor-pointer",children:""})}),a&&G.jsx("div",{className:"w-full h-full flex items-center justify-center bg-gray-800 text-white text-center p-4 rounded",children:G.jsx("p",{className:"text-lg font-medium",children:"Uh oh... looks like you're on mobile. Only can play the games on a desktop for now."})}),!a&&G.jsx("div",{ref:e,className:"w-full h-full overflow-hidden rounded"})]})]})}function Pg(){return G.jsxs("footer",{className:"bg-gray-800 text-gray-300 mt-20 w-full rounded-t-lg",children:[G.jsxs("div",{className:"max-w-screen-xl mx-auto px-6 py-10 grid grid-cols-1 md:grid-cols-3 gap-10",children:[G.jsxs("div",{children:[G.jsx("div",{className:"flex items-center space-x-3",children:G.jsx("span",{className:"text-xl font-bold text-white",children:"Canvas Games"})}),G.jsx("p",{className:"mt-4 text-sm text-gray-400",children:"A collection of experimental HTML canvas games built with curiosity and a bit of pixel dust."})]}),G.jsxs("div",{className:"md:col-start-3 md:text-right",children:[G.jsx("h3",{className:"text-white text-lg font-semibold mb-4",children:"Follow Me"}),G.jsxs("div",{className:"flex md:justify-end space-x-4",children:[G.jsx("a",{href:"https://github.com",target:"_blank",rel:"noopener noreferrer",className:"hover:text-white",children:"GitHub"}),G.jsx("a",{href:"https://twitter.com",target:"_blank",rel:"noopener noreferrer",className:"hover:text-white",children:"Twitter"}),G.jsx("a",{href:"https://linkedin.com",target:"_blank",rel:"noopener noreferrer",className:"hover:text-white",children:"LinkedIn"})]})]})]}),G.jsxs("div",{className:"border-t border-gray-700 text-center text-sm py-4 text-gray-500 pb-5",children:[" ",new Date().getFullYear()," Paul Q. Peters"]})]})}function Tg(){const[s,t]=ne.useState(!1);return ne.useEffect(()=>{const e=()=>{t(!!document.fullscreenElement)};return document.addEventListener("fullscreenchange",e),document.addEventListener("webkitfullscreenchange",e),document.addEventListener("mozfullscreenchange",e),document.addEventListener("MSFullscreenChange",e),t(!!document.fullscreenElement),()=>{document.removeEventListener("fullscreenchange",e),document.removeEventListener("webkitfullscreenchange",e),document.removeEventListener("mozfullscreenchange",e),document.removeEventListener("MSFullscreenChange",e)}},[]),{isFullscreen:s}}function Eg(){ne.useEffect(()=>{const s=t=>{["ArrowUp","ArrowDown"," "].includes(t.key)&&t.preventDefault()};return window.addEventListener("keydown",s,{passive:!1}),()=>{window.removeEventListener("keydown",s)}},[])}function Ro(){return/Mobi|Android|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)}export{Y as $,Ma as A,wt as B,zt as C,ot as D,O as E,Wl as F,cr as G,ui as H,Ht as I,fh as J,vh as K,at as L,X as M,q as N,Uh as O,ft as P,pi as Q,cn as R,nd as S,Ut as T,Xs as U,Ar as V,mi as W,Vl as X,ct as Y,qo as Z,Pa as _,Wt as a,Z as a0,$h as a1,pd as a2,ad as a3,Rd as a4,Ld as a5,Ud as a6,Hd as a7,Wd as a8,kt as a9,Wa as aa,Ii as ab,Ti as ac,je as ad,so as ae,qt as af,Vu as ag,nt as ah,Jt as ai,fl as aj,fo as ak,Va as al,Lg as am,zg as an,_s as b,Vs as c,En as d,ut as e,Ei as f,ed as g,Sa as h,ia as i,jt as j,ba as k,Qs as l,Bd as m,Fd as n,Nd as o,Dd as p,In as q,kl as r,$ as s,ma as t,ul as u,$d as v,it as w,ae as x,Vo as y,Dt as z};
