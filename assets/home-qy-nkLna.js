const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/browserAll-4tTy4Z01.js","assets/webworkerAll-Iwr3b0ip.js","assets/colorToUniform-BXaCBwVl.js","assets/chunk-QMGIS6GS-CNxDbbuP.js","assets/WebGPURenderer-D057-5E0.js","assets/SharedSystems-DtCO9Hfy.js","assets/WebGLRenderer-Dua_rM7r.js"])))=>i.map(i=>d[i]);
var oc=Object.defineProperty;var ac=(s,t,e)=>t in s?oc(s,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):s[t]=e;var yt=(s,t,e)=>ac(s,typeof t!="symbol"?t+"":t,e);import{w as lc,t as cc,v as hc,j as G,c as re}from"./chunk-QMGIS6GS-CNxDbbuP.js";function Vo(s){return s&&s.__esModule&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s}const Yo=()=>{const s=new Map;return{on:(o,a)=>{const l=new Date().getTime().toString().slice(-8),h=Math.floor(Math.random()*1e8),c=`evt_${l}_${h}`;return s.set(c,{id:c,event:o,callback:a}),c},fire:(o,a)=>{for(const l of s.values())l.event===o&&l.callback(a)},count:()=>s.size,remove:o=>{s.delete(o)},clear:()=>s.clear()}},uc="modulepreload",dc=function(s){return"/canvas-games/"+s},hi={},qs=function(t,e,n){let r=Promise.resolve();if(e&&e.length>0){let o=function(h){return Promise.all(h.map(c=>Promise.resolve(c).then(u=>({status:"fulfilled",value:u}),u=>({status:"rejected",reason:u}))))};document.getElementsByTagName("link");const a=document.querySelector("meta[property=csp-nonce]"),l=(a==null?void 0:a.nonce)||(a==null?void 0:a.getAttribute("nonce"));r=o(e.map(h=>{if(h=dc(h),h in hi)return;hi[h]=!0;const c=h.endsWith(".css"),u=c?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${h}"]${u}`))return;const f=document.createElement("link");if(f.rel=c?"stylesheet":uc,c||(f.as="script"),f.crossOrigin="",f.href=h,l&&f.setAttribute("nonce",l),document.head.appendChild(f),c)return new Promise((d,p)=>{f.addEventListener("load",d),f.addEventListener("error",()=>p(new Error(`Unable to preload CSS for ${h}`)))})}))}function i(o){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=o,window.dispatchEvent(a),!a.defaultPrevented)throw o}return r.then(o=>{for(const a of o||[])a.status==="rejected"&&i(a.reason);return t().catch(i)})};var N=(s=>(s.Application="application",s.WebGLPipes="webgl-pipes",s.WebGLPipesAdaptor="webgl-pipes-adaptor",s.WebGLSystem="webgl-system",s.WebGPUPipes="webgpu-pipes",s.WebGPUPipesAdaptor="webgpu-pipes-adaptor",s.WebGPUSystem="webgpu-system",s.CanvasSystem="canvas-system",s.CanvasPipesAdaptor="canvas-pipes-adaptor",s.CanvasPipes="canvas-pipes",s.Asset="asset",s.LoadParser="load-parser",s.ResolveParser="resolve-parser",s.CacheParser="cache-parser",s.DetectionParser="detection-parser",s.MaskEffect="mask-effect",s.BlendMode="blend-mode",s.TextureSource="texture-source",s.Environment="environment",s.ShapeBuilder="shape-builder",s.Batcher="batcher",s))(N||{});const ur=s=>{if(typeof s=="function"||typeof s=="object"&&s.extension){if(!s.extension)throw new Error("Extension class must have an extension object");s={...typeof s.extension!="object"?{type:s.extension}:s.extension,ref:s}}if(typeof s=="object")s={...s};else throw new Error("Invalid extension type");return typeof s.type=="string"&&(s.type=[s.type]),s},ks=(s,t)=>ur(s).priority??t,dt={_addHandlers:{},_removeHandlers:{},_queue:{},remove(...s){return s.map(ur).forEach(t=>{t.type.forEach(e=>{var n,r;return(r=(n=this._removeHandlers)[e])==null?void 0:r.call(n,t)})}),this},add(...s){return s.map(ur).forEach(t=>{t.type.forEach(e=>{var i,o;const n=this._addHandlers,r=this._queue;n[e]?(o=n[e])==null||o.call(n,t):(r[e]=r[e]||[],(i=r[e])==null||i.push(t))})}),this},handle(s,t,e){var o;const n=this._addHandlers,r=this._removeHandlers;if(n[s]||r[s])throw new Error(`Extension type ${s} already has a handler`);n[s]=t,r[s]=e;const i=this._queue;return i[s]&&((o=i[s])==null||o.forEach(a=>t(a)),delete i[s]),this},handleByMap(s,t){return this.handle(s,e=>{e.name&&(t[e.name]=e.ref)},e=>{e.name&&delete t[e.name]})},handleByNamedList(s,t,e=-1){return this.handle(s,n=>{t.findIndex(i=>i.name===n.name)>=0||(t.push({name:n.name,value:n.ref}),t.sort((i,o)=>ks(o.value,e)-ks(i.value,e)))},n=>{const r=t.findIndex(i=>i.name===n.name);r!==-1&&t.splice(r,1)})},handleByList(s,t,e=-1){return this.handle(s,n=>{t.includes(n.ref)||(t.push(n.ref),t.sort((r,i)=>ks(i,e)-ks(r,e)))},n=>{const r=t.indexOf(n.ref);r!==-1&&t.splice(r,1)})},mixin(s,...t){for(const e of t)Object.defineProperties(s.prototype,Object.getOwnPropertyDescriptors(e))}},fc={extension:{type:N.Environment,name:"browser",priority:-1},test:()=>!0,load:async()=>{await qs(()=>import("./browserAll-4tTy4Z01.js"),__vite__mapDeps([0,1,2,3]))}},pc={extension:{type:N.Environment,name:"webworker",priority:0},test:()=>typeof self<"u"&&self.WorkerGlobalScope!==void 0,load:async()=>{await qs(()=>import("./webworkerAll-Iwr3b0ip.js"),__vite__mapDeps([1,2,3]))}};class bt{constructor(t,e,n){this._x=e||0,this._y=n||0,this._observer=t}clone(t){return new bt(t??this._observer,this._x,this._y)}set(t=0,e=t){return(this._x!==t||this._y!==e)&&(this._x=t,this._y=e,this._observer._onUpdate(this)),this}copyFrom(t){return(this._x!==t.x||this._y!==t.y)&&(this._x=t.x,this._y=t.y,this._observer._onUpdate(this)),this}copyTo(t){return t.set(this._x,this._y),t}equals(t){return t.x===this._x&&t.y===this._y}toString(){return`[pixi.js/math:ObservablePoint x=${this._x} y=${this._y} scope=${this._observer}]`}get x(){return this._x}set x(t){this._x!==t&&(this._x=t,this._observer._onUpdate(this))}get y(){return this._y}set y(t){this._y!==t&&(this._y=t,this._observer._onUpdate(this))}}var wn={exports:{}},ui;function mc(){return ui||(ui=1,function(s){var t=Object.prototype.hasOwnProperty,e="~";function n(){}Object.create&&(n.prototype=Object.create(null),new n().__proto__||(e=!1));function r(l,h,c){this.fn=l,this.context=h,this.once=c||!1}function i(l,h,c,u,f){if(typeof c!="function")throw new TypeError("The listener must be a function");var d=new r(c,u||l,f),p=e?e+h:h;return l._events[p]?l._events[p].fn?l._events[p]=[l._events[p],d]:l._events[p].push(d):(l._events[p]=d,l._eventsCount++),l}function o(l,h){--l._eventsCount===0?l._events=new n:delete l._events[h]}function a(){this._events=new n,this._eventsCount=0}a.prototype.eventNames=function(){var h=[],c,u;if(this._eventsCount===0)return h;for(u in c=this._events)t.call(c,u)&&h.push(e?u.slice(1):u);return Object.getOwnPropertySymbols?h.concat(Object.getOwnPropertySymbols(c)):h},a.prototype.listeners=function(h){var c=e?e+h:h,u=this._events[c];if(!u)return[];if(u.fn)return[u.fn];for(var f=0,d=u.length,p=new Array(d);f<d;f++)p[f]=u[f].fn;return p},a.prototype.listenerCount=function(h){var c=e?e+h:h,u=this._events[c];return u?u.fn?1:u.length:0},a.prototype.emit=function(h,c,u,f,d,p){var g=e?e+h:h;if(!this._events[g])return!1;var m=this._events[g],x=arguments.length,y,b;if(m.fn){switch(m.once&&this.removeListener(h,m.fn,void 0,!0),x){case 1:return m.fn.call(m.context),!0;case 2:return m.fn.call(m.context,c),!0;case 3:return m.fn.call(m.context,c,u),!0;case 4:return m.fn.call(m.context,c,u,f),!0;case 5:return m.fn.call(m.context,c,u,f,d),!0;case 6:return m.fn.call(m.context,c,u,f,d,p),!0}for(b=1,y=new Array(x-1);b<x;b++)y[b-1]=arguments[b];m.fn.apply(m.context,y)}else{var w=m.length,_;for(b=0;b<w;b++)switch(m[b].once&&this.removeListener(h,m[b].fn,void 0,!0),x){case 1:m[b].fn.call(m[b].context);break;case 2:m[b].fn.call(m[b].context,c);break;case 3:m[b].fn.call(m[b].context,c,u);break;case 4:m[b].fn.call(m[b].context,c,u,f);break;default:if(!y)for(_=1,y=new Array(x-1);_<x;_++)y[_-1]=arguments[_];m[b].fn.apply(m[b].context,y)}}return!0},a.prototype.on=function(h,c,u){return i(this,h,c,u,!1)},a.prototype.once=function(h,c,u){return i(this,h,c,u,!0)},a.prototype.removeListener=function(h,c,u,f){var d=e?e+h:h;if(!this._events[d])return this;if(!c)return o(this,d),this;var p=this._events[d];if(p.fn)p.fn===c&&(!f||p.once)&&(!u||p.context===u)&&o(this,d);else{for(var g=0,m=[],x=p.length;g<x;g++)(p[g].fn!==c||f&&!p[g].once||u&&p[g].context!==u)&&m.push(p[g]);m.length?this._events[d]=m.length===1?m[0]:m:o(this,d)}return this},a.prototype.removeAllListeners=function(h){var c;return h?(c=e?e+h:h,this._events[c]&&o(this,c)):(this._events=new n,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=e,a.EventEmitter=a,s.exports=a}(wn)),wn.exports}var gc=mc();const Wt=Vo(gc),xc=Math.PI*2,yc=180/Math.PI,bc=Math.PI/180;class ft{constructor(t=0,e=0){this.x=0,this.y=0,this.x=t,this.y=e}clone(){return new ft(this.x,this.y)}copyFrom(t){return this.set(t.x,t.y),this}copyTo(t){return t.set(this.x,this.y),t}equals(t){return t.x===this.x&&t.y===this.y}set(t=0,e=t){return this.x=t,this.y=e,this}toString(){return`[pixi.js/math:Point x=${this.x} y=${this.y}]`}static get shared(){return _n.x=0,_n.y=0,_n}}const _n=new ft;class X{constructor(t=1,e=0,n=0,r=1,i=0,o=0){this.array=null,this.a=t,this.b=e,this.c=n,this.d=r,this.tx=i,this.ty=o}fromArray(t){this.a=t[0],this.b=t[1],this.c=t[3],this.d=t[4],this.tx=t[2],this.ty=t[5]}set(t,e,n,r,i,o){return this.a=t,this.b=e,this.c=n,this.d=r,this.tx=i,this.ty=o,this}toArray(t,e){this.array||(this.array=new Float32Array(9));const n=e||this.array;return t?(n[0]=this.a,n[1]=this.b,n[2]=0,n[3]=this.c,n[4]=this.d,n[5]=0,n[6]=this.tx,n[7]=this.ty,n[8]=1):(n[0]=this.a,n[1]=this.c,n[2]=this.tx,n[3]=this.b,n[4]=this.d,n[5]=this.ty,n[6]=0,n[7]=0,n[8]=1),n}apply(t,e){e=e||new ft;const n=t.x,r=t.y;return e.x=this.a*n+this.c*r+this.tx,e.y=this.b*n+this.d*r+this.ty,e}applyInverse(t,e){e=e||new ft;const n=this.a,r=this.b,i=this.c,o=this.d,a=this.tx,l=this.ty,h=1/(n*o+i*-r),c=t.x,u=t.y;return e.x=o*h*c+-i*h*u+(l*i-a*o)*h,e.y=n*h*u+-r*h*c+(-l*n+a*r)*h,e}translate(t,e){return this.tx+=t,this.ty+=e,this}scale(t,e){return this.a*=t,this.d*=e,this.c*=t,this.b*=e,this.tx*=t,this.ty*=e,this}rotate(t){const e=Math.cos(t),n=Math.sin(t),r=this.a,i=this.c,o=this.tx;return this.a=r*e-this.b*n,this.b=r*n+this.b*e,this.c=i*e-this.d*n,this.d=i*n+this.d*e,this.tx=o*e-this.ty*n,this.ty=o*n+this.ty*e,this}append(t){const e=this.a,n=this.b,r=this.c,i=this.d;return this.a=t.a*e+t.b*r,this.b=t.a*n+t.b*i,this.c=t.c*e+t.d*r,this.d=t.c*n+t.d*i,this.tx=t.tx*e+t.ty*r+this.tx,this.ty=t.tx*n+t.ty*i+this.ty,this}appendFrom(t,e){const n=t.a,r=t.b,i=t.c,o=t.d,a=t.tx,l=t.ty,h=e.a,c=e.b,u=e.c,f=e.d;return this.a=n*h+r*u,this.b=n*c+r*f,this.c=i*h+o*u,this.d=i*c+o*f,this.tx=a*h+l*u+e.tx,this.ty=a*c+l*f+e.ty,this}setTransform(t,e,n,r,i,o,a,l,h){return this.a=Math.cos(a+h)*i,this.b=Math.sin(a+h)*i,this.c=-Math.sin(a-l)*o,this.d=Math.cos(a-l)*o,this.tx=t-(n*this.a+r*this.c),this.ty=e-(n*this.b+r*this.d),this}prepend(t){const e=this.tx;if(t.a!==1||t.b!==0||t.c!==0||t.d!==1){const n=this.a,r=this.c;this.a=n*t.a+this.b*t.c,this.b=n*t.b+this.b*t.d,this.c=r*t.a+this.d*t.c,this.d=r*t.b+this.d*t.d}return this.tx=e*t.a+this.ty*t.c+t.tx,this.ty=e*t.b+this.ty*t.d+t.ty,this}decompose(t){const e=this.a,n=this.b,r=this.c,i=this.d,o=t.pivot,a=-Math.atan2(-r,i),l=Math.atan2(n,e),h=Math.abs(a+l);return h<1e-5||Math.abs(xc-h)<1e-5?(t.rotation=l,t.skew.x=t.skew.y=0):(t.rotation=0,t.skew.x=a,t.skew.y=l),t.scale.x=Math.sqrt(e*e+n*n),t.scale.y=Math.sqrt(r*r+i*i),t.position.x=this.tx+(o.x*e+o.y*r),t.position.y=this.ty+(o.x*n+o.y*i),t}invert(){const t=this.a,e=this.b,n=this.c,r=this.d,i=this.tx,o=t*r-e*n;return this.a=r/o,this.b=-e/o,this.c=-n/o,this.d=t/o,this.tx=(n*this.ty-r*i)/o,this.ty=-(t*this.ty-e*i)/o,this}isIdentity(){return this.a===1&&this.b===0&&this.c===0&&this.d===1&&this.tx===0&&this.ty===0}identity(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this}clone(){const t=new X;return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t}copyTo(t){return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t}copyFrom(t){return this.a=t.a,this.b=t.b,this.c=t.c,this.d=t.d,this.tx=t.tx,this.ty=t.ty,this}equals(t){return t.a===this.a&&t.b===this.b&&t.c===this.c&&t.d===this.d&&t.tx===this.tx&&t.ty===this.ty}toString(){return`[pixi.js:Matrix a=${this.a} b=${this.b} c=${this.c} d=${this.d} tx=${this.tx} ty=${this.ty}]`}static get IDENTITY(){return _c.identity()}static get shared(){return wc.identity()}}const wc=new X,_c=new X,Ce=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],ke=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],Pe=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],Me=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],dr=[],Xo=[],Ps=Math.sign;function vc(){for(let s=0;s<16;s++){const t=[];dr.push(t);for(let e=0;e<16;e++){const n=Ps(Ce[s]*Ce[e]+Pe[s]*ke[e]),r=Ps(ke[s]*Ce[e]+Me[s]*ke[e]),i=Ps(Ce[s]*Pe[e]+Pe[s]*Me[e]),o=Ps(ke[s]*Pe[e]+Me[s]*Me[e]);for(let a=0;a<16;a++)if(Ce[a]===n&&ke[a]===r&&Pe[a]===i&&Me[a]===o){t.push(a);break}}}for(let s=0;s<16;s++){const t=new X;t.set(Ce[s],ke[s],Pe[s],Me[s],0,0),Xo.push(t)}}vc();const et={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MAIN_DIAGONAL:10,MIRROR_HORIZONTAL:12,REVERSE_DIAGONAL:14,uX:s=>Ce[s],uY:s=>ke[s],vX:s=>Pe[s],vY:s=>Me[s],inv:s=>s&8?s&15:-s&7,add:(s,t)=>dr[s][t],sub:(s,t)=>dr[s][et.inv(t)],rotate180:s=>s^4,isVertical:s=>(s&3)===2,byDirection:(s,t)=>Math.abs(s)*2<=Math.abs(t)?t>=0?et.S:et.N:Math.abs(t)*2<=Math.abs(s)?s>0?et.E:et.W:t>0?s>0?et.SE:et.SW:s>0?et.NE:et.NW,matrixAppendRotationInv:(s,t,e=0,n=0)=>{const r=Xo[et.inv(t)];r.tx=e,r.ty=n,s.append(r)}},Ms=[new ft,new ft,new ft,new ft];class q{constructor(t=0,e=0,n=0,r=0){this.type="rectangle",this.x=Number(t),this.y=Number(e),this.width=Number(n),this.height=Number(r)}get left(){return this.x}get right(){return this.x+this.width}get top(){return this.y}get bottom(){return this.y+this.height}isEmpty(){return this.left===this.right||this.top===this.bottom}static get EMPTY(){return new q(0,0,0,0)}clone(){return new q(this.x,this.y,this.width,this.height)}copyFromBounds(t){return this.x=t.minX,this.y=t.minY,this.width=t.maxX-t.minX,this.height=t.maxY-t.minY,this}copyFrom(t){return this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height,this}copyTo(t){return t.copyFrom(this),t}contains(t,e){return this.width<=0||this.height<=0?!1:t>=this.x&&t<this.x+this.width&&e>=this.y&&e<this.y+this.height}strokeContains(t,e,n,r=.5){const{width:i,height:o}=this;if(i<=0||o<=0)return!1;const a=this.x,l=this.y,h=n*(1-r),c=n-h,u=a-h,f=a+i+h,d=l-h,p=l+o+h,g=a+c,m=a+i-c,x=l+c,y=l+o-c;return t>=u&&t<=f&&e>=d&&e<=p&&!(t>g&&t<m&&e>x&&e<y)}intersects(t,e){if(!e){const P=this.x<t.x?t.x:this.x;if((this.right>t.right?t.right:this.right)<=P)return!1;const k=this.y<t.y?t.y:this.y;return(this.bottom>t.bottom?t.bottom:this.bottom)>k}const n=this.left,r=this.right,i=this.top,o=this.bottom;if(r<=n||o<=i)return!1;const a=Ms[0].set(t.left,t.top),l=Ms[1].set(t.left,t.bottom),h=Ms[2].set(t.right,t.top),c=Ms[3].set(t.right,t.bottom);if(h.x<=a.x||l.y<=a.y)return!1;const u=Math.sign(e.a*e.d-e.b*e.c);if(u===0||(e.apply(a,a),e.apply(l,l),e.apply(h,h),e.apply(c,c),Math.max(a.x,l.x,h.x,c.x)<=n||Math.min(a.x,l.x,h.x,c.x)>=r||Math.max(a.y,l.y,h.y,c.y)<=i||Math.min(a.y,l.y,h.y,c.y)>=o))return!1;const f=u*(l.y-a.y),d=u*(a.x-l.x),p=f*n+d*i,g=f*r+d*i,m=f*n+d*o,x=f*r+d*o;if(Math.max(p,g,m,x)<=f*a.x+d*a.y||Math.min(p,g,m,x)>=f*c.x+d*c.y)return!1;const y=u*(a.y-h.y),b=u*(h.x-a.x),w=y*n+b*i,_=y*r+b*i,A=y*n+b*o,C=y*r+b*o;return!(Math.max(w,_,A,C)<=y*a.x+b*a.y||Math.min(w,_,A,C)>=y*c.x+b*c.y)}pad(t=0,e=t){return this.x-=t,this.y-=e,this.width+=t*2,this.height+=e*2,this}fit(t){const e=Math.max(this.x,t.x),n=Math.min(this.x+this.width,t.x+t.width),r=Math.max(this.y,t.y),i=Math.min(this.y+this.height,t.y+t.height);return this.x=e,this.width=Math.max(n-e,0),this.y=r,this.height=Math.max(i-r,0),this}ceil(t=1,e=.001){const n=Math.ceil((this.x+this.width-e)*t)/t,r=Math.ceil((this.y+this.height-e)*t)/t;return this.x=Math.floor((this.x+e)*t)/t,this.y=Math.floor((this.y+e)*t)/t,this.width=n-this.x,this.height=r-this.y,this}enlarge(t){const e=Math.min(this.x,t.x),n=Math.max(this.x+this.width,t.x+t.width),r=Math.min(this.y,t.y),i=Math.max(this.y+this.height,t.y+t.height);return this.x=e,this.width=n-e,this.y=r,this.height=i-r,this}getBounds(t){return t||(t=new q),t.copyFrom(this),t}containsRect(t){if(this.width<=0||this.height<=0)return!1;const e=t.x,n=t.y,r=t.x+t.width,i=t.y+t.height;return e>=this.x&&e<this.x+this.width&&n>=this.y&&n<this.y+this.height&&r>=this.x&&r<this.x+this.width&&i>=this.y&&i<this.y+this.height}set(t,e,n,r){return this.x=t,this.y=e,this.width=n,this.height=r,this}toString(){return`[pixi.js/math:Rectangle x=${this.x} y=${this.y} width=${this.width} height=${this.height}]`}}const vn={default:-1};function lt(s="default"){return vn[s]===void 0&&(vn[s]=-1),++vn[s]}const di={},Z="8.0.0",Ac="8.3.4";function V(s,t,e=3){if(di[t])return;let n=new Error().stack;typeof n>"u"?console.warn("PixiJS Deprecation Warning: ",`${t}
Deprecated since v${s}`):(n=n.split(`
`).splice(e).join(`
`),console.groupCollapsed?(console.groupCollapsed("%cPixiJS Deprecation Warning: %c%s","color:#614108;background:#fffbe6","font-weight:normal;color:#614108;background:#fffbe6",`${t}
Deprecated since v${s}`),console.warn(n),console.groupEnd()):(console.warn("PixiJS Deprecation Warning: ",`${t}
Deprecated since v${s}`),console.warn(n))),di[t]=!0}const qo=()=>{};function $e(s){return s+=s===0?1:0,--s,s|=s>>>1,s|=s>>>2,s|=s>>>4,s|=s>>>8,s|=s>>>16,s+1}function fi(s){return!(s&s-1)&&!!s}function Ko(s){const t={};for(const e in s)s[e]!==void 0&&(t[e]=s[e]);return t}const pi=Object.create(null);function Sc(s){const t=pi[s];return t===void 0&&(pi[s]=lt("resource")),t}const Zo=class Qo extends Wt{constructor(t={}){super(),this._resourceType="textureSampler",this._touched=0,this._maxAnisotropy=1,this.destroyed=!1,t={...Qo.defaultOptions,...t},this.addressMode=t.addressMode,this.addressModeU=t.addressModeU??this.addressModeU,this.addressModeV=t.addressModeV??this.addressModeV,this.addressModeW=t.addressModeW??this.addressModeW,this.scaleMode=t.scaleMode,this.magFilter=t.magFilter??this.magFilter,this.minFilter=t.minFilter??this.minFilter,this.mipmapFilter=t.mipmapFilter??this.mipmapFilter,this.lodMinClamp=t.lodMinClamp,this.lodMaxClamp=t.lodMaxClamp,this.compare=t.compare,this.maxAnisotropy=t.maxAnisotropy??1}set addressMode(t){this.addressModeU=t,this.addressModeV=t,this.addressModeW=t}get addressMode(){return this.addressModeU}set wrapMode(t){V(Z,"TextureStyle.wrapMode is now TextureStyle.addressMode"),this.addressMode=t}get wrapMode(){return this.addressMode}set scaleMode(t){this.magFilter=t,this.minFilter=t,this.mipmapFilter=t}get scaleMode(){return this.magFilter}set maxAnisotropy(t){this._maxAnisotropy=Math.min(t,16),this._maxAnisotropy>1&&(this.scaleMode="linear")}get maxAnisotropy(){return this._maxAnisotropy}get _resourceId(){return this._sharedResourceId||this._generateResourceId()}update(){this.emit("change",this),this._sharedResourceId=null}_generateResourceId(){const t=`${this.addressModeU}-${this.addressModeV}-${this.addressModeW}-${this.magFilter}-${this.minFilter}-${this.mipmapFilter}-${this.lodMinClamp}-${this.lodMaxClamp}-${this.compare}-${this._maxAnisotropy}`;return this._sharedResourceId=Sc(t),this._resourceId}destroy(){this.destroyed=!0,this.emit("destroy",this),this.emit("change",this),this.removeAllListeners()}};Zo.defaultOptions={addressMode:"clamp-to-edge",scaleMode:"linear"};let Ve=Zo;const Jo=class ta extends Wt{constructor(t={}){super(),this.options=t,this.uid=lt("textureSource"),this._resourceType="textureSource",this._resourceId=lt("resource"),this.uploadMethodId="unknown",this._resolution=1,this.pixelWidth=1,this.pixelHeight=1,this.width=1,this.height=1,this.sampleCount=1,this.mipLevelCount=1,this.autoGenerateMipmaps=!1,this.format="rgba8unorm",this.dimension="2d",this.antialias=!1,this._touched=0,this._batchTick=-1,this._textureBindLocation=-1,t={...ta.defaultOptions,...t},this.label=t.label??"",this.resource=t.resource,this.autoGarbageCollect=t.autoGarbageCollect,this._resolution=t.resolution,t.width?this.pixelWidth=t.width*this._resolution:this.pixelWidth=this.resource?this.resourceWidth??1:1,t.height?this.pixelHeight=t.height*this._resolution:this.pixelHeight=this.resource?this.resourceHeight??1:1,this.width=this.pixelWidth/this._resolution,this.height=this.pixelHeight/this._resolution,this.format=t.format,this.dimension=t.dimensions,this.mipLevelCount=t.mipLevelCount,this.autoGenerateMipmaps=t.autoGenerateMipmaps,this.sampleCount=t.sampleCount,this.antialias=t.antialias,this.alphaMode=t.alphaMode,this.style=new Ve(Ko(t)),this.destroyed=!1,this._refreshPOT()}get source(){return this}get style(){return this._style}set style(t){var e,n;this.style!==t&&((e=this._style)==null||e.off("change",this._onStyleChange,this),this._style=t,(n=this._style)==null||n.on("change",this._onStyleChange,this),this._onStyleChange())}get addressMode(){return this._style.addressMode}set addressMode(t){this._style.addressMode=t}get repeatMode(){return this._style.addressMode}set repeatMode(t){this._style.addressMode=t}get magFilter(){return this._style.magFilter}set magFilter(t){this._style.magFilter=t}get minFilter(){return this._style.minFilter}set minFilter(t){this._style.minFilter=t}get mipmapFilter(){return this._style.mipmapFilter}set mipmapFilter(t){this._style.mipmapFilter=t}get lodMinClamp(){return this._style.lodMinClamp}set lodMinClamp(t){this._style.lodMinClamp=t}get lodMaxClamp(){return this._style.lodMaxClamp}set lodMaxClamp(t){this._style.lodMaxClamp=t}_onStyleChange(){this.emit("styleChange",this)}update(){if(this.resource){const t=this._resolution;if(this.resize(this.resourceWidth/t,this.resourceHeight/t))return}this.emit("update",this)}destroy(){this.destroyed=!0,this.emit("destroy",this),this.emit("change",this),this._style&&(this._style.destroy(),this._style=null),this.uploadMethodId=null,this.resource=null,this.removeAllListeners()}unload(){this._resourceId=lt("resource"),this.emit("change",this),this.emit("unload",this)}get resourceWidth(){const{resource:t}=this;return t.naturalWidth||t.videoWidth||t.displayWidth||t.width}get resourceHeight(){const{resource:t}=this;return t.naturalHeight||t.videoHeight||t.displayHeight||t.height}get resolution(){return this._resolution}set resolution(t){this._resolution!==t&&(this._resolution=t,this.width=this.pixelWidth/t,this.height=this.pixelHeight/t)}resize(t,e,n){n||(n=this._resolution),t||(t=this.width),e||(e=this.height);const r=Math.round(t*n),i=Math.round(e*n);return this.width=r/n,this.height=i/n,this._resolution=n,this.pixelWidth===r&&this.pixelHeight===i?!1:(this._refreshPOT(),this.pixelWidth=r,this.pixelHeight=i,this.emit("resize",this),this._resourceId=lt("resource"),this.emit("change",this),!0)}updateMipmaps(){this.autoGenerateMipmaps&&this.mipLevelCount>1&&this.emit("updateMipmaps",this)}set wrapMode(t){this._style.wrapMode=t}get wrapMode(){return this._style.wrapMode}set scaleMode(t){this._style.scaleMode=t}get scaleMode(){return this._style.scaleMode}_refreshPOT(){this.isPowerOfTwo=fi(this.pixelWidth)&&fi(this.pixelHeight)}static test(t){throw new Error("Unimplemented")}};Jo.defaultOptions={resolution:1,format:"bgra8unorm",alphaMode:"premultiply-alpha-on-upload",dimensions:"2d",mipLevelCount:1,autoGenerateMipmaps:!1,sampleCount:1,antialias:!1,autoGarbageCollect:!1};let jt=Jo;class Nr extends jt{constructor(t){const e=t.resource||new Float32Array(t.width*t.height*4);let n=t.format;n||(e instanceof Float32Array?n="rgba32float":e instanceof Int32Array||e instanceof Uint32Array?n="rgba32uint":e instanceof Int16Array||e instanceof Uint16Array?n="rgba16uint":(e instanceof Int8Array,n="bgra8unorm")),super({...t,resource:e,format:n}),this.uploadMethodId="buffer"}static test(t){return t instanceof Int8Array||t instanceof Uint8Array||t instanceof Uint8ClampedArray||t instanceof Int16Array||t instanceof Uint16Array||t instanceof Int32Array||t instanceof Uint32Array||t instanceof Float32Array}}Nr.extension=N.TextureSource;const mi=new X;class Cc{constructor(t,e){this.mapCoord=new X,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._textureID=-1,this._updateID=0,this.clampOffset=0,typeof e>"u"?this.clampMargin=t.width<10?0:.5:this.clampMargin=e,this.isSimple=!1,this.texture=t}get texture(){return this._texture}set texture(t){var e;this.texture!==t&&((e=this._texture)==null||e.removeListener("update",this.update,this),this._texture=t,this._texture.addListener("update",this.update,this),this.update())}multiplyUvs(t,e){e===void 0&&(e=t);const n=this.mapCoord;for(let r=0;r<t.length;r+=2){const i=t[r],o=t[r+1];e[r]=i*n.a+o*n.c+n.tx,e[r+1]=i*n.b+o*n.d+n.ty}return e}update(){const t=this._texture;this._updateID++;const e=t.uvs;this.mapCoord.set(e.x1-e.x0,e.y1-e.y0,e.x3-e.x0,e.y3-e.y0,e.x0,e.y0);const n=t.orig,r=t.trim;r&&(mi.set(n.width/r.width,0,0,n.height/r.height,-r.x/r.width,-r.y/r.height),this.mapCoord.append(mi));const i=t.source,o=this.uClampFrame,a=this.clampMargin/i._resolution,l=this.clampOffset/i._resolution;return o[0]=(t.frame.x+a+l)/i.width,o[1]=(t.frame.y+a+l)/i.height,o[2]=(t.frame.x+t.frame.width-a+l)/i.width,o[3]=(t.frame.y+t.frame.height-a+l)/i.height,this.uClampOffset[0]=this.clampOffset/i.pixelWidth,this.uClampOffset[1]=this.clampOffset/i.pixelHeight,this.isSimple=t.frame.width===i.width&&t.frame.height===i.height&&t.rotate===0,!0}}class $ extends Wt{constructor({source:t,label:e,frame:n,orig:r,trim:i,defaultAnchor:o,defaultBorders:a,rotate:l,dynamic:h}={}){if(super(),this.uid=lt("texture"),this.uvs={x0:0,y0:0,x1:0,y1:0,x2:0,y2:0,x3:0,y3:0},this.frame=new q,this.noFrame=!1,this.dynamic=!1,this.isTexture=!0,this.label=e,this.source=(t==null?void 0:t.source)??new jt,this.noFrame=!n,n)this.frame.copyFrom(n);else{const{width:c,height:u}=this._source;this.frame.width=c,this.frame.height=u}this.orig=r||this.frame,this.trim=i,this.rotate=l??0,this.defaultAnchor=o,this.defaultBorders=a,this.destroyed=!1,this.dynamic=h||!1,this.updateUvs()}set source(t){this._source&&this._source.off("resize",this.update,this),this._source=t,t.on("resize",this.update,this),this.emit("update",this)}get source(){return this._source}get textureMatrix(){return this._textureMatrix||(this._textureMatrix=new Cc(this)),this._textureMatrix}get width(){return this.orig.width}get height(){return this.orig.height}updateUvs(){const{uvs:t,frame:e}=this,{width:n,height:r}=this._source,i=e.x/n,o=e.y/r,a=e.width/n,l=e.height/r;let h=this.rotate;if(h){const c=a/2,u=l/2,f=i+c,d=o+u;h=et.add(h,et.NW),t.x0=f+c*et.uX(h),t.y0=d+u*et.uY(h),h=et.add(h,2),t.x1=f+c*et.uX(h),t.y1=d+u*et.uY(h),h=et.add(h,2),t.x2=f+c*et.uX(h),t.y2=d+u*et.uY(h),h=et.add(h,2),t.x3=f+c*et.uX(h),t.y3=d+u*et.uY(h)}else t.x0=i,t.y0=o,t.x1=i+a,t.y1=o,t.x2=i+a,t.y2=o+l,t.x3=i,t.y3=o+l}destroy(t=!1){this._source&&t&&(this._source.destroy(),this._source=null),this._textureMatrix=null,this.destroyed=!0,this.emit("destroy",this),this.removeAllListeners()}update(){this.noFrame&&(this.frame.width=this._source.width,this.frame.height=this._source.height),this.updateUvs(),this.emit("update",this)}get baseTexture(){return V(Z,"Texture.baseTexture is now Texture.source"),this._source}}$.EMPTY=new $({label:"EMPTY",source:new jt({label:"EMPTY"})});$.EMPTY.destroy=qo;$.WHITE=new $({source:new Nr({resource:new Uint8Array([255,255,255,255]),width:1,height:1,alphaMode:"premultiply-alpha-on-upload",label:"WHITE"}),label:"WHITE"});$.WHITE.destroy=qo;function kc(s,t,e){const{width:n,height:r}=e.orig,i=e.trim;if(i){const o=i.width,a=i.height;s.minX=i.x-t._x*n,s.maxX=s.minX+o,s.minY=i.y-t._y*r,s.maxY=s.minY+a}else s.minX=-t._x*n,s.maxX=s.minX+n,s.minY=-t._y*r,s.maxY=s.minY+r}const gi=new X;class Dt{constructor(t=1/0,e=1/0,n=-1/0,r=-1/0){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.matrix=gi,this.minX=t,this.minY=e,this.maxX=n,this.maxY=r}isEmpty(){return this.minX>this.maxX||this.minY>this.maxY}get rectangle(){this._rectangle||(this._rectangle=new q);const t=this._rectangle;return this.minX>this.maxX||this.minY>this.maxY?(t.x=0,t.y=0,t.width=0,t.height=0):t.copyFromBounds(this),t}clear(){return this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.matrix=gi,this}set(t,e,n,r){this.minX=t,this.minY=e,this.maxX=n,this.maxY=r}addFrame(t,e,n,r,i){i||(i=this.matrix);const o=i.a,a=i.b,l=i.c,h=i.d,c=i.tx,u=i.ty;let f=this.minX,d=this.minY,p=this.maxX,g=this.maxY,m=o*t+l*e+c,x=a*t+h*e+u;m<f&&(f=m),x<d&&(d=x),m>p&&(p=m),x>g&&(g=x),m=o*n+l*e+c,x=a*n+h*e+u,m<f&&(f=m),x<d&&(d=x),m>p&&(p=m),x>g&&(g=x),m=o*t+l*r+c,x=a*t+h*r+u,m<f&&(f=m),x<d&&(d=x),m>p&&(p=m),x>g&&(g=x),m=o*n+l*r+c,x=a*n+h*r+u,m<f&&(f=m),x<d&&(d=x),m>p&&(p=m),x>g&&(g=x),this.minX=f,this.minY=d,this.maxX=p,this.maxY=g}addRect(t,e){this.addFrame(t.x,t.y,t.x+t.width,t.y+t.height,e)}addBounds(t,e){this.addFrame(t.minX,t.minY,t.maxX,t.maxY,e)}addBoundsMask(t){this.minX=this.minX>t.minX?this.minX:t.minX,this.minY=this.minY>t.minY?this.minY:t.minY,this.maxX=this.maxX<t.maxX?this.maxX:t.maxX,this.maxY=this.maxY<t.maxY?this.maxY:t.maxY}applyMatrix(t){const e=this.minX,n=this.minY,r=this.maxX,i=this.maxY,{a:o,b:a,c:l,d:h,tx:c,ty:u}=t;let f=o*e+l*n+c,d=a*e+h*n+u;this.minX=f,this.minY=d,this.maxX=f,this.maxY=d,f=o*r+l*n+c,d=a*r+h*n+u,this.minX=f<this.minX?f:this.minX,this.minY=d<this.minY?d:this.minY,this.maxX=f>this.maxX?f:this.maxX,this.maxY=d>this.maxY?d:this.maxY,f=o*e+l*i+c,d=a*e+h*i+u,this.minX=f<this.minX?f:this.minX,this.minY=d<this.minY?d:this.minY,this.maxX=f>this.maxX?f:this.maxX,this.maxY=d>this.maxY?d:this.maxY,f=o*r+l*i+c,d=a*r+h*i+u,this.minX=f<this.minX?f:this.minX,this.minY=d<this.minY?d:this.minY,this.maxX=f>this.maxX?f:this.maxX,this.maxY=d>this.maxY?d:this.maxY}fit(t){return this.minX<t.left&&(this.minX=t.left),this.maxX>t.right&&(this.maxX=t.right),this.minY<t.top&&(this.minY=t.top),this.maxY>t.bottom&&(this.maxY=t.bottom),this}fitBounds(t,e,n,r){return this.minX<t&&(this.minX=t),this.maxX>e&&(this.maxX=e),this.minY<n&&(this.minY=n),this.maxY>r&&(this.maxY=r),this}pad(t,e=t){return this.minX-=t,this.maxX+=t,this.minY-=e,this.maxY+=e,this}ceil(){return this.minX=Math.floor(this.minX),this.minY=Math.floor(this.minY),this.maxX=Math.ceil(this.maxX),this.maxY=Math.ceil(this.maxY),this}clone(){return new Dt(this.minX,this.minY,this.maxX,this.maxY)}scale(t,e=t){return this.minX*=t,this.minY*=e,this.maxX*=t,this.maxY*=e,this}get x(){return this.minX}set x(t){const e=this.maxX-this.minX;this.minX=t,this.maxX=t+e}get y(){return this.minY}set y(t){const e=this.maxY-this.minY;this.minY=t,this.maxY=t+e}get width(){return this.maxX-this.minX}set width(t){this.maxX=this.minX+t}get height(){return this.maxY-this.minY}set height(t){this.maxY=this.minY+t}get left(){return this.minX}get right(){return this.maxX}get top(){return this.minY}get bottom(){return this.maxY}get isPositive(){return this.maxX-this.minX>0&&this.maxY-this.minY>0}get isValid(){return this.minX+this.minY!==1/0}addVertexData(t,e,n,r){let i=this.minX,o=this.minY,a=this.maxX,l=this.maxY;r||(r=this.matrix);const h=r.a,c=r.b,u=r.c,f=r.d,d=r.tx,p=r.ty;for(let g=e;g<n;g+=2){const m=t[g],x=t[g+1],y=h*m+u*x+d,b=c*m+f*x+p;i=y<i?y:i,o=b<o?b:o,a=y>a?y:a,l=b>l?b:l}this.minX=i,this.minY=o,this.maxX=a,this.maxY=l}containsPoint(t,e){return this.minX<=t&&this.minY<=e&&this.maxX>=t&&this.maxY>=e}toString(){return`[pixi.js:Bounds minX=${this.minX} minY=${this.minY} maxX=${this.maxX} maxY=${this.maxY} width=${this.width} height=${this.height}]`}copyFrom(t){return this.minX=t.minX,this.minY=t.minY,this.maxX=t.maxX,this.maxY=t.maxY,this}}var Pc={grad:.9,turn:360,rad:360/(2*Math.PI)},ee=function(s){return typeof s=="string"?s.length>0:typeof s=="number"},ht=function(s,t,e){return t===void 0&&(t=0),e===void 0&&(e=Math.pow(10,t)),Math.round(e*s)/e+0},Rt=function(s,t,e){return t===void 0&&(t=0),e===void 0&&(e=1),s>e?e:s>t?s:t},ea=function(s){return(s=isFinite(s)?s%360:0)>0?s:s+360},xi=function(s){return{r:Rt(s.r,0,255),g:Rt(s.g,0,255),b:Rt(s.b,0,255),a:Rt(s.a)}},An=function(s){return{r:ht(s.r),g:ht(s.g),b:ht(s.b),a:ht(s.a,3)}},Mc=/^#([0-9a-f]{3,8})$/i,Ts=function(s){var t=s.toString(16);return t.length<2?"0"+t:t},sa=function(s){var t=s.r,e=s.g,n=s.b,r=s.a,i=Math.max(t,e,n),o=i-Math.min(t,e,n),a=o?i===t?(e-n)/o:i===e?2+(n-t)/o:4+(t-e)/o:0;return{h:60*(a<0?a+6:a),s:i?o/i*100:0,v:i/255*100,a:r}},na=function(s){var t=s.h,e=s.s,n=s.v,r=s.a;t=t/360*6,e/=100,n/=100;var i=Math.floor(t),o=n*(1-e),a=n*(1-(t-i)*e),l=n*(1-(1-t+i)*e),h=i%6;return{r:255*[n,a,o,o,l,n][h],g:255*[l,n,n,a,o,o][h],b:255*[o,o,l,n,n,a][h],a:r}},yi=function(s){return{h:ea(s.h),s:Rt(s.s,0,100),l:Rt(s.l,0,100),a:Rt(s.a)}},bi=function(s){return{h:ht(s.h),s:ht(s.s),l:ht(s.l),a:ht(s.a,3)}},wi=function(s){return na((e=(t=s).s,{h:t.h,s:(e*=((n=t.l)<50?n:100-n)/100)>0?2*e/(n+e)*100:0,v:n+e,a:t.a}));var t,e,n},ps=function(s){return{h:(t=sa(s)).h,s:(r=(200-(e=t.s))*(n=t.v)/100)>0&&r<200?e*n/100/(r<=100?r:200-r)*100:0,l:r/2,a:t.a};var t,e,n,r},Tc=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s*,\s*([+-]?\d*\.?\d+)%\s*,\s*([+-]?\d*\.?\d+)%\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,Ec=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s+([+-]?\d*\.?\d+)%\s+([+-]?\d*\.?\d+)%\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,Ic=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,Bc=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,fr={string:[[function(s){var t=Mc.exec(s);return t?(s=t[1]).length<=4?{r:parseInt(s[0]+s[0],16),g:parseInt(s[1]+s[1],16),b:parseInt(s[2]+s[2],16),a:s.length===4?ht(parseInt(s[3]+s[3],16)/255,2):1}:s.length===6||s.length===8?{r:parseInt(s.substr(0,2),16),g:parseInt(s.substr(2,2),16),b:parseInt(s.substr(4,2),16),a:s.length===8?ht(parseInt(s.substr(6,2),16)/255,2):1}:null:null},"hex"],[function(s){var t=Ic.exec(s)||Bc.exec(s);return t?t[2]!==t[4]||t[4]!==t[6]?null:xi({r:Number(t[1])/(t[2]?100/255:1),g:Number(t[3])/(t[4]?100/255:1),b:Number(t[5])/(t[6]?100/255:1),a:t[7]===void 0?1:Number(t[7])/(t[8]?100:1)}):null},"rgb"],[function(s){var t=Tc.exec(s)||Ec.exec(s);if(!t)return null;var e,n,r=yi({h:(e=t[1],n=t[2],n===void 0&&(n="deg"),Number(e)*(Pc[n]||1)),s:Number(t[3]),l:Number(t[4]),a:t[5]===void 0?1:Number(t[5])/(t[6]?100:1)});return wi(r)},"hsl"]],object:[[function(s){var t=s.r,e=s.g,n=s.b,r=s.a,i=r===void 0?1:r;return ee(t)&&ee(e)&&ee(n)?xi({r:Number(t),g:Number(e),b:Number(n),a:Number(i)}):null},"rgb"],[function(s){var t=s.h,e=s.s,n=s.l,r=s.a,i=r===void 0?1:r;if(!ee(t)||!ee(e)||!ee(n))return null;var o=yi({h:Number(t),s:Number(e),l:Number(n),a:Number(i)});return wi(o)},"hsl"],[function(s){var t=s.h,e=s.s,n=s.v,r=s.a,i=r===void 0?1:r;if(!ee(t)||!ee(e)||!ee(n))return null;var o=function(a){return{h:ea(a.h),s:Rt(a.s,0,100),v:Rt(a.v,0,100),a:Rt(a.a)}}({h:Number(t),s:Number(e),v:Number(n),a:Number(i)});return na(o)},"hsv"]]},_i=function(s,t){for(var e=0;e<t.length;e++){var n=t[e][0](s);if(n)return[n,t[e][1]]}return[null,void 0]},Fc=function(s){return typeof s=="string"?_i(s.trim(),fr.string):typeof s=="object"&&s!==null?_i(s,fr.object):[null,void 0]},Sn=function(s,t){var e=ps(s);return{h:e.h,s:Rt(e.s+100*t,0,100),l:e.l,a:e.a}},Cn=function(s){return(299*s.r+587*s.g+114*s.b)/1e3/255},vi=function(s,t){var e=ps(s);return{h:e.h,s:e.s,l:Rt(e.l+100*t,0,100),a:e.a}},pr=function(){function s(t){this.parsed=Fc(t)[0],this.rgba=this.parsed||{r:0,g:0,b:0,a:1}}return s.prototype.isValid=function(){return this.parsed!==null},s.prototype.brightness=function(){return ht(Cn(this.rgba),2)},s.prototype.isDark=function(){return Cn(this.rgba)<.5},s.prototype.isLight=function(){return Cn(this.rgba)>=.5},s.prototype.toHex=function(){return t=An(this.rgba),e=t.r,n=t.g,r=t.b,o=(i=t.a)<1?Ts(ht(255*i)):"","#"+Ts(e)+Ts(n)+Ts(r)+o;var t,e,n,r,i,o},s.prototype.toRgb=function(){return An(this.rgba)},s.prototype.toRgbString=function(){return t=An(this.rgba),e=t.r,n=t.g,r=t.b,(i=t.a)<1?"rgba("+e+", "+n+", "+r+", "+i+")":"rgb("+e+", "+n+", "+r+")";var t,e,n,r,i},s.prototype.toHsl=function(){return bi(ps(this.rgba))},s.prototype.toHslString=function(){return t=bi(ps(this.rgba)),e=t.h,n=t.s,r=t.l,(i=t.a)<1?"hsla("+e+", "+n+"%, "+r+"%, "+i+")":"hsl("+e+", "+n+"%, "+r+"%)";var t,e,n,r,i},s.prototype.toHsv=function(){return t=sa(this.rgba),{h:ht(t.h),s:ht(t.s),v:ht(t.v),a:ht(t.a,3)};var t},s.prototype.invert=function(){return Vt({r:255-(t=this.rgba).r,g:255-t.g,b:255-t.b,a:t.a});var t},s.prototype.saturate=function(t){return t===void 0&&(t=.1),Vt(Sn(this.rgba,t))},s.prototype.desaturate=function(t){return t===void 0&&(t=.1),Vt(Sn(this.rgba,-t))},s.prototype.grayscale=function(){return Vt(Sn(this.rgba,-1))},s.prototype.lighten=function(t){return t===void 0&&(t=.1),Vt(vi(this.rgba,t))},s.prototype.darken=function(t){return t===void 0&&(t=.1),Vt(vi(this.rgba,-t))},s.prototype.rotate=function(t){return t===void 0&&(t=15),this.hue(this.hue()+t)},s.prototype.alpha=function(t){return typeof t=="number"?Vt({r:(e=this.rgba).r,g:e.g,b:e.b,a:t}):ht(this.rgba.a,3);var e},s.prototype.hue=function(t){var e=ps(this.rgba);return typeof t=="number"?Vt({h:t,s:e.s,l:e.l,a:e.a}):ht(e.h)},s.prototype.isEqual=function(t){return this.toHex()===Vt(t).toHex()},s}(),Vt=function(s){return s instanceof pr?s:new pr(s)},Ai=[],Rc=function(s){s.forEach(function(t){Ai.indexOf(t)<0&&(t(pr,fr),Ai.push(t))})};function Lc(s,t){var e={white:"#ffffff",bisque:"#ffe4c4",blue:"#0000ff",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",antiquewhite:"#faebd7",aqua:"#00ffff",azure:"#f0ffff",whitesmoke:"#f5f5f5",papayawhip:"#ffefd5",plum:"#dda0dd",blanchedalmond:"#ffebcd",black:"#000000",gold:"#ffd700",goldenrod:"#daa520",gainsboro:"#dcdcdc",cornsilk:"#fff8dc",cornflowerblue:"#6495ed",burlywood:"#deb887",aquamarine:"#7fffd4",beige:"#f5f5dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkkhaki:"#bdb76b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",peachpuff:"#ffdab9",darkmagenta:"#8b008b",darkred:"#8b0000",darkorchid:"#9932cc",darkorange:"#ff8c00",darkslateblue:"#483d8b",gray:"#808080",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",deeppink:"#ff1493",deepskyblue:"#00bfff",wheat:"#f5deb3",firebrick:"#b22222",floralwhite:"#fffaf0",ghostwhite:"#f8f8ff",darkviolet:"#9400d3",magenta:"#ff00ff",green:"#008000",dodgerblue:"#1e90ff",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",blueviolet:"#8a2be2",forestgreen:"#228b22",lawngreen:"#7cfc00",indianred:"#cd5c5c",indigo:"#4b0082",fuchsia:"#ff00ff",brown:"#a52a2a",maroon:"#800000",mediumblue:"#0000cd",lightcoral:"#f08080",darkturquoise:"#00ced1",lightcyan:"#e0ffff",ivory:"#fffff0",lightyellow:"#ffffe0",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",linen:"#faf0e6",mediumaquamarine:"#66cdaa",lemonchiffon:"#fffacd",lime:"#00ff00",khaki:"#f0e68c",mediumseagreen:"#3cb371",limegreen:"#32cd32",mediumspringgreen:"#00fa9a",lightskyblue:"#87cefa",lightblue:"#add8e6",midnightblue:"#191970",lightpink:"#ffb6c1",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",mintcream:"#f5fffa",lightslategray:"#778899",lightslategrey:"#778899",navajowhite:"#ffdead",navy:"#000080",mediumvioletred:"#c71585",powderblue:"#b0e0e6",palegoldenrod:"#eee8aa",oldlace:"#fdf5e6",paleturquoise:"#afeeee",mediumturquoise:"#48d1cc",mediumorchid:"#ba55d3",rebeccapurple:"#663399",lightsteelblue:"#b0c4de",mediumslateblue:"#7b68ee",thistle:"#d8bfd8",tan:"#d2b48c",orchid:"#da70d6",mediumpurple:"#9370db",purple:"#800080",pink:"#ffc0cb",skyblue:"#87ceeb",springgreen:"#00ff7f",palegreen:"#98fb98",red:"#ff0000",yellow:"#ffff00",slateblue:"#6a5acd",lavenderblush:"#fff0f5",peru:"#cd853f",palevioletred:"#db7093",violet:"#ee82ee",teal:"#008080",slategray:"#708090",slategrey:"#708090",aliceblue:"#f0f8ff",darkseagreen:"#8fbc8f",darkolivegreen:"#556b2f",greenyellow:"#adff2f",seagreen:"#2e8b57",seashell:"#fff5ee",tomato:"#ff6347",silver:"#c0c0c0",sienna:"#a0522d",lavender:"#e6e6fa",lightgreen:"#90ee90",orange:"#ffa500",orangered:"#ff4500",steelblue:"#4682b4",royalblue:"#4169e1",turquoise:"#40e0d0",yellowgreen:"#9acd32",salmon:"#fa8072",saddlebrown:"#8b4513",sandybrown:"#f4a460",rosybrown:"#bc8f8f",darksalmon:"#e9967a",lightgoldenrodyellow:"#fafad2",snow:"#fffafa",lightgrey:"#d3d3d3",lightgray:"#d3d3d3",dimgray:"#696969",dimgrey:"#696969",olivedrab:"#6b8e23",olive:"#808000"},n={};for(var r in e)n[e[r]]=r;var i={};s.prototype.toName=function(o){if(!(this.rgba.a||this.rgba.r||this.rgba.g||this.rgba.b))return"transparent";var a,l,h=n[this.toHex()];if(h)return h;if(o!=null&&o.closest){var c=this.toRgb(),u=1/0,f="black";if(!i.length)for(var d in e)i[d]=new s(e[d]).toRgb();for(var p in e){var g=(a=c,l=i[p],Math.pow(a.r-l.r,2)+Math.pow(a.g-l.g,2)+Math.pow(a.b-l.b,2));g<u&&(u=g,f=p)}return f}},t.string.push([function(o){var a=o.toLowerCase(),l=a==="transparent"?"#0000":e[a];return l?new s(l).toRgb():null},"name"])}Rc([Lc]);const Ye=class hs{constructor(t=16777215){this._value=null,this._components=new Float32Array(4),this._components.fill(1),this._int=16777215,this.value=t}get red(){return this._components[0]}get green(){return this._components[1]}get blue(){return this._components[2]}get alpha(){return this._components[3]}setValue(t){return this.value=t,this}set value(t){if(t instanceof hs)this._value=this._cloneSource(t._value),this._int=t._int,this._components.set(t._components);else{if(t===null)throw new Error("Cannot set Color#value to null");(this._value===null||!this._isSourceEqual(this._value,t))&&(this._value=this._cloneSource(t),this._normalize(this._value))}}get value(){return this._value}_cloneSource(t){return typeof t=="string"||typeof t=="number"||t instanceof Number||t===null?t:Array.isArray(t)||ArrayBuffer.isView(t)?t.slice(0):typeof t=="object"&&t!==null?{...t}:t}_isSourceEqual(t,e){const n=typeof t;if(n!==typeof e)return!1;if(n==="number"||n==="string"||t instanceof Number)return t===e;if(Array.isArray(t)&&Array.isArray(e)||ArrayBuffer.isView(t)&&ArrayBuffer.isView(e))return t.length!==e.length?!1:t.every((i,o)=>i===e[o]);if(t!==null&&e!==null){const i=Object.keys(t),o=Object.keys(e);return i.length!==o.length?!1:i.every(a=>t[a]===e[a])}return t===e}toRgba(){const[t,e,n,r]=this._components;return{r:t,g:e,b:n,a:r}}toRgb(){const[t,e,n]=this._components;return{r:t,g:e,b:n}}toRgbaString(){const[t,e,n]=this.toUint8RgbArray();return`rgba(${t},${e},${n},${this.alpha})`}toUint8RgbArray(t){const[e,n,r]=this._components;return this._arrayRgb||(this._arrayRgb=[]),t||(t=this._arrayRgb),t[0]=Math.round(e*255),t[1]=Math.round(n*255),t[2]=Math.round(r*255),t}toArray(t){this._arrayRgba||(this._arrayRgba=[]),t||(t=this._arrayRgba);const[e,n,r,i]=this._components;return t[0]=e,t[1]=n,t[2]=r,t[3]=i,t}toRgbArray(t){this._arrayRgb||(this._arrayRgb=[]),t||(t=this._arrayRgb);const[e,n,r]=this._components;return t[0]=e,t[1]=n,t[2]=r,t}toNumber(){return this._int}toBgrNumber(){const[t,e,n]=this.toUint8RgbArray();return(n<<16)+(e<<8)+t}toLittleEndianNumber(){const t=this._int;return(t>>16)+(t&65280)+((t&255)<<16)}multiply(t){const[e,n,r,i]=hs._temp.setValue(t)._components;return this._components[0]*=e,this._components[1]*=n,this._components[2]*=r,this._components[3]*=i,this._refreshInt(),this._value=null,this}premultiply(t,e=!0){return e&&(this._components[0]*=t,this._components[1]*=t,this._components[2]*=t),this._components[3]=t,this._refreshInt(),this._value=null,this}toPremultiplied(t,e=!0){if(t===1)return(255<<24)+this._int;if(t===0)return e?0:this._int;let n=this._int>>16&255,r=this._int>>8&255,i=this._int&255;return e&&(n=n*t+.5|0,r=r*t+.5|0,i=i*t+.5|0),(t*255<<24)+(n<<16)+(r<<8)+i}toHex(){const t=this._int.toString(16);return`#${"000000".substring(0,6-t.length)+t}`}toHexa(){const e=Math.round(this._components[3]*255).toString(16);return this.toHex()+"00".substring(0,2-e.length)+e}setAlpha(t){return this._components[3]=this._clamp(t),this}_normalize(t){let e,n,r,i;if((typeof t=="number"||t instanceof Number)&&t>=0&&t<=16777215){const o=t;e=(o>>16&255)/255,n=(o>>8&255)/255,r=(o&255)/255,i=1}else if((Array.isArray(t)||t instanceof Float32Array)&&t.length>=3&&t.length<=4)t=this._clamp(t),[e,n,r,i=1]=t;else if((t instanceof Uint8Array||t instanceof Uint8ClampedArray)&&t.length>=3&&t.length<=4)t=this._clamp(t,0,255),[e,n,r,i=255]=t,e/=255,n/=255,r/=255,i/=255;else if(typeof t=="string"||typeof t=="object"){if(typeof t=="string"){const a=hs.HEX_PATTERN.exec(t);a&&(t=`#${a[2]}`)}const o=Vt(t);o.isValid()&&({r:e,g:n,b:r,a:i}=o.rgba,e/=255,n/=255,r/=255)}if(e!==void 0)this._components[0]=e,this._components[1]=n,this._components[2]=r,this._components[3]=i,this._refreshInt();else throw new Error(`Unable to convert color ${t}`)}_refreshInt(){this._clamp(this._components);const[t,e,n]=this._components;this._int=(t*255<<16)+(e*255<<8)+(n*255|0)}_clamp(t,e=0,n=1){return typeof t=="number"?Math.min(Math.max(t,e),n):(t.forEach((r,i)=>{t[i]=Math.min(Math.max(r,e),n)}),t)}static isColorLike(t){return typeof t=="number"||typeof t=="string"||t instanceof Number||t instanceof hs||Array.isArray(t)||t instanceof Uint8Array||t instanceof Uint8ClampedArray||t instanceof Float32Array||t.r!==void 0&&t.g!==void 0&&t.b!==void 0||t.r!==void 0&&t.g!==void 0&&t.b!==void 0&&t.a!==void 0||t.h!==void 0&&t.s!==void 0&&t.l!==void 0||t.h!==void 0&&t.s!==void 0&&t.l!==void 0&&t.a!==void 0||t.h!==void 0&&t.s!==void 0&&t.v!==void 0||t.h!==void 0&&t.s!==void 0&&t.v!==void 0&&t.a!==void 0}};Ye.shared=new Ye;Ye._temp=new Ye;Ye.HEX_PATTERN=/^(#|0x)?(([a-f0-9]{3}){1,2}([a-f0-9]{2})?)$/i;let ot=Ye;const zc={cullArea:null,cullable:!1,cullableChildren:!0};class Ur{constructor(t,e){this._pool=[],this._count=0,this._index=0,this._classType=t,e&&this.prepopulate(e)}prepopulate(t){for(let e=0;e<t;e++)this._pool[this._index++]=new this._classType;this._count+=t}get(t){var n;let e;return this._index>0?e=this._pool[--this._index]:e=new this._classType,(n=e.init)==null||n.call(e,t),e}return(t){var e;(e=t.reset)==null||e.call(t),this._pool[this._index++]=t}get totalSize(){return this._count}get totalFree(){return this._index}get totalUsed(){return this._count-this._index}clear(){this._pool.length=0,this._index=0}}class Gc{constructor(){this._poolsByClass=new Map}prepopulate(t,e){this.getPool(t).prepopulate(e)}get(t,e){return this.getPool(t).get(e)}return(t){this.getPool(t.constructor).return(t)}getPool(t){return this._poolsByClass.has(t)||this._poolsByClass.set(t,new Ur(t)),this._poolsByClass.get(t)}stats(){const t={};return this._poolsByClass.forEach(e=>{const n=t[e._classType.name]?e._classType.name+e._classType.ID:e._classType.name;t[n]={free:e.totalFree,used:e.totalUsed,size:e.totalSize}}),t}}const ae=new Gc,Oc={get isCachedAsTexture(){var s;return!!((s=this.renderGroup)!=null&&s.isCachedAsTexture)},cacheAsTexture(s){typeof s=="boolean"&&s===!1?this.disableRenderGroup():(this.enableRenderGroup(),this.renderGroup.enableCacheAsTexture(s===!0?{}:s))},updateCacheTexture(){var s;(s=this.renderGroup)==null||s.updateCacheTexture()},get cacheAsBitmap(){return this.isCachedAsTexture},set cacheAsBitmap(s){V("v8.6.0","cacheAsBitmap is deprecated, use cacheAsTexture instead."),this.cacheAsTexture(s)}};function Nc(s,t,e){const n=s.length;let r;if(t>=n||e===0)return;e=t+e>n?n-t:e;const i=n-e;for(r=t;r<i;++r)s[r]=s[r+e];s.length=i}const Uc={allowChildren:!0,removeChildren(s=0,t){var i;const e=t??this.children.length,n=e-s,r=[];if(n>0&&n<=e){for(let a=e-1;a>=s;a--){const l=this.children[a];l&&(r.push(l),l.parent=null)}Nc(this.children,s,e);const o=this.renderGroup||this.parentRenderGroup;o&&o.removeChildren(r);for(let a=0;a<r.length;++a){const l=r[a];(i=l.parentRenderLayer)==null||i.detach(l),this.emit("childRemoved",l,this,a),r[a].emit("removed",this)}return r.length>0&&this._didViewChangeTick++,r}else if(n===0&&this.children.length===0)return r;throw new RangeError("removeChildren: numeric values are outside the acceptable range.")},removeChildAt(s){const t=this.getChildAt(s);return this.removeChild(t)},getChildAt(s){if(s<0||s>=this.children.length)throw new Error(`getChildAt: Index (${s}) does not exist.`);return this.children[s]},setChildIndex(s,t){if(t<0||t>=this.children.length)throw new Error(`The index ${t} supplied is out of bounds ${this.children.length}`);this.getChildIndex(s),this.addChildAt(s,t)},getChildIndex(s){const t=this.children.indexOf(s);if(t===-1)throw new Error("The supplied Container must be a child of the caller");return t},addChildAt(s,t){this.allowChildren||V(Z,"addChildAt: Only Containers will be allowed to add children in v8.0.0");const{children:e}=this;if(t<0||t>e.length)throw new Error(`${s}addChildAt: The index ${t} supplied is out of bounds ${e.length}`);if(s.parent){const r=s.parent.children.indexOf(s);if(s.parent===this&&r===t)return s;r!==-1&&s.parent.children.splice(r,1)}t===e.length?e.push(s):e.splice(t,0,s),s.parent=this,s.didChange=!0,s._updateFlags=15;const n=this.renderGroup||this.parentRenderGroup;return n&&n.addChild(s),this.sortableChildren&&(this.sortDirty=!0),this.emit("childAdded",s,this,t),s.emit("added",this),s},swapChildren(s,t){if(s===t)return;const e=this.getChildIndex(s),n=this.getChildIndex(t);this.children[e]=t,this.children[n]=s;const r=this.renderGroup||this.parentRenderGroup;r&&(r.structureDidChange=!0),this._didContainerChangeTick++},removeFromParent(){var s;(s=this.parent)==null||s.removeChild(this)},reparentChild(...s){return s.length===1?this.reparentChildAt(s[0],this.children.length):(s.forEach(t=>this.reparentChildAt(t,this.children.length)),s[0])},reparentChildAt(s,t){if(s.parent===this)return this.setChildIndex(s,t),s;const e=s.worldTransform.clone();s.removeFromParent(),this.addChildAt(s,t);const n=this.worldTransform.clone();return n.invert(),e.prepend(n),s.setFromMatrix(e),s}},Dc={collectRenderables(s,t,e){this.parentRenderLayer&&this.parentRenderLayer!==e||this.globalDisplayStatus<7||!this.includeInBuild||(this.sortableChildren&&this.sortChildren(),this.isSimple?this.collectRenderablesSimple(s,t,e):this.renderGroup?t.renderPipes.renderGroup.addRenderGroup(this.renderGroup,s):this.collectRenderablesWithEffects(s,t,e))},collectRenderablesSimple(s,t,e){const n=this.children,r=n.length;for(let i=0;i<r;i++)n[i].collectRenderables(s,t,e)},collectRenderablesWithEffects(s,t,e){const{renderPipes:n}=t;for(let r=0;r<this.effects.length;r++){const i=this.effects[r];n[i.pipe].push(i,this,s)}this.collectRenderablesSimple(s,t,e);for(let r=this.effects.length-1;r>=0;r--){const i=this.effects[r];n[i.pipe].pop(i,this,s)}}};class Si{constructor(){this.pipe="filter",this.priority=1}destroy(){for(let t=0;t<this.filters.length;t++)this.filters[t].destroy();this.filters=null,this.filterArea=null}}class Hc{constructor(){this._effectClasses=[],this._tests=[],this._initialized=!1}init(){this._initialized||(this._initialized=!0,this._effectClasses.forEach(t=>{this.add({test:t.test,maskClass:t})}))}add(t){this._tests.push(t)}getMaskEffect(t){this._initialized||this.init();for(let e=0;e<this._tests.length;e++){const n=this._tests[e];if(n.test(t))return ae.get(n.maskClass,t)}return t}returnMaskEffect(t){ae.return(t)}}const mr=new Hc;dt.handleByList(N.MaskEffect,mr._effectClasses);const Wc={_maskEffect:null,_maskOptions:{inverse:!1},_filterEffect:null,effects:[],_markStructureAsChanged(){const s=this.renderGroup||this.parentRenderGroup;s&&(s.structureDidChange=!0)},addEffect(s){this.effects.indexOf(s)===-1&&(this.effects.push(s),this.effects.sort((e,n)=>e.priority-n.priority),this._markStructureAsChanged(),this._updateIsSimple())},removeEffect(s){const t=this.effects.indexOf(s);t!==-1&&(this.effects.splice(t,1),this._markStructureAsChanged(),this._updateIsSimple())},set mask(s){const t=this._maskEffect;(t==null?void 0:t.mask)!==s&&(t&&(this.removeEffect(t),mr.returnMaskEffect(t),this._maskEffect=null),s!=null&&(this._maskEffect=mr.getMaskEffect(s),this.addEffect(this._maskEffect)))},get mask(){var s;return(s=this._maskEffect)==null?void 0:s.mask},setMask(s){this._maskOptions={...this._maskOptions,...s},s.mask&&(this.mask=s.mask),this._markStructureAsChanged()},set filters(s){var i;!Array.isArray(s)&&s&&(s=[s]);const t=this._filterEffect||(this._filterEffect=new Si);s=s;const e=(s==null?void 0:s.length)>0,n=((i=t.filters)==null?void 0:i.length)>0,r=e!==n;s=Array.isArray(s)?s.slice(0):s,t.filters=Object.freeze(s),r&&(e?this.addEffect(t):(this.removeEffect(t),t.filters=s??null))},get filters(){var s;return(s=this._filterEffect)==null?void 0:s.filters},set filterArea(s){this._filterEffect||(this._filterEffect=new Si),this._filterEffect.filterArea=s},get filterArea(){var s;return(s=this._filterEffect)==null?void 0:s.filterArea}},jc={label:null,get name(){return V(Z,"Container.name property has been removed, use Container.label instead"),this.label},set name(s){V(Z,"Container.name property has been removed, use Container.label instead"),this.label=s},getChildByName(s,t=!1){return this.getChildByLabel(s,t)},getChildByLabel(s,t=!1){const e=this.children;for(let n=0;n<e.length;n++){const r=e[n];if(r.label===s||s instanceof RegExp&&s.test(r.label))return r}if(t)for(let n=0;n<e.length;n++){const i=e[n].getChildByLabel(s,!0);if(i)return i}return null},getChildrenByLabel(s,t=!1,e=[]){const n=this.children;for(let r=0;r<n.length;r++){const i=n[r];(i.label===s||s instanceof RegExp&&s.test(i.label))&&e.push(i)}if(t)for(let r=0;r<n.length;r++)n[r].getChildrenByLabel(s,!0,e);return e}},mt=new Ur(X),le=new Ur(Dt),$c=new X,Vc={getFastGlobalBounds(s,t){t||(t=new Dt),t.clear(),this._getGlobalBoundsRecursive(!!s,t,this.parentRenderLayer),t.isValid||t.set(0,0,0,0);const e=this.renderGroup||this.parentRenderGroup;return t.applyMatrix(e.worldTransform),t},_getGlobalBoundsRecursive(s,t,e){let n=t;if(s&&this.parentRenderLayer&&this.parentRenderLayer!==e||this.localDisplayStatus!==7||!this.measurable)return;const r=!!this.effects.length;if((this.renderGroup||r)&&(n=le.get().clear()),this.boundsArea)t.addRect(this.boundsArea,this.worldTransform);else{if(this.renderPipeId){const o=this.bounds;n.addFrame(o.minX,o.minY,o.maxX,o.maxY,this.groupTransform)}const i=this.children;for(let o=0;o<i.length;o++)i[o]._getGlobalBoundsRecursive(s,n,e)}if(r){let i=!1;const o=this.renderGroup||this.parentRenderGroup;for(let a=0;a<this.effects.length;a++)this.effects[a].addBounds&&(i||(i=!0,n.applyMatrix(o.worldTransform)),this.effects[a].addBounds(n,!0));i&&(n.applyMatrix(o.worldTransform.copyTo($c).invert()),t.addBounds(n,this.relativeGroupTransform)),t.addBounds(n),le.return(n)}else this.renderGroup&&(t.addBounds(n,this.relativeGroupTransform),le.return(n))}};function ra(s,t,e){e.clear();let n,r;return s.parent?t?n=s.parent.worldTransform:(r=mt.get().identity(),n=Dr(s,r)):n=X.IDENTITY,ia(s,e,n,t),r&&mt.return(r),e.isValid||e.set(0,0,0,0),e}function ia(s,t,e,n){var a,l;if(!s.visible||!s.measurable)return;let r;n?r=s.worldTransform:(s.updateLocalTransform(),r=mt.get(),r.appendFrom(s.localTransform,e));const i=t,o=!!s.effects.length;if(o&&(t=le.get().clear()),s.boundsArea)t.addRect(s.boundsArea,r);else{s.bounds&&(t.matrix=r,t.addBounds(s.bounds));for(let h=0;h<s.children.length;h++)ia(s.children[h],t,r,n)}if(o){for(let h=0;h<s.effects.length;h++)(l=(a=s.effects[h]).addBounds)==null||l.call(a,t);i.addBounds(t,X.IDENTITY),le.return(t)}n||mt.return(r)}function Dr(s,t){const e=s.parent;return e&&(Dr(e,t),e.updateLocalTransform(),t.append(e.localTransform)),t}function oa(s,t){if(s===16777215||!t)return t;if(t===16777215||!s)return s;const e=s>>16&255,n=s>>8&255,r=s&255,i=t>>16&255,o=t>>8&255,a=t&255,l=e*i/255|0,h=n*o/255|0,c=r*a/255|0;return(l<<16)+(h<<8)+c}const Ci=16777215;function ki(s,t){return s===Ci?t:t===Ci?s:oa(s,t)}function Vs(s){return((s&255)<<16)+(s&65280)+(s>>16&255)}const Yc={getGlobalAlpha(s){if(s)return this.renderGroup?this.renderGroup.worldAlpha:this.parentRenderGroup?this.parentRenderGroup.worldAlpha*this.alpha:this.alpha;let t=this.alpha,e=this.parent;for(;e;)t*=e.alpha,e=e.parent;return t},getGlobalTransform(s,t){if(t)return s.copyFrom(this.worldTransform);this.updateLocalTransform();const e=Dr(this,mt.get().identity());return s.appendFrom(this.localTransform,e),mt.return(e),s},getGlobalTint(s){if(s)return this.renderGroup?Vs(this.renderGroup.worldColor):this.parentRenderGroup?Vs(ki(this.localColor,this.parentRenderGroup.worldColor)):this.tint;let t=this.localColor,e=this.parent;for(;e;)t=ki(t,e.localColor),e=e.parent;return Vs(t)}};function aa(s,t,e){return t.clear(),e||(e=X.IDENTITY),la(s,t,e,s,!0),t.isValid||t.set(0,0,0,0),t}function la(s,t,e,n,r){var l,h;let i;if(r)i=mt.get(),i=e.copyTo(i);else{if(!s.visible||!s.measurable)return;s.updateLocalTransform();const c=s.localTransform;i=mt.get(),i.appendFrom(c,e)}const o=t,a=!!s.effects.length;if(a&&(t=le.get().clear()),s.boundsArea)t.addRect(s.boundsArea,i);else{s.renderPipeId&&(t.matrix=i,t.addBounds(s.bounds));const c=s.children;for(let u=0;u<c.length;u++)la(c[u],t,i,n,!1)}if(a){for(let c=0;c<s.effects.length;c++)(h=(l=s.effects[c]).addLocalBounds)==null||h.call(l,t,n);o.addBounds(t,X.IDENTITY),le.return(t)}mt.return(i)}function ca(s,t){const e=s.children;for(let n=0;n<e.length;n++){const r=e[n],i=r.uid,o=(r._didViewChangeTick&65535)<<16|r._didContainerChangeTick&65535,a=t.index;(t.data[a]!==i||t.data[a+1]!==o)&&(t.data[t.index]=i,t.data[t.index+1]=o,t.didChange=!0),t.index=a+2,r.children.length&&ca(r,t)}return t.didChange}const Xc=new X,qc={_localBoundsCacheId:-1,_localBoundsCacheData:null,_setWidth(s,t){const e=Math.sign(this.scale.x)||1;t!==0?this.scale.x=s/t*e:this.scale.x=e},_setHeight(s,t){const e=Math.sign(this.scale.y)||1;t!==0?this.scale.y=s/t*e:this.scale.y=e},getLocalBounds(){this._localBoundsCacheData||(this._localBoundsCacheData={data:[],index:1,didChange:!1,localBounds:new Dt});const s=this._localBoundsCacheData;return s.index=1,s.didChange=!1,s.data[0]!==this._didViewChangeTick&&(s.didChange=!0,s.data[0]=this._didViewChangeTick),ca(this,s),s.didChange&&aa(this,s.localBounds,Xc),s.localBounds},getBounds(s,t){return ra(this,s,t||new Dt)}},Kc={_onRender:null,set onRender(s){const t=this.renderGroup||this.parentRenderGroup;if(!s){this._onRender&&(t==null||t.removeOnRender(this)),this._onRender=null;return}this._onRender||t==null||t.addOnRender(this),this._onRender=s},get onRender(){return this._onRender}},Zc={_zIndex:0,sortDirty:!1,sortableChildren:!1,get zIndex(){return this._zIndex},set zIndex(s){this._zIndex!==s&&(this._zIndex=s,this.depthOfChildModified())},depthOfChildModified(){this.parent&&(this.parent.sortableChildren=!0,this.parent.sortDirty=!0),this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0)},sortChildren(){this.sortDirty&&(this.sortDirty=!1,this.children.sort(Qc))}};function Qc(s,t){return s._zIndex-t._zIndex}const Jc={getGlobalPosition(s=new ft,t=!1){return this.parent?this.parent.toGlobal(this._position,s,t):(s.x=this._position.x,s.y=this._position.y),s},toGlobal(s,t,e=!1){const n=this.getGlobalTransform(mt.get(),e);return t=n.apply(s,t),mt.return(n),t},toLocal(s,t,e,n){t&&(s=t.toGlobal(s,e,n));const r=this.getGlobalTransform(mt.get(),n);return e=r.applyInverse(s,e),mt.return(r),e}};class ha{constructor(){this.uid=lt("instructionSet"),this.instructions=[],this.instructionSize=0,this.renderables=[],this.gcTick=0}reset(){this.instructionSize=0}add(t){this.instructions[this.instructionSize++]=t}log(){this.instructions.length=this.instructionSize,console.table(this.instructions,["type","action"])}}let th=0;class eh{constructor(t){this._poolKeyHash=Object.create(null),this._texturePool={},this.textureOptions=t||{},this.enableFullScreen=!1,this.textureStyle=new Ve(this.textureOptions)}createTexture(t,e,n){const r=new jt({...this.textureOptions,width:t,height:e,resolution:1,antialias:n,autoGarbageCollect:!1});return new $({source:r,label:`texturePool_${th++}`})}getOptimalTexture(t,e,n=1,r){let i=Math.ceil(t*n-1e-6),o=Math.ceil(e*n-1e-6);i=$e(i),o=$e(o);const a=(i<<17)+(o<<1)+(r?1:0);this._texturePool[a]||(this._texturePool[a]=[]);let l=this._texturePool[a].pop();return l||(l=this.createTexture(i,o,r)),l.source._resolution=n,l.source.width=i/n,l.source.height=o/n,l.source.pixelWidth=i,l.source.pixelHeight=o,l.frame.x=0,l.frame.y=0,l.frame.width=t,l.frame.height=e,l.updateUvs(),this._poolKeyHash[l.uid]=a,l}getSameSizeTexture(t,e=!1){const n=t.source;return this.getOptimalTexture(t.width,t.height,n._resolution,e)}returnTexture(t,e=!1){const n=this._poolKeyHash[t.uid];e&&(t.source.style=this.textureStyle),this._texturePool[n].push(t)}clear(t){if(t=t!==!1,t)for(const e in this._texturePool){const n=this._texturePool[e];if(n)for(let r=0;r<n.length;r++)n[r].destroy(!0)}this._texturePool={}}}const sh=new eh;class nh{constructor(){this.renderPipeId="renderGroup",this.root=null,this.canBundle=!1,this.renderGroupParent=null,this.renderGroupChildren=[],this.worldTransform=new X,this.worldColorAlpha=4294967295,this.worldColor=16777215,this.worldAlpha=1,this.childrenToUpdate=Object.create(null),this.updateTick=0,this.gcTick=0,this.childrenRenderablesToUpdate={list:[],index:0},this.structureDidChange=!0,this.instructionSet=new ha,this._onRenderContainers=[],this.textureNeedsUpdate=!0,this.isCachedAsTexture=!1,this._matrixDirty=7}init(t){this.root=t,t._onRender&&this.addOnRender(t),t.didChange=!0;const e=t.children;for(let n=0;n<e.length;n++){const r=e[n];r._updateFlags=15,this.addChild(r)}}enableCacheAsTexture(t={}){this.textureOptions=t,this.isCachedAsTexture=!0,this.textureNeedsUpdate=!0}disableCacheAsTexture(){this.isCachedAsTexture=!1,this.texture&&(sh.returnTexture(this.texture),this.texture=null)}updateCacheTexture(){this.textureNeedsUpdate=!0}reset(){this.renderGroupChildren.length=0;for(const t in this.childrenToUpdate){const e=this.childrenToUpdate[t];e.list.fill(null),e.index=0}this.childrenRenderablesToUpdate.index=0,this.childrenRenderablesToUpdate.list.fill(null),this.root=null,this.updateTick=0,this.structureDidChange=!0,this._onRenderContainers.length=0,this.renderGroupParent=null,this.disableCacheAsTexture()}get localTransform(){return this.root.localTransform}addRenderGroupChild(t){t.renderGroupParent&&t.renderGroupParent._removeRenderGroupChild(t),t.renderGroupParent=this,this.renderGroupChildren.push(t)}_removeRenderGroupChild(t){const e=this.renderGroupChildren.indexOf(t);e>-1&&this.renderGroupChildren.splice(e,1),t.renderGroupParent=null}addChild(t){if(this.structureDidChange=!0,t.parentRenderGroup=this,t.updateTick=-1,t.parent===this.root?t.relativeRenderGroupDepth=1:t.relativeRenderGroupDepth=t.parent.relativeRenderGroupDepth+1,t.didChange=!0,this.onChildUpdate(t),t.renderGroup){this.addRenderGroupChild(t.renderGroup);return}t._onRender&&this.addOnRender(t);const e=t.children;for(let n=0;n<e.length;n++)this.addChild(e[n])}removeChild(t){if(this.structureDidChange=!0,t._onRender&&(t.renderGroup||this.removeOnRender(t)),t.parentRenderGroup=null,t.renderGroup){this._removeRenderGroupChild(t.renderGroup);return}const e=t.children;for(let n=0;n<e.length;n++)this.removeChild(e[n])}removeChildren(t){for(let e=0;e<t.length;e++)this.removeChild(t[e])}onChildUpdate(t){let e=this.childrenToUpdate[t.relativeRenderGroupDepth];e||(e=this.childrenToUpdate[t.relativeRenderGroupDepth]={index:0,list:[]}),e.list[e.index++]=t}updateRenderable(t){t.globalDisplayStatus<7||(this.instructionSet.renderPipes[t.renderPipeId].updateRenderable(t),t.didViewUpdate=!1)}onChildViewUpdate(t){this.childrenRenderablesToUpdate.list[this.childrenRenderablesToUpdate.index++]=t}get isRenderable(){return this.root.localDisplayStatus===7&&this.worldAlpha>0}addOnRender(t){this._onRenderContainers.push(t)}removeOnRender(t){this._onRenderContainers.splice(this._onRenderContainers.indexOf(t),1)}runOnRender(t){for(let e=0;e<this._onRenderContainers.length;e++)this._onRenderContainers[e]._onRender(t)}destroy(){this.disableCacheAsTexture(),this.renderGroupParent=null,this.root=null,this.childrenRenderablesToUpdate=null,this.childrenToUpdate=null,this.renderGroupChildren=null,this._onRenderContainers=null,this.instructionSet=null}getChildren(t=[]){const e=this.root.children;for(let n=0;n<e.length;n++)this._getChildren(e[n],t);return t}_getChildren(t,e=[]){if(e.push(t),t.renderGroup)return e;const n=t.children;for(let r=0;r<n.length;r++)this._getChildren(n[r],e);return e}invalidateMatrices(){this._matrixDirty=7}get inverseWorldTransform(){return(this._matrixDirty&1)===0?this._inverseWorldTransform:(this._matrixDirty&=-2,this._inverseWorldTransform||(this._inverseWorldTransform=new X),this._inverseWorldTransform.copyFrom(this.worldTransform).invert())}get textureOffsetInverseTransform(){return(this._matrixDirty&2)===0?this._textureOffsetInverseTransform:(this._matrixDirty&=-3,this._textureOffsetInverseTransform||(this._textureOffsetInverseTransform=new X),this._textureOffsetInverseTransform.copyFrom(this.inverseWorldTransform).translate(-this._textureBounds.x,-this._textureBounds.y))}get inverseParentTextureTransform(){if((this._matrixDirty&4)===0)return this._inverseParentTextureTransform;this._matrixDirty&=-5;const t=this._parentCacheAsTextureRenderGroup;return t?(this._inverseParentTextureTransform||(this._inverseParentTextureTransform=new X),this._inverseParentTextureTransform.copyFrom(this.worldTransform).prepend(t.inverseWorldTransform).translate(-t._textureBounds.x,-t._textureBounds.y)):this.worldTransform}get cacheToLocalTransform(){return this._parentCacheAsTextureRenderGroup?this._parentCacheAsTextureRenderGroup.textureOffsetInverseTransform:null}}function rh(s,t,e={}){for(const n in t)!e[n]&&t[n]!==void 0&&(s[n]=t[n])}const kn=new bt(null),Pn=new bt(null),Mn=new bt(null,1,1),Pi=1,ih=2,Tn=4;class zt extends Wt{constructor(t={}){var e,n;super(),this.uid=lt("renderable"),this._updateFlags=15,this.renderGroup=null,this.parentRenderGroup=null,this.parentRenderGroupIndex=0,this.didChange=!1,this.didViewUpdate=!1,this.relativeRenderGroupDepth=0,this.children=[],this.parent=null,this.includeInBuild=!0,this.measurable=!0,this.isSimple=!0,this.updateTick=-1,this.localTransform=new X,this.relativeGroupTransform=new X,this.groupTransform=this.relativeGroupTransform,this.destroyed=!1,this._position=new bt(this,0,0),this._scale=Mn,this._pivot=Pn,this._skew=kn,this._cx=1,this._sx=0,this._cy=0,this._sy=1,this._rotation=0,this.localColor=16777215,this.localAlpha=1,this.groupAlpha=1,this.groupColor=16777215,this.groupColorAlpha=4294967295,this.localBlendMode="inherit",this.groupBlendMode="normal",this.localDisplayStatus=7,this.globalDisplayStatus=7,this._didContainerChangeTick=0,this._didViewChangeTick=0,this._didLocalTransformChangeId=-1,this.effects=[],rh(this,t,{children:!0,parent:!0,effects:!0}),(e=t.children)==null||e.forEach(r=>this.addChild(r)),(n=t.parent)==null||n.addChild(this)}static mixin(t){V("8.8.0","Container.mixin is deprecated, please use extensions.mixin instead."),dt.mixin(zt,t)}set _didChangeId(t){this._didViewChangeTick=t>>12&4095,this._didContainerChangeTick=t&4095}get _didChangeId(){return this._didContainerChangeTick&4095|(this._didViewChangeTick&4095)<<12}addChild(...t){if(this.allowChildren||V(Z,"addChild: Only Containers will be allowed to add children in v8.0.0"),t.length>1){for(let r=0;r<t.length;r++)this.addChild(t[r]);return t[0]}const e=t[0],n=this.renderGroup||this.parentRenderGroup;return e.parent===this?(this.children.splice(this.children.indexOf(e),1),this.children.push(e),n&&(n.structureDidChange=!0),e):(e.parent&&e.parent.removeChild(e),this.children.push(e),this.sortableChildren&&(this.sortDirty=!0),e.parent=this,e.didChange=!0,e._updateFlags=15,n&&n.addChild(e),this.emit("childAdded",e,this,this.children.length-1),e.emit("added",this),this._didViewChangeTick++,e._zIndex!==0&&e.depthOfChildModified(),e)}removeChild(...t){if(t.length>1){for(let r=0;r<t.length;r++)this.removeChild(t[r]);return t[0]}const e=t[0],n=this.children.indexOf(e);return n>-1&&(this._didViewChangeTick++,this.children.splice(n,1),this.renderGroup?this.renderGroup.removeChild(e):this.parentRenderGroup&&this.parentRenderGroup.removeChild(e),e.parentRenderLayer&&e.parentRenderLayer.detach(e),e.parent=null,this.emit("childRemoved",e,this,n),e.emit("removed",this)),e}_onUpdate(t){t&&t===this._skew&&this._updateSkew(),this._didContainerChangeTick++,!this.didChange&&(this.didChange=!0,this.parentRenderGroup&&this.parentRenderGroup.onChildUpdate(this))}set isRenderGroup(t){!!this.renderGroup!==t&&(t?this.enableRenderGroup():this.disableRenderGroup())}get isRenderGroup(){return!!this.renderGroup}enableRenderGroup(){if(this.renderGroup)return;const t=this.parentRenderGroup;t==null||t.removeChild(this),this.renderGroup=ae.get(nh,this),this.groupTransform=X.IDENTITY,t==null||t.addChild(this),this._updateIsSimple()}disableRenderGroup(){if(!this.renderGroup)return;const t=this.parentRenderGroup;t==null||t.removeChild(this),ae.return(this.renderGroup),this.renderGroup=null,this.groupTransform=this.relativeGroupTransform,t==null||t.addChild(this),this._updateIsSimple()}_updateIsSimple(){this.isSimple=!this.renderGroup&&this.effects.length===0}get worldTransform(){return this._worldTransform||(this._worldTransform=new X),this.renderGroup?this._worldTransform.copyFrom(this.renderGroup.worldTransform):this.parentRenderGroup&&this._worldTransform.appendFrom(this.relativeGroupTransform,this.parentRenderGroup.worldTransform),this._worldTransform}get x(){return this._position.x}set x(t){this._position.x=t}get y(){return this._position.y}set y(t){this._position.y=t}get position(){return this._position}set position(t){this._position.copyFrom(t)}get rotation(){return this._rotation}set rotation(t){this._rotation!==t&&(this._rotation=t,this._onUpdate(this._skew))}get angle(){return this.rotation*yc}set angle(t){this.rotation=t*bc}get pivot(){return this._pivot===Pn&&(this._pivot=new bt(this,0,0)),this._pivot}set pivot(t){this._pivot===Pn&&(this._pivot=new bt(this,0,0)),typeof t=="number"?this._pivot.set(t):this._pivot.copyFrom(t)}get skew(){return this._skew===kn&&(this._skew=new bt(this,0,0)),this._skew}set skew(t){this._skew===kn&&(this._skew=new bt(this,0,0)),this._skew.copyFrom(t)}get scale(){return this._scale===Mn&&(this._scale=new bt(this,1,1)),this._scale}set scale(t){this._scale===Mn&&(this._scale=new bt(this,0,0)),typeof t=="number"?this._scale.set(t):this._scale.copyFrom(t)}get width(){return Math.abs(this.scale.x*this.getLocalBounds().width)}set width(t){const e=this.getLocalBounds().width;this._setWidth(t,e)}get height(){return Math.abs(this.scale.y*this.getLocalBounds().height)}set height(t){const e=this.getLocalBounds().height;this._setHeight(t,e)}getSize(t){t||(t={});const e=this.getLocalBounds();return t.width=Math.abs(this.scale.x*e.width),t.height=Math.abs(this.scale.y*e.height),t}setSize(t,e){const n=this.getLocalBounds();typeof t=="object"?(e=t.height??t.width,t=t.width):e??(e=t),t!==void 0&&this._setWidth(t,n.width),e!==void 0&&this._setHeight(e,n.height)}_updateSkew(){const t=this._rotation,e=this._skew;this._cx=Math.cos(t+e._y),this._sx=Math.sin(t+e._y),this._cy=-Math.sin(t-e._x),this._sy=Math.cos(t-e._x)}updateTransform(t){return this.position.set(typeof t.x=="number"?t.x:this.position.x,typeof t.y=="number"?t.y:this.position.y),this.scale.set(typeof t.scaleX=="number"?t.scaleX||1:this.scale.x,typeof t.scaleY=="number"?t.scaleY||1:this.scale.y),this.rotation=typeof t.rotation=="number"?t.rotation:this.rotation,this.skew.set(typeof t.skewX=="number"?t.skewX:this.skew.x,typeof t.skewY=="number"?t.skewY:this.skew.y),this.pivot.set(typeof t.pivotX=="number"?t.pivotX:this.pivot.x,typeof t.pivotY=="number"?t.pivotY:this.pivot.y),this}setFromMatrix(t){t.decompose(this)}updateLocalTransform(){const t=this._didContainerChangeTick;if(this._didLocalTransformChangeId===t)return;this._didLocalTransformChangeId=t;const e=this.localTransform,n=this._scale,r=this._pivot,i=this._position,o=n._x,a=n._y,l=r._x,h=r._y;e.a=this._cx*o,e.b=this._sx*o,e.c=this._cy*a,e.d=this._sy*a,e.tx=i._x-(l*e.a+h*e.c),e.ty=i._y-(l*e.b+h*e.d)}set alpha(t){t!==this.localAlpha&&(this.localAlpha=t,this._updateFlags|=Pi,this._onUpdate())}get alpha(){return this.localAlpha}set tint(t){const n=ot.shared.setValue(t??16777215).toBgrNumber();n!==this.localColor&&(this.localColor=n,this._updateFlags|=Pi,this._onUpdate())}get tint(){return Vs(this.localColor)}set blendMode(t){this.localBlendMode!==t&&(this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0),this._updateFlags|=ih,this.localBlendMode=t,this._onUpdate())}get blendMode(){return this.localBlendMode}get visible(){return!!(this.localDisplayStatus&2)}set visible(t){const e=t?2:0;(this.localDisplayStatus&2)!==e&&(this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0),this._updateFlags|=Tn,this.localDisplayStatus^=2,this._onUpdate())}get culled(){return!(this.localDisplayStatus&4)}set culled(t){const e=t?0:4;(this.localDisplayStatus&4)!==e&&(this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0),this._updateFlags|=Tn,this.localDisplayStatus^=4,this._onUpdate())}get renderable(){return!!(this.localDisplayStatus&1)}set renderable(t){const e=t?1:0;(this.localDisplayStatus&1)!==e&&(this._updateFlags|=Tn,this.localDisplayStatus^=1,this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0),this._onUpdate())}get isRenderable(){return this.localDisplayStatus===7&&this.groupAlpha>0}destroy(t=!1){var r;if(this.destroyed)return;this.destroyed=!0;let e;if(this.children.length&&(e=this.removeChildren(0,this.children.length)),this.removeFromParent(),this.parent=null,this._maskEffect=null,this._filterEffect=null,this.effects=null,this._position=null,this._scale=null,this._pivot=null,this._skew=null,this.emit("destroyed",this),this.removeAllListeners(),(typeof t=="boolean"?t:t==null?void 0:t.children)&&e)for(let i=0;i<e.length;++i)e[i].destroy(t);(r=this.renderGroup)==null||r.destroy(),this.renderGroup=null}}dt.mixin(zt,Uc,Vc,Jc,Kc,qc,Wc,jc,Zc,zc,Oc,Yc,Dc);class Hr extends zt{constructor(t){super(t),this.canBundle=!0,this.allowChildren=!1,this._roundPixels=0,this._lastUsed=-1,this._gpuData=Object.create(null),this._bounds=new Dt(0,1,0,0),this._boundsDirty=!0}get bounds(){return this._boundsDirty?(this.updateBounds(),this._boundsDirty=!1,this._bounds):this._bounds}get roundPixels(){return!!this._roundPixels}set roundPixels(t){this._roundPixels=t?1:0}containsPoint(t){const e=this.bounds,{x:n,y:r}=t;return n>=e.minX&&n<=e.maxX&&r>=e.minY&&r<=e.maxY}onViewUpdate(){if(this._didViewChangeTick++,this._boundsDirty=!0,this.didViewUpdate)return;this.didViewUpdate=!0;const t=this.renderGroup||this.parentRenderGroup;t&&t.onChildViewUpdate(this)}destroy(t){var e,n;super.destroy(t),this._bounds=null;for(const r in this._gpuData)(n=(e=this._gpuData[r]).destroy)==null||n.call(e);this._gpuData=null}collectRenderablesSimple(t,e,n){const{renderPipes:r}=e;r.blendMode.setBlendMode(this,this.groupBlendMode,t),r[this.renderPipeId].addRenderable(this,t),this.didViewUpdate=!1;const o=this.children,a=o.length;for(let l=0;l<a;l++)o[l].collectRenderables(t,e,n)}}class Ht extends Hr{constructor(t=$.EMPTY){t instanceof $&&(t={texture:t});const{texture:e=$.EMPTY,anchor:n,roundPixels:r,width:i,height:o,...a}=t;super({label:"Sprite",...a}),this.renderPipeId="sprite",this.batched=!0,this._visualBounds={minX:0,maxX:1,minY:0,maxY:0},this._anchor=new bt({_onUpdate:()=>{this.onViewUpdate()}}),n?this.anchor=n:e.defaultAnchor&&(this.anchor=e.defaultAnchor),this.texture=e,this.allowChildren=!1,this.roundPixels=r??!1,i!==void 0&&(this.width=i),o!==void 0&&(this.height=o)}static from(t,e=!1){return t instanceof $?new Ht(t):new Ht($.from(t,e))}set texture(t){t||(t=$.EMPTY);const e=this._texture;e!==t&&(e&&e.dynamic&&e.off("update",this.onViewUpdate,this),t.dynamic&&t.on("update",this.onViewUpdate,this),this._texture=t,this._width&&this._setWidth(this._width,this._texture.orig.width),this._height&&this._setHeight(this._height,this._texture.orig.height),this.onViewUpdate())}get texture(){return this._texture}get visualBounds(){return kc(this._visualBounds,this._anchor,this._texture),this._visualBounds}get sourceBounds(){return V("8.6.1","Sprite.sourceBounds is deprecated, use visualBounds instead."),this.visualBounds}updateBounds(){const t=this._anchor,e=this._texture,n=this._bounds,{width:r,height:i}=e.orig;n.minX=-t._x*r,n.maxX=n.minX+r,n.minY=-t._y*i,n.maxY=n.minY+i}destroy(t=!1){if(super.destroy(t),typeof t=="boolean"?t:t==null?void 0:t.texture){const n=typeof t=="boolean"?t:t==null?void 0:t.textureSource;this._texture.destroy(n)}this._texture=null,this._visualBounds=null,this._bounds=null,this._anchor=null,this._gpuData=null}get anchor(){return this._anchor}set anchor(t){typeof t=="number"?this._anchor.set(t):this._anchor.copyFrom(t)}get width(){return Math.abs(this.scale.x)*this._texture.orig.width}set width(t){this._setWidth(t,this._texture.orig.width),this._width=t}get height(){return Math.abs(this.scale.y)*this._texture.orig.height}set height(t){this._setHeight(t,this._texture.orig.height),this._height=t}getSize(t){return t||(t={}),t.width=Math.abs(this.scale.x)*this._texture.orig.width,t.height=Math.abs(this.scale.y)*this._texture.orig.height,t}setSize(t,e){typeof t=="object"?(e=t.height??t.width,t=t.width):e??(e=t),t!==void 0&&this._setWidth(t,this._texture.orig.width),e!==void 0&&this._setHeight(e,this._texture.orig.height)}}const oh=new Dt;function ua(s,t,e){const n=oh;s.measurable=!0,ra(s,e,n),t.addBoundsMask(n),s.measurable=!1}let En=0;const Mi=500;function it(...s){En!==Mi&&(En++,En===Mi?console.warn("PixiJS Warning: too many warnings, no more warnings will be reported to the console by PixiJS."):console.warn("PixiJS Warning: ",...s))}function da(s,t,e){const n=le.get();s.measurable=!0;const r=mt.get().identity(),i=fa(s,e,r);aa(s,n,i),s.measurable=!1,t.addBoundsMask(n),mt.return(r),le.return(n)}function fa(s,t,e){return s?(s!==t&&(fa(s.parent,t,e),s.updateLocalTransform(),e.append(s.localTransform)),e):(it("Mask bounds, renderable is not inside the root container"),e)}class pa{constructor(t){this.priority=0,this.inverse=!1,this.pipe="alphaMask",t!=null&&t.mask&&this.init(t.mask)}init(t){this.mask=t,this.renderMaskToTexture=!(t instanceof Ht),this.mask.renderable=this.renderMaskToTexture,this.mask.includeInBuild=!this.renderMaskToTexture,this.mask.measurable=!1}reset(){this.mask.measurable=!0,this.mask=null}addBounds(t,e){this.inverse||ua(this.mask,t,e)}addLocalBounds(t,e){da(this.mask,t,e)}containsPoint(t,e){const n=this.mask;return e(n,t)}destroy(){this.reset()}static test(t){return t instanceof Ht}}pa.extension=N.MaskEffect;class ma{constructor(t){this.priority=0,this.pipe="colorMask",t!=null&&t.mask&&this.init(t.mask)}init(t){this.mask=t}destroy(){}static test(t){return typeof t=="number"}}ma.extension=N.MaskEffect;class ga{constructor(t){this.priority=0,this.pipe="stencilMask",t!=null&&t.mask&&this.init(t.mask)}init(t){this.mask=t,this.mask.includeInBuild=!1,this.mask.measurable=!1}reset(){this.mask.measurable=!0,this.mask.includeInBuild=!0,this.mask=null}addBounds(t,e){ua(this.mask,t,e)}addLocalBounds(t,e){da(this.mask,t,e)}containsPoint(t,e){const n=this.mask;return e(n,t)}destroy(){this.reset()}static test(t){return t instanceof zt}}ga.extension=N.MaskEffect;const ah={createCanvas:(s,t)=>{const e=document.createElement("canvas");return e.width=s,e.height=t,e},getCanvasRenderingContext2D:()=>CanvasRenderingContext2D,getWebGLRenderingContext:()=>WebGLRenderingContext,getNavigator:()=>navigator,getBaseUrl:()=>document.baseURI??window.location.href,getFontFaceSet:()=>document.fonts,fetch:(s,t)=>fetch(s,t),parseXML:s=>new DOMParser().parseFromString(s,"text/xml")};let Ti=ah;const at={get(){return Ti},set(s){Ti=s}};class xa extends jt{constructor(t){t.resource||(t.resource=at.get().createCanvas()),t.width||(t.width=t.resource.width,t.autoDensity||(t.width/=t.resolution)),t.height||(t.height=t.resource.height,t.autoDensity||(t.height/=t.resolution)),super(t),this.uploadMethodId="image",this.autoDensity=t.autoDensity,this.resizeCanvas(),this.transparent=!!t.transparent}resizeCanvas(){this.autoDensity&&"style"in this.resource&&(this.resource.style.width=`${this.width}px`,this.resource.style.height=`${this.height}px`),(this.resource.width!==this.pixelWidth||this.resource.height!==this.pixelHeight)&&(this.resource.width=this.pixelWidth,this.resource.height=this.pixelHeight)}resize(t=this.width,e=this.height,n=this._resolution){const r=super.resize(t,e,n);return r&&this.resizeCanvas(),r}static test(t){return globalThis.HTMLCanvasElement&&t instanceof HTMLCanvasElement||globalThis.OffscreenCanvas&&t instanceof OffscreenCanvas}get context2D(){return this._context2D||(this._context2D=this.resource.getContext("2d"))}}xa.extension=N.TextureSource;class ze extends jt{constructor(t){super(t),this.uploadMethodId="image",this.autoGarbageCollect=!0}static test(t){return globalThis.HTMLImageElement&&t instanceof HTMLImageElement||typeof ImageBitmap<"u"&&t instanceof ImageBitmap||globalThis.VideoFrame&&t instanceof VideoFrame}}ze.extension=N.TextureSource;var Ks=(s=>(s[s.INTERACTION=50]="INTERACTION",s[s.HIGH=25]="HIGH",s[s.NORMAL=0]="NORMAL",s[s.LOW=-25]="LOW",s[s.UTILITY=-50]="UTILITY",s))(Ks||{});class In{constructor(t,e=null,n=0,r=!1){this.next=null,this.previous=null,this._destroyed=!1,this._fn=t,this._context=e,this.priority=n,this._once=r}match(t,e=null){return this._fn===t&&this._context===e}emit(t){this._fn&&(this._context?this._fn.call(this._context,t):this._fn(t));const e=this.next;return this._once&&this.destroy(!0),this._destroyed&&(this.next=null),e}connect(t){this.previous=t,t.next&&(t.next.previous=this),this.next=t.next,t.next=this}destroy(t=!1){this._destroyed=!0,this._fn=null,this._context=null,this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous);const e=this.next;return this.next=t?null:e,this.previous=null,e}}const ya=class At{constructor(){this.autoStart=!1,this.deltaTime=1,this.lastTime=-1,this.speed=1,this.started=!1,this._requestId=null,this._maxElapsedMS=100,this._minElapsedMS=0,this._protected=!1,this._lastFrame=-1,this._head=new In(null,null,1/0),this.deltaMS=1/At.targetFPMS,this.elapsedMS=1/At.targetFPMS,this._tick=t=>{this._requestId=null,this.started&&(this.update(t),this.started&&this._requestId===null&&this._head.next&&(this._requestId=requestAnimationFrame(this._tick)))}}_requestIfNeeded(){this._requestId===null&&this._head.next&&(this.lastTime=performance.now(),this._lastFrame=this.lastTime,this._requestId=requestAnimationFrame(this._tick))}_cancelIfNeeded(){this._requestId!==null&&(cancelAnimationFrame(this._requestId),this._requestId=null)}_startIfPossible(){this.started?this._requestIfNeeded():this.autoStart&&this.start()}add(t,e,n=Ks.NORMAL){return this._addListener(new In(t,e,n))}addOnce(t,e,n=Ks.NORMAL){return this._addListener(new In(t,e,n,!0))}_addListener(t){let e=this._head.next,n=this._head;if(!e)t.connect(n);else{for(;e;){if(t.priority>e.priority){t.connect(n);break}n=e,e=e.next}t.previous||t.connect(n)}return this._startIfPossible(),this}remove(t,e){let n=this._head.next;for(;n;)n.match(t,e)?n=n.destroy():n=n.next;return this._head.next||this._cancelIfNeeded(),this}get count(){if(!this._head)return 0;let t=0,e=this._head;for(;e=e.next;)t++;return t}start(){this.started||(this.started=!0,this._requestIfNeeded())}stop(){this.started&&(this.started=!1,this._cancelIfNeeded())}destroy(){if(!this._protected){this.stop();let t=this._head.next;for(;t;)t=t.destroy(!0);this._head.destroy(),this._head=null}}update(t=performance.now()){let e;if(t>this.lastTime){if(e=this.elapsedMS=t-this.lastTime,e>this._maxElapsedMS&&(e=this._maxElapsedMS),e*=this.speed,this._minElapsedMS){const i=t-this._lastFrame|0;if(i<this._minElapsedMS)return;this._lastFrame=t-i%this._minElapsedMS}this.deltaMS=e,this.deltaTime=this.deltaMS*At.targetFPMS;const n=this._head;let r=n.next;for(;r;)r=r.emit(this);n.next||this._cancelIfNeeded()}else this.deltaTime=this.deltaMS=this.elapsedMS=0;this.lastTime=t}get FPS(){return 1e3/this.elapsedMS}get minFPS(){return 1e3/this._maxElapsedMS}set minFPS(t){const e=Math.min(this.maxFPS,t),n=Math.min(Math.max(0,e)/1e3,At.targetFPMS);this._maxElapsedMS=1/n}get maxFPS(){return this._minElapsedMS?Math.round(1e3/this._minElapsedMS):0}set maxFPS(t){if(t===0)this._minElapsedMS=0;else{const e=Math.max(this.minFPS,t);this._minElapsedMS=1/(e/1e3)}}static get shared(){if(!At._shared){const t=At._shared=new At;t.autoStart=!0,t._protected=!0}return At._shared}static get system(){if(!At._system){const t=At._system=new At;t.autoStart=!0,t._protected=!0}return At._system}};ya.targetFPMS=.06;let Ut=ya,Bn;async function ba(){return Bn??(Bn=(async()=>{var o;const t=document.createElement("canvas").getContext("webgl");if(!t)return"premultiply-alpha-on-upload";const e=await new Promise(a=>{const l=document.createElement("video");l.onloadeddata=()=>a(l),l.onerror=()=>a(null),l.autoplay=!1,l.crossOrigin="anonymous",l.preload="auto",l.src="data:video/webm;base64,GkXfo59ChoEBQveBAULygQRC84EIQoKEd2VibUKHgQJChYECGFOAZwEAAAAAAAHTEU2bdLpNu4tTq4QVSalmU6yBoU27i1OrhBZUrmtTrIHGTbuMU6uEElTDZ1OsggEXTbuMU6uEHFO7a1OsggG97AEAAAAAAABZAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAVSalmoCrXsYMPQkBNgIRMYXZmV0GETGF2ZkSJiEBEAAAAAAAAFlSua8yuAQAAAAAAAEPXgQFzxYgAAAAAAAAAAZyBACK1nIN1bmSIgQCGhVZfVlA5g4EBI+ODhAJiWgDglLCBArqBApqBAlPAgQFVsIRVuYEBElTDZ9Vzc9JjwItjxYgAAAAAAAAAAWfInEWjh0VOQ09ERVJEh49MYXZjIGxpYnZweC12cDlnyKJFo4hEVVJBVElPTkSHlDAwOjAwOjAwLjA0MDAwMDAwMAAAH0O2dcfngQCgwqGggQAAAIJJg0IAABAAFgA4JBwYSgAAICAAEb///4r+AAB1oZ2mm+6BAaWWgkmDQgAAEAAWADgkHBhKAAAgIABIQBxTu2uRu4+zgQC3iveBAfGCAXHwgQM=",l.load()});if(!e)return"premultiply-alpha-on-upload";const n=t.createTexture();t.bindTexture(t.TEXTURE_2D,n);const r=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,r),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,n,0),t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),t.pixelStorei(t.UNPACK_COLORSPACE_CONVERSION_WEBGL,t.NONE),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,e);const i=new Uint8Array(4);return t.readPixels(0,0,1,1,t.RGBA,t.UNSIGNED_BYTE,i),t.deleteFramebuffer(r),t.deleteTexture(n),(o=t.getExtension("WEBGL_lose_context"))==null||o.loseContext(),i[0]<=i[3]?"premultiplied-alpha":"premultiply-alpha-on-upload"})()),Bn}const hn=class wa extends jt{constructor(t){super(t),this.isReady=!1,this.uploadMethodId="video",t={...wa.defaultOptions,...t},this._autoUpdate=!0,this._isConnectedToTicker=!1,this._updateFPS=t.updateFPS||0,this._msToNextUpdate=0,this.autoPlay=t.autoPlay!==!1,this.alphaMode=t.alphaMode??"premultiply-alpha-on-upload",this._videoFrameRequestCallback=this._videoFrameRequestCallback.bind(this),this._videoFrameRequestCallbackHandle=null,this._load=null,this._resolve=null,this._reject=null,this._onCanPlay=this._onCanPlay.bind(this),this._onCanPlayThrough=this._onCanPlayThrough.bind(this),this._onError=this._onError.bind(this),this._onPlayStart=this._onPlayStart.bind(this),this._onPlayStop=this._onPlayStop.bind(this),this._onSeeked=this._onSeeked.bind(this),t.autoLoad!==!1&&this.load()}updateFrame(){if(!this.destroyed){if(this._updateFPS){const t=Ut.shared.elapsedMS*this.resource.playbackRate;this._msToNextUpdate=Math.floor(this._msToNextUpdate-t)}(!this._updateFPS||this._msToNextUpdate<=0)&&(this._msToNextUpdate=this._updateFPS?Math.floor(1e3/this._updateFPS):0),this.isValid&&this.update()}}_videoFrameRequestCallback(){this.updateFrame(),this.destroyed?this._videoFrameRequestCallbackHandle=null:this._videoFrameRequestCallbackHandle=this.resource.requestVideoFrameCallback(this._videoFrameRequestCallback)}get isValid(){return!!this.resource.videoWidth&&!!this.resource.videoHeight}async load(){if(this._load)return this._load;const t=this.resource,e=this.options;return(t.readyState===t.HAVE_ENOUGH_DATA||t.readyState===t.HAVE_FUTURE_DATA)&&t.width&&t.height&&(t.complete=!0),t.addEventListener("play",this._onPlayStart),t.addEventListener("pause",this._onPlayStop),t.addEventListener("seeked",this._onSeeked),this._isSourceReady()?this._mediaReady():(e.preload||t.addEventListener("canplay",this._onCanPlay),t.addEventListener("canplaythrough",this._onCanPlayThrough),t.addEventListener("error",this._onError,!0)),this.alphaMode=await ba(),this._load=new Promise((n,r)=>{this.isValid?n(this):(this._resolve=n,this._reject=r,e.preloadTimeoutMs!==void 0&&(this._preloadTimeout=setTimeout(()=>{this._onError(new ErrorEvent(`Preload exceeded timeout of ${e.preloadTimeoutMs}ms`))})),t.load())}),this._load}_onError(t){this.resource.removeEventListener("error",this._onError,!0),this.emit("error",t),this._reject&&(this._reject(t),this._reject=null,this._resolve=null)}_isSourcePlaying(){const t=this.resource;return!t.paused&&!t.ended}_isSourceReady(){return this.resource.readyState>2}_onPlayStart(){this.isValid||this._mediaReady(),this._configureAutoUpdate()}_onPlayStop(){this._configureAutoUpdate()}_onSeeked(){this._autoUpdate&&!this._isSourcePlaying()&&(this._msToNextUpdate=0,this.updateFrame(),this._msToNextUpdate=0)}_onCanPlay(){this.resource.removeEventListener("canplay",this._onCanPlay),this._mediaReady()}_onCanPlayThrough(){this.resource.removeEventListener("canplaythrough",this._onCanPlay),this._preloadTimeout&&(clearTimeout(this._preloadTimeout),this._preloadTimeout=void 0),this._mediaReady()}_mediaReady(){const t=this.resource;this.isValid&&(this.isReady=!0,this.resize(t.videoWidth,t.videoHeight)),this._msToNextUpdate=0,this.updateFrame(),this._msToNextUpdate=0,this._resolve&&(this._resolve(this),this._resolve=null,this._reject=null),this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&this.resource.play()}destroy(){this._configureAutoUpdate();const t=this.resource;t&&(t.removeEventListener("play",this._onPlayStart),t.removeEventListener("pause",this._onPlayStop),t.removeEventListener("seeked",this._onSeeked),t.removeEventListener("canplay",this._onCanPlay),t.removeEventListener("canplaythrough",this._onCanPlayThrough),t.removeEventListener("error",this._onError,!0),t.pause(),t.src="",t.load()),super.destroy()}get autoUpdate(){return this._autoUpdate}set autoUpdate(t){t!==this._autoUpdate&&(this._autoUpdate=t,this._configureAutoUpdate())}get updateFPS(){return this._updateFPS}set updateFPS(t){t!==this._updateFPS&&(this._updateFPS=t,this._configureAutoUpdate())}_configureAutoUpdate(){this._autoUpdate&&this._isSourcePlaying()?!this._updateFPS&&this.resource.requestVideoFrameCallback?(this._isConnectedToTicker&&(Ut.shared.remove(this.updateFrame,this),this._isConnectedToTicker=!1,this._msToNextUpdate=0),this._videoFrameRequestCallbackHandle===null&&(this._videoFrameRequestCallbackHandle=this.resource.requestVideoFrameCallback(this._videoFrameRequestCallback))):(this._videoFrameRequestCallbackHandle!==null&&(this.resource.cancelVideoFrameCallback(this._videoFrameRequestCallbackHandle),this._videoFrameRequestCallbackHandle=null),this._isConnectedToTicker||(Ut.shared.add(this.updateFrame,this),this._isConnectedToTicker=!0,this._msToNextUpdate=0)):(this._videoFrameRequestCallbackHandle!==null&&(this.resource.cancelVideoFrameCallback(this._videoFrameRequestCallbackHandle),this._videoFrameRequestCallbackHandle=null),this._isConnectedToTicker&&(Ut.shared.remove(this.updateFrame,this),this._isConnectedToTicker=!1,this._msToNextUpdate=0))}static test(t){return globalThis.HTMLVideoElement&&t instanceof HTMLVideoElement}};hn.extension=N.TextureSource;hn.defaultOptions={...jt.defaultOptions,autoLoad:!0,autoPlay:!0,updateFPS:0,crossorigin:!0,loop:!1,muted:!0,playsinline:!0,preload:!1};hn.MIME_TYPES={ogv:"video/ogg",mov:"video/quicktime",m4v:"video/mp4"};let Ys=hn;const Nt=(s,t,e=!1)=>(Array.isArray(s)||(s=[s]),t?s.map(n=>typeof n=="string"||e?t(n):n):s);class lh{constructor(){this._parsers=[],this._cache=new Map,this._cacheMap=new Map}reset(){this._cacheMap.clear(),this._cache.clear()}has(t){return this._cache.has(t)}get(t){const e=this._cache.get(t);return e||it(`[Assets] Asset id ${t} was not found in the Cache`),e}set(t,e){const n=Nt(t);let r;for(let l=0;l<this.parsers.length;l++){const h=this.parsers[l];if(h.test(e)){r=h.getCacheableAssets(n,e);break}}const i=new Map(Object.entries(r||{}));r||n.forEach(l=>{i.set(l,e)});const o=[...i.keys()],a={cacheKeys:o,keys:n};n.forEach(l=>{this._cacheMap.set(l,a)}),o.forEach(l=>{const h=r?r[l]:e;this._cache.has(l)&&this._cache.get(l)!==h&&it("[Cache] already has key:",l),this._cache.set(l,i.get(l))})}remove(t){if(!this._cacheMap.has(t)){it(`[Assets] Asset id ${t} was not found in the Cache`);return}const e=this._cacheMap.get(t);e.cacheKeys.forEach(r=>{this._cache.delete(r)}),e.keys.forEach(r=>{this._cacheMap.delete(r)})}get parsers(){return this._parsers}}const rt=new lh,gr=[];dt.handleByList(N.TextureSource,gr);function _a(s={}){const t=s&&s.resource,e=t?s.resource:s,n=t?s:{resource:s};for(let r=0;r<gr.length;r++){const i=gr[r];if(i.test(e))return new i(n)}throw new Error(`Could not find a source type for resource: ${n.resource}`)}function ch(s={},t=!1){const e=s&&s.resource,n=e?s.resource:s,r=e?s:{resource:s};if(!t&&rt.has(n))return rt.get(n);const i=new $({source:_a(r)});return i.on("destroy",()=>{rt.has(n)&&rt.remove(n)}),t||rt.set(n,i),i}function hh(s,t=!1){return typeof s=="string"?rt.get(s):s instanceof jt?new $({source:s}):ch(s,t)}$.from=hh;jt.from=_a;dt.add(pa,ma,ga,Ys,ze,xa,Nr);var xe=(s=>(s[s.Low=0]="Low",s[s.Normal=1]="Normal",s[s.High=2]="High",s))(xe||{});function Gt(s){if(typeof s!="string")throw new TypeError(`Path must be a string. Received ${JSON.stringify(s)}`)}function rs(s){return s.split("?")[0].split("#")[0]}function uh(s){return s.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function dh(s,t,e){return s.replace(new RegExp(uh(t),"g"),e)}function fh(s,t){let e="",n=0,r=-1,i=0,o=-1;for(let a=0;a<=s.length;++a){if(a<s.length)o=s.charCodeAt(a);else{if(o===47)break;o=47}if(o===47){if(!(r===a-1||i===1))if(r!==a-1&&i===2){if(e.length<2||n!==2||e.charCodeAt(e.length-1)!==46||e.charCodeAt(e.length-2)!==46){if(e.length>2){const l=e.lastIndexOf("/");if(l!==e.length-1){l===-1?(e="",n=0):(e=e.slice(0,l),n=e.length-1-e.lastIndexOf("/")),r=a,i=0;continue}}else if(e.length===2||e.length===1){e="",n=0,r=a,i=0;continue}}}else e.length>0?e+=`/${s.slice(r+1,a)}`:e=s.slice(r+1,a),n=a-r-1;r=a,i=0}else o===46&&i!==-1?++i:i=-1}return e}const Ct={toPosix(s){return dh(s,"\\","/")},isUrl(s){return/^https?:/.test(this.toPosix(s))},isDataUrl(s){return/^data:([a-z]+\/[a-z0-9-+.]+(;[a-z0-9-.!#$%*+.{}|~`]+=[a-z0-9-.!#$%*+.{}()_|~`]+)*)?(;base64)?,([a-z0-9!$&',()*+;=\-._~:@\/?%\s<>]*?)$/i.test(s)},isBlobUrl(s){return s.startsWith("blob:")},hasProtocol(s){return/^[^/:]+:/.test(this.toPosix(s))},getProtocol(s){Gt(s),s=this.toPosix(s);const t=/^file:\/\/\//.exec(s);if(t)return t[0];const e=/^[^/:]+:\/{0,2}/.exec(s);return e?e[0]:""},toAbsolute(s,t,e){if(Gt(s),this.isDataUrl(s)||this.isBlobUrl(s))return s;const n=rs(this.toPosix(t??at.get().getBaseUrl())),r=rs(this.toPosix(e??this.rootname(n)));return s=this.toPosix(s),s.startsWith("/")?Ct.join(r,s.slice(1)):this.isAbsolute(s)?s:this.join(n,s)},normalize(s){if(Gt(s),s.length===0)return".";if(this.isDataUrl(s)||this.isBlobUrl(s))return s;s=this.toPosix(s);let t="";const e=s.startsWith("/");this.hasProtocol(s)&&(t=this.rootname(s),s=s.slice(t.length));const n=s.endsWith("/");return s=fh(s),s.length>0&&n&&(s+="/"),e?`/${s}`:t+s},isAbsolute(s){return Gt(s),s=this.toPosix(s),this.hasProtocol(s)?!0:s.startsWith("/")},join(...s){if(s.length===0)return".";let t;for(let e=0;e<s.length;++e){const n=s[e];if(Gt(n),n.length>0)if(t===void 0)t=n;else{const r=s[e-1]??"";this.joinExtensions.includes(this.extname(r).toLowerCase())?t+=`/../${n}`:t+=`/${n}`}}return t===void 0?".":this.normalize(t)},dirname(s){if(Gt(s),s.length===0)return".";s=this.toPosix(s);let t=s.charCodeAt(0);const e=t===47;let n=-1,r=!0;const i=this.getProtocol(s),o=s;s=s.slice(i.length);for(let a=s.length-1;a>=1;--a)if(t=s.charCodeAt(a),t===47){if(!r){n=a;break}}else r=!1;return n===-1?e?"/":this.isUrl(o)?i+s:i:e&&n===1?"//":i+s.slice(0,n)},rootname(s){Gt(s),s=this.toPosix(s);let t="";if(s.startsWith("/")?t="/":t=this.getProtocol(s),this.isUrl(s)){const e=s.indexOf("/",t.length);e!==-1?t=s.slice(0,e):t=s,t.endsWith("/")||(t+="/")}return t},basename(s,t){Gt(s),t&&Gt(t),s=rs(this.toPosix(s));let e=0,n=-1,r=!0,i;if(t!==void 0&&t.length>0&&t.length<=s.length){if(t.length===s.length&&t===s)return"";let o=t.length-1,a=-1;for(i=s.length-1;i>=0;--i){const l=s.charCodeAt(i);if(l===47){if(!r){e=i+1;break}}else a===-1&&(r=!1,a=i+1),o>=0&&(l===t.charCodeAt(o)?--o===-1&&(n=i):(o=-1,n=a))}return e===n?n=a:n===-1&&(n=s.length),s.slice(e,n)}for(i=s.length-1;i>=0;--i)if(s.charCodeAt(i)===47){if(!r){e=i+1;break}}else n===-1&&(r=!1,n=i+1);return n===-1?"":s.slice(e,n)},extname(s){Gt(s),s=rs(this.toPosix(s));let t=-1,e=0,n=-1,r=!0,i=0;for(let o=s.length-1;o>=0;--o){const a=s.charCodeAt(o);if(a===47){if(!r){e=o+1;break}continue}n===-1&&(r=!1,n=o+1),a===46?t===-1?t=o:i!==1&&(i=1):t!==-1&&(i=-1)}return t===-1||n===-1||i===0||i===1&&t===n-1&&t===e+1?"":s.slice(t,n)},parse(s){Gt(s);const t={root:"",dir:"",base:"",ext:"",name:""};if(s.length===0)return t;s=rs(this.toPosix(s));let e=s.charCodeAt(0);const n=this.isAbsolute(s);let r;t.root=this.rootname(s),n||this.hasProtocol(s)?r=1:r=0;let i=-1,o=0,a=-1,l=!0,h=s.length-1,c=0;for(;h>=r;--h){if(e=s.charCodeAt(h),e===47){if(!l){o=h+1;break}continue}a===-1&&(l=!1,a=h+1),e===46?i===-1?i=h:c!==1&&(c=1):i!==-1&&(c=-1)}return i===-1||a===-1||c===0||c===1&&i===a-1&&i===o+1?a!==-1&&(o===0&&n?t.base=t.name=s.slice(1,a):t.base=t.name=s.slice(o,a)):(o===0&&n?(t.name=s.slice(1,i),t.base=s.slice(1,a)):(t.name=s.slice(o,i),t.base=s.slice(o,a)),t.ext=s.slice(i,a)),t.dir=this.dirname(s),t},sep:"/",delimiter:":",joinExtensions:[".html"]};function va(s,t,e,n,r){const i=t[e];for(let o=0;o<i.length;o++){const a=i[o];e<t.length-1?va(s.replace(n[e],a),t,e+1,n,r):r.push(s.replace(n[e],a))}}function ph(s){const t=/\{(.*?)\}/g,e=s.match(t),n=[];if(e){const r=[];e.forEach(i=>{const o=i.substring(1,i.length-1).split(",");r.push(o)}),va(s,r,0,e,n)}else n.push(s);return n}const Zs=s=>!Array.isArray(s);class Qe{constructor(){this._defaultBundleIdentifierOptions={connector:"-",createBundleAssetId:(t,e)=>`${t}${this._bundleIdConnector}${e}`,extractAssetIdFromBundle:(t,e)=>e.replace(`${t}${this._bundleIdConnector}`,"")},this._bundleIdConnector=this._defaultBundleIdentifierOptions.connector,this._createBundleAssetId=this._defaultBundleIdentifierOptions.createBundleAssetId,this._extractAssetIdFromBundle=this._defaultBundleIdentifierOptions.extractAssetIdFromBundle,this._assetMap={},this._preferredOrder=[],this._parsers=[],this._resolverHash={},this._bundles={}}setBundleIdentifier(t){if(this._bundleIdConnector=t.connector??this._bundleIdConnector,this._createBundleAssetId=t.createBundleAssetId??this._createBundleAssetId,this._extractAssetIdFromBundle=t.extractAssetIdFromBundle??this._extractAssetIdFromBundle,this._extractAssetIdFromBundle("foo",this._createBundleAssetId("foo","bar"))!=="bar")throw new Error("[Resolver] GenerateBundleAssetId are not working correctly")}prefer(...t){t.forEach(e=>{this._preferredOrder.push(e),e.priority||(e.priority=Object.keys(e.params))}),this._resolverHash={}}set basePath(t){this._basePath=t}get basePath(){return this._basePath}set rootPath(t){this._rootPath=t}get rootPath(){return this._rootPath}get parsers(){return this._parsers}reset(){this.setBundleIdentifier(this._defaultBundleIdentifierOptions),this._assetMap={},this._preferredOrder=[],this._resolverHash={},this._rootPath=null,this._basePath=null,this._manifest=null,this._bundles={},this._defaultSearchParams=null}setDefaultSearchParams(t){if(typeof t=="string")this._defaultSearchParams=t;else{const e=t;this._defaultSearchParams=Object.keys(e).map(n=>`${encodeURIComponent(n)}=${encodeURIComponent(e[n])}`).join("&")}}getAlias(t){const{alias:e,src:n}=t;return Nt(e||n,i=>typeof i=="string"?i:Array.isArray(i)?i.map(o=>(o==null?void 0:o.src)??o):i!=null&&i.src?i.src:i,!0)}addManifest(t){this._manifest&&it("[Resolver] Manifest already exists, this will be overwritten"),this._manifest=t,t.bundles.forEach(e=>{this.addBundle(e.name,e.assets)})}addBundle(t,e){const n=[];let r=e;Array.isArray(e)||(r=Object.entries(e).map(([i,o])=>typeof o=="string"||Array.isArray(o)?{alias:i,src:o}:{alias:i,...o})),r.forEach(i=>{const o=i.src,a=i.alias;let l;if(typeof a=="string"){const h=this._createBundleAssetId(t,a);n.push(h),l=[a,h]}else{const h=a.map(c=>this._createBundleAssetId(t,c));n.push(...h),l=[...a,...h]}this.add({...i,alias:l,src:o})}),this._bundles[t]=n}add(t){const e=[];Array.isArray(t)?e.push(...t):e.push(t);let n;n=i=>{this.hasKey(i)&&it(`[Resolver] already has key: ${i} overwriting`)},Nt(e).forEach(i=>{const{src:o}=i;let{data:a,format:l,loadParser:h}=i;const c=Nt(o).map(d=>typeof d=="string"?ph(d):Array.isArray(d)?d:[d]),u=this.getAlias(i);Array.isArray(u)?u.forEach(n):n(u);const f=[];c.forEach(d=>{d.forEach(p=>{let g={};if(typeof p!="object"){g.src=p;for(let m=0;m<this._parsers.length;m++){const x=this._parsers[m];if(x.test(p)){g=x.parse(p);break}}}else a=p.data??a,l=p.format??l,h=p.loadParser??h,g={...g,...p};if(!u)throw new Error(`[Resolver] alias is undefined for this asset: ${g.src}`);g=this._buildResolvedAsset(g,{aliases:u,data:a,format:l,loadParser:h}),f.push(g)})}),u.forEach(d=>{this._assetMap[d]=f})})}resolveBundle(t){const e=Zs(t);t=Nt(t);const n={};return t.forEach(r=>{const i=this._bundles[r];if(i){const o=this.resolve(i),a={};for(const l in o){const h=o[l];a[this._extractAssetIdFromBundle(r,l)]=h}n[r]=a}}),e?n[t[0]]:n}resolveUrl(t){const e=this.resolve(t);if(typeof t!="string"){const n={};for(const r in e)n[r]=e[r].src;return n}return e.src}resolve(t){const e=Zs(t);t=Nt(t);const n={};return t.forEach(r=>{if(!this._resolverHash[r])if(this._assetMap[r]){let i=this._assetMap[r];const o=this._getPreferredOrder(i);o==null||o.priority.forEach(a=>{o.params[a].forEach(l=>{const h=i.filter(c=>c[a]?c[a]===l:!1);h.length&&(i=h)})}),this._resolverHash[r]=i[0]}else this._resolverHash[r]=this._buildResolvedAsset({alias:[r],src:r},{});n[r]=this._resolverHash[r]}),e?n[t[0]]:n}hasKey(t){return!!this._assetMap[t]}hasBundle(t){return!!this._bundles[t]}_getPreferredOrder(t){for(let e=0;e<t.length;e++){const n=t[e],r=this._preferredOrder.find(i=>i.params.format.includes(n.format));if(r)return r}return this._preferredOrder[0]}_appendDefaultSearchParams(t){if(!this._defaultSearchParams)return t;const e=/\?/.test(t)?"&":"?";return`${t}${e}${this._defaultSearchParams}`}_buildResolvedAsset(t,e){const{aliases:n,data:r,loadParser:i,format:o}=e;return(this._basePath||this._rootPath)&&(t.src=Ct.toAbsolute(t.src,this._basePath,this._rootPath)),t.alias=n??t.alias??[t.src],t.src=this._appendDefaultSearchParams(t.src),t.data={...r||{},...t.data},t.loadParser=i??t.loadParser,t.format=o??t.format??mh(t.src),t}}Qe.RETINA_PREFIX=/@([0-9\.]+)x/;function mh(s){return s.split(".").pop().split("?").shift().split("#").shift()}const xr=(s,t)=>{const e=t.split("?")[1];return e&&(s+=`?${e}`),s},Aa=class us{constructor(t,e){this.linkedSheets=[];let n=t;(t==null?void 0:t.source)instanceof jt&&(n={texture:t,data:e});const{texture:r,data:i,cachePrefix:o=""}=n;this.cachePrefix=o,this._texture=r instanceof $?r:null,this.textureSource=r.source,this.textures={},this.animations={},this.data=i;const a=parseFloat(i.meta.scale);a?(this.resolution=a,r.source.resolution=this.resolution):this.resolution=r.source._resolution,this._frames=this.data.frames,this._frameKeys=Object.keys(this._frames),this._batchIndex=0,this._callback=null}parse(){return new Promise(t=>{this._callback=t,this._batchIndex=0,this._frameKeys.length<=us.BATCH_SIZE?(this._processFrames(0),this._processAnimations(),this._parseComplete()):this._nextBatch()})}_processFrames(t){let e=t;const n=us.BATCH_SIZE;for(;e-t<n&&e<this._frameKeys.length;){const r=this._frameKeys[e],i=this._frames[r],o=i.frame;if(o){let a=null,l=null;const h=i.trimmed!==!1&&i.sourceSize?i.sourceSize:i.frame,c=new q(0,0,Math.floor(h.w)/this.resolution,Math.floor(h.h)/this.resolution);i.rotated?a=new q(Math.floor(o.x)/this.resolution,Math.floor(o.y)/this.resolution,Math.floor(o.h)/this.resolution,Math.floor(o.w)/this.resolution):a=new q(Math.floor(o.x)/this.resolution,Math.floor(o.y)/this.resolution,Math.floor(o.w)/this.resolution,Math.floor(o.h)/this.resolution),i.trimmed!==!1&&i.spriteSourceSize&&(l=new q(Math.floor(i.spriteSourceSize.x)/this.resolution,Math.floor(i.spriteSourceSize.y)/this.resolution,Math.floor(o.w)/this.resolution,Math.floor(o.h)/this.resolution)),this.textures[r]=new $({source:this.textureSource,frame:a,orig:c,trim:l,rotate:i.rotated?2:0,defaultAnchor:i.anchor,defaultBorders:i.borders,label:r.toString()})}e++}}_processAnimations(){const t=this.data.animations||{};for(const e in t){this.animations[e]=[];for(let n=0;n<t[e].length;n++){const r=t[e][n];this.animations[e].push(this.textures[r])}}}_parseComplete(){const t=this._callback;this._callback=null,this._batchIndex=0,t.call(this,this.textures)}_nextBatch(){this._processFrames(this._batchIndex*us.BATCH_SIZE),this._batchIndex++,setTimeout(()=>{this._batchIndex*us.BATCH_SIZE<this._frameKeys.length?this._nextBatch():(this._processAnimations(),this._parseComplete())},0)}destroy(t=!1){var e;for(const n in this.textures)this.textures[n].destroy();this._frames=null,this._frameKeys=null,this.data=null,this.textures=null,t&&((e=this._texture)==null||e.destroy(),this.textureSource.destroy()),this._texture=null,this.textureSource=null,this.linkedSheets=[]}};Aa.BATCH_SIZE=1e3;let Ei=Aa;const gh=["jpg","png","jpeg","avif","webp","basis","etc2","bc7","bc6h","bc5","bc4","bc3","bc2","bc1","eac","astc"];function Sa(s,t,e){const n={};if(s.forEach(r=>{n[r]=t}),Object.keys(t.textures).forEach(r=>{n[`${t.cachePrefix}${r}`]=t.textures[r]}),!e){const r=Ct.dirname(s[0]);t.linkedSheets.forEach((i,o)=>{const a=Sa([`${r}/${t.data.meta.related_multi_packs[o]}`],i,!0);Object.assign(n,a)})}return n}const xh={extension:N.Asset,cache:{test:s=>s instanceof Ei,getCacheableAssets:(s,t)=>Sa(s,t,!1)},resolver:{extension:{type:N.ResolveParser,name:"resolveSpritesheet"},test:s=>{const e=s.split("?")[0].split("."),n=e.pop(),r=e.pop();return n==="json"&&gh.includes(r)},parse:s=>{var e;const t=s.split(".");return{resolution:parseFloat(((e=Qe.RETINA_PREFIX.exec(s))==null?void 0:e[1])??"1"),format:t[t.length-2],src:s}}},loader:{name:"spritesheetLoader",extension:{type:N.LoadParser,priority:xe.Normal,name:"spritesheetLoader"},async testParse(s,t){return Ct.extname(t.src).toLowerCase()===".json"&&!!s.frames},async parse(s,t,e){var u,f;const{texture:n,imageFilename:r,textureOptions:i,cachePrefix:o}=(t==null?void 0:t.data)??{};let a=Ct.dirname(t.src);a&&a.lastIndexOf("/")!==a.length-1&&(a+="/");let l;if(n instanceof $)l=n;else{const d=xr(a+(r??s.meta.image),t.src);l=(await e.load([{src:d,data:i}]))[d]}const h=new Ei({texture:l.source,data:s,cachePrefix:o});await h.parse();const c=(u=s==null?void 0:s.meta)==null?void 0:u.related_multi_packs;if(Array.isArray(c)){const d=[];for(const g of c){if(typeof g!="string")continue;let m=a+g;(f=t.data)!=null&&f.ignoreMultiPack||(m=xr(m,t.src),d.push(e.load({src:m,data:{textureOptions:i,ignoreMultiPack:!0}})))}const p=await Promise.all(d);h.linkedSheets=p,p.forEach(g=>{g.linkedSheets=[h].concat(h.linkedSheets.filter(m=>m!==g))})}return h},async unload(s,t,e){await e.unload(s.textureSource._sourceOrigin),s.destroy(!1)}}};dt.add(xh);const Fn=Object.create(null),Ii=Object.create(null);function Wr(s,t){let e=Ii[s];return e===void 0&&(Fn[t]===void 0&&(Fn[t]=1),Ii[s]=e=Fn[t]++),e}let Oe;function Ca(){return(!Oe||Oe!=null&&Oe.isContextLost())&&(Oe=at.get().createCanvas().getContext("webgl",{})),Oe}let Es;function yh(){if(!Es){Es="mediump";const s=Ca();s&&s.getShaderPrecisionFormat&&(Es=s.getShaderPrecisionFormat(s.FRAGMENT_SHADER,s.HIGH_FLOAT).precision?"highp":"mediump")}return Es}function bh(s,t,e){return t?s:e?(s=s.replace("out vec4 finalColor;",""),`

        #ifdef GL_ES // This checks if it is WebGL1
        #define in varying
        #define finalColor gl_FragColor
        #define texture texture2D
        #endif
        ${s}
        `):`

        #ifdef GL_ES // This checks if it is WebGL1
        #define in attribute
        #define out varying
        #endif
        ${s}
        `}function wh(s,t,e){const n=e?t.maxSupportedFragmentPrecision:t.maxSupportedVertexPrecision;if(s.substring(0,9)!=="precision"){let r=e?t.requestedFragmentPrecision:t.requestedVertexPrecision;return r==="highp"&&n!=="highp"&&(r="mediump"),`precision ${r} float;
${s}`}else if(n!=="highp"&&s.substring(0,15)==="precision highp")return s.replace("precision highp","precision mediump");return s}function _h(s,t){return t?`#version 300 es
${s}`:s}const vh={},Ah={};function Sh(s,{name:t="pixi-program"},e=!0){t=t.replace(/\s+/g,"-"),t+=e?"-fragment":"-vertex";const n=e?vh:Ah;return n[t]?(n[t]++,t+=`-${n[t]}`):n[t]=1,s.indexOf("#define SHADER_NAME")!==-1?s:`${`#define SHADER_NAME ${t}`}
${s}`}function Ch(s,t){return t?s.replace("#version 300 es",""):s}const Rn={stripVersion:Ch,ensurePrecision:wh,addProgramDefines:bh,setProgramName:Sh,insertVersion:_h},Ln=Object.create(null),ka=class yr{constructor(t){t={...yr.defaultOptions,...t};const e=t.fragment.indexOf("#version 300 es")!==-1,n={stripVersion:e,ensurePrecision:{requestedFragmentPrecision:t.preferredFragmentPrecision,requestedVertexPrecision:t.preferredVertexPrecision,maxSupportedVertexPrecision:"highp",maxSupportedFragmentPrecision:yh()},setProgramName:{name:t.name},addProgramDefines:e,insertVersion:e};let r=t.fragment,i=t.vertex;Object.keys(Rn).forEach(o=>{const a=n[o];r=Rn[o](r,a,!0),i=Rn[o](i,a,!1)}),this.fragment=r,this.vertex=i,this.transformFeedbackVaryings=t.transformFeedbackVaryings,this._key=Wr(`${this.vertex}:${this.fragment}`,"gl-program")}destroy(){this.fragment=null,this.vertex=null,this._attributeData=null,this._uniformData=null,this._uniformBlockData=null,this.transformFeedbackVaryings=null}static from(t){const e=`${t.vertex}:${t.fragment}`;return Ln[e]||(Ln[e]=new yr(t)),Ln[e]}};ka.defaultOptions={preferredVertexPrecision:"highp",preferredFragmentPrecision:"mediump"};let un=ka;const Bi={uint8x2:{size:2,stride:2,normalised:!1},uint8x4:{size:4,stride:4,normalised:!1},sint8x2:{size:2,stride:2,normalised:!1},sint8x4:{size:4,stride:4,normalised:!1},unorm8x2:{size:2,stride:2,normalised:!0},unorm8x4:{size:4,stride:4,normalised:!0},snorm8x2:{size:2,stride:2,normalised:!0},snorm8x4:{size:4,stride:4,normalised:!0},uint16x2:{size:2,stride:4,normalised:!1},uint16x4:{size:4,stride:8,normalised:!1},sint16x2:{size:2,stride:4,normalised:!1},sint16x4:{size:4,stride:8,normalised:!1},unorm16x2:{size:2,stride:4,normalised:!0},unorm16x4:{size:4,stride:8,normalised:!0},snorm16x2:{size:2,stride:4,normalised:!0},snorm16x4:{size:4,stride:8,normalised:!0},float16x2:{size:2,stride:4,normalised:!1},float16x4:{size:4,stride:8,normalised:!1},float32:{size:1,stride:4,normalised:!1},float32x2:{size:2,stride:8,normalised:!1},float32x3:{size:3,stride:12,normalised:!1},float32x4:{size:4,stride:16,normalised:!1},uint32:{size:1,stride:4,normalised:!1},uint32x2:{size:2,stride:8,normalised:!1},uint32x3:{size:3,stride:12,normalised:!1},uint32x4:{size:4,stride:16,normalised:!1},sint32:{size:1,stride:4,normalised:!1},sint32x2:{size:2,stride:8,normalised:!1},sint32x3:{size:3,stride:12,normalised:!1},sint32x4:{size:4,stride:16,normalised:!1}};function kh(s){return Bi[s]??Bi.float32}const Ph={f32:"float32","vec2<f32>":"float32x2","vec3<f32>":"float32x3","vec4<f32>":"float32x4",vec2f:"float32x2",vec3f:"float32x3",vec4f:"float32x4",i32:"sint32","vec2<i32>":"sint32x2","vec3<i32>":"sint32x3","vec4<i32>":"sint32x4",u32:"uint32","vec2<u32>":"uint32x2","vec3<u32>":"uint32x3","vec4<u32>":"uint32x4",bool:"uint32","vec2<bool>":"uint32x2","vec3<bool>":"uint32x3","vec4<bool>":"uint32x4"};function Mh({source:s,entryPoint:t}){const e={},n=s.indexOf(`fn ${t}`);if(n!==-1){const r=s.indexOf("->",n);if(r!==-1){const i=s.substring(n,r),o=/@location\((\d+)\)\s+([a-zA-Z0-9_]+)\s*:\s*([a-zA-Z0-9_<>]+)(?:,|\s|$)/g;let a;for(;(a=o.exec(i))!==null;){const l=Ph[a[3]]??"float32";e[a[2]]={location:parseInt(a[1],10),format:l,stride:kh(l).stride,offset:0,instance:!1,start:0}}}}return e}function zn(s){var u,f;const t=/(^|[^/])@(group|binding)\(\d+\)[^;]+;/g,e=/@group\((\d+)\)/,n=/@binding\((\d+)\)/,r=/var(<[^>]+>)? (\w+)/,i=/:\s*(\w+)/,o=/struct\s+(\w+)\s*{([^}]+)}/g,a=/(\w+)\s*:\s*([\w\<\>]+)/g,l=/struct\s+(\w+)/,h=(u=s.match(t))==null?void 0:u.map(d=>({group:parseInt(d.match(e)[1],10),binding:parseInt(d.match(n)[1],10),name:d.match(r)[2],isUniform:d.match(r)[1]==="<uniform>",type:d.match(i)[1]}));if(!h)return{groups:[],structs:[]};const c=((f=s.match(o))==null?void 0:f.map(d=>{const p=d.match(l)[1],g=d.match(a).reduce((m,x)=>{const[y,b]=x.split(":");return m[y.trim()]=b.trim(),m},{});return g?{name:p,members:g}:null}).filter(({name:d})=>h.some(p=>p.type===d)))??[];return{groups:h,structs:c}}var ds=(s=>(s[s.VERTEX=1]="VERTEX",s[s.FRAGMENT=2]="FRAGMENT",s[s.COMPUTE=4]="COMPUTE",s))(ds||{});function Th({groups:s}){const t=[];for(let e=0;e<s.length;e++){const n=s[e];t[n.group]||(t[n.group]=[]),n.isUniform?t[n.group].push({binding:n.binding,visibility:ds.VERTEX|ds.FRAGMENT,buffer:{type:"uniform"}}):n.type==="sampler"?t[n.group].push({binding:n.binding,visibility:ds.FRAGMENT,sampler:{type:"filtering"}}):n.type==="texture_2d"&&t[n.group].push({binding:n.binding,visibility:ds.FRAGMENT,texture:{sampleType:"float",viewDimension:"2d",multisampled:!1}})}return t}function Eh({groups:s}){const t=[];for(let e=0;e<s.length;e++){const n=s[e];t[n.group]||(t[n.group]={}),t[n.group][n.name]=n.binding}return t}function Ih(s,t){const e=new Set,n=new Set,r=[...s.structs,...t.structs].filter(o=>e.has(o.name)?!1:(e.add(o.name),!0)),i=[...s.groups,...t.groups].filter(o=>{const a=`${o.name}-${o.binding}`;return n.has(a)?!1:(n.add(a),!0)});return{structs:r,groups:i}}const Gn=Object.create(null);class Je{constructor(t){var a,l;this._layoutKey=0,this._attributeLocationsKey=0;const{fragment:e,vertex:n,layout:r,gpuLayout:i,name:o}=t;if(this.name=o,this.fragment=e,this.vertex=n,e.source===n.source){const h=zn(e.source);this.structsAndGroups=h}else{const h=zn(n.source),c=zn(e.source);this.structsAndGroups=Ih(h,c)}this.layout=r??Eh(this.structsAndGroups),this.gpuLayout=i??Th(this.structsAndGroups),this.autoAssignGlobalUniforms=((a=this.layout[0])==null?void 0:a.globalUniforms)!==void 0,this.autoAssignLocalUniforms=((l=this.layout[1])==null?void 0:l.localUniforms)!==void 0,this._generateProgramKey()}_generateProgramKey(){const{vertex:t,fragment:e}=this,n=t.source+e.source+t.entryPoint+e.entryPoint;this._layoutKey=Wr(n,"program")}get attributeData(){return this._attributeData??(this._attributeData=Mh(this.vertex)),this._attributeData}destroy(){this.gpuLayout=null,this.layout=null,this.structsAndGroups=null,this.fragment=null,this.vertex=null}static from(t){const e=`${t.vertex.source}:${t.fragment.source}:${t.fragment.entryPoint}:${t.vertex.entryPoint}`;return Gn[e]||(Gn[e]=new Je(t)),Gn[e]}}const Pa=["f32","i32","vec2<f32>","vec3<f32>","vec4<f32>","mat2x2<f32>","mat3x3<f32>","mat4x4<f32>","mat3x2<f32>","mat4x2<f32>","mat2x3<f32>","mat4x3<f32>","mat2x4<f32>","mat3x4<f32>","vec2<i32>","vec3<i32>","vec4<i32>"],Bh=Pa.reduce((s,t)=>(s[t]=!0,s),{});function Fh(s,t){switch(s){case"f32":return 0;case"vec2<f32>":return new Float32Array(2*t);case"vec3<f32>":return new Float32Array(3*t);case"vec4<f32>":return new Float32Array(4*t);case"mat2x2<f32>":return new Float32Array([1,0,0,1]);case"mat3x3<f32>":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4x4<f32>":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}return null}const Ma=class Ta{constructor(t,e){this._touched=0,this.uid=lt("uniform"),this._resourceType="uniformGroup",this._resourceId=lt("resource"),this.isUniformGroup=!0,this._dirtyId=0,this.destroyed=!1,e={...Ta.defaultOptions,...e},this.uniformStructures=t;const n={};for(const r in t){const i=t[r];if(i.name=r,i.size=i.size??1,!Bh[i.type])throw new Error(`Uniform type ${i.type} is not supported. Supported uniform types are: ${Pa.join(", ")}`);i.value??(i.value=Fh(i.type,i.size)),n[r]=i.value}this.uniforms=n,this._dirtyId=1,this.ubo=e.ubo,this.isStatic=e.isStatic,this._signature=Wr(Object.keys(n).map(r=>`${r}-${t[r].type}`).join("-"),"uniform-group")}update(){this._dirtyId++}};Ma.defaultOptions={ubo:!1,isStatic:!1};let Ea=Ma;class Xs{constructor(t){this.resources=Object.create(null),this._dirty=!0;let e=0;for(const n in t){const r=t[n];this.setResource(r,e++)}this._updateKey()}_updateKey(){if(!this._dirty)return;this._dirty=!1;const t=[];let e=0;for(const n in this.resources)t[e++]=this.resources[n]._resourceId;this._key=t.join("|")}setResource(t,e){var r,i;const n=this.resources[e];t!==n&&(n&&((r=t.off)==null||r.call(t,"change",this.onResourceChange,this)),(i=t.on)==null||i.call(t,"change",this.onResourceChange,this),this.resources[e]=t,this._dirty=!0)}getResource(t){return this.resources[t]}_touch(t){const e=this.resources;for(const n in e)e[n]._touched=t}destroy(){var e;const t=this.resources;for(const n in t){const r=t[n];(e=r.off)==null||e.call(r,"change",this.onResourceChange,this)}this.resources=null}onResourceChange(t){if(this._dirty=!0,t.destroyed){const e=this.resources;for(const n in e)e[n]===t&&(e[n]=null)}else this._updateKey()}}var br=(s=>(s[s.WEBGL=1]="WEBGL",s[s.WEBGPU=2]="WEBGPU",s[s.BOTH=3]="BOTH",s))(br||{});class dn extends Wt{constructor(t){super(),this.uid=lt("shader"),this._uniformBindMap=Object.create(null),this._ownedBindGroups=[];let{gpuProgram:e,glProgram:n,groups:r,resources:i,compatibleRenderers:o,groupMap:a}=t;this.gpuProgram=e,this.glProgram=n,o===void 0&&(o=0,e&&(o|=br.WEBGPU),n&&(o|=br.WEBGL)),this.compatibleRenderers=o;const l={};if(!i&&!r&&(i={}),i&&r)throw new Error("[Shader] Cannot have both resources and groups");if(!e&&r&&!a)throw new Error("[Shader] No group map or WebGPU shader provided - consider using resources instead.");if(!e&&r&&a)for(const h in a)for(const c in a[h]){const u=a[h][c];l[u]={group:h,binding:c,name:u}}else if(e&&r&&!a){const h=e.structsAndGroups.groups;a={},h.forEach(c=>{a[c.group]=a[c.group]||{},a[c.group][c.binding]=c.name,l[c.name]=c})}else if(i){r={},a={},e&&e.structsAndGroups.groups.forEach(u=>{a[u.group]=a[u.group]||{},a[u.group][u.binding]=u.name,l[u.name]=u});let h=0;for(const c in i)l[c]||(r[99]||(r[99]=new Xs,this._ownedBindGroups.push(r[99])),l[c]={group:99,binding:h,name:c},a[99]=a[99]||{},a[99][h]=c,h++);for(const c in i){const u=c;let f=i[c];!f.source&&!f._resourceType&&(f=new Ea(f));const d=l[u];d&&(r[d.group]||(r[d.group]=new Xs,this._ownedBindGroups.push(r[d.group])),r[d.group].setResource(f,d.binding))}}this.groups=r,this._uniformBindMap=a,this.resources=this._buildResourceAccessor(r,l)}addResource(t,e,n){var r,i;(r=this._uniformBindMap)[e]||(r[e]={}),(i=this._uniformBindMap[e])[n]||(i[n]=t),this.groups[e]||(this.groups[e]=new Xs,this._ownedBindGroups.push(this.groups[e]))}_buildResourceAccessor(t,e){const n={};for(const r in e){const i=e[r];Object.defineProperty(n,i.name,{get(){return t[i.group].getResource(i.binding)},set(o){t[i.group].setResource(o,i.binding)}})}return n}destroy(t=!1){var e,n;this.emit("destroy",this),t&&((e=this.gpuProgram)==null||e.destroy(),(n=this.glProgram)==null||n.destroy()),this.gpuProgram=null,this.glProgram=null,this.removeAllListeners(),this._uniformBindMap=null,this._ownedBindGroups.forEach(r=>{r.destroy()}),this._ownedBindGroups=null,this.resources=null,this.groups=null}static from(t){const{gpu:e,gl:n,...r}=t;let i,o;return e&&(i=Je.from(e)),n&&(o=un.from(n)),new dn({gpuProgram:i,glProgram:o,...r})}}const Rh={normal:0,add:1,multiply:2,screen:3,overlay:4,erase:5,"normal-npm":6,"add-npm":7,"screen-npm":8,min:9,max:10},On=0,Nn=1,Un=2,Dn=3,Hn=4,Wn=5,wr=class Ia{constructor(){this.data=0,this.blendMode="normal",this.polygonOffset=0,this.blend=!0,this.depthMask=!0}get blend(){return!!(this.data&1<<On)}set blend(t){!!(this.data&1<<On)!==t&&(this.data^=1<<On)}get offsets(){return!!(this.data&1<<Nn)}set offsets(t){!!(this.data&1<<Nn)!==t&&(this.data^=1<<Nn)}set cullMode(t){if(t==="none"){this.culling=!1;return}this.culling=!0,this.clockwiseFrontFace=t==="front"}get cullMode(){return this.culling?this.clockwiseFrontFace?"front":"back":"none"}get culling(){return!!(this.data&1<<Un)}set culling(t){!!(this.data&1<<Un)!==t&&(this.data^=1<<Un)}get depthTest(){return!!(this.data&1<<Dn)}set depthTest(t){!!(this.data&1<<Dn)!==t&&(this.data^=1<<Dn)}get depthMask(){return!!(this.data&1<<Wn)}set depthMask(t){!!(this.data&1<<Wn)!==t&&(this.data^=1<<Wn)}get clockwiseFrontFace(){return!!(this.data&1<<Hn)}set clockwiseFrontFace(t){!!(this.data&1<<Hn)!==t&&(this.data^=1<<Hn)}get blendMode(){return this._blendMode}set blendMode(t){this.blend=t!=="none",this._blendMode=t,this._blendModeId=Rh[t]||0}get polygonOffset(){return this._polygonOffset}set polygonOffset(t){this.offsets=!!t,this._polygonOffset=t}toString(){return`[pixi.js/core:State blendMode=${this.blendMode} clockwiseFrontFace=${this.clockwiseFrontFace} culling=${this.culling} depthMask=${this.depthMask} polygonOffset=${this.polygonOffset}]`}static for2d(){const t=new Ia;return t.depthTest=!1,t.blend=!0,t}};wr.default2d=wr.for2d();let Lh=wr;const Ba=class _r extends dn{constructor(t){t={..._r.defaultOptions,...t},super(t),this.enabled=!0,this._state=Lh.for2d(),this.blendMode=t.blendMode,this.padding=t.padding,typeof t.antialias=="boolean"?this.antialias=t.antialias?"on":"off":this.antialias=t.antialias,this.resolution=t.resolution,this.blendRequired=t.blendRequired,this.clipToViewport=t.clipToViewport,this.addResource("uTexture",0,1)}apply(t,e,n,r){t.applyFilter(this,e,n,r)}get blendMode(){return this._state.blendMode}set blendMode(t){this._state.blendMode=t}static from(t){const{gpu:e,gl:n,...r}=t;let i,o;return e&&(i=Je.from(e)),n&&(o=un.from(n)),new _r({gpuProgram:i,glProgram:o,...r})}};Ba.defaultOptions={blendMode:"normal",resolution:1,padding:0,antialias:"off",blendRequired:!1,clipToViewport:!0};let zh=Ba;const vr=[];dt.handleByNamedList(N.Environment,vr);async function Gh(s){if(!s)for(let t=0;t<vr.length;t++){const e=vr[t];if(e.value.test()){await e.value.load();return}}}let is;function Oh(){if(typeof is=="boolean")return is;try{is=new Function("param1","param2","param3","return param1[param2] === param3;")({a:"b"},"a","b")===!0}catch{is=!1}return is}function Fi(s,t,e=2){const n=t&&t.length,r=n?t[0]*e:s.length;let i=Fa(s,0,r,e,!0);const o=[];if(!i||i.next===i.prev)return o;let a,l,h;if(n&&(i=Wh(s,t,i,e)),s.length>80*e){a=1/0,l=1/0;let c=-1/0,u=-1/0;for(let f=e;f<r;f+=e){const d=s[f],p=s[f+1];d<a&&(a=d),p<l&&(l=p),d>c&&(c=d),p>u&&(u=p)}h=Math.max(c-a,u-l),h=h!==0?32767/h:0}return _s(i,o,e,a,l,h,0),o}function Fa(s,t,e,n,r){let i;if(r===tu(s,t,e,n)>0)for(let o=t;o<e;o+=n)i=Ri(o/n|0,s[o],s[o+1],i);else for(let o=e-n;o>=t;o-=n)i=Ri(o/n|0,s[o],s[o+1],i);return i&&Xe(i,i.next)&&(As(i),i=i.next),i}function Ge(s,t){if(!s)return s;t||(t=s);let e=s,n;do if(n=!1,!e.steiner&&(Xe(e,e.next)||st(e.prev,e,e.next)===0)){if(As(e),e=t=e.prev,e===e.next)break;n=!0}else e=e.next;while(n||e!==t);return t}function _s(s,t,e,n,r,i,o){if(!s)return;!o&&i&&Xh(s,n,r,i);let a=s;for(;s.prev!==s.next;){const l=s.prev,h=s.next;if(i?Uh(s,n,r,i):Nh(s)){t.push(l.i,s.i,h.i),As(s),s=h.next,a=h.next;continue}if(s=h,s===a){o?o===1?(s=Dh(Ge(s),t),_s(s,t,e,n,r,i,2)):o===2&&Hh(s,t,e,n,r,i):_s(Ge(s),t,e,n,r,i,1);break}}}function Nh(s){const t=s.prev,e=s,n=s.next;if(st(t,e,n)>=0)return!1;const r=t.x,i=e.x,o=n.x,a=t.y,l=e.y,h=n.y,c=Math.min(r,i,o),u=Math.min(a,l,h),f=Math.max(r,i,o),d=Math.max(a,l,h);let p=n.next;for(;p!==t;){if(p.x>=c&&p.x<=f&&p.y>=u&&p.y<=d&&fs(r,a,i,l,o,h,p.x,p.y)&&st(p.prev,p,p.next)>=0)return!1;p=p.next}return!0}function Uh(s,t,e,n){const r=s.prev,i=s,o=s.next;if(st(r,i,o)>=0)return!1;const a=r.x,l=i.x,h=o.x,c=r.y,u=i.y,f=o.y,d=Math.min(a,l,h),p=Math.min(c,u,f),g=Math.max(a,l,h),m=Math.max(c,u,f),x=Ar(d,p,t,e,n),y=Ar(g,m,t,e,n);let b=s.prevZ,w=s.nextZ;for(;b&&b.z>=x&&w&&w.z<=y;){if(b.x>=d&&b.x<=g&&b.y>=p&&b.y<=m&&b!==r&&b!==o&&fs(a,c,l,u,h,f,b.x,b.y)&&st(b.prev,b,b.next)>=0||(b=b.prevZ,w.x>=d&&w.x<=g&&w.y>=p&&w.y<=m&&w!==r&&w!==o&&fs(a,c,l,u,h,f,w.x,w.y)&&st(w.prev,w,w.next)>=0))return!1;w=w.nextZ}for(;b&&b.z>=x;){if(b.x>=d&&b.x<=g&&b.y>=p&&b.y<=m&&b!==r&&b!==o&&fs(a,c,l,u,h,f,b.x,b.y)&&st(b.prev,b,b.next)>=0)return!1;b=b.prevZ}for(;w&&w.z<=y;){if(w.x>=d&&w.x<=g&&w.y>=p&&w.y<=m&&w!==r&&w!==o&&fs(a,c,l,u,h,f,w.x,w.y)&&st(w.prev,w,w.next)>=0)return!1;w=w.nextZ}return!0}function Dh(s,t){let e=s;do{const n=e.prev,r=e.next.next;!Xe(n,r)&&La(n,e,e.next,r)&&vs(n,r)&&vs(r,n)&&(t.push(n.i,e.i,r.i),As(e),As(e.next),e=s=r),e=e.next}while(e!==s);return Ge(e)}function Hh(s,t,e,n,r,i){let o=s;do{let a=o.next.next;for(;a!==o.prev;){if(o.i!==a.i&&Zh(o,a)){let l=za(o,a);o=Ge(o,o.next),l=Ge(l,l.next),_s(o,t,e,n,r,i,0),_s(l,t,e,n,r,i,0);return}a=a.next}o=o.next}while(o!==s)}function Wh(s,t,e,n){const r=[];for(let i=0,o=t.length;i<o;i++){const a=t[i]*n,l=i<o-1?t[i+1]*n:s.length,h=Fa(s,a,l,n,!1);h===h.next&&(h.steiner=!0),r.push(Kh(h))}r.sort(jh);for(let i=0;i<r.length;i++)e=$h(r[i],e);return e}function jh(s,t){let e=s.x-t.x;if(e===0&&(e=s.y-t.y,e===0)){const n=(s.next.y-s.y)/(s.next.x-s.x),r=(t.next.y-t.y)/(t.next.x-t.x);e=n-r}return e}function $h(s,t){const e=Vh(s,t);if(!e)return t;const n=za(e,s);return Ge(n,n.next),Ge(e,e.next)}function Vh(s,t){let e=t;const n=s.x,r=s.y;let i=-1/0,o;if(Xe(s,e))return e;do{if(Xe(s,e.next))return e.next;if(r<=e.y&&r>=e.next.y&&e.next.y!==e.y){const u=e.x+(r-e.y)*(e.next.x-e.x)/(e.next.y-e.y);if(u<=n&&u>i&&(i=u,o=e.x<e.next.x?e:e.next,u===n))return o}e=e.next}while(e!==t);if(!o)return null;const a=o,l=o.x,h=o.y;let c=1/0;e=o;do{if(n>=e.x&&e.x>=l&&n!==e.x&&Ra(r<h?n:i,r,l,h,r<h?i:n,r,e.x,e.y)){const u=Math.abs(r-e.y)/(n-e.x);vs(e,s)&&(u<c||u===c&&(e.x>o.x||e.x===o.x&&Yh(o,e)))&&(o=e,c=u)}e=e.next}while(e!==a);return o}function Yh(s,t){return st(s.prev,s,t.prev)<0&&st(t.next,s,s.next)<0}function Xh(s,t,e,n){let r=s;do r.z===0&&(r.z=Ar(r.x,r.y,t,e,n)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next;while(r!==s);r.prevZ.nextZ=null,r.prevZ=null,qh(r)}function qh(s){let t,e=1;do{let n=s,r;s=null;let i=null;for(t=0;n;){t++;let o=n,a=0;for(let h=0;h<e&&(a++,o=o.nextZ,!!o);h++);let l=e;for(;a>0||l>0&&o;)a!==0&&(l===0||!o||n.z<=o.z)?(r=n,n=n.nextZ,a--):(r=o,o=o.nextZ,l--),i?i.nextZ=r:s=r,r.prevZ=i,i=r;n=o}i.nextZ=null,e*=2}while(t>1);return s}function Ar(s,t,e,n,r){return s=(s-e)*r|0,t=(t-n)*r|0,s=(s|s<<8)&16711935,s=(s|s<<4)&252645135,s=(s|s<<2)&858993459,s=(s|s<<1)&1431655765,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,t=(t|t<<1)&1431655765,s|t<<1}function Kh(s){let t=s,e=s;do(t.x<e.x||t.x===e.x&&t.y<e.y)&&(e=t),t=t.next;while(t!==s);return e}function Ra(s,t,e,n,r,i,o,a){return(r-o)*(t-a)>=(s-o)*(i-a)&&(s-o)*(n-a)>=(e-o)*(t-a)&&(e-o)*(i-a)>=(r-o)*(n-a)}function fs(s,t,e,n,r,i,o,a){return!(s===o&&t===a)&&Ra(s,t,e,n,r,i,o,a)}function Zh(s,t){return s.next.i!==t.i&&s.prev.i!==t.i&&!Qh(s,t)&&(vs(s,t)&&vs(t,s)&&Jh(s,t)&&(st(s.prev,s,t.prev)||st(s,t.prev,t))||Xe(s,t)&&st(s.prev,s,s.next)>0&&st(t.prev,t,t.next)>0)}function st(s,t,e){return(t.y-s.y)*(e.x-t.x)-(t.x-s.x)*(e.y-t.y)}function Xe(s,t){return s.x===t.x&&s.y===t.y}function La(s,t,e,n){const r=Bs(st(s,t,e)),i=Bs(st(s,t,n)),o=Bs(st(e,n,s)),a=Bs(st(e,n,t));return!!(r!==i&&o!==a||r===0&&Is(s,e,t)||i===0&&Is(s,n,t)||o===0&&Is(e,s,n)||a===0&&Is(e,t,n))}function Is(s,t,e){return t.x<=Math.max(s.x,e.x)&&t.x>=Math.min(s.x,e.x)&&t.y<=Math.max(s.y,e.y)&&t.y>=Math.min(s.y,e.y)}function Bs(s){return s>0?1:s<0?-1:0}function Qh(s,t){let e=s;do{if(e.i!==s.i&&e.next.i!==s.i&&e.i!==t.i&&e.next.i!==t.i&&La(e,e.next,s,t))return!0;e=e.next}while(e!==s);return!1}function vs(s,t){return st(s.prev,s,s.next)<0?st(s,t,s.next)>=0&&st(s,s.prev,t)>=0:st(s,t,s.prev)<0||st(s,s.next,t)<0}function Jh(s,t){let e=s,n=!1;const r=(s.x+t.x)/2,i=(s.y+t.y)/2;do e.y>i!=e.next.y>i&&e.next.y!==e.y&&r<(e.next.x-e.x)*(i-e.y)/(e.next.y-e.y)+e.x&&(n=!n),e=e.next;while(e!==s);return n}function za(s,t){const e=Sr(s.i,s.x,s.y),n=Sr(t.i,t.x,t.y),r=s.next,i=t.prev;return s.next=t,t.prev=s,e.next=r,r.prev=e,n.next=e,e.prev=n,i.next=n,n.prev=i,n}function Ri(s,t,e,n){const r=Sr(s,t,e);return n?(r.next=n.next,r.prev=n,n.next.prev=r,n.next=r):(r.prev=r,r.next=r),r}function As(s){s.next.prev=s.prev,s.prev.next=s.next,s.prevZ&&(s.prevZ.nextZ=s.nextZ),s.nextZ&&(s.nextZ.prevZ=s.prevZ)}function Sr(s,t,e){return{i:s,x:t,y:e,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}function tu(s,t,e,n){let r=0;for(let i=t,o=e-n;i<e;i+=n)r+=(s[o]-s[i])*(s[i+1]+s[o+1]),o=i;return r}const eu=Fi.default||Fi;var Ga=(s=>(s[s.NONE=0]="NONE",s[s.COLOR=16384]="COLOR",s[s.STENCIL=1024]="STENCIL",s[s.DEPTH=256]="DEPTH",s[s.COLOR_DEPTH=16640]="COLOR_DEPTH",s[s.COLOR_STENCIL=17408]="COLOR_STENCIL",s[s.DEPTH_STENCIL=1280]="DEPTH_STENCIL",s[s.ALL=17664]="ALL",s))(Ga||{});class su{constructor(t){this.items=[],this._name=t}emit(t,e,n,r,i,o,a,l){const{name:h,items:c}=this;for(let u=0,f=c.length;u<f;u++)c[u][h](t,e,n,r,i,o,a,l);return this}add(t){return t[this._name]&&(this.remove(t),this.items.push(t)),this}remove(t){const e=this.items.indexOf(t);return e!==-1&&this.items.splice(e,1),this}contains(t){return this.items.indexOf(t)!==-1}removeAll(){return this.items.length=0,this}destroy(){this.removeAll(),this.items=null,this._name=null}get empty(){return this.items.length===0}get name(){return this._name}}const nu=["init","destroy","contextChange","resolutionChange","resetState","renderEnd","renderStart","render","update","postrender","prerender"],Oa=class Na extends Wt{constructor(t){super(),this.uid=lt("renderer"),this.runners=Object.create(null),this.renderPipes=Object.create(null),this._initOptions={},this._systemsHash=Object.create(null),this.type=t.type,this.name=t.name,this.config=t;const e=[...nu,...this.config.runners??[]];this._addRunners(...e),this._unsafeEvalCheck()}async init(t={}){const e=t.skipExtensionImports===!0?!0:t.manageImports===!1;await Gh(e),this._addSystems(this.config.systems),this._addPipes(this.config.renderPipes,this.config.renderPipeAdaptors);for(const n in this._systemsHash)t={...this._systemsHash[n].constructor.defaultOptions,...t};t={...Na.defaultOptions,...t},this._roundPixels=t.roundPixels?1:0;for(let n=0;n<this.runners.init.items.length;n++)await this.runners.init.items[n].init(t);this._initOptions=t}render(t,e){let n=t;if(n instanceof zt&&(n={container:n},e&&(V(Z,"passing a second argument is deprecated, please use render options instead"),n.target=e.renderTexture)),n.target||(n.target=this.view.renderTarget),n.target===this.view.renderTarget&&(this._lastObjectRendered=n.container,n.clearColor??(n.clearColor=this.background.colorRgba),n.clear??(n.clear=this.background.clearBeforeRender)),n.clearColor){const r=Array.isArray(n.clearColor)&&n.clearColor.length===4;n.clearColor=r?n.clearColor:ot.shared.setValue(n.clearColor).toArray()}n.transform||(n.container.updateLocalTransform(),n.transform=n.container.localTransform),n.container.enableRenderGroup(),this.runners.prerender.emit(n),this.runners.renderStart.emit(n),this.runners.render.emit(n),this.runners.renderEnd.emit(n),this.runners.postrender.emit(n)}resize(t,e,n){const r=this.view.resolution;this.view.resize(t,e,n),this.emit("resize",this.view.screen.width,this.view.screen.height,this.view.resolution),n!==void 0&&n!==r&&this.runners.resolutionChange.emit(n)}clear(t={}){const e=this;t.target||(t.target=e.renderTarget.renderTarget),t.clearColor||(t.clearColor=this.background.colorRgba),t.clear??(t.clear=Ga.ALL);const{clear:n,clearColor:r,target:i}=t;ot.shared.setValue(r??this.background.colorRgba),e.renderTarget.clear(i,n,ot.shared.toArray())}get resolution(){return this.view.resolution}set resolution(t){this.view.resolution=t,this.runners.resolutionChange.emit(t)}get width(){return this.view.texture.frame.width}get height(){return this.view.texture.frame.height}get canvas(){return this.view.canvas}get lastObjectRendered(){return this._lastObjectRendered}get renderingToScreen(){return this.renderTarget.renderingToScreen}get screen(){return this.view.screen}_addRunners(...t){t.forEach(e=>{this.runners[e]=new su(e)})}_addSystems(t){let e;for(e in t){const n=t[e];this._addSystem(n.value,n.name)}}_addSystem(t,e){const n=new t(this);if(this[e])throw new Error(`Whoops! The name "${e}" is already in use`);this[e]=n,this._systemsHash[e]=n;for(const r in this.runners)this.runners[r].add(n);return this}_addPipes(t,e){const n=e.reduce((r,i)=>(r[i.name]=i.value,r),{});t.forEach(r=>{const i=r.value,o=r.name,a=n[o];this.renderPipes[o]=new i(this,a?new a:null)})}destroy(t=!1){this.runners.destroy.items.reverse(),this.runners.destroy.emit(t),Object.values(this.runners).forEach(e=>{e.destroy()}),this._systemsHash=null,this.renderPipes=null}generateTexture(t){return this.textureGenerator.generateTexture(t)}get roundPixels(){return!!this._roundPixels}_unsafeEvalCheck(){if(!Oh())throw new Error("Current environment does not allow unsafe-eval, please use pixi.js/unsafe-eval module to enable support.")}resetState(){this.runners.resetState.emit()}};Oa.defaultOptions={resolution:1,failIfMajorPerformanceCaveat:!1,roundPixels:!1};let Ua=Oa,Fs;function ru(s){return Fs!==void 0||(Fs=(()=>{var e;const t={stencil:!0,failIfMajorPerformanceCaveat:s??Ua.defaultOptions.failIfMajorPerformanceCaveat};try{if(!at.get().getWebGLRenderingContext())return!1;let r=at.get().createCanvas().getContext("webgl",t);const i=!!((e=r==null?void 0:r.getContextAttributes())!=null&&e.stencil);if(r){const o=r.getExtension("WEBGL_lose_context");o&&o.loseContext()}return r=null,i}catch{return!1}})()),Fs}let Rs;async function iu(s={}){return Rs!==void 0||(Rs=await(async()=>{const t=at.get().getNavigator().gpu;if(!t)return!1;try{return await(await t.requestAdapter(s)).requestDevice(),!0}catch{return!1}})()),Rs}const Li=["webgl","webgpu","canvas"];async function ou(s){let t=[];s.preference?(t.push(s.preference),Li.forEach(i=>{i!==s.preference&&t.push(i)})):t=Li.slice();let e,n={};for(let i=0;i<t.length;i++){const o=t[i];if(o==="webgpu"&&await iu()){const{WebGPURenderer:a}=await qs(async()=>{const{WebGPURenderer:l}=await import("./WebGPURenderer-D057-5E0.js");return{WebGPURenderer:l}},__vite__mapDeps([4,2,5,3]));e=a,n={...s,...s.webgpu};break}else if(o==="webgl"&&ru(s.failIfMajorPerformanceCaveat??Ua.defaultOptions.failIfMajorPerformanceCaveat)){const{WebGLRenderer:a}=await qs(async()=>{const{WebGLRenderer:l}=await import("./WebGLRenderer-Dua_rM7r.js");return{WebGLRenderer:l}},__vite__mapDeps([6,2,5,3]));e=a,n={...s,...s.webgl};break}else if(o==="canvas")throw n={...s},new Error("CanvasRenderer is not yet implemented")}if(delete n.webgpu,delete n.webgl,!e)throw new Error("No available renderer for the current environment");const r=new e;return await r.init(n),r}const Da="8.10.2";class Ha{static init(){var t;(t=globalThis.__PIXI_APP_INIT__)==null||t.call(globalThis,this,Da)}static destroy(){}}Ha.extension=N.Application;class au{constructor(t){this._renderer=t}init(){var t;(t=globalThis.__PIXI_RENDERER_INIT__)==null||t.call(globalThis,this._renderer,Da)}destroy(){this._renderer=null}}au.extension={type:[N.WebGLSystem,N.WebGPUSystem],name:"initHook",priority:-10};const Wa=class Cr{constructor(...t){this.stage=new zt,t[0]!==void 0&&V(Z,"Application constructor options are deprecated, please use Application.init() instead.")}async init(t){t={...t},this.renderer=await ou(t),Cr._plugins.forEach(e=>{e.init.call(this,t)})}render(){this.renderer.render({container:this.stage})}get canvas(){return this.renderer.canvas}get view(){return V(Z,"Application.view is deprecated, please use Application.canvas instead."),this.renderer.canvas}get screen(){return this.renderer.screen}destroy(t=!1,e=!1){const n=Cr._plugins.slice(0);n.reverse(),n.forEach(r=>{r.destroy.call(this)}),this.stage.destroy(e),this.stage=null,this.renderer.destroy(t),this.renderer=null}};Wa._plugins=[];let ja=Wa;dt.handleByList(N.Application,ja._plugins);dt.add(Ha);class $a extends Wt{constructor(){super(...arguments),this.chars=Object.create(null),this.lineHeight=0,this.fontFamily="",this.fontMetrics={fontSize:0,ascent:0,descent:0},this.baseLineOffset=0,this.distanceField={type:"none",range:0},this.pages=[],this.applyFillAsTint=!0,this.baseMeasurementFontSize=100,this.baseRenderedFontSize=100}get font(){return V(Z,"BitmapFont.font is deprecated, please use BitmapFont.fontFamily instead."),this.fontFamily}get pageTextures(){return V(Z,"BitmapFont.pageTextures is deprecated, please use BitmapFont.pages instead."),this.pages}get size(){return V(Z,"BitmapFont.size is deprecated, please use BitmapFont.fontMetrics.fontSize instead."),this.fontMetrics.fontSize}get distanceFieldRange(){return V(Z,"BitmapFont.distanceFieldRange is deprecated, please use BitmapFont.distanceField.range instead."),this.distanceField.range}get distanceFieldType(){return V(Z,"BitmapFont.distanceFieldType is deprecated, please use BitmapFont.distanceField.type instead."),this.distanceField.type}destroy(t=!1){var e;this.emit("destroy",this),this.removeAllListeners();for(const n in this.chars)(e=this.chars[n].texture)==null||e.destroy();this.chars=null,t&&(this.pages.forEach(n=>n.texture.destroy(!0)),this.pages=null)}}const lu=["serif","sans-serif","monospace","cursive","fantasy","system-ui"];function Qs(s){const t=typeof s.fontSize=="number"?`${s.fontSize}px`:s.fontSize;let e=s.fontFamily;Array.isArray(s.fontFamily)||(e=s.fontFamily.split(","));for(let n=e.length-1;n>=0;n--){let r=e[n].trim();!/([\"\'])[^\'\"]+\1/.test(r)&&!lu.includes(r)&&(r=`"${r}"`),e[n]=r}return`${s.fontStyle} ${s.fontVariant} ${s.fontWeight} ${t} ${e.join(",")}`}const jn={willReadFrequently:!0},te=class O{static get experimentalLetterSpacingSupported(){let t=O._experimentalLetterSpacingSupported;if(t===void 0){const e=at.get().getCanvasRenderingContext2D().prototype;t=O._experimentalLetterSpacingSupported="letterSpacing"in e||"textLetterSpacing"in e}return t}constructor(t,e,n,r,i,o,a,l,h){this.text=t,this.style=e,this.width=n,this.height=r,this.lines=i,this.lineWidths=o,this.lineHeight=a,this.maxLineWidth=l,this.fontProperties=h}static measureText(t=" ",e,n=O._canvas,r=e.wordWrap){var x;const i=Qs(e),o=O.measureFont(i);o.fontSize===0&&(o.fontSize=e.fontSize,o.ascent=e.fontSize);const a=O.__context;a.font=i;const h=(r?O._wordWrap(t,e,n):t).split(/(?:\r\n|\r|\n)/),c=new Array(h.length);let u=0;for(let y=0;y<h.length;y++){const b=O._measureText(h[y],e.letterSpacing,a);c[y]=b,u=Math.max(u,b)}const f=((x=e._stroke)==null?void 0:x.width)||0;let d=u+f;e.dropShadow&&(d+=e.dropShadow.distance);const p=e.lineHeight||o.fontSize;let g=Math.max(p,o.fontSize+f)+(h.length-1)*(p+e.leading);return e.dropShadow&&(g+=e.dropShadow.distance),new O(t,e,d,g,h,c,p+e.leading,u,o)}static _measureText(t,e,n){let r=!1;O.experimentalLetterSpacingSupported&&(O.experimentalLetterSpacing?(n.letterSpacing=`${e}px`,n.textLetterSpacing=`${e}px`,r=!0):(n.letterSpacing="0px",n.textLetterSpacing="0px"));const i=n.measureText(t);let o=i.width;const a=-i.actualBoundingBoxLeft;let h=i.actualBoundingBoxRight-a;if(o>0)if(r)o-=e,h-=e;else{const c=(O.graphemeSegmenter(t).length-1)*e;o+=c,h+=c}return Math.max(o,h)}static _wordWrap(t,e,n=O._canvas){const r=n.getContext("2d",jn);let i=0,o="",a="";const l=Object.create(null),{letterSpacing:h,whiteSpace:c}=e,u=O._collapseSpaces(c),f=O._collapseNewlines(c);let d=!u;const p=e.wordWrapWidth+h,g=O._tokenize(t);for(let m=0;m<g.length;m++){let x=g[m];if(O._isNewline(x)){if(!f){a+=O._addLine(o),d=!u,o="",i=0;continue}x=" "}if(u){const b=O.isBreakingSpace(x),w=O.isBreakingSpace(o[o.length-1]);if(b&&w)continue}const y=O._getFromCache(x,h,l,r);if(y>p)if(o!==""&&(a+=O._addLine(o),o="",i=0),O.canBreakWords(x,e.breakWords)){const b=O.wordWrapSplit(x);for(let w=0;w<b.length;w++){let _=b[w],A=_,C=1;for(;b[w+C];){const v=b[w+C];if(!O.canBreakChars(A,v,x,w,e.breakWords))_+=v;else break;A=v,C++}w+=C-1;const P=O._getFromCache(_,h,l,r);P+i>p&&(a+=O._addLine(o),d=!1,o="",i=0),o+=_,i+=P}}else{o.length>0&&(a+=O._addLine(o),o="",i=0);const b=m===g.length-1;a+=O._addLine(x,!b),d=!1,o="",i=0}else y+i>p&&(d=!1,a+=O._addLine(o),o="",i=0),(o.length>0||!O.isBreakingSpace(x)||d)&&(o+=x,i+=y)}return a+=O._addLine(o,!1),a}static _addLine(t,e=!0){return t=O._trimRight(t),t=e?`${t}
`:t,t}static _getFromCache(t,e,n,r){let i=n[t];return typeof i!="number"&&(i=O._measureText(t,e,r)+e,n[t]=i),i}static _collapseSpaces(t){return t==="normal"||t==="pre-line"}static _collapseNewlines(t){return t==="normal"}static _trimRight(t){if(typeof t!="string")return"";for(let e=t.length-1;e>=0;e--){const n=t[e];if(!O.isBreakingSpace(n))break;t=t.slice(0,-1)}return t}static _isNewline(t){return typeof t!="string"?!1:O._newlines.includes(t.charCodeAt(0))}static isBreakingSpace(t,e){return typeof t!="string"?!1:O._breakingSpaces.includes(t.charCodeAt(0))}static _tokenize(t){const e=[];let n="";if(typeof t!="string")return e;for(let r=0;r<t.length;r++){const i=t[r],o=t[r+1];if(O.isBreakingSpace(i,o)||O._isNewline(i)){n!==""&&(e.push(n),n=""),e.push(i);continue}n+=i}return n!==""&&e.push(n),e}static canBreakWords(t,e){return e}static canBreakChars(t,e,n,r,i){return!0}static wordWrapSplit(t){return O.graphemeSegmenter(t)}static measureFont(t){if(O._fonts[t])return O._fonts[t];const e=O._context;e.font=t;const n=e.measureText(O.METRICS_STRING+O.BASELINE_SYMBOL),r={ascent:n.actualBoundingBoxAscent,descent:n.actualBoundingBoxDescent,fontSize:n.actualBoundingBoxAscent+n.actualBoundingBoxDescent};return O._fonts[t]=r,r}static clearMetrics(t=""){t?delete O._fonts[t]:O._fonts={}}static get _canvas(){if(!O.__canvas){let t;try{const e=new OffscreenCanvas(0,0),n=e.getContext("2d",jn);if(n!=null&&n.measureText)return O.__canvas=e,e;t=at.get().createCanvas()}catch{t=at.get().createCanvas()}t.width=t.height=10,O.__canvas=t}return O.__canvas}static get _context(){return O.__context||(O.__context=O._canvas.getContext("2d",jn)),O.__context}};te.METRICS_STRING="|ÉqÅ";te.BASELINE_SYMBOL="M";te.BASELINE_MULTIPLIER=1.4;te.HEIGHT_MULTIPLIER=2;te.graphemeSegmenter=(()=>{if(typeof(Intl==null?void 0:Intl.Segmenter)=="function"){const s=new Intl.Segmenter;return t=>{const e=s.segment(t),n=[];let r=0;for(const i of e)n[r++]=i.segment;return n}}return s=>[...s]})();te.experimentalLetterSpacing=!1;te._fonts={};te._newlines=[10,13];te._breakingSpaces=[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288];let qt=te;const zi=[{offset:0,color:"white"},{offset:1,color:"black"}],jr=class kr{constructor(...t){this.uid=lt("fillGradient"),this.type="linear",this.colorStops=[];let e=cu(t);e={...e.type==="radial"?kr.defaultRadialOptions:kr.defaultLinearOptions,...Ko(e)},this._textureSize=e.textureSize,this._wrapMode=e.wrapMode,e.type==="radial"?(this.center=e.center,this.outerCenter=e.outerCenter??this.center,this.innerRadius=e.innerRadius,this.outerRadius=e.outerRadius,this.scale=e.scale,this.rotation=e.rotation):(this.start=e.start,this.end=e.end),this.textureSpace=e.textureSpace,this.type=e.type,e.colorStops.forEach(r=>{this.addColorStop(r.offset,r.color)})}addColorStop(t,e){return this.colorStops.push({offset:t,color:ot.shared.setValue(e).toHexa()}),this}buildLinearGradient(){if(this.texture)return;let{x:t,y:e}=this.start,{x:n,y:r}=this.end,i=n-t,o=r-e;const a=i<0||o<0;if(this._wrapMode==="clamp-to-edge"){if(i<0){const m=t;t=n,n=m,i*=-1}if(o<0){const m=e;e=r,r=m,o*=-1}}const l=this.colorStops.length?this.colorStops:zi,h=this._textureSize,{canvas:c,context:u}=Oi(h,1),f=a?u.createLinearGradient(this._textureSize,0,0,0):u.createLinearGradient(0,0,this._textureSize,0);Gi(f,l),u.fillStyle=f,u.fillRect(0,0,h,1),this.texture=new $({source:new ze({resource:c,addressMode:this._wrapMode})});const d=Math.sqrt(i*i+o*o),p=Math.atan2(o,i),g=new X;g.scale(d/h,1),g.rotate(p),g.translate(t,e),this.textureSpace==="local"&&g.scale(h,h),this.transform=g}buildGradient(){this.type==="linear"?this.buildLinearGradient():this.buildRadialGradient()}buildRadialGradient(){if(this.texture)return;const t=this.colorStops.length?this.colorStops:zi,e=this._textureSize,{canvas:n,context:r}=Oi(e,e),{x:i,y:o}=this.center,{x:a,y:l}=this.outerCenter,h=this.innerRadius,c=this.outerRadius,u=a-c,f=l-c,d=e/(c*2),p=(i-u)*d,g=(o-f)*d,m=r.createRadialGradient(p,g,h*d,(a-u)*d,(l-f)*d,c*d);Gi(m,t),r.fillStyle=t[t.length-1].color,r.fillRect(0,0,e,e),r.fillStyle=m,r.translate(p,g),r.rotate(this.rotation),r.scale(1,this.scale),r.translate(-p,-g),r.fillRect(0,0,e,e),this.texture=new $({source:new ze({resource:n,addressMode:this._wrapMode})});const x=new X;x.scale(1/d,1/d),x.translate(u,f),this.textureSpace==="local"&&x.scale(e,e),this.transform=x}get styleKey(){return this.uid}destroy(){var t;(t=this.texture)==null||t.destroy(!0),this.texture=null}};jr.defaultLinearOptions={start:{x:0,y:0},end:{x:0,y:1},colorStops:[],textureSpace:"local",type:"linear",textureSize:256,wrapMode:"clamp-to-edge"};jr.defaultRadialOptions={center:{x:.5,y:.5},innerRadius:0,outerRadius:.5,colorStops:[],scale:1,textureSpace:"local",type:"radial",textureSize:256,wrapMode:"clamp-to-edge"};let ce=jr;function Gi(s,t){for(let e=0;e<t.length;e++){const n=t[e];s.addColorStop(n.offset,n.color)}}function Oi(s,t){const e=at.get().createCanvas(s,t),n=e.getContext("2d");return{canvas:e,context:n}}function cu(s){let t=s[0]??{};return(typeof t=="number"||s[1])&&(V("8.5.2","use options object instead"),t={type:"linear",start:{x:s[0],y:s[1]},end:{x:s[2],y:s[3]},textureSpace:s[4],textureSize:s[5]??ce.defaultLinearOptions.textureSize}),t}const Ni={repeat:{addressModeU:"repeat",addressModeV:"repeat"},"repeat-x":{addressModeU:"repeat",addressModeV:"clamp-to-edge"},"repeat-y":{addressModeU:"clamp-to-edge",addressModeV:"repeat"},"no-repeat":{addressModeU:"clamp-to-edge",addressModeV:"clamp-to-edge"}};class fn{constructor(t,e){this.uid=lt("fillPattern"),this.transform=new X,this._styleKey=null,this.texture=t,this.transform.scale(1/t.frame.width,1/t.frame.height),e&&(t.source.style.addressModeU=Ni[e].addressModeU,t.source.style.addressModeV=Ni[e].addressModeV)}setTransform(t){const e=this.texture;this.transform.copyFrom(t),this.transform.invert(),this.transform.scale(1/e.frame.width,1/e.frame.height),this._styleKey=null}get styleKey(){return this._styleKey?this._styleKey:(this._styleKey=`fill-pattern-${this.uid}-${this.texture.uid}-${this.transform.toArray().join("-")}`,this._styleKey)}}var $n,Ui;function hu(){if(Ui)return $n;Ui=1,$n=e;var s={a:7,c:6,h:1,l:2,m:2,q:4,s:4,t:2,v:1,z:0},t=/([astvzqmhlc])([^astvzqmhlc]*)/ig;function e(i){var o=[];return i.replace(t,function(a,l,h){var c=l.toLowerCase();for(h=r(h),c=="m"&&h.length>2&&(o.push([l].concat(h.splice(0,2))),c="l",l=l=="m"?"l":"L");;){if(h.length==s[c])return h.unshift(l),o.push(h);if(h.length<s[c])throw new Error("malformed path data");o.push([l].concat(h.splice(0,s[c])))}}),o}var n=/-?[0-9]*\.?[0-9]+(?:e[-+]?\d+)?/ig;function r(i){var o=i.match(n);return o?o.map(Number):[]}return $n}var uu=hu();const du=Vo(uu);function fu(s,t){const e=du(s),n=[];let r=null,i=0,o=0;for(let a=0;a<e.length;a++){const l=e[a],h=l[0],c=l;switch(h){case"M":i=c[1],o=c[2],t.moveTo(i,o);break;case"m":i+=c[1],o+=c[2],t.moveTo(i,o);break;case"H":i=c[1],t.lineTo(i,o);break;case"h":i+=c[1],t.lineTo(i,o);break;case"V":o=c[1],t.lineTo(i,o);break;case"v":o+=c[1],t.lineTo(i,o);break;case"L":i=c[1],o=c[2],t.lineTo(i,o);break;case"l":i+=c[1],o+=c[2],t.lineTo(i,o);break;case"C":i=c[5],o=c[6],t.bezierCurveTo(c[1],c[2],c[3],c[4],i,o);break;case"c":t.bezierCurveTo(i+c[1],o+c[2],i+c[3],o+c[4],i+c[5],o+c[6]),i+=c[5],o+=c[6];break;case"S":i=c[3],o=c[4],t.bezierCurveToShort(c[1],c[2],i,o);break;case"s":t.bezierCurveToShort(i+c[1],o+c[2],i+c[3],o+c[4]),i+=c[3],o+=c[4];break;case"Q":i=c[3],o=c[4],t.quadraticCurveTo(c[1],c[2],i,o);break;case"q":t.quadraticCurveTo(i+c[1],o+c[2],i+c[3],o+c[4]),i+=c[3],o+=c[4];break;case"T":i=c[1],o=c[2],t.quadraticCurveToShort(i,o);break;case"t":i+=c[1],o+=c[2],t.quadraticCurveToShort(i,o);break;case"A":i=c[6],o=c[7],t.arcToSvg(c[1],c[2],c[3],c[4],c[5],i,o);break;case"a":i+=c[6],o+=c[7],t.arcToSvg(c[1],c[2],c[3],c[4],c[5],i,o);break;case"Z":case"z":t.closePath(),n.length>0&&(r=n.pop(),r?(i=r.startX,o=r.startY):(i=0,o=0)),r=null;break;default:it(`Unknown SVG path command: ${h}`)}h!=="Z"&&h!=="z"&&r===null&&(r={startX:i,startY:o},n.push(r))}return t}class $r{constructor(t=0,e=0,n=0){this.type="circle",this.x=t,this.y=e,this.radius=n}clone(){return new $r(this.x,this.y,this.radius)}contains(t,e){if(this.radius<=0)return!1;const n=this.radius*this.radius;let r=this.x-t,i=this.y-e;return r*=r,i*=i,r+i<=n}strokeContains(t,e,n,r=.5){if(this.radius===0)return!1;const i=this.x-t,o=this.y-e,a=this.radius,l=(1-r)*n,h=Math.sqrt(i*i+o*o);return h<=a+l&&h>a-(n-l)}getBounds(t){return t||(t=new q),t.x=this.x-this.radius,t.y=this.y-this.radius,t.width=this.radius*2,t.height=this.radius*2,t}copyFrom(t){return this.x=t.x,this.y=t.y,this.radius=t.radius,this}copyTo(t){return t.copyFrom(this),t}toString(){return`[pixi.js/math:Circle x=${this.x} y=${this.y} radius=${this.radius}]`}}class Vr{constructor(t=0,e=0,n=0,r=0){this.type="ellipse",this.x=t,this.y=e,this.halfWidth=n,this.halfHeight=r}clone(){return new Vr(this.x,this.y,this.halfWidth,this.halfHeight)}contains(t,e){if(this.halfWidth<=0||this.halfHeight<=0)return!1;let n=(t-this.x)/this.halfWidth,r=(e-this.y)/this.halfHeight;return n*=n,r*=r,n+r<=1}strokeContains(t,e,n,r=.5){const{halfWidth:i,halfHeight:o}=this;if(i<=0||o<=0)return!1;const a=n*(1-r),l=n-a,h=i-l,c=o-l,u=i+a,f=o+a,d=t-this.x,p=e-this.y,g=d*d/(h*h)+p*p/(c*c),m=d*d/(u*u)+p*p/(f*f);return g>1&&m<=1}getBounds(t){return t||(t=new q),t.x=this.x-this.halfWidth,t.y=this.y-this.halfHeight,t.width=this.halfWidth*2,t.height=this.halfHeight*2,t}copyFrom(t){return this.x=t.x,this.y=t.y,this.halfWidth=t.halfWidth,this.halfHeight=t.halfHeight,this}copyTo(t){return t.copyFrom(this),t}toString(){return`[pixi.js/math:Ellipse x=${this.x} y=${this.y} halfWidth=${this.halfWidth} halfHeight=${this.halfHeight}]`}}function pu(s,t,e,n,r,i){const o=s-e,a=t-n,l=r-e,h=i-n,c=o*l+a*h,u=l*l+h*h;let f=-1;u!==0&&(f=c/u);let d,p;f<0?(d=e,p=n):f>1?(d=r,p=i):(d=e+f*l,p=n+f*h);const g=s-d,m=t-p;return g*g+m*m}let mu,gu;class ms{constructor(...t){this.type="polygon";let e=Array.isArray(t[0])?t[0]:t;if(typeof e[0]!="number"){const n=[];for(let r=0,i=e.length;r<i;r++)n.push(e[r].x,e[r].y);e=n}this.points=e,this.closePath=!0}isClockwise(){let t=0;const e=this.points,n=e.length;for(let r=0;r<n;r+=2){const i=e[r],o=e[r+1],a=e[(r+2)%n],l=e[(r+3)%n];t+=(a-i)*(l+o)}return t<0}containsPolygon(t){const e=this.getBounds(mu),n=t.getBounds(gu);if(!e.containsRect(n))return!1;const r=t.points;for(let i=0;i<r.length;i+=2){const o=r[i],a=r[i+1];if(!this.contains(o,a))return!1}return!0}clone(){const t=this.points.slice(),e=new ms(t);return e.closePath=this.closePath,e}contains(t,e){let n=!1;const r=this.points.length/2;for(let i=0,o=r-1;i<r;o=i++){const a=this.points[i*2],l=this.points[i*2+1],h=this.points[o*2],c=this.points[o*2+1];l>e!=c>e&&t<(h-a)*((e-l)/(c-l))+a&&(n=!n)}return n}strokeContains(t,e,n,r=.5){const i=n*n,o=i*(1-r),a=i-o,{points:l}=this,h=l.length-(this.closePath?0:2);for(let c=0;c<h;c+=2){const u=l[c],f=l[c+1],d=l[(c+2)%l.length],p=l[(c+3)%l.length],g=pu(t,e,u,f,d,p),m=Math.sign((d-u)*(e-f)-(p-f)*(t-u));if(g<=(m<0?a:o))return!0}return!1}getBounds(t){t||(t=new q);const e=this.points;let n=1/0,r=-1/0,i=1/0,o=-1/0;for(let a=0,l=e.length;a<l;a+=2){const h=e[a],c=e[a+1];n=h<n?h:n,r=h>r?h:r,i=c<i?c:i,o=c>o?c:o}return t.x=n,t.width=r-n,t.y=i,t.height=o-i,t}copyFrom(t){return this.points=t.points.slice(),this.closePath=t.closePath,this}copyTo(t){return t.copyFrom(this),t}toString(){return`[pixi.js/math:PolygoncloseStroke=${this.closePath}points=${this.points.reduce((t,e)=>`${t}, ${e}`,"")}]`}get lastX(){return this.points[this.points.length-2]}get lastY(){return this.points[this.points.length-1]}get x(){return this.points[this.points.length-2]}get y(){return this.points[this.points.length-1]}}const Ls=(s,t,e,n,r,i,o)=>{const a=s-e,l=t-n,h=Math.sqrt(a*a+l*l);return h>=r-i&&h<=r+o};class Yr{constructor(t=0,e=0,n=0,r=0,i=20){this.type="roundedRectangle",this.x=t,this.y=e,this.width=n,this.height=r,this.radius=i}getBounds(t){return t||(t=new q),t.x=this.x,t.y=this.y,t.width=this.width,t.height=this.height,t}clone(){return new Yr(this.x,this.y,this.width,this.height,this.radius)}copyFrom(t){return this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height,this}copyTo(t){return t.copyFrom(this),t}contains(t,e){if(this.width<=0||this.height<=0)return!1;if(t>=this.x&&t<=this.x+this.width&&e>=this.y&&e<=this.y+this.height){const n=Math.max(0,Math.min(this.radius,Math.min(this.width,this.height)/2));if(e>=this.y+n&&e<=this.y+this.height-n||t>=this.x+n&&t<=this.x+this.width-n)return!0;let r=t-(this.x+n),i=e-(this.y+n);const o=n*n;if(r*r+i*i<=o||(r=t-(this.x+this.width-n),r*r+i*i<=o)||(i=e-(this.y+this.height-n),r*r+i*i<=o)||(r=t-(this.x+n),r*r+i*i<=o))return!0}return!1}strokeContains(t,e,n,r=.5){const{x:i,y:o,width:a,height:l,radius:h}=this,c=n*(1-r),u=n-c,f=i+h,d=o+h,p=a-h*2,g=l-h*2,m=i+a,x=o+l;return(t>=i-c&&t<=i+u||t>=m-u&&t<=m+c)&&e>=d&&e<=d+g||(e>=o-c&&e<=o+u||e>=x-u&&e<=x+c)&&t>=f&&t<=f+p?!0:t<f&&e<d&&Ls(t,e,f,d,h,u,c)||t>m-h&&e<d&&Ls(t,e,m-h,d,h,u,c)||t>m-h&&e>x-h&&Ls(t,e,m-h,x-h,h,u,c)||t<f&&e>x-h&&Ls(t,e,f,x-h,h,u,c)}toString(){return`[pixi.js/math:RoundedRectangle x=${this.x} y=${this.y}width=${this.width} height=${this.height} radius=${this.radius}]`}}const Va={};function xu(s,t,e){let n=2166136261;for(let r=0;r<t;r++)n^=s[r].uid,n=Math.imul(n,16777619),n>>>=0;return Va[n]||yu(s,t,n,e)}function yu(s,t,e,n){const r={};let i=0;for(let a=0;a<n;a++){const l=a<t?s[a]:$.EMPTY.source;r[i++]=l.source,r[i++]=l.style}const o=new Xs(r);return Va[e]=o,o}class Di{constructor(t){typeof t=="number"?this.rawBinaryData=new ArrayBuffer(t):t instanceof Uint8Array?this.rawBinaryData=t.buffer:this.rawBinaryData=t,this.uint32View=new Uint32Array(this.rawBinaryData),this.float32View=new Float32Array(this.rawBinaryData),this.size=this.rawBinaryData.byteLength}get int8View(){return this._int8View||(this._int8View=new Int8Array(this.rawBinaryData)),this._int8View}get uint8View(){return this._uint8View||(this._uint8View=new Uint8Array(this.rawBinaryData)),this._uint8View}get int16View(){return this._int16View||(this._int16View=new Int16Array(this.rawBinaryData)),this._int16View}get int32View(){return this._int32View||(this._int32View=new Int32Array(this.rawBinaryData)),this._int32View}get float64View(){return this._float64Array||(this._float64Array=new Float64Array(this.rawBinaryData)),this._float64Array}get bigUint64View(){return this._bigUint64Array||(this._bigUint64Array=new BigUint64Array(this.rawBinaryData)),this._bigUint64Array}view(t){return this[`${t}View`]}destroy(){this.rawBinaryData=null,this._int8View=null,this._uint8View=null,this._int16View=null,this.uint16View=null,this._int32View=null,this.uint32View=null,this.float32View=null}static sizeOf(t){switch(t){case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;default:throw new Error(`${t} isn't a valid view type`)}}}function Hi(s,t){const e=s.byteLength/8|0,n=new Float64Array(s,0,e);new Float64Array(t,0,e).set(n);const i=s.byteLength-e*8;if(i>0){const o=new Uint8Array(s,e*8,i);new Uint8Array(t,e*8,i).set(o)}}const bu={normal:"normal-npm",add:"add-npm",screen:"screen-npm"};var wu=(s=>(s[s.DISABLED=0]="DISABLED",s[s.RENDERING_MASK_ADD=1]="RENDERING_MASK_ADD",s[s.MASK_ACTIVE=2]="MASK_ACTIVE",s[s.INVERSE_MASK_ACTIVE=3]="INVERSE_MASK_ACTIVE",s[s.RENDERING_MASK_REMOVE=4]="RENDERING_MASK_REMOVE",s[s.NONE=5]="NONE",s))(wu||{});function Wi(s,t){return t.alphaMode==="no-premultiply-alpha"&&bu[s]||s}const _u=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%","gl_FragColor = vec4(0.0);","}"].join(`
`);function vu(s){let t="";for(let e=0;e<s;++e)e>0&&(t+=`
else `),e<s-1&&(t+=`if(test == ${e}.0){}`);return t}function Au(s,t){if(s===0)throw new Error("Invalid value of `0` passed to `checkMaxIfStatementsInShader`");const e=t.createShader(t.FRAGMENT_SHADER);try{for(;;){const n=_u.replace(/%forloop%/gi,vu(s));if(t.shaderSource(e,n),t.compileShader(e),!t.getShaderParameter(e,t.COMPILE_STATUS))s=s/2|0;else break}}finally{t.deleteShader(e)}return s}let Ne=null;function Su(){var t;if(Ne)return Ne;const s=Ca();return Ne=s.getParameter(s.MAX_TEXTURE_IMAGE_UNITS),Ne=Au(Ne,s),(t=s.getExtension("WEBGL_lose_context"))==null||t.loseContext(),Ne}class Cu{constructor(){this.ids=Object.create(null),this.textures=[],this.count=0}clear(){for(let t=0;t<this.count;t++){const e=this.textures[t];this.textures[t]=null,this.ids[e.uid]=null}this.count=0}}class ku{constructor(){this.renderPipeId="batch",this.action="startBatch",this.start=0,this.size=0,this.textures=new Cu,this.blendMode="normal",this.topology="triangle-strip",this.canBundle=!0}destroy(){this.textures=null,this.gpuBindGroup=null,this.bindGroup=null,this.batcher=null}}const Ya=[];let Pr=0;function ji(){return Pr>0?Ya[--Pr]:new ku}function $i(s){Ya[Pr++]=s}let os=0;const Xa=class qa{constructor(t){this.uid=lt("batcher"),this.dirty=!0,this.batchIndex=0,this.batches=[],this._elements=[],t={...qa.defaultOptions,...t},t.maxTextures||(V("v8.8.0","maxTextures is a required option for Batcher now, please pass it in the options"),t.maxTextures=Su());const{maxTextures:e,attributesInitialSize:n,indicesInitialSize:r}=t;this.attributeBuffer=new Di(n*4),this.indexBuffer=new Uint16Array(r),this.maxTextures=e}begin(){this.elementSize=0,this.elementStart=0,this.indexSize=0,this.attributeSize=0;for(let t=0;t<this.batchIndex;t++)$i(this.batches[t]);this.batchIndex=0,this._batchIndexStart=0,this._batchIndexSize=0,this.dirty=!0}add(t){this._elements[this.elementSize++]=t,t._indexStart=this.indexSize,t._attributeStart=this.attributeSize,t._batcher=this,this.indexSize+=t.indexSize,this.attributeSize+=t.attributeSize*this.vertexSize}checkAndUpdateTexture(t,e){const n=t._batch.textures.ids[e._source.uid];return!n&&n!==0?!1:(t._textureId=n,t.texture=e,!0)}updateElement(t){this.dirty=!0;const e=this.attributeBuffer;t.packAsQuad?this.packQuadAttributes(t,e.float32View,e.uint32View,t._attributeStart,t._textureId):this.packAttributes(t,e.float32View,e.uint32View,t._attributeStart,t._textureId)}break(t){const e=this._elements;if(!e[this.elementStart])return;let n=ji(),r=n.textures;r.clear();const i=e[this.elementStart];let o=Wi(i.blendMode,i.texture._source),a=i.topology;this.attributeSize*4>this.attributeBuffer.size&&this._resizeAttributeBuffer(this.attributeSize*4),this.indexSize>this.indexBuffer.length&&this._resizeIndexBuffer(this.indexSize);const l=this.attributeBuffer.float32View,h=this.attributeBuffer.uint32View,c=this.indexBuffer;let u=this._batchIndexSize,f=this._batchIndexStart,d="startBatch";const p=this.maxTextures;for(let g=this.elementStart;g<this.elementSize;++g){const m=e[g];e[g]=null;const y=m.texture._source,b=Wi(m.blendMode,y),w=o!==b||a!==m.topology;if(y._batchTick===os&&!w){m._textureId=y._textureBindLocation,u+=m.indexSize,m.packAsQuad?(this.packQuadAttributes(m,l,h,m._attributeStart,m._textureId),this.packQuadIndex(c,m._indexStart,m._attributeStart/this.vertexSize)):(this.packAttributes(m,l,h,m._attributeStart,m._textureId),this.packIndex(m,c,m._indexStart,m._attributeStart/this.vertexSize)),m._batch=n;continue}y._batchTick=os,(r.count>=p||w)&&(this._finishBatch(n,f,u-f,r,o,a,t,d),d="renderBatch",f=u,o=b,a=m.topology,n=ji(),r=n.textures,r.clear(),++os),m._textureId=y._textureBindLocation=r.count,r.ids[y.uid]=r.count,r.textures[r.count++]=y,m._batch=n,u+=m.indexSize,m.packAsQuad?(this.packQuadAttributes(m,l,h,m._attributeStart,m._textureId),this.packQuadIndex(c,m._indexStart,m._attributeStart/this.vertexSize)):(this.packAttributes(m,l,h,m._attributeStart,m._textureId),this.packIndex(m,c,m._indexStart,m._attributeStart/this.vertexSize))}r.count>0&&(this._finishBatch(n,f,u-f,r,o,a,t,d),f=u,++os),this.elementStart=this.elementSize,this._batchIndexStart=f,this._batchIndexSize=u}_finishBatch(t,e,n,r,i,o,a,l){t.gpuBindGroup=null,t.bindGroup=null,t.action=l,t.batcher=this,t.textures=r,t.blendMode=i,t.topology=o,t.start=e,t.size=n,++os,this.batches[this.batchIndex++]=t,a.add(t)}finish(t){this.break(t)}ensureAttributeBuffer(t){t*4<=this.attributeBuffer.size||this._resizeAttributeBuffer(t*4)}ensureIndexBuffer(t){t<=this.indexBuffer.length||this._resizeIndexBuffer(t)}_resizeAttributeBuffer(t){const e=Math.max(t,this.attributeBuffer.size*2),n=new Di(e);Hi(this.attributeBuffer.rawBinaryData,n.rawBinaryData),this.attributeBuffer=n}_resizeIndexBuffer(t){const e=this.indexBuffer;let n=Math.max(t,e.length*1.5);n+=n%2;const r=n>65535?new Uint32Array(n):new Uint16Array(n);if(r.BYTES_PER_ELEMENT!==e.BYTES_PER_ELEMENT)for(let i=0;i<e.length;i++)r[i]=e[i];else Hi(e.buffer,r.buffer);this.indexBuffer=r}packQuadIndex(t,e,n){t[e]=n+0,t[e+1]=n+1,t[e+2]=n+2,t[e+3]=n+0,t[e+4]=n+2,t[e+5]=n+3}packIndex(t,e,n,r){const i=t.indices,o=t.indexSize,a=t.indexOffset,l=t.attributeOffset;for(let h=0;h<o;h++)e[n++]=r+i[h+a]-l}destroy(){for(let t=0;t<this.batches.length;t++)$i(this.batches[t]);this.batches=null;for(let t=0;t<this._elements.length;t++)this._elements[t]._batch=null;this._elements=null,this.indexBuffer=null,this.attributeBuffer.destroy(),this.attributeBuffer=null}};Xa.defaultOptions={maxTextures:null,attributesInitialSize:4,indicesInitialSize:6};let Pu=Xa;var wt=(s=>(s[s.MAP_READ=1]="MAP_READ",s[s.MAP_WRITE=2]="MAP_WRITE",s[s.COPY_SRC=4]="COPY_SRC",s[s.COPY_DST=8]="COPY_DST",s[s.INDEX=16]="INDEX",s[s.VERTEX=32]="VERTEX",s[s.UNIFORM=64]="UNIFORM",s[s.STORAGE=128]="STORAGE",s[s.INDIRECT=256]="INDIRECT",s[s.QUERY_RESOLVE=512]="QUERY_RESOLVE",s[s.STATIC=1024]="STATIC",s))(wt||{});class Ss extends Wt{constructor(t){let{data:e,size:n}=t;const{usage:r,label:i,shrinkToFit:o}=t;super(),this.uid=lt("buffer"),this._resourceType="buffer",this._resourceId=lt("resource"),this._touched=0,this._updateID=1,this._dataInt32=null,this.shrinkToFit=!0,this.destroyed=!1,e instanceof Array&&(e=new Float32Array(e)),this._data=e,n??(n=e==null?void 0:e.byteLength);const a=!!e;this.descriptor={size:n,usage:r,mappedAtCreation:a,label:i},this.shrinkToFit=o??!0}get data(){return this._data}set data(t){this.setDataWithSize(t,t.length,!0)}get dataInt32(){return this._dataInt32||(this._dataInt32=new Int32Array(this.data.buffer)),this._dataInt32}get static(){return!!(this.descriptor.usage&wt.STATIC)}set static(t){t?this.descriptor.usage|=wt.STATIC:this.descriptor.usage&=~wt.STATIC}setDataWithSize(t,e,n){if(this._updateID++,this._updateSize=e*t.BYTES_PER_ELEMENT,this._data===t){n&&this.emit("update",this);return}const r=this._data;if(this._data=t,this._dataInt32=null,!r||r.length!==t.length){!this.shrinkToFit&&r&&t.byteLength<r.byteLength?n&&this.emit("update",this):(this.descriptor.size=t.byteLength,this._resourceId=lt("resource"),this.emit("change",this));return}n&&this.emit("update",this)}update(t){this._updateSize=t??this._updateSize,this._updateID++,this.emit("update",this)}destroy(){this.destroyed=!0,this.emit("destroy",this),this.emit("change",this),this._data=null,this.descriptor=null,this.removeAllListeners()}}function Ka(s,t){if(!(s instanceof Ss)){let e=t?wt.INDEX:wt.VERTEX;s instanceof Array&&(t?(s=new Uint32Array(s),e=wt.INDEX|wt.COPY_DST):(s=new Float32Array(s),e=wt.VERTEX|wt.COPY_DST)),s=new Ss({data:s,label:t?"index-mesh-buffer":"vertex-mesh-buffer",usage:e})}return s}function Mu(s,t,e){const n=s.getAttribute(t);if(!n)return e.minX=0,e.minY=0,e.maxX=0,e.maxY=0,e;const r=n.buffer.data;let i=1/0,o=1/0,a=-1/0,l=-1/0;const h=r.BYTES_PER_ELEMENT,c=(n.offset||0)/h,u=(n.stride||2*4)/h;for(let f=c;f<r.length;f+=u){const d=r[f],p=r[f+1];d>a&&(a=d),p>l&&(l=p),d<i&&(i=d),p<o&&(o=p)}return e.minX=i,e.minY=o,e.maxX=a,e.maxY=l,e}function Tu(s){return(s instanceof Ss||Array.isArray(s)||s.BYTES_PER_ELEMENT)&&(s={buffer:s}),s.buffer=Ka(s.buffer,!1),s}class Eu extends Wt{constructor(t={}){super(),this.uid=lt("geometry"),this._layoutKey=0,this.instanceCount=1,this._bounds=new Dt,this._boundsDirty=!0;const{attributes:e,indexBuffer:n,topology:r}=t;if(this.buffers=[],this.attributes={},e)for(const i in e)this.addAttribute(i,e[i]);this.instanceCount=t.instanceCount??1,n&&this.addIndex(n),this.topology=r||"triangle-list"}onBufferUpdate(){this._boundsDirty=!0,this.emit("update",this)}getAttribute(t){return this.attributes[t]}getIndex(){return this.indexBuffer}getBuffer(t){return this.getAttribute(t).buffer}getSize(){for(const t in this.attributes){const e=this.attributes[t];return e.buffer.data.length/(e.stride/4||e.size)}return 0}addAttribute(t,e){const n=Tu(e);this.buffers.indexOf(n.buffer)===-1&&(this.buffers.push(n.buffer),n.buffer.on("update",this.onBufferUpdate,this),n.buffer.on("change",this.onBufferUpdate,this)),this.attributes[t]=n}addIndex(t){this.indexBuffer=Ka(t,!0),this.buffers.push(this.indexBuffer)}get bounds(){return this._boundsDirty?(this._boundsDirty=!1,Mu(this,"aPosition",this._bounds)):this._bounds}destroy(t=!1){this.emit("destroy",this),this.removeAllListeners(),t&&this.buffers.forEach(e=>e.destroy()),this.attributes=null,this.buffers=null,this.indexBuffer=null,this._bounds=null}}const Iu=new Float32Array(1),Bu=new Uint32Array(1);class Fu extends Eu{constructor(){const e=new Ss({data:Iu,label:"attribute-batch-buffer",usage:wt.VERTEX|wt.COPY_DST,shrinkToFit:!1}),n=new Ss({data:Bu,label:"index-batch-buffer",usage:wt.INDEX|wt.COPY_DST,shrinkToFit:!1}),r=6*4;super({attributes:{aPosition:{buffer:e,format:"float32x2",stride:r,offset:0},aUV:{buffer:e,format:"float32x2",stride:r,offset:2*4},aColor:{buffer:e,format:"unorm8x4",stride:r,offset:4*4},aTextureIdAndRound:{buffer:e,format:"uint16x2",stride:r,offset:5*4}},indexBuffer:n})}}function Vi(s,t,e){if(s)for(const n in s){const r=n.toLocaleLowerCase(),i=t[r];if(i){let o=s[n];n==="header"&&(o=o.replace(/@in\s+[^;]+;\s*/g,"").replace(/@out\s+[^;]+;\s*/g,"")),e&&i.push(`//----${e}----//`),i.push(o)}else it(`${n} placement hook does not exist in shader`)}}const Ru=/\{\{(.*?)\}\}/g;function Yi(s){var n;const t={};return(((n=s.match(Ru))==null?void 0:n.map(r=>r.replace(/[{()}]/g,"")))??[]).forEach(r=>{t[r]=[]}),t}function Xi(s,t){let e;const n=/@in\s+([^;]+);/g;for(;(e=n.exec(s))!==null;)t.push(e[1])}function qi(s,t,e=!1){const n=[];Xi(t,n),s.forEach(a=>{a.header&&Xi(a.header,n)});const r=n;e&&r.sort();const i=r.map((a,l)=>`       @location(${l}) ${a},`).join(`
`);let o=t.replace(/@in\s+[^;]+;\s*/g,"");return o=o.replace("{{in}}",`
${i}
`),o}function Ki(s,t){let e;const n=/@out\s+([^;]+);/g;for(;(e=n.exec(s))!==null;)t.push(e[1])}function Lu(s){const e=/\b(\w+)\s*:/g.exec(s);return e?e[1]:""}function zu(s){const t=/@.*?\s+/g;return s.replace(t,"")}function Gu(s,t){const e=[];Ki(t,e),s.forEach(l=>{l.header&&Ki(l.header,e)});let n=0;const r=e.sort().map(l=>l.indexOf("builtin")>-1?l:`@location(${n++}) ${l}`).join(`,
`),i=e.sort().map(l=>`       var ${zu(l)};`).join(`
`),o=`return VSOutput(
            ${e.sort().map(l=>` ${Lu(l)}`).join(`,
`)});`;let a=t.replace(/@out\s+[^;]+;\s*/g,"");return a=a.replace("{{struct}}",`
${r}
`),a=a.replace("{{start}}",`
${i}
`),a=a.replace("{{return}}",`
${o}
`),a}function Zi(s,t){let e=s;for(const n in t){const r=t[n];r.join(`
`).length?e=e.replace(`{{${n}}}`,`//-----${n} START-----//
${r.join(`
`)}
//----${n} FINISH----//`):e=e.replace(`{{${n}}}`,"")}return e}const me=Object.create(null),Vn=new Map;let Ou=0;function Nu({template:s,bits:t}){const e=Za(s,t);if(me[e])return me[e];const{vertex:n,fragment:r}=Du(s,t);return me[e]=Qa(n,r,t),me[e]}function Uu({template:s,bits:t}){const e=Za(s,t);return me[e]||(me[e]=Qa(s.vertex,s.fragment,t)),me[e]}function Du(s,t){const e=t.map(o=>o.vertex).filter(o=>!!o),n=t.map(o=>o.fragment).filter(o=>!!o);let r=qi(e,s.vertex,!0);r=Gu(e,r);const i=qi(n,s.fragment,!0);return{vertex:r,fragment:i}}function Za(s,t){return t.map(e=>(Vn.has(e)||Vn.set(e,Ou++),Vn.get(e))).sort((e,n)=>e-n).join("-")+s.vertex+s.fragment}function Qa(s,t,e){const n=Yi(s),r=Yi(t);return e.forEach(i=>{Vi(i.vertex,n,i.name),Vi(i.fragment,r,i.name)}),{vertex:Zi(s,n),fragment:Zi(t,r)}}const Hu=`
    @in aPosition: vec2<f32>;
    @in aUV: vec2<f32>;

    @out @builtin(position) vPosition: vec4<f32>;
    @out vUV : vec2<f32>;
    @out vColor : vec4<f32>;

    {{header}}

    struct VSOutput {
        {{struct}}
    };

    @vertex
    fn main( {{in}} ) -> VSOutput {

        var worldTransformMatrix = globalUniforms.uWorldTransformMatrix;
        var modelMatrix = mat3x3<f32>(
            1.0, 0.0, 0.0,
            0.0, 1.0, 0.0,
            0.0, 0.0, 1.0
          );
        var position = aPosition;
        var uv = aUV;

        {{start}}

        vColor = vec4<f32>(1., 1., 1., 1.);

        {{main}}

        vUV = uv;

        var modelViewProjectionMatrix = globalUniforms.uProjectionMatrix * worldTransformMatrix * modelMatrix;

        vPosition =  vec4<f32>((modelViewProjectionMatrix *  vec3<f32>(position, 1.0)).xy, 0.0, 1.0);

        vColor *= globalUniforms.uWorldColorAlpha;

        {{end}}

        {{return}}
    };
`,Wu=`
    @in vUV : vec2<f32>;
    @in vColor : vec4<f32>;

    {{header}}

    @fragment
    fn main(
        {{in}}
      ) -> @location(0) vec4<f32> {

        {{start}}

        var outColor:vec4<f32>;

        {{main}}

        var finalColor:vec4<f32> = outColor * vColor;

        {{end}}

        return finalColor;
      };
`,ju=`
    in vec2 aPosition;
    in vec2 aUV;

    out vec4 vColor;
    out vec2 vUV;

    {{header}}

    void main(void){

        mat3 worldTransformMatrix = uWorldTransformMatrix;
        mat3 modelMatrix = mat3(
            1.0, 0.0, 0.0,
            0.0, 1.0, 0.0,
            0.0, 0.0, 1.0
          );
        vec2 position = aPosition;
        vec2 uv = aUV;

        {{start}}

        vColor = vec4(1.);

        {{main}}

        vUV = uv;

        mat3 modelViewProjectionMatrix = uProjectionMatrix * worldTransformMatrix * modelMatrix;

        gl_Position = vec4((modelViewProjectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);

        vColor *= uWorldColorAlpha;

        {{end}}
    }
`,$u=`

    in vec4 vColor;
    in vec2 vUV;

    out vec4 finalColor;

    {{header}}

    void main(void) {

        {{start}}

        vec4 outColor;

        {{main}}

        finalColor = outColor * vColor;

        {{end}}
    }
`,Vu={name:"global-uniforms-bit",vertex:{header:`
        struct GlobalUniforms {
            uProjectionMatrix:mat3x3<f32>,
            uWorldTransformMatrix:mat3x3<f32>,
            uWorldColorAlpha: vec4<f32>,
            uResolution: vec2<f32>,
        }

        @group(0) @binding(0) var<uniform> globalUniforms : GlobalUniforms;
        `}},Yu={name:"global-uniforms-bit",vertex:{header:`
          uniform mat3 uProjectionMatrix;
          uniform mat3 uWorldTransformMatrix;
          uniform vec4 uWorldColorAlpha;
          uniform vec2 uResolution;
        `}};function Xu({bits:s,name:t}){const e=Nu({template:{fragment:Wu,vertex:Hu},bits:[Vu,...s]});return Je.from({name:t,vertex:{source:e.vertex,entryPoint:"main"},fragment:{source:e.fragment,entryPoint:"main"}})}function qu({bits:s,name:t}){return new un({name:t,...Uu({template:{vertex:ju,fragment:$u},bits:[Yu,...s]})})}const Ku={name:"color-bit",vertex:{header:`
            @in aColor: vec4<f32>;
        `,main:`
            vColor *= vec4<f32>(aColor.rgb * aColor.a, aColor.a);
        `}},Zu={name:"color-bit",vertex:{header:`
            in vec4 aColor;
        `,main:`
            vColor *= vec4(aColor.rgb * aColor.a, aColor.a);
        `}},Yn={};function Qu(s){const t=[];if(s===1)t.push("@group(1) @binding(0) var textureSource1: texture_2d<f32>;"),t.push("@group(1) @binding(1) var textureSampler1: sampler;");else{let e=0;for(let n=0;n<s;n++)t.push(`@group(1) @binding(${e++}) var textureSource${n+1}: texture_2d<f32>;`),t.push(`@group(1) @binding(${e++}) var textureSampler${n+1}: sampler;`)}return t.join(`
`)}function Ju(s){const t=[];if(s===1)t.push("outColor = textureSampleGrad(textureSource1, textureSampler1, vUV, uvDx, uvDy);");else{t.push("switch vTextureId {");for(let e=0;e<s;e++)e===s-1?t.push("  default:{"):t.push(`  case ${e}:{`),t.push(`      outColor = textureSampleGrad(textureSource${e+1}, textureSampler${e+1}, vUV, uvDx, uvDy);`),t.push("      break;}");t.push("}")}return t.join(`
`)}function td(s){return Yn[s]||(Yn[s]={name:"texture-batch-bit",vertex:{header:`
                @in aTextureIdAndRound: vec2<u32>;
                @out @interpolate(flat) vTextureId : u32;
            `,main:`
                vTextureId = aTextureIdAndRound.y;
            `,end:`
                if(aTextureIdAndRound.x == 1)
                {
                    vPosition = vec4<f32>(roundPixels(vPosition.xy, globalUniforms.uResolution), vPosition.zw);
                }
            `},fragment:{header:`
                @in @interpolate(flat) vTextureId: u32;

                ${Qu(s)}
            `,main:`
                var uvDx = dpdx(vUV);
                var uvDy = dpdy(vUV);

                ${Ju(s)}
            `}}),Yn[s]}const Xn={};function ed(s){const t=[];for(let e=0;e<s;e++)e>0&&t.push("else"),e<s-1&&t.push(`if(vTextureId < ${e}.5)`),t.push("{"),t.push(`	outColor = texture(uTextures[${e}], vUV);`),t.push("}");return t.join(`
`)}function sd(s){return Xn[s]||(Xn[s]={name:"texture-batch-bit",vertex:{header:`
                in vec2 aTextureIdAndRound;
                out float vTextureId;

            `,main:`
                vTextureId = aTextureIdAndRound.y;
            `,end:`
                if(aTextureIdAndRound.x == 1.)
                {
                    gl_Position.xy = roundPixels(gl_Position.xy, uResolution);
                }
            `},fragment:{header:`
                in float vTextureId;

                uniform sampler2D uTextures[${s}];

            `,main:`

                ${ed(s)}
            `}}),Xn[s]}const nd={name:"round-pixels-bit",vertex:{header:`
            fn roundPixels(position: vec2<f32>, targetSize: vec2<f32>) -> vec2<f32>
            {
                return (floor(((position * 0.5 + 0.5) * targetSize) + 0.5) / targetSize) * 2.0 - 1.0;
            }
        `}},rd={name:"round-pixels-bit",vertex:{header:`
            vec2 roundPixels(vec2 position, vec2 targetSize)
            {
                return (floor(((position * 0.5 + 0.5) * targetSize) + 0.5) / targetSize) * 2.0 - 1.0;
            }
        `}},Qi={};function id(s){let t=Qi[s];if(t)return t;const e=new Int32Array(s);for(let n=0;n<s;n++)e[n]=n;return t=Qi[s]=new Ea({uTextures:{value:e,type:"i32",size:s}},{isStatic:!0}),t}class od extends dn{constructor(t){const e=qu({name:"batch",bits:[Zu,sd(t),rd]}),n=Xu({name:"batch",bits:[Ku,td(t),nd]});super({glProgram:e,gpuProgram:n,resources:{batchSamplers:id(t)}})}}let qn=null;const Ja=class tl extends Pu{constructor(t){super(t),this.geometry=new Fu,this.name=tl.extension.name,this.vertexSize=6,qn??(qn=new od(t.maxTextures)),this.shader=qn}packAttributes(t,e,n,r,i){const o=i<<16|t.roundPixels&65535,a=t.transform,l=a.a,h=a.b,c=a.c,u=a.d,f=a.tx,d=a.ty,{positions:p,uvs:g}=t,m=t.color,x=t.attributeOffset,y=x+t.attributeSize;for(let b=x;b<y;b++){const w=b*2,_=p[w],A=p[w+1];e[r++]=l*_+c*A+f,e[r++]=u*A+h*_+d,e[r++]=g[w],e[r++]=g[w+1],n[r++]=m,n[r++]=o}}packQuadAttributes(t,e,n,r,i){const o=t.texture,a=t.transform,l=a.a,h=a.b,c=a.c,u=a.d,f=a.tx,d=a.ty,p=t.bounds,g=p.maxX,m=p.minX,x=p.maxY,y=p.minY,b=o.uvs,w=t.color,_=i<<16|t.roundPixels&65535;e[r+0]=l*m+c*y+f,e[r+1]=u*y+h*m+d,e[r+2]=b.x0,e[r+3]=b.y0,n[r+4]=w,n[r+5]=_,e[r+6]=l*g+c*y+f,e[r+7]=u*y+h*g+d,e[r+8]=b.x1,e[r+9]=b.y1,n[r+10]=w,n[r+11]=_,e[r+12]=l*g+c*x+f,e[r+13]=u*x+h*g+d,e[r+14]=b.x2,e[r+15]=b.y2,n[r+16]=w,n[r+17]=_,e[r+18]=l*m+c*x+f,e[r+19]=u*x+h*m+d,e[r+20]=b.x3,e[r+21]=b.y3,n[r+22]=w,n[r+23]=_}};Ja.extension={type:[N.Batcher],name:"default"};let ad=Ja;function ld(s,t,e,n,r,i,o,a=null){let l=0;e*=t,r*=i;const h=a.a,c=a.b,u=a.c,f=a.d,d=a.tx,p=a.ty;for(;l<o;){const g=s[e],m=s[e+1];n[r]=h*g+u*m+d,n[r+1]=c*g+f*m+p,r+=i,e+=t,l++}}function cd(s,t,e,n){let r=0;for(t*=e;r<n;)s[t]=0,s[t+1]=0,t+=e,r++}function el(s,t,e,n,r){const i=t.a,o=t.b,a=t.c,l=t.d,h=t.tx,c=t.ty;e||(e=0),n||(n=2),r||(r=s.length/n-e);let u=e*n;for(let f=0;f<r;f++){const d=s[u],p=s[u+1];s[u]=i*d+a*p+h,s[u+1]=o*d+l*p+c,u+=n}}const hd=new X;class sl{constructor(){this.packAsQuad=!1,this.batcherName="default",this.topology="triangle-list",this.applyTransform=!0,this.roundPixels=0,this._batcher=null,this._batch=null}get uvs(){return this.geometryData.uvs}get positions(){return this.geometryData.vertices}get indices(){return this.geometryData.indices}get blendMode(){return this.renderable&&this.applyTransform?this.renderable.groupBlendMode:"normal"}get color(){const t=this.baseColor,e=t>>16|t&65280|(t&255)<<16,n=this.renderable;return n?oa(e,n.groupColor)+(this.alpha*n.groupAlpha*255<<24):e+(this.alpha*255<<24)}get transform(){var t;return((t=this.renderable)==null?void 0:t.groupTransform)||hd}copyTo(t){t.indexOffset=this.indexOffset,t.indexSize=this.indexSize,t.attributeOffset=this.attributeOffset,t.attributeSize=this.attributeSize,t.baseColor=this.baseColor,t.alpha=this.alpha,t.texture=this.texture,t.geometryData=this.geometryData,t.topology=this.topology}reset(){this.applyTransform=!0,this.renderable=null,this.topology="triangle-list"}}const Cs={extension:{type:N.ShapeBuilder,name:"circle"},build(s,t){let e,n,r,i,o,a;if(s.type==="circle"){const w=s;if(o=a=w.radius,o<=0)return!1;e=w.x,n=w.y,r=i=0}else if(s.type==="ellipse"){const w=s;if(o=w.halfWidth,a=w.halfHeight,o<=0||a<=0)return!1;e=w.x,n=w.y,r=i=0}else{const w=s,_=w.width/2,A=w.height/2;e=w.x+_,n=w.y+A,o=a=Math.max(0,Math.min(w.radius,Math.min(_,A))),r=_-o,i=A-a}if(r<0||i<0)return!1;const l=Math.ceil(2.3*Math.sqrt(o+a)),h=l*8+(r?4:0)+(i?4:0);if(h===0)return!1;if(l===0)return t[0]=t[6]=e+r,t[1]=t[3]=n+i,t[2]=t[4]=e-r,t[5]=t[7]=n-i,!0;let c=0,u=l*4+(r?2:0)+2,f=u,d=h,p=r+o,g=i,m=e+p,x=e-p,y=n+g;if(t[c++]=m,t[c++]=y,t[--u]=y,t[--u]=x,i){const w=n-g;t[f++]=x,t[f++]=w,t[--d]=w,t[--d]=m}for(let w=1;w<l;w++){const _=Math.PI/2*(w/l),A=r+Math.cos(_)*o,C=i+Math.sin(_)*a,P=e+A,v=e-A,k=n+C,S=n-C;t[c++]=P,t[c++]=k,t[--u]=k,t[--u]=v,t[f++]=v,t[f++]=S,t[--d]=S,t[--d]=P}p=r,g=i+a,m=e+p,x=e-p,y=n+g;const b=n-g;return t[c++]=m,t[c++]=y,t[--d]=b,t[--d]=m,r&&(t[c++]=x,t[c++]=y,t[--d]=b,t[--d]=x),!0},triangulate(s,t,e,n,r,i){if(s.length===0)return;let o=0,a=0;for(let c=0;c<s.length;c+=2)o+=s[c],a+=s[c+1];o/=s.length/2,a/=s.length/2;let l=n;t[l*e]=o,t[l*e+1]=a;const h=l++;for(let c=0;c<s.length;c+=2)t[l*e]=s[c],t[l*e+1]=s[c+1],c>0&&(r[i++]=l,r[i++]=h,r[i++]=l-1),l++;r[i++]=h+1,r[i++]=h,r[i++]=l-1}},ud={...Cs,extension:{...Cs.extension,name:"ellipse"}},dd={...Cs,extension:{...Cs.extension,name:"roundedRectangle"}},nl=1e-4,Ji=1e-4;function fd(s){const t=s.length;if(t<6)return 1;let e=0;for(let n=0,r=s[t-2],i=s[t-1];n<t;n+=2){const o=s[n],a=s[n+1];e+=(o-r)*(a+i),r=o,i=a}return e<0?-1:1}function to(s,t,e,n,r,i,o,a){const l=s-e*r,h=t-n*r,c=s+e*i,u=t+n*i;let f,d;o?(f=n,d=-e):(f=-n,d=e);const p=l+f,g=h+d,m=c+f,x=u+d;return a.push(p,g),a.push(m,x),2}function _e(s,t,e,n,r,i,o,a){const l=e-s,h=n-t;let c=Math.atan2(l,h),u=Math.atan2(r-s,i-t);a&&c<u?c+=Math.PI*2:!a&&c>u&&(u+=Math.PI*2);let f=c;const d=u-c,p=Math.abs(d),g=Math.sqrt(l*l+h*h),m=(15*p*Math.sqrt(g)/Math.PI>>0)+1,x=d/m;if(f+=x,a){o.push(s,t),o.push(e,n);for(let y=1,b=f;y<m;y++,b+=x)o.push(s,t),o.push(s+Math.sin(b)*g,t+Math.cos(b)*g);o.push(s,t),o.push(r,i)}else{o.push(e,n),o.push(s,t);for(let y=1,b=f;y<m;y++,b+=x)o.push(s+Math.sin(b)*g,t+Math.cos(b)*g),o.push(s,t);o.push(r,i),o.push(s,t)}return m*2}function pd(s,t,e,n,r,i){const o=nl;if(s.length===0)return;const a=t;let l=a.alignment;if(t.alignment!==.5){let D=fd(s);l=(l-.5)*D+.5}const h=new ft(s[0],s[1]),c=new ft(s[s.length-2],s[s.length-1]),u=n,f=Math.abs(h.x-c.x)<o&&Math.abs(h.y-c.y)<o;if(u){s=s.slice(),f&&(s.pop(),s.pop(),c.set(s[s.length-2],s[s.length-1]));const D=(h.x+c.x)*.5,W=(c.y+h.y)*.5;s.unshift(D,W),s.push(D,W)}const d=r,p=s.length/2;let g=s.length;const m=d.length/2,x=a.width/2,y=x*x,b=a.miterLimit*a.miterLimit;let w=s[0],_=s[1],A=s[2],C=s[3],P=0,v=0,k=-(_-C),S=w-A,M=0,E=0,F=Math.sqrt(k*k+S*S);k/=F,S/=F,k*=x,S*=x;const R=l,T=(1-R)*2,I=R*2;u||(a.cap==="round"?g+=_e(w-k*(T-I)*.5,_-S*(T-I)*.5,w-k*T,_-S*T,w+k*I,_+S*I,d,!0)+2:a.cap==="square"&&(g+=to(w,_,k,S,T,I,!0,d))),d.push(w-k*T,_-S*T),d.push(w+k*I,_+S*I);for(let D=1;D<p-1;++D){w=s[(D-1)*2],_=s[(D-1)*2+1],A=s[D*2],C=s[D*2+1],P=s[(D+1)*2],v=s[(D+1)*2+1],k=-(_-C),S=w-A,F=Math.sqrt(k*k+S*S),k/=F,S/=F,k*=x,S*=x,M=-(C-v),E=A-P,F=Math.sqrt(M*M+E*E),M/=F,E/=F,M*=x,E*=x;const W=A-w,U=_-C,Q=A-P,H=v-C,K=W*Q+U*H,Y=U*Q-H*W,tt=Y<0;if(Math.abs(Y)<.001*Math.abs(K)){d.push(A-k*T,C-S*T),d.push(A+k*I,C+S*I),K>=0&&(a.join==="round"?g+=_e(A,C,A-k*T,C-S*T,A-M*T,C-E*T,d,!1)+4:g+=2,d.push(A-M*I,C-E*I),d.push(A+M*T,C+E*T));continue}const J=(-k+w)*(-S+C)-(-k+A)*(-S+_),Pt=(-M+P)*(-E+C)-(-M+A)*(-E+v),ut=(W*Pt-Q*J)/Y,vt=(H*J-U*Pt)/Y,xt=(ut-A)*(ut-A)+(vt-C)*(vt-C),Mt=A+(ut-A)*T,ye=C+(vt-C)*T,be=A-(ut-A)*I,we=C-(vt-C)*I,rc=Math.min(W*W+U*U,Q*Q+H*H),ci=tt?T:I,ic=rc+ci*ci*y;xt<=ic?a.join==="bevel"||xt/y>b?(tt?(d.push(Mt,ye),d.push(A+k*I,C+S*I),d.push(Mt,ye),d.push(A+M*I,C+E*I)):(d.push(A-k*T,C-S*T),d.push(be,we),d.push(A-M*T,C-E*T),d.push(be,we)),g+=2):a.join==="round"?tt?(d.push(Mt,ye),d.push(A+k*I,C+S*I),g+=_e(A,C,A+k*I,C+S*I,A+M*I,C+E*I,d,!0)+4,d.push(Mt,ye),d.push(A+M*I,C+E*I)):(d.push(A-k*T,C-S*T),d.push(be,we),g+=_e(A,C,A-k*T,C-S*T,A-M*T,C-E*T,d,!1)+4,d.push(A-M*T,C-E*T),d.push(be,we)):(d.push(Mt,ye),d.push(be,we)):(d.push(A-k*T,C-S*T),d.push(A+k*I,C+S*I),a.join==="round"?tt?g+=_e(A,C,A+k*I,C+S*I,A+M*I,C+E*I,d,!0)+2:g+=_e(A,C,A-k*T,C-S*T,A-M*T,C-E*T,d,!1)+2:a.join==="miter"&&xt/y<=b&&(tt?(d.push(be,we),d.push(be,we)):(d.push(Mt,ye),d.push(Mt,ye)),g+=2),d.push(A-M*T,C-E*T),d.push(A+M*I,C+E*I),g+=2)}w=s[(p-2)*2],_=s[(p-2)*2+1],A=s[(p-1)*2],C=s[(p-1)*2+1],k=-(_-C),S=w-A,F=Math.sqrt(k*k+S*S),k/=F,S/=F,k*=x,S*=x,d.push(A-k*T,C-S*T),d.push(A+k*I,C+S*I),u||(a.cap==="round"?g+=_e(A-k*(T-I)*.5,C-S*(T-I)*.5,A-k*T,C-S*T,A+k*I,C+S*I,d,!1)+2:a.cap==="square"&&(g+=to(A,C,k,S,T,I,!1,d)));const B=Ji*Ji;for(let D=m;D<g+m-2;++D)w=d[D*2],_=d[D*2+1],A=d[(D+1)*2],C=d[(D+1)*2+1],P=d[(D+2)*2],v=d[(D+2)*2+1],!(Math.abs(w*(C-v)+A*(v-_)+P*(_-C))<B)&&i.push(D,D+1,D+2)}function md(s,t,e,n){const r=nl;if(s.length===0)return;const i=s[0],o=s[1],a=s[s.length-2],l=s[s.length-1],h=t||Math.abs(i-a)<r&&Math.abs(o-l)<r,c=e,u=s.length/2,f=c.length/2;for(let d=0;d<u;d++)c.push(s[d*2]),c.push(s[d*2+1]);for(let d=0;d<u-1;d++)n.push(f+d,f+d+1);h&&n.push(f+u-1,f)}function rl(s,t,e,n,r,i,o){const a=eu(s,t,2);if(!a)return;for(let h=0;h<a.length;h+=3)i[o++]=a[h]+r,i[o++]=a[h+1]+r,i[o++]=a[h+2]+r;let l=r*n;for(let h=0;h<s.length;h+=2)e[l]=s[h],e[l+1]=s[h+1],l+=n}const gd=[],xd={extension:{type:N.ShapeBuilder,name:"polygon"},build(s,t){for(let e=0;e<s.points.length;e++)t[e]=s.points[e];return!0},triangulate(s,t,e,n,r,i){rl(s,gd,t,e,n,r,i)}},yd={extension:{type:N.ShapeBuilder,name:"rectangle"},build(s,t){const e=s,n=e.x,r=e.y,i=e.width,o=e.height;return i>0&&o>0?(t[0]=n,t[1]=r,t[2]=n+i,t[3]=r,t[4]=n+i,t[5]=r+o,t[6]=n,t[7]=r+o,!0):!1},triangulate(s,t,e,n,r,i){let o=0;n*=e,t[n+o]=s[0],t[n+o+1]=s[1],o+=e,t[n+o]=s[2],t[n+o+1]=s[3],o+=e,t[n+o]=s[6],t[n+o+1]=s[7],o+=e,t[n+o]=s[4],t[n+o+1]=s[5],o+=e;const a=n/e;r[i++]=a,r[i++]=a+1,r[i++]=a+2,r[i++]=a+1,r[i++]=a+3,r[i++]=a+2}},bd={extension:{type:N.ShapeBuilder,name:"triangle"},build(s,t){return t[0]=s.x,t[1]=s.y,t[2]=s.x2,t[3]=s.y2,t[4]=s.x3,t[5]=s.y3,!0},triangulate(s,t,e,n,r,i){let o=0;n*=e,t[n+o]=s[0],t[n+o+1]=s[1],o+=e,t[n+o]=s[2],t[n+o+1]=s[3],o+=e,t[n+o]=s[4],t[n+o+1]=s[5];const a=n/e;r[i++]=a,r[i++]=a+1,r[i++]=a+2}},wd=new X,_d=new q;function vd(s,t,e,n){const r=t.matrix?s.copyFrom(t.matrix).invert():s.identity();if(t.textureSpace==="local"){const o=e.getBounds(_d);t.width&&o.pad(t.width);const{x:a,y:l}=o,h=1/o.width,c=1/o.height,u=-a*h,f=-l*c,d=r.a,p=r.b,g=r.c,m=r.d;r.a*=h,r.b*=h,r.c*=c,r.d*=c,r.tx=u*d+f*g+r.tx,r.ty=u*p+f*m+r.ty}else r.translate(t.texture.frame.x,t.texture.frame.y),r.scale(1/t.texture.source.width,1/t.texture.source.height);const i=t.texture.source.style;return!(t.fill instanceof ce)&&i.addressMode==="clamp-to-edge"&&(i.addressMode="repeat",i.update()),n&&r.append(wd.copyFrom(n).invert()),r}const pn={};dt.handleByMap(N.ShapeBuilder,pn);dt.add(yd,xd,bd,Cs,ud,dd);const Ad=new q,Sd=new X;function Cd(s,t){const{geometryData:e,batches:n}=t;n.length=0,e.indices.length=0,e.vertices.length=0,e.uvs.length=0;for(let r=0;r<s.instructions.length;r++){const i=s.instructions[r];if(i.action==="texture")kd(i.data,n,e);else if(i.action==="fill"||i.action==="stroke"){const o=i.action==="stroke",a=i.data.path.shapePath,l=i.data.style,h=i.data.hole;o&&h&&eo(h.shapePath,l,!0,n,e),h&&(a.shapePrimitives[a.shapePrimitives.length-1].holes=h.shapePath.shapePrimitives),eo(a,l,o,n,e)}}}function kd(s,t,e){const n=[],r=pn.rectangle,i=Ad;i.x=s.dx,i.y=s.dy,i.width=s.dw,i.height=s.dh;const o=s.transform;if(!r.build(i,n))return;const{vertices:a,uvs:l,indices:h}=e,c=h.length,u=a.length/2;o&&el(n,o),r.triangulate(n,a,2,u,h,c);const f=s.image,d=f.uvs;l.push(d.x0,d.y0,d.x1,d.y1,d.x3,d.y3,d.x2,d.y2);const p=ae.get(sl);p.indexOffset=c,p.indexSize=h.length-c,p.attributeOffset=u,p.attributeSize=a.length/2-u,p.baseColor=s.style,p.alpha=s.alpha,p.texture=f,p.geometryData=e,t.push(p)}function eo(s,t,e,n,r){const{vertices:i,uvs:o,indices:a}=r;s.shapePrimitives.forEach(({shape:l,transform:h,holes:c})=>{const u=[],f=pn[l.type];if(!f.build(l,u))return;const d=a.length,p=i.length/2;let g="triangle-list";if(h&&el(u,h),e){const b=l.closePath??!0,w=t;w.pixelLine?(md(u,b,i,a),g="line-list"):pd(u,w,!1,b,i,a)}else if(c){const b=[],w=u.slice();Pd(c).forEach(A=>{b.push(w.length/2),w.push(...A)}),rl(w,b,i,2,p,a,d)}else f.triangulate(u,i,2,p,a,d);const m=o.length/2,x=t.texture;if(x!==$.WHITE){const b=vd(Sd,t,l,h);ld(i,2,p,o,m,2,i.length/2-p,b)}else cd(o,m,2,i.length/2-p);const y=ae.get(sl);y.indexOffset=d,y.indexSize=a.length-d,y.attributeOffset=p,y.attributeSize=i.length/2-p,y.baseColor=t.color,y.alpha=t.alpha,y.texture=x,y.geometryData=r,y.topology=g,n.push(y)})}function Pd(s){const t=[];for(let e=0;e<s.length;e++){const n=s[e].shape,r=[];pn[n.type].build(n,r)&&t.push(r)}return t}class Md{constructor(){this.batches=[],this.geometryData={vertices:[],uvs:[],indices:[]}}}class Td{constructor(){this.instructions=new ha}init(t){this.batcher=new ad({maxTextures:t}),this.instructions.reset()}get geometry(){return V(Ac,"GraphicsContextRenderData#geometry is deprecated, please use batcher.geometry instead."),this.batcher.geometry}}const Xr=class Mr{constructor(t){this._gpuContextHash={},this._graphicsDataContextHash=Object.create(null),this._renderer=t,t.renderableGC.addManagedHash(this,"_gpuContextHash"),t.renderableGC.addManagedHash(this,"_graphicsDataContextHash")}init(t){Mr.defaultOptions.bezierSmoothness=(t==null?void 0:t.bezierSmoothness)??Mr.defaultOptions.bezierSmoothness}getContextRenderData(t){return this._graphicsDataContextHash[t.uid]||this._initContextRenderData(t)}updateGpuContext(t){let e=this._gpuContextHash[t.uid]||this._initContext(t);if(t.dirty){e?this._cleanGraphicsContextData(t):e=this._initContext(t),Cd(t,e);const n=t.batchMode;t.customShader||n==="no-batch"?e.isBatchable=!1:n==="auto"?e.isBatchable=e.geometryData.vertices.length<400:e.isBatchable=!0,t.dirty=!1}return e}getGpuContext(t){return this._gpuContextHash[t.uid]||this._initContext(t)}_initContextRenderData(t){const e=ae.get(Td,{maxTextures:this._renderer.limits.maxBatchableTextures}),{batches:n,geometryData:r}=this._gpuContextHash[t.uid],i=r.vertices.length,o=r.indices.length;for(let c=0;c<n.length;c++)n[c].applyTransform=!1;const a=e.batcher;a.ensureAttributeBuffer(i),a.ensureIndexBuffer(o),a.begin();for(let c=0;c<n.length;c++){const u=n[c];a.add(u)}a.finish(e.instructions);const l=a.geometry;l.indexBuffer.setDataWithSize(a.indexBuffer,a.indexSize,!0),l.buffers[0].setDataWithSize(a.attributeBuffer.float32View,a.attributeSize,!0);const h=a.batches;for(let c=0;c<h.length;c++){const u=h[c];u.bindGroup=xu(u.textures.textures,u.textures.count,this._renderer.limits.maxBatchableTextures)}return this._graphicsDataContextHash[t.uid]=e,e}_initContext(t){const e=new Md;return e.context=t,this._gpuContextHash[t.uid]=e,t.on("destroy",this.onGraphicsContextDestroy,this),this._gpuContextHash[t.uid]}onGraphicsContextDestroy(t){this._cleanGraphicsContextData(t),t.off("destroy",this.onGraphicsContextDestroy,this),this._gpuContextHash[t.uid]=null}_cleanGraphicsContextData(t){const e=this._gpuContextHash[t.uid];e.isBatchable||this._graphicsDataContextHash[t.uid]&&(ae.return(this.getContextRenderData(t)),this._graphicsDataContextHash[t.uid]=null),e.batches&&e.batches.forEach(n=>{ae.return(n)})}destroy(){for(const t in this._gpuContextHash)this._gpuContextHash[t]&&this.onGraphicsContextDestroy(this._gpuContextHash[t].context)}};Xr.extension={type:[N.WebGLSystem,N.WebGPUSystem,N.CanvasSystem],name:"graphicsContext"};Xr.defaultOptions={bezierSmoothness:.5};let il=Xr;const Ed=8,zs=11920929e-14,Id=1;function ol(s,t,e,n,r,i,o,a,l,h){const u=Math.min(.99,Math.max(0,h??il.defaultOptions.bezierSmoothness));let f=(Id-u)/1;return f*=f,Bd(t,e,n,r,i,o,a,l,s,f),s}function Bd(s,t,e,n,r,i,o,a,l,h){Tr(s,t,e,n,r,i,o,a,l,h,0),l.push(o,a)}function Tr(s,t,e,n,r,i,o,a,l,h,c){if(c>Ed)return;const u=(s+e)/2,f=(t+n)/2,d=(e+r)/2,p=(n+i)/2,g=(r+o)/2,m=(i+a)/2,x=(u+d)/2,y=(f+p)/2,b=(d+g)/2,w=(p+m)/2,_=(x+b)/2,A=(y+w)/2;if(c>0){let C=o-s,P=a-t;const v=Math.abs((e-o)*P-(n-a)*C),k=Math.abs((r-o)*P-(i-a)*C);if(v>zs&&k>zs){if((v+k)*(v+k)<=h*(C*C+P*P)){l.push(_,A);return}}else if(v>zs){if(v*v<=h*(C*C+P*P)){l.push(_,A);return}}else if(k>zs){if(k*k<=h*(C*C+P*P)){l.push(_,A);return}}else if(C=_-(s+o)/2,P=A-(t+a)/2,C*C+P*P<=h){l.push(_,A);return}}Tr(s,t,u,f,x,y,_,A,l,h,c+1),Tr(_,A,b,w,g,m,o,a,l,h,c+1)}const Fd=8,Rd=11920929e-14,Ld=1;function zd(s,t,e,n,r,i,o,a){const h=Math.min(.99,Math.max(0,a??il.defaultOptions.bezierSmoothness));let c=(Ld-h)/1;return c*=c,Gd(t,e,n,r,i,o,s,c),s}function Gd(s,t,e,n,r,i,o,a){Er(o,s,t,e,n,r,i,a,0),o.push(r,i)}function Er(s,t,e,n,r,i,o,a,l){if(l>Fd)return;const h=(t+n)/2,c=(e+r)/2,u=(n+i)/2,f=(r+o)/2,d=(h+u)/2,p=(c+f)/2;let g=i-t,m=o-e;const x=Math.abs((n-i)*m-(r-o)*g);if(x>Rd){if(x*x<=a*(g*g+m*m)){s.push(d,p);return}}else if(g=d-(t+i)/2,m=p-(e+o)/2,g*g+m*m<=a){s.push(d,p);return}Er(s,t,e,h,c,d,p,a,l+1),Er(s,d,p,u,f,i,o,a,l+1)}function al(s,t,e,n,r,i,o,a){let l=Math.abs(r-i);(!o&&r>i||o&&i>r)&&(l=2*Math.PI-l),a||(a=Math.max(6,Math.floor(6*Math.pow(n,1/3)*(l/Math.PI)))),a=Math.max(a,3);let h=l/a,c=r;h*=o?-1:1;for(let u=0;u<a+1;u++){const f=Math.cos(c),d=Math.sin(c),p=t+f*n,g=e+d*n;s.push(p,g),c+=h}}function Od(s,t,e,n,r,i){const o=s[s.length-2],l=s[s.length-1]-e,h=o-t,c=r-e,u=n-t,f=Math.abs(l*u-h*c);if(f<1e-8||i===0){(s[s.length-2]!==t||s[s.length-1]!==e)&&s.push(t,e);return}const d=l*l+h*h,p=c*c+u*u,g=l*c+h*u,m=i*Math.sqrt(d)/f,x=i*Math.sqrt(p)/f,y=m*g/d,b=x*g/p,w=m*u+x*h,_=m*c+x*l,A=h*(x+y),C=l*(x+y),P=u*(m+b),v=c*(m+b),k=Math.atan2(C-_,A-w),S=Math.atan2(v-_,P-w);al(s,w+t,_+e,i,k,S,h*c>u*l)}const gs=Math.PI*2,Kn={centerX:0,centerY:0,ang1:0,ang2:0},Zn=({x:s,y:t},e,n,r,i,o,a,l)=>{s*=e,t*=n;const h=r*s-i*t,c=i*s+r*t;return l.x=h+o,l.y=c+a,l};function Nd(s,t){const e=t===-1.5707963267948966?-.551915024494:1.3333333333333333*Math.tan(t/4),n=t===1.5707963267948966?.551915024494:e,r=Math.cos(s),i=Math.sin(s),o=Math.cos(s+t),a=Math.sin(s+t);return[{x:r-i*n,y:i+r*n},{x:o+a*n,y:a-o*n},{x:o,y:a}]}const so=(s,t,e,n)=>{const r=s*n-t*e<0?-1:1;let i=s*e+t*n;return i>1&&(i=1),i<-1&&(i=-1),r*Math.acos(i)},Ud=(s,t,e,n,r,i,o,a,l,h,c,u,f)=>{const d=Math.pow(r,2),p=Math.pow(i,2),g=Math.pow(c,2),m=Math.pow(u,2);let x=d*p-d*m-p*g;x<0&&(x=0),x/=d*m+p*g,x=Math.sqrt(x)*(o===a?-1:1);const y=x*r/i*u,b=x*-i/r*c,w=h*y-l*b+(s+e)/2,_=l*y+h*b+(t+n)/2,A=(c-y)/r,C=(u-b)/i,P=(-c-y)/r,v=(-u-b)/i,k=so(1,0,A,C);let S=so(A,C,P,v);a===0&&S>0&&(S-=gs),a===1&&S<0&&(S+=gs),f.centerX=w,f.centerY=_,f.ang1=k,f.ang2=S};function Dd(s,t,e,n,r,i,o,a=0,l=0,h=0){if(i===0||o===0)return;const c=Math.sin(a*gs/360),u=Math.cos(a*gs/360),f=u*(t-n)/2+c*(e-r)/2,d=-c*(t-n)/2+u*(e-r)/2;if(f===0&&d===0)return;i=Math.abs(i),o=Math.abs(o);const p=Math.pow(f,2)/Math.pow(i,2)+Math.pow(d,2)/Math.pow(o,2);p>1&&(i*=Math.sqrt(p),o*=Math.sqrt(p)),Ud(t,e,n,r,i,o,l,h,c,u,f,d,Kn);let{ang1:g,ang2:m}=Kn;const{centerX:x,centerY:y}=Kn;let b=Math.abs(m)/(gs/4);Math.abs(1-b)<1e-7&&(b=1);const w=Math.max(Math.ceil(b),1);m/=w;let _=s[s.length-2],A=s[s.length-1];const C={x:0,y:0};for(let P=0;P<w;P++){const v=Nd(g,m),{x:k,y:S}=Zn(v[0],i,o,u,c,x,y,C),{x:M,y:E}=Zn(v[1],i,o,u,c,x,y,C),{x:F,y:R}=Zn(v[2],i,o,u,c,x,y,C);ol(s,_,A,k,S,M,E,F,R),_=F,A=R,g+=m}}function Hd(s,t,e){const n=(o,a)=>{const l=a.x-o.x,h=a.y-o.y,c=Math.sqrt(l*l+h*h),u=l/c,f=h/c;return{len:c,nx:u,ny:f}},r=(o,a)=>{o===0?s.moveTo(a.x,a.y):s.lineTo(a.x,a.y)};let i=t[t.length-1];for(let o=0;o<t.length;o++){const a=t[o%t.length],l=a.radius??e;if(l<=0){r(o,a),i=a;continue}const h=t[(o+1)%t.length],c=n(a,i),u=n(a,h);if(c.len<1e-4||u.len<1e-4){r(o,a),i=a;continue}let f=Math.asin(c.nx*u.ny-c.ny*u.nx),d=1,p=!1;c.nx*u.nx-c.ny*-u.ny<0?f<0?f=Math.PI+f:(f=Math.PI-f,d=-1,p=!0):f>0&&(d=-1,p=!0);const g=f/2;let m,x=Math.abs(Math.cos(g)*l/Math.sin(g));x>Math.min(c.len/2,u.len/2)?(x=Math.min(c.len/2,u.len/2),m=Math.abs(x*Math.sin(g)/Math.cos(g))):m=l;const y=a.x+u.nx*x+-u.ny*m*d,b=a.y+u.ny*x+u.nx*m*d,w=Math.atan2(c.ny,c.nx)+Math.PI/2*d,_=Math.atan2(u.ny,u.nx)-Math.PI/2*d;o===0&&s.moveTo(y+Math.cos(w)*m,b+Math.sin(w)*m),s.arc(y,b,m,w,_,p),i=a}}function Wd(s,t,e,n){const r=(a,l)=>Math.sqrt((a.x-l.x)**2+(a.y-l.y)**2),i=(a,l,h)=>({x:a.x+(l.x-a.x)*h,y:a.y+(l.y-a.y)*h}),o=t.length;for(let a=0;a<o;a++){const l=t[(a+1)%o],h=l.radius??e;if(h<=0){a===0?s.moveTo(l.x,l.y):s.lineTo(l.x,l.y);continue}const c=t[a],u=t[(a+2)%o],f=r(c,l);let d;if(f<1e-4)d=l;else{const m=Math.min(f/2,h);d=i(l,c,m/f)}const p=r(u,l);let g;if(p<1e-4)g=l;else{const m=Math.min(p/2,h);g=i(l,u,m/p)}a===0?s.moveTo(d.x,d.y):s.lineTo(d.x,d.y),s.quadraticCurveTo(l.x,l.y,g.x,g.y,n)}}const jd=new q;class $d{constructor(t){this.shapePrimitives=[],this._currentPoly=null,this._bounds=new Dt,this._graphicsPath2D=t,this.signed=t.checkForHoles}moveTo(t,e){return this.startPoly(t,e),this}lineTo(t,e){this._ensurePoly();const n=this._currentPoly.points,r=n[n.length-2],i=n[n.length-1];return(r!==t||i!==e)&&n.push(t,e),this}arc(t,e,n,r,i,o){this._ensurePoly(!1);const a=this._currentPoly.points;return al(a,t,e,n,r,i,o),this}arcTo(t,e,n,r,i){this._ensurePoly();const o=this._currentPoly.points;return Od(o,t,e,n,r,i),this}arcToSvg(t,e,n,r,i,o,a){const l=this._currentPoly.points;return Dd(l,this._currentPoly.lastX,this._currentPoly.lastY,o,a,t,e,n,r,i),this}bezierCurveTo(t,e,n,r,i,o,a){this._ensurePoly();const l=this._currentPoly;return ol(this._currentPoly.points,l.lastX,l.lastY,t,e,n,r,i,o,a),this}quadraticCurveTo(t,e,n,r,i){this._ensurePoly();const o=this._currentPoly;return zd(this._currentPoly.points,o.lastX,o.lastY,t,e,n,r,i),this}closePath(){return this.endPoly(!0),this}addPath(t,e){this.endPoly(),e&&!e.isIdentity()&&(t=t.clone(!0),t.transform(e));const n=this.shapePrimitives,r=n.length;for(let i=0;i<t.instructions.length;i++){const o=t.instructions[i];this[o.action](...o.data)}if(t.checkForHoles&&n.length-r>1){let i=null;for(let o=r;o<n.length;o++){const a=n[o];if(a.shape.type==="polygon"){const l=a.shape,h=i==null?void 0:i.shape;h&&h.containsPolygon(l)?(i.holes||(i.holes=[]),i.holes.push(a),n.copyWithin(o,o+1),n.length--,o--):i=a}}}return this}finish(t=!1){this.endPoly(t)}rect(t,e,n,r,i){return this.drawShape(new q(t,e,n,r),i),this}circle(t,e,n,r){return this.drawShape(new $r(t,e,n),r),this}poly(t,e,n){const r=new ms(t);return r.closePath=e,this.drawShape(r,n),this}regularPoly(t,e,n,r,i=0,o){r=Math.max(r|0,3);const a=-1*Math.PI/2+i,l=Math.PI*2/r,h=[];for(let c=0;c<r;c++){const u=a-c*l;h.push(t+n*Math.cos(u),e+n*Math.sin(u))}return this.poly(h,!0,o),this}roundPoly(t,e,n,r,i,o=0,a){if(r=Math.max(r|0,3),i<=0)return this.regularPoly(t,e,n,r,o);const l=n*Math.sin(Math.PI/r)-.001;i=Math.min(i,l);const h=-1*Math.PI/2+o,c=Math.PI*2/r,u=(r-2)*Math.PI/r/2;for(let f=0;f<r;f++){const d=f*c+h,p=t+n*Math.cos(d),g=e+n*Math.sin(d),m=d+Math.PI+u,x=d-Math.PI-u,y=p+i*Math.cos(m),b=g+i*Math.sin(m),w=p+i*Math.cos(x),_=g+i*Math.sin(x);f===0?this.moveTo(y,b):this.lineTo(y,b),this.quadraticCurveTo(p,g,w,_,a)}return this.closePath()}roundShape(t,e,n=!1,r){return t.length<3?this:(n?Wd(this,t,e,r):Hd(this,t,e),this.closePath())}filletRect(t,e,n,r,i){if(i===0)return this.rect(t,e,n,r);const o=Math.min(n,r)/2,a=Math.min(o,Math.max(-o,i)),l=t+n,h=e+r,c=a<0?-a:0,u=Math.abs(a);return this.moveTo(t,e+u).arcTo(t+c,e+c,t+u,e,u).lineTo(l-u,e).arcTo(l-c,e+c,l,e+u,u).lineTo(l,h-u).arcTo(l-c,h-c,t+n-u,h,u).lineTo(t+u,h).arcTo(t+c,h-c,t,h-u,u).closePath()}chamferRect(t,e,n,r,i,o){if(i<=0)return this.rect(t,e,n,r);const a=Math.min(i,Math.min(n,r)/2),l=t+n,h=e+r,c=[t+a,e,l-a,e,l,e+a,l,h-a,l-a,h,t+a,h,t,h-a,t,e+a];for(let u=c.length-1;u>=2;u-=2)c[u]===c[u-2]&&c[u-1]===c[u-3]&&c.splice(u-1,2);return this.poly(c,!0,o)}ellipse(t,e,n,r,i){return this.drawShape(new Vr(t,e,n,r),i),this}roundRect(t,e,n,r,i,o){return this.drawShape(new Yr(t,e,n,r,i),o),this}drawShape(t,e){return this.endPoly(),this.shapePrimitives.push({shape:t,transform:e}),this}startPoly(t,e){let n=this._currentPoly;return n&&this.endPoly(),n=new ms,n.points.push(t,e),this._currentPoly=n,this}endPoly(t=!1){const e=this._currentPoly;return e&&e.points.length>2&&(e.closePath=t,this.shapePrimitives.push({shape:e})),this._currentPoly=null,this}_ensurePoly(t=!0){if(!this._currentPoly&&(this._currentPoly=new ms,t)){const e=this.shapePrimitives[this.shapePrimitives.length-1];if(e){let n=e.shape.x,r=e.shape.y;if(e.transform&&!e.transform.isIdentity()){const i=e.transform,o=n;n=i.a*n+i.c*r+i.tx,r=i.b*o+i.d*r+i.ty}this._currentPoly.points.push(n,r)}else this._currentPoly.points.push(0,0)}}buildPath(){const t=this._graphicsPath2D;this.shapePrimitives.length=0,this._currentPoly=null;for(let e=0;e<t.instructions.length;e++){const n=t.instructions[e];this[n.action](...n.data)}this.finish()}get bounds(){const t=this._bounds;t.clear();const e=this.shapePrimitives;for(let n=0;n<e.length;n++){const r=e[n],i=r.shape.getBounds(jd);r.transform?t.addRect(i,r.transform):t.addRect(i)}return t}}class qe{constructor(t,e=!1){this.instructions=[],this.uid=lt("graphicsPath"),this._dirty=!0,this.checkForHoles=e,typeof t=="string"?fu(t,this):this.instructions=(t==null?void 0:t.slice())??[]}get shapePath(){return this._shapePath||(this._shapePath=new $d(this)),this._dirty&&(this._dirty=!1,this._shapePath.buildPath()),this._shapePath}addPath(t,e){return t=t.clone(),this.instructions.push({action:"addPath",data:[t,e]}),this._dirty=!0,this}arc(...t){return this.instructions.push({action:"arc",data:t}),this._dirty=!0,this}arcTo(...t){return this.instructions.push({action:"arcTo",data:t}),this._dirty=!0,this}arcToSvg(...t){return this.instructions.push({action:"arcToSvg",data:t}),this._dirty=!0,this}bezierCurveTo(...t){return this.instructions.push({action:"bezierCurveTo",data:t}),this._dirty=!0,this}bezierCurveToShort(t,e,n,r,i){const o=this.instructions[this.instructions.length-1],a=this.getLastPoint(ft.shared);let l=0,h=0;if(!o||o.action!=="bezierCurveTo")l=a.x,h=a.y;else{l=o.data[2],h=o.data[3];const c=a.x,u=a.y;l=c+(c-l),h=u+(u-h)}return this.instructions.push({action:"bezierCurveTo",data:[l,h,t,e,n,r,i]}),this._dirty=!0,this}closePath(){return this.instructions.push({action:"closePath",data:[]}),this._dirty=!0,this}ellipse(...t){return this.instructions.push({action:"ellipse",data:t}),this._dirty=!0,this}lineTo(...t){return this.instructions.push({action:"lineTo",data:t}),this._dirty=!0,this}moveTo(...t){return this.instructions.push({action:"moveTo",data:t}),this}quadraticCurveTo(...t){return this.instructions.push({action:"quadraticCurveTo",data:t}),this._dirty=!0,this}quadraticCurveToShort(t,e,n){const r=this.instructions[this.instructions.length-1],i=this.getLastPoint(ft.shared);let o=0,a=0;if(!r||r.action!=="quadraticCurveTo")o=i.x,a=i.y;else{o=r.data[0],a=r.data[1];const l=i.x,h=i.y;o=l+(l-o),a=h+(h-a)}return this.instructions.push({action:"quadraticCurveTo",data:[o,a,t,e,n]}),this._dirty=!0,this}rect(t,e,n,r,i){return this.instructions.push({action:"rect",data:[t,e,n,r,i]}),this._dirty=!0,this}circle(t,e,n,r){return this.instructions.push({action:"circle",data:[t,e,n,r]}),this._dirty=!0,this}roundRect(...t){return this.instructions.push({action:"roundRect",data:t}),this._dirty=!0,this}poly(...t){return this.instructions.push({action:"poly",data:t}),this._dirty=!0,this}regularPoly(...t){return this.instructions.push({action:"regularPoly",data:t}),this._dirty=!0,this}roundPoly(...t){return this.instructions.push({action:"roundPoly",data:t}),this._dirty=!0,this}roundShape(...t){return this.instructions.push({action:"roundShape",data:t}),this._dirty=!0,this}filletRect(...t){return this.instructions.push({action:"filletRect",data:t}),this._dirty=!0,this}chamferRect(...t){return this.instructions.push({action:"chamferRect",data:t}),this._dirty=!0,this}star(t,e,n,r,i,o,a){i||(i=r/2);const l=-1*Math.PI/2+o,h=n*2,c=Math.PI*2/h,u=[];for(let f=0;f<h;f++){const d=f%2?i:r,p=f*c+l;u.push(t+d*Math.cos(p),e+d*Math.sin(p))}return this.poly(u,!0,a),this}clone(t=!1){const e=new qe;if(e.checkForHoles=this.checkForHoles,!t)e.instructions=this.instructions.slice();else for(let n=0;n<this.instructions.length;n++){const r=this.instructions[n];e.instructions.push({action:r.action,data:r.data.slice()})}return e}clear(){return this.instructions.length=0,this._dirty=!0,this}transform(t){if(t.isIdentity())return this;const e=t.a,n=t.b,r=t.c,i=t.d,o=t.tx,a=t.ty;let l=0,h=0,c=0,u=0,f=0,d=0,p=0,g=0;for(let m=0;m<this.instructions.length;m++){const x=this.instructions[m],y=x.data;switch(x.action){case"moveTo":case"lineTo":l=y[0],h=y[1],y[0]=e*l+r*h+o,y[1]=n*l+i*h+a;break;case"bezierCurveTo":c=y[0],u=y[1],f=y[2],d=y[3],l=y[4],h=y[5],y[0]=e*c+r*u+o,y[1]=n*c+i*u+a,y[2]=e*f+r*d+o,y[3]=n*f+i*d+a,y[4]=e*l+r*h+o,y[5]=n*l+i*h+a;break;case"quadraticCurveTo":c=y[0],u=y[1],l=y[2],h=y[3],y[0]=e*c+r*u+o,y[1]=n*c+i*u+a,y[2]=e*l+r*h+o,y[3]=n*l+i*h+a;break;case"arcToSvg":l=y[5],h=y[6],p=y[0],g=y[1],y[0]=e*p+r*g,y[1]=n*p+i*g,y[5]=e*l+r*h+o,y[6]=n*l+i*h+a;break;case"circle":y[4]=as(y[3],t);break;case"rect":y[4]=as(y[4],t);break;case"ellipse":y[8]=as(y[8],t);break;case"roundRect":y[5]=as(y[5],t);break;case"addPath":y[0].transform(t);break;case"poly":y[2]=as(y[2],t);break;default:it("unknown transform action",x.action);break}}return this._dirty=!0,this}get bounds(){return this.shapePath.bounds}getLastPoint(t){let e=this.instructions.length-1,n=this.instructions[e];if(!n)return t.x=0,t.y=0,t;for(;n.action==="closePath";){if(e--,e<0)return t.x=0,t.y=0,t;n=this.instructions[e]}switch(n.action){case"moveTo":case"lineTo":t.x=n.data[0],t.y=n.data[1];break;case"quadraticCurveTo":t.x=n.data[2],t.y=n.data[3];break;case"bezierCurveTo":t.x=n.data[4],t.y=n.data[5];break;case"arc":case"arcToSvg":t.x=n.data[5],t.y=n.data[6];break;case"addPath":n.data[0].getLastPoint(t);break}return t}}function as(s,t){return s?s.prepend(t):t.clone()}function nt(s,t,e){const n=s.getAttribute(t);return n?Number(n):e}function Vd(s,t){const e=s.querySelectorAll("defs");for(let n=0;n<e.length;n++){const r=e[n];for(let i=0;i<r.children.length;i++){const o=r.children[i];switch(o.nodeName.toLowerCase()){case"lineargradient":t.defs[o.id]=Yd(o);break;case"radialgradient":t.defs[o.id]=Xd();break}}}}function Yd(s){const t=nt(s,"x1",0),e=nt(s,"y1",0),n=nt(s,"x2",1),r=nt(s,"y2",0),i=s.getAttribute("gradientUnits")||"objectBoundingBox",o=new ce(t,e,n,r,i==="objectBoundingBox"?"local":"global");for(let a=0;a<s.children.length;a++){const l=s.children[a],h=nt(l,"offset",0),c=ot.shared.setValue(l.getAttribute("stop-color")).toNumber();o.addColorStop(h,c)}return o}function Xd(s){return it("[SVG Parser] Radial gradients are not yet supported"),new ce(0,0,1,0)}function no(s){const t=s.match(/url\s*\(\s*['"]?\s*#([^'"\s)]+)\s*['"]?\s*\)/i);return t?t[1]:""}const ro={fill:{type:"paint",default:0},"fill-opacity":{type:"number",default:1},stroke:{type:"paint",default:0},"stroke-width":{type:"number",default:1},"stroke-opacity":{type:"number",default:1},"stroke-linecap":{type:"string",default:"butt"},"stroke-linejoin":{type:"string",default:"miter"},"stroke-miterlimit":{type:"number",default:10},"stroke-dasharray":{type:"string",default:"none"},"stroke-dashoffset":{type:"number",default:0},opacity:{type:"number",default:1}};function ll(s,t){const e=s.getAttribute("style"),n={},r={},i={strokeStyle:n,fillStyle:r,useFill:!1,useStroke:!1};for(const o in ro){const a=s.getAttribute(o);a&&io(t,i,o,a.trim())}if(e){const o=e.split(";");for(let a=0;a<o.length;a++){const l=o[a].trim(),[h,c]=l.split(":");ro[h]&&io(t,i,h,c.trim())}}return{strokeStyle:i.useStroke?n:null,fillStyle:i.useFill?r:null,useFill:i.useFill,useStroke:i.useStroke}}function io(s,t,e,n){switch(e){case"stroke":if(n!=="none"){if(n.startsWith("url(")){const r=no(n);t.strokeStyle.fill=s.defs[r]}else t.strokeStyle.color=ot.shared.setValue(n).toNumber();t.useStroke=!0}break;case"stroke-width":t.strokeStyle.width=Number(n);break;case"fill":if(n!=="none"){if(n.startsWith("url(")){const r=no(n);t.fillStyle.fill=s.defs[r]}else t.fillStyle.color=ot.shared.setValue(n).toNumber();t.useFill=!0}break;case"fill-opacity":t.fillStyle.alpha=Number(n);break;case"stroke-opacity":t.strokeStyle.alpha=Number(n);break;case"opacity":t.fillStyle.alpha=Number(n),t.strokeStyle.alpha=Number(n);break}}function qd(s,t){if(typeof s=="string"){const o=document.createElement("div");o.innerHTML=s.trim(),s=o.querySelector("svg")}const e={context:t,defs:{},path:new qe};Vd(s,e);const n=s.children,{fillStyle:r,strokeStyle:i}=ll(s,e);for(let o=0;o<n.length;o++){const a=n[o];a.nodeName.toLowerCase()!=="defs"&&cl(a,e,r,i)}return t}function cl(s,t,e,n){const r=s.children,{fillStyle:i,strokeStyle:o}=ll(s,t);i&&e?e={...e,...i}:i&&(e=i),o&&n?n={...n,...o}:o&&(n=o);const a=!e&&!n;a&&(e={color:0});let l,h,c,u,f,d,p,g,m,x,y,b,w,_,A,C,P;switch(s.nodeName.toLowerCase()){case"path":_=s.getAttribute("d"),s.getAttribute("fill-rule")==="evenodd"&&it("SVG Evenodd fill rule not supported, your svg may render incorrectly"),A=new qe(_,!0),t.context.path(A),e&&t.context.fill(e),n&&t.context.stroke(n);break;case"circle":p=nt(s,"cx",0),g=nt(s,"cy",0),m=nt(s,"r",0),t.context.ellipse(p,g,m,m),e&&t.context.fill(e),n&&t.context.stroke(n);break;case"rect":l=nt(s,"x",0),h=nt(s,"y",0),C=nt(s,"width",0),P=nt(s,"height",0),x=nt(s,"rx",0),y=nt(s,"ry",0),x||y?t.context.roundRect(l,h,C,P,x||y):t.context.rect(l,h,C,P),e&&t.context.fill(e),n&&t.context.stroke(n);break;case"ellipse":p=nt(s,"cx",0),g=nt(s,"cy",0),x=nt(s,"rx",0),y=nt(s,"ry",0),t.context.beginPath(),t.context.ellipse(p,g,x,y),e&&t.context.fill(e),n&&t.context.stroke(n);break;case"line":c=nt(s,"x1",0),u=nt(s,"y1",0),f=nt(s,"x2",0),d=nt(s,"y2",0),t.context.beginPath(),t.context.moveTo(c,u),t.context.lineTo(f,d),n&&t.context.stroke(n);break;case"polygon":w=s.getAttribute("points"),b=w.match(/\d+/g).map(v=>parseInt(v,10)),t.context.poly(b,!0),e&&t.context.fill(e),n&&t.context.stroke(n);break;case"polyline":w=s.getAttribute("points"),b=w.match(/\d+/g).map(v=>parseInt(v,10)),t.context.poly(b,!1),n&&t.context.stroke(n);break;case"g":case"svg":break;default:{it(`[SVG parser] <${s.nodeName}> elements unsupported`);break}}a&&(e=null);for(let v=0;v<r.length;v++)cl(r[v],t,e,n)}function Kd(s){return ot.isColorLike(s)}function oo(s){return s instanceof fn}function ao(s){return s instanceof ce}function Zd(s){return s instanceof $}function Qd(s,t,e){const n=ot.shared.setValue(t??0);return s.color=n.toNumber(),s.alpha=n.alpha===1?e.alpha:n.alpha,s.texture=$.WHITE,{...e,...s}}function Jd(s,t,e){return s.texture=t,{...e,...s}}function lo(s,t,e){return s.fill=t,s.color=16777215,s.texture=t.texture,s.matrix=t.transform,{...e,...s}}function co(s,t,e){return t.buildGradient(),s.fill=t,s.color=16777215,s.texture=t.texture,s.matrix=t.transform,s.textureSpace=t.textureSpace,{...e,...s}}function tf(s,t){const e={...t,...s},n=ot.shared.setValue(e.color);return e.alpha*=n.alpha,e.color=n.toNumber(),e}function Ee(s,t){if(s==null)return null;const e={},n=s;return Kd(s)?Qd(e,s,t):Zd(s)?Jd(e,s,t):oo(s)?lo(e,s,t):ao(s)?co(e,s,t):n.fill&&oo(n.fill)?lo(n,n.fill,t):n.fill&&ao(n.fill)?co(n,n.fill,t):tf(n,t)}function Js(s,t){const{width:e,alignment:n,miterLimit:r,cap:i,join:o,pixelLine:a,...l}=t,h=Ee(s,l);return h?{width:e,alignment:n,miterLimit:r,cap:i,join:o,pixelLine:a,...h}:null}const ef=new ft,ho=new X,qr=class Yt extends Wt{constructor(){super(...arguments),this.uid=lt("graphicsContext"),this.dirty=!0,this.batchMode="auto",this.instructions=[],this._activePath=new qe,this._transform=new X,this._fillStyle={...Yt.defaultFillStyle},this._strokeStyle={...Yt.defaultStrokeStyle},this._stateStack=[],this._tick=0,this._bounds=new Dt,this._boundsDirty=!0}clone(){const t=new Yt;return t.batchMode=this.batchMode,t.instructions=this.instructions.slice(),t._activePath=this._activePath.clone(),t._transform=this._transform.clone(),t._fillStyle={...this._fillStyle},t._strokeStyle={...this._strokeStyle},t._stateStack=this._stateStack.slice(),t._bounds=this._bounds.clone(),t._boundsDirty=!0,t}get fillStyle(){return this._fillStyle}set fillStyle(t){this._fillStyle=Ee(t,Yt.defaultFillStyle)}get strokeStyle(){return this._strokeStyle}set strokeStyle(t){this._strokeStyle=Js(t,Yt.defaultStrokeStyle)}setFillStyle(t){return this._fillStyle=Ee(t,Yt.defaultFillStyle),this}setStrokeStyle(t){return this._strokeStyle=Ee(t,Yt.defaultStrokeStyle),this}texture(t,e,n,r,i,o){return this.instructions.push({action:"texture",data:{image:t,dx:n||0,dy:r||0,dw:i||t.frame.width,dh:o||t.frame.height,transform:this._transform.clone(),alpha:this._fillStyle.alpha,style:e?ot.shared.setValue(e).toNumber():16777215}}),this.onUpdate(),this}beginPath(){return this._activePath=new qe,this}fill(t,e){let n;const r=this.instructions[this.instructions.length-1];return this._tick===0&&r&&r.action==="stroke"?n=r.data.path:n=this._activePath.clone(),n?(t!=null&&(e!==void 0&&typeof t=="number"&&(V(Z,"GraphicsContext.fill(color, alpha) is deprecated, use GraphicsContext.fill({ color, alpha }) instead"),t={color:t,alpha:e}),this._fillStyle=Ee(t,Yt.defaultFillStyle)),this.instructions.push({action:"fill",data:{style:this.fillStyle,path:n}}),this.onUpdate(),this._initNextPathLocation(),this._tick=0,this):this}_initNextPathLocation(){const{x:t,y:e}=this._activePath.getLastPoint(ft.shared);this._activePath.clear(),this._activePath.moveTo(t,e)}stroke(t){let e;const n=this.instructions[this.instructions.length-1];return this._tick===0&&n&&n.action==="fill"?e=n.data.path:e=this._activePath.clone(),e?(t!=null&&(this._strokeStyle=Js(t,Yt.defaultStrokeStyle)),this.instructions.push({action:"stroke",data:{style:this.strokeStyle,path:e}}),this.onUpdate(),this._initNextPathLocation(),this._tick=0,this):this}cut(){for(let t=0;t<2;t++){const e=this.instructions[this.instructions.length-1-t],n=this._activePath.clone();if(e&&(e.action==="stroke"||e.action==="fill"))if(e.data.hole)e.data.hole.addPath(n);else{e.data.hole=n;break}}return this._initNextPathLocation(),this}arc(t,e,n,r,i,o){this._tick++;const a=this._transform;return this._activePath.arc(a.a*t+a.c*e+a.tx,a.b*t+a.d*e+a.ty,n,r,i,o),this}arcTo(t,e,n,r,i){this._tick++;const o=this._transform;return this._activePath.arcTo(o.a*t+o.c*e+o.tx,o.b*t+o.d*e+o.ty,o.a*n+o.c*r+o.tx,o.b*n+o.d*r+o.ty,i),this}arcToSvg(t,e,n,r,i,o,a){this._tick++;const l=this._transform;return this._activePath.arcToSvg(t,e,n,r,i,l.a*o+l.c*a+l.tx,l.b*o+l.d*a+l.ty),this}bezierCurveTo(t,e,n,r,i,o,a){this._tick++;const l=this._transform;return this._activePath.bezierCurveTo(l.a*t+l.c*e+l.tx,l.b*t+l.d*e+l.ty,l.a*n+l.c*r+l.tx,l.b*n+l.d*r+l.ty,l.a*i+l.c*o+l.tx,l.b*i+l.d*o+l.ty,a),this}closePath(){var t;return this._tick++,(t=this._activePath)==null||t.closePath(),this}ellipse(t,e,n,r){return this._tick++,this._activePath.ellipse(t,e,n,r,this._transform.clone()),this}circle(t,e,n){return this._tick++,this._activePath.circle(t,e,n,this._transform.clone()),this}path(t){return this._tick++,this._activePath.addPath(t,this._transform.clone()),this}lineTo(t,e){this._tick++;const n=this._transform;return this._activePath.lineTo(n.a*t+n.c*e+n.tx,n.b*t+n.d*e+n.ty),this}moveTo(t,e){this._tick++;const n=this._transform,r=this._activePath.instructions,i=n.a*t+n.c*e+n.tx,o=n.b*t+n.d*e+n.ty;return r.length===1&&r[0].action==="moveTo"?(r[0].data[0]=i,r[0].data[1]=o,this):(this._activePath.moveTo(i,o),this)}quadraticCurveTo(t,e,n,r,i){this._tick++;const o=this._transform;return this._activePath.quadraticCurveTo(o.a*t+o.c*e+o.tx,o.b*t+o.d*e+o.ty,o.a*n+o.c*r+o.tx,o.b*n+o.d*r+o.ty,i),this}rect(t,e,n,r){return this._tick++,this._activePath.rect(t,e,n,r,this._transform.clone()),this}roundRect(t,e,n,r,i){return this._tick++,this._activePath.roundRect(t,e,n,r,i,this._transform.clone()),this}poly(t,e){return this._tick++,this._activePath.poly(t,e,this._transform.clone()),this}regularPoly(t,e,n,r,i=0,o){return this._tick++,this._activePath.regularPoly(t,e,n,r,i,o),this}roundPoly(t,e,n,r,i,o){return this._tick++,this._activePath.roundPoly(t,e,n,r,i,o),this}roundShape(t,e,n,r){return this._tick++,this._activePath.roundShape(t,e,n,r),this}filletRect(t,e,n,r,i){return this._tick++,this._activePath.filletRect(t,e,n,r,i),this}chamferRect(t,e,n,r,i,o){return this._tick++,this._activePath.chamferRect(t,e,n,r,i,o),this}star(t,e,n,r,i=0,o=0){return this._tick++,this._activePath.star(t,e,n,r,i,o,this._transform.clone()),this}svg(t){return this._tick++,qd(t,this),this}restore(){const t=this._stateStack.pop();return t&&(this._transform=t.transform,this._fillStyle=t.fillStyle,this._strokeStyle=t.strokeStyle),this}save(){return this._stateStack.push({transform:this._transform.clone(),fillStyle:{...this._fillStyle},strokeStyle:{...this._strokeStyle}}),this}getTransform(){return this._transform}resetTransform(){return this._transform.identity(),this}rotate(t){return this._transform.rotate(t),this}scale(t,e=t){return this._transform.scale(t,e),this}setTransform(t,e,n,r,i,o){return t instanceof X?(this._transform.set(t.a,t.b,t.c,t.d,t.tx,t.ty),this):(this._transform.set(t,e,n,r,i,o),this)}transform(t,e,n,r,i,o){return t instanceof X?(this._transform.append(t),this):(ho.set(t,e,n,r,i,o),this._transform.append(ho),this)}translate(t,e=t){return this._transform.translate(t,e),this}clear(){return this._activePath.clear(),this.instructions.length=0,this.resetTransform(),this.onUpdate(),this}onUpdate(){this.dirty||(this.emit("update",this,16),this.dirty=!0,this._boundsDirty=!0)}get bounds(){if(!this._boundsDirty)return this._bounds;const t=this._bounds;t.clear();for(let e=0;e<this.instructions.length;e++){const n=this.instructions[e],r=n.action;if(r==="fill"){const i=n.data;t.addBounds(i.path.bounds)}else if(r==="texture"){const i=n.data;t.addFrame(i.dx,i.dy,i.dx+i.dw,i.dy+i.dh,i.transform)}if(r==="stroke"){const i=n.data,o=i.style.alignment,a=i.style.width*(1-o),l=i.path.bounds;t.addFrame(l.minX-a,l.minY-a,l.maxX+a,l.maxY+a)}}return t}containsPoint(t){var r;if(!this.bounds.containsPoint(t.x,t.y))return!1;const e=this.instructions;let n=!1;for(let i=0;i<e.length;i++){const o=e[i],a=o.data,l=a.path;if(!o.action||!l)continue;const h=a.style,c=l.shapePath.shapePrimitives;for(let u=0;u<c.length;u++){const f=c[u].shape;if(!h||!f)continue;const d=c[u].transform,p=d?d.applyInverse(t,ef):t;if(o.action==="fill")n=f.contains(p.x,p.y);else{const m=h;n=f.strokeContains(p.x,p.y,m.width,m.alignment)}const g=a.hole;if(g){const m=(r=g.shapePath)==null?void 0:r.shapePrimitives;if(m)for(let x=0;x<m.length;x++)m[x].shape.contains(p.x,p.y)&&(n=!1)}if(n)return!0}}return n}destroy(t=!1){if(this._stateStack.length=0,this._transform=null,this.emit("destroy",this),this.removeAllListeners(),typeof t=="boolean"?t:t==null?void 0:t.texture){const n=typeof t=="boolean"?t:t==null?void 0:t.textureSource;this._fillStyle.texture&&this._fillStyle.texture.destroy(n),this._strokeStyle.texture&&this._strokeStyle.texture.destroy(n)}this._fillStyle=null,this._strokeStyle=null,this.instructions=null,this._activePath=null,this._bounds=null,this._stateStack=null,this.customShader=null,this._transform=null}};qr.defaultFillStyle={color:16777215,alpha:1,texture:$.WHITE,matrix:null,fill:null,textureSpace:"local"};qr.defaultStrokeStyle={width:1,color:16777215,alpha:1,alignment:.5,miterLimit:10,cap:"butt",join:"miter",texture:$.WHITE,matrix:null,fill:null,textureSpace:"local",pixelLine:!1};let Bt=qr;const uo=["align","breakWords","cssOverrides","fontVariant","fontWeight","leading","letterSpacing","lineHeight","padding","textBaseline","trim","whiteSpace","wordWrap","wordWrapWidth","fontFamily","fontStyle","fontSize"];function sf(s){const t=[];let e=0;for(let n=0;n<uo.length;n++){const r=`_${uo[n]}`;t[e++]=s[r]}return e=hl(s._fill,t,e),e=rf(s._stroke,t,e),e=of(s.dropShadow,t,e),e=nf(s.filters,t,e),t.join("-")}function nf(s,t,e){if(!s)return e;for(const n of s)t[e++]=n.uid;return e}function hl(s,t,e){var n;return s&&(t[e++]=s.color,t[e++]=s.alpha,t[e++]=(n=s.fill)==null?void 0:n.styleKey),e}function rf(s,t,e){return s&&(e=hl(s,t,e),t[e++]=s.width,t[e++]=s.alignment,t[e++]=s.cap,t[e++]=s.join,t[e++]=s.miterLimit),e}function of(s,t,e){return s&&(t[e++]=s.alpha,t[e++]=s.angle,t[e++]=s.blur,t[e++]=s.distance,t[e++]=ot.shared.setValue(s.color).toNumber()),e}const Kr=class He extends Wt{constructor(t={}){super(),af(t);const e={...He.defaultTextStyle,...t};for(const n in e){const r=n;this[r]=e[n]}this.update()}get align(){return this._align}set align(t){this._align=t,this.update()}get breakWords(){return this._breakWords}set breakWords(t){this._breakWords=t,this.update()}get dropShadow(){return this._dropShadow}set dropShadow(t){t!==null&&typeof t=="object"?this._dropShadow=this._createProxy({...He.defaultDropShadow,...t}):this._dropShadow=t?this._createProxy({...He.defaultDropShadow}):null,this.update()}get fontFamily(){return this._fontFamily}set fontFamily(t){this._fontFamily=t,this.update()}get fontSize(){return this._fontSize}set fontSize(t){typeof t=="string"?this._fontSize=parseInt(t,10):this._fontSize=t,this.update()}get fontStyle(){return this._fontStyle}set fontStyle(t){this._fontStyle=t.toLowerCase(),this.update()}get fontVariant(){return this._fontVariant}set fontVariant(t){this._fontVariant=t,this.update()}get fontWeight(){return this._fontWeight}set fontWeight(t){this._fontWeight=t,this.update()}get leading(){return this._leading}set leading(t){this._leading=t,this.update()}get letterSpacing(){return this._letterSpacing}set letterSpacing(t){this._letterSpacing=t,this.update()}get lineHeight(){return this._lineHeight}set lineHeight(t){this._lineHeight=t,this.update()}get padding(){return this._padding}set padding(t){this._padding=t,this.update()}get filters(){return this._filters}set filters(t){this._filters=t,this.update()}get trim(){return this._trim}set trim(t){this._trim=t,this.update()}get textBaseline(){return this._textBaseline}set textBaseline(t){this._textBaseline=t,this.update()}get whiteSpace(){return this._whiteSpace}set whiteSpace(t){this._whiteSpace=t,this.update()}get wordWrap(){return this._wordWrap}set wordWrap(t){this._wordWrap=t,this.update()}get wordWrapWidth(){return this._wordWrapWidth}set wordWrapWidth(t){this._wordWrapWidth=t,this.update()}get fill(){return this._originalFill}set fill(t){t!==this._originalFill&&(this._originalFill=t,this._isFillStyle(t)&&(this._originalFill=this._createProxy({...Bt.defaultFillStyle,...t},()=>{this._fill=Ee({...this._originalFill},Bt.defaultFillStyle)})),this._fill=Ee(t===0?"black":t,Bt.defaultFillStyle),this.update())}get stroke(){return this._originalStroke}set stroke(t){t!==this._originalStroke&&(this._originalStroke=t,this._isFillStyle(t)&&(this._originalStroke=this._createProxy({...Bt.defaultStrokeStyle,...t},()=>{this._stroke=Js({...this._originalStroke},Bt.defaultStrokeStyle)})),this._stroke=Js(t,Bt.defaultStrokeStyle),this.update())}_generateKey(){return this._styleKey=sf(this),this._styleKey}update(){this._styleKey=null,this.emit("update",this)}reset(){const t=He.defaultTextStyle;for(const e in t)this[e]=t[e]}get styleKey(){return this._styleKey||this._generateKey()}clone(){return new He({align:this.align,breakWords:this.breakWords,dropShadow:this._dropShadow?{...this._dropShadow}:null,fill:this._fill,fontFamily:this.fontFamily,fontSize:this.fontSize,fontStyle:this.fontStyle,fontVariant:this.fontVariant,fontWeight:this.fontWeight,leading:this.leading,letterSpacing:this.letterSpacing,lineHeight:this.lineHeight,padding:this.padding,stroke:this._stroke,textBaseline:this.textBaseline,whiteSpace:this.whiteSpace,wordWrap:this.wordWrap,wordWrapWidth:this.wordWrapWidth,filters:this._filters?[...this._filters]:void 0})}_getFinalPadding(){let t=0;if(this._filters)for(let e=0;e<this._filters.length;e++)t+=this._filters[e].padding;return Math.max(this._padding,t)}destroy(t=!1){var n,r,i,o;if(this.removeAllListeners(),typeof t=="boolean"?t:t==null?void 0:t.texture){const a=typeof t=="boolean"?t:t==null?void 0:t.textureSource;(n=this._fill)!=null&&n.texture&&this._fill.texture.destroy(a),(r=this._originalFill)!=null&&r.texture&&this._originalFill.texture.destroy(a),(i=this._stroke)!=null&&i.texture&&this._stroke.texture.destroy(a),(o=this._originalStroke)!=null&&o.texture&&this._originalStroke.texture.destroy(a)}this._fill=null,this._stroke=null,this.dropShadow=null,this._originalStroke=null,this._originalFill=null}_createProxy(t,e){return new Proxy(t,{set:(n,r,i)=>(n[r]=i,e==null||e(r,i),this.update(),!0)})}_isFillStyle(t){return(t??null)!==null&&!(ot.isColorLike(t)||t instanceof ce||t instanceof fn)}};Kr.defaultDropShadow={alpha:1,angle:Math.PI/6,blur:0,color:"black",distance:5};Kr.defaultTextStyle={align:"left",breakWords:!1,dropShadow:null,fill:"black",fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",leading:0,letterSpacing:0,lineHeight:0,padding:0,stroke:null,textBaseline:"alphabetic",trim:!1,whiteSpace:"pre",wordWrap:!1,wordWrapWidth:100};let kt=Kr;function af(s){const t=s;if(typeof t.dropShadow=="boolean"&&t.dropShadow){const e=kt.defaultDropShadow;s.dropShadow={alpha:t.dropShadowAlpha??e.alpha,angle:t.dropShadowAngle??e.angle,blur:t.dropShadowBlur??e.blur,color:t.dropShadowColor??e.color,distance:t.dropShadowDistance??e.distance}}if(t.strokeThickness!==void 0){V(Z,"strokeThickness is now a part of stroke");const e=t.stroke;let n={};if(ot.isColorLike(e))n.color=e;else if(e instanceof ce||e instanceof fn)n.fill=e;else if(Object.hasOwnProperty.call(e,"color")||Object.hasOwnProperty.call(e,"fill"))n=e;else throw new Error("Invalid stroke value.");s.stroke={...n,width:t.strokeThickness}}if(Array.isArray(t.fillGradientStops)){V(Z,"gradient fill is now a fill pattern: `new FillGradient(...)`");let e;s.fontSize==null?s.fontSize=kt.defaultTextStyle.fontSize:typeof s.fontSize=="string"?e=parseInt(s.fontSize,10):e=s.fontSize;const n=new ce({start:{x:0,y:0},end:{x:0,y:(e||0)*1.7}}),r=t.fillGradientStops.map(i=>ot.shared.setValue(i).toNumber());r.forEach((i,o)=>{const a=o/(r.length-1);n.addColorStop(a,i)}),s.fill={fill:n}}}class lf{constructor(t){this._canvasPool=Object.create(null),this.canvasOptions=t||{},this.enableFullScreen=!1}_createCanvasAndContext(t,e){const n=at.get().createCanvas();n.width=t,n.height=e;const r=n.getContext("2d");return{canvas:n,context:r}}getOptimalCanvasAndContext(t,e,n=1){t=Math.ceil(t*n-1e-6),e=Math.ceil(e*n-1e-6),t=$e(t),e=$e(e);const r=(t<<17)+(e<<1);this._canvasPool[r]||(this._canvasPool[r]=[]);let i=this._canvasPool[r].pop();return i||(i=this._createCanvasAndContext(t,e)),i}returnCanvasAndContext(t){const e=t.canvas,{width:n,height:r}=e,i=(n<<17)+(r<<1);t.context.clearRect(0,0,n,r),this._canvasPool[i].push(t)}clear(){this._canvasPool={}}}const tn=new lf,fo=1e5;function en(s,t,e,n=0){if(s.texture===$.WHITE&&!s.fill)return ot.shared.setValue(s.color).setAlpha(s.alpha??1).toHexa();if(s.fill){if(s.fill instanceof fn){const r=s.fill,i=t.createPattern(r.texture.source.resource,"repeat"),o=r.transform.copyTo(X.shared);return o.scale(r.texture.frame.width,r.texture.frame.height),i.setTransform(o),i}else if(s.fill instanceof ce){const r=s.fill,i=r.type==="linear",o=r.textureSpace==="local";let a=1,l=1;o&&e&&(a=e.width+n,l=e.height+n);let h,c=!1;if(i){const{start:u,end:f}=r;h=t.createLinearGradient(u.x*a,u.y*l,f.x*a,f.y*l),c=Math.abs(f.x-u.x)<Math.abs((f.y-u.y)*.1)}else{const{center:u,innerRadius:f,outerCenter:d,outerRadius:p}=r;h=t.createRadialGradient(u.x*a,u.y*l,f*a,d.x*a,d.y*l,p*a)}if(c&&o&&e){const u=e.lineHeight/l;for(let f=0;f<e.lines.length;f++){const d=(f*e.lineHeight+n/2)/l;r.colorStops.forEach(p=>{const g=d+p.offset*u;h.addColorStop(Math.floor(g*fo)/fo,ot.shared.setValue(p.color).toHex())})}}else r.colorStops.forEach(u=>{h.addColorStop(u.offset,ot.shared.setValue(u.color).toHex())});return h}}else{const r=t.createPattern(s.texture.source.resource,"repeat"),i=s.matrix.copyTo(X.shared);return i.scale(s.texture.frame.width,s.texture.frame.height),r.setTransform(i),r}return it("FillStyle not recognised",s),"red"}const ul=class dl extends $a{constructor(t){super(),this.resolution=1,this.pages=[],this._padding=0,this._measureCache=Object.create(null),this._currentChars=[],this._currentX=0,this._currentY=0,this._currentMaxCharHeight=0,this._currentPageIndex=-1,this._skipKerning=!1;const e={...dl.defaultOptions,...t};this._textureSize=e.textureSize,this._mipmap=e.mipmap;const n=e.style.clone();e.overrideFill&&(n._fill.color=16777215,n._fill.alpha=1,n._fill.texture=$.WHITE,n._fill.fill=null),this.applyFillAsTint=e.overrideFill;const r=n.fontSize;n.fontSize=this.baseMeasurementFontSize;const i=Qs(n);e.overrideSize?n._stroke&&(n._stroke.width*=this.baseRenderedFontSize/r):n.fontSize=this.baseRenderedFontSize=r,this._style=n,this._skipKerning=e.skipKerning??!1,this.resolution=e.resolution??1,this._padding=e.padding??4,e.textureStyle&&(this._textureStyle=e.textureStyle instanceof Ve?e.textureStyle:new Ve(e.textureStyle)),this.fontMetrics=qt.measureFont(i),this.lineHeight=n.lineHeight||this.fontMetrics.fontSize||n.fontSize}ensureCharacters(t){var m,x;const e=qt.graphemeSegmenter(t).filter(y=>!this._currentChars.includes(y)).filter((y,b,w)=>w.indexOf(y)===b);if(!e.length)return;this._currentChars=[...this._currentChars,...e];let n;this._currentPageIndex===-1?n=this._nextPage():n=this.pages[this._currentPageIndex];let{canvas:r,context:i}=n.canvasAndContext,o=n.texture.source;const a=this._style;let l=this._currentX,h=this._currentY,c=this._currentMaxCharHeight;const u=this.baseRenderedFontSize/this.baseMeasurementFontSize,f=this._padding*u;let d=!1;const p=r.width/this.resolution,g=r.height/this.resolution;for(let y=0;y<e.length;y++){const b=e[y],w=qt.measureText(b,a,r,!1);w.lineHeight=w.height;const _=w.width*u,A=Math.ceil((a.fontStyle==="italic"?2:1)*_),C=w.height*u,P=A+f*2,v=C+f*2;if(d=!1,b!==`
`&&b!=="\r"&&b!=="	"&&b!==" "&&(d=!0,c=Math.ceil(Math.max(v,c))),l+P>p&&(h+=c,c=v,l=0,h+c>g)){o.update();const S=this._nextPage();r=S.canvasAndContext.canvas,i=S.canvasAndContext.context,o=S.texture.source,l=0,h=0,c=0}const k=_/u-(((m=a.dropShadow)==null?void 0:m.distance)??0)-(((x=a._stroke)==null?void 0:x.width)??0);if(this.chars[b]={id:b.codePointAt(0),xOffset:-this._padding,yOffset:-this._padding,xAdvance:k,kerning:{}},d){this._drawGlyph(i,w,l+f,h+f,u,a);const S=o.width*u,M=o.height*u,E=new q(l/S*o.width,h/M*o.height,P/S*o.width,v/M*o.height);this.chars[b].texture=new $({source:o,frame:E}),l+=Math.ceil(P)}}o.update(),this._currentX=l,this._currentY=h,this._currentMaxCharHeight=c,this._skipKerning&&this._applyKerning(e,i)}get pageTextures(){return V(Z,"BitmapFont.pageTextures is deprecated, please use BitmapFont.pages instead."),this.pages}_applyKerning(t,e){const n=this._measureCache;for(let r=0;r<t.length;r++){const i=t[r];for(let o=0;o<this._currentChars.length;o++){const a=this._currentChars[o];let l=n[i];l||(l=n[i]=e.measureText(i).width);let h=n[a];h||(h=n[a]=e.measureText(a).width);let c=e.measureText(i+a).width,u=c-(l+h);u&&(this.chars[i].kerning[a]=u),c=e.measureText(i+a).width,u=c-(l+h),u&&(this.chars[a].kerning[i]=u)}}}_nextPage(){this._currentPageIndex++;const t=this.resolution,e=tn.getOptimalCanvasAndContext(this._textureSize,this._textureSize,t);this._setupContext(e.context,this._style,t);const n=t*(this.baseRenderedFontSize/this.baseMeasurementFontSize),r=new $({source:new ze({resource:e.canvas,resolution:n,alphaMode:"premultiply-alpha-on-upload",autoGenerateMipmaps:this._mipmap})});this._textureStyle&&(r.source.style=this._textureStyle);const i={canvasAndContext:e,texture:r};return this.pages[this._currentPageIndex]=i,i}_setupContext(t,e,n){e.fontSize=this.baseRenderedFontSize,t.scale(n,n),t.font=Qs(e),e.fontSize=this.baseMeasurementFontSize,t.textBaseline=e.textBaseline;const r=e._stroke,i=(r==null?void 0:r.width)??0;if(r&&(t.lineWidth=i,t.lineJoin=r.join,t.miterLimit=r.miterLimit,t.strokeStyle=en(r,t)),e._fill&&(t.fillStyle=en(e._fill,t)),e.dropShadow){const o=e.dropShadow,a=ot.shared.setValue(o.color).toArray(),l=o.blur*n,h=o.distance*n;t.shadowColor=`rgba(${a[0]*255},${a[1]*255},${a[2]*255},${o.alpha})`,t.shadowBlur=l,t.shadowOffsetX=Math.cos(o.angle)*h,t.shadowOffsetY=Math.sin(o.angle)*h}else t.shadowColor="black",t.shadowBlur=0,t.shadowOffsetX=0,t.shadowOffsetY=0}_drawGlyph(t,e,n,r,i,o){const a=e.text,l=e.fontProperties,h=o._stroke,c=((h==null?void 0:h.width)??0)*i,u=n+c/2,f=r-c/2,d=l.descent*i,p=e.lineHeight*i;o.stroke&&c&&t.strokeText(a,u,f+p-d),o._fill&&t.fillText(a,u,f+p-d)}destroy(){super.destroy();for(let t=0;t<this.pages.length;t++){const{canvasAndContext:e,texture:n}=this.pages[t];tn.returnCanvasAndContext(e),n.destroy(!0)}this.pages=null}};ul.defaultOptions={textureSize:512,style:new kt,mipmap:!0};let po=ul;function cf(s,t,e,n){const r={width:0,height:0,offsetY:0,scale:t.fontSize/e.baseMeasurementFontSize,lines:[{width:0,charPositions:[],spaceWidth:0,spacesIndex:[],chars:[]}]};r.offsetY=e.baseLineOffset;let i=r.lines[0],o=null,a=!0;const l={width:0,start:0,index:0,positions:[],chars:[]},h=p=>{const g=i.width;for(let m=0;m<l.index;m++){const x=p.positions[m];i.chars.push(p.chars[m]),i.charPositions.push(x+g)}i.width+=p.width,a=!1,l.width=0,l.index=0,l.chars.length=0},c=()=>{let p=i.chars.length-1;if(n){let g=i.chars[p];for(;g===" ";)i.width-=e.chars[g].xAdvance,g=i.chars[--p]}r.width=Math.max(r.width,i.width),i={width:0,charPositions:[],chars:[],spaceWidth:0,spacesIndex:[]},a=!0,r.lines.push(i),r.height+=e.lineHeight},u=e.baseMeasurementFontSize/t.fontSize,f=t.letterSpacing*u,d=t.wordWrapWidth*u;for(let p=0;p<s.length+1;p++){let g;const m=p===s.length;m||(g=s[p]);const x=e.chars[g]||e.chars[" "];if(/(?:\s)/.test(g)||g==="\r"||g===`
`||m){if(!a&&t.wordWrap&&i.width+l.width-f>d?(c(),h(l),m||i.charPositions.push(0)):(l.start=i.width,h(l),m||i.charPositions.push(0)),g==="\r"||g===`
`)i.width!==0&&c();else if(!m){const _=x.xAdvance+(x.kerning[o]||0)+f;i.width+=_,i.spaceWidth=_,i.spacesIndex.push(i.charPositions.length),i.chars.push(g)}}else{const w=x.kerning[o]||0,_=x.xAdvance+w+f;l.positions[l.index++]=l.width+w,l.chars.push(g),l.width+=_}o=g}return c(),t.align==="center"?hf(r):t.align==="right"?uf(r):t.align==="justify"&&df(r),r}function hf(s){for(let t=0;t<s.lines.length;t++){const e=s.lines[t],n=s.width/2-e.width/2;for(let r=0;r<e.charPositions.length;r++)e.charPositions[r]+=n}}function uf(s){for(let t=0;t<s.lines.length;t++){const e=s.lines[t],n=s.width-e.width;for(let r=0;r<e.charPositions.length;r++)e.charPositions[r]+=n}}function df(s){const t=s.width;for(let e=0;e<s.lines.length;e++){const n=s.lines[e];let r=0,i=n.spacesIndex[r++],o=0;const a=n.spacesIndex.length,h=(t-n.width)/a;for(let c=0;c<n.charPositions.length;c++)c===i&&(i=n.spacesIndex[r++],o+=h),n.charPositions[c]+=o}}function ff(s){if(s==="")return[];typeof s=="string"&&(s=[s]);const t=[];for(let e=0,n=s.length;e<n;e++){const r=s[e];if(Array.isArray(r)){if(r.length!==2)throw new Error(`[BitmapFont]: Invalid character range length, expecting 2 got ${r.length}.`);if(r[0].length===0||r[1].length===0)throw new Error("[BitmapFont]: Invalid character delimiter.");const i=r[0].charCodeAt(0),o=r[1].charCodeAt(0);if(o<i)throw new Error("[BitmapFont]: Invalid character range.");for(let a=i,l=o;a<=l;a++)t.push(String.fromCharCode(a))}else t.push(...Array.from(r))}if(t.length===0)throw new Error("[BitmapFont]: Empty set when resolving characters.");return t}let Gs=0;class pf{constructor(){this.ALPHA=[["a","z"],["A","Z"]," "],this.NUMERIC=[["0","9"]],this.ALPHANUMERIC=[["a","z"],["A","Z"],["0","9"]," "],this.ASCII=[[" ","~"]],this.defaultOptions={chars:this.ALPHANUMERIC,resolution:1,padding:4,skipKerning:!1,textureStyle:null}}getFont(t,e){var o;let n=`${e.fontFamily}-bitmap`,r=!0;if(e._fill.fill&&!e._stroke)n+=e._fill.fill.styleKey,r=!1;else if(e._stroke||e.dropShadow){let a=e.styleKey;a=a.substring(0,a.lastIndexOf("-")),n=`${a}-bitmap`,r=!1}if(!rt.has(n)){const a=new po({style:e,overrideFill:r,overrideSize:!0,...this.defaultOptions});Gs++,Gs>50&&it("BitmapText",`You have dynamically created ${Gs} bitmap fonts, this can be inefficient. Try pre installing your font styles using \`BitmapFont.install({name:"style1", style})\``),a.once("destroy",()=>{Gs--,rt.remove(n)}),rt.set(n,a)}const i=rt.get(n);return(o=i.ensureCharacters)==null||o.call(i,t),i}getLayout(t,e,n=!0){const r=this.getFont(t,e),i=qt.graphemeSegmenter(t);return cf(i,e,r,n)}measureText(t,e,n=!0){return this.getLayout(t,e,n)}install(...t){var h,c,u,f;let e=t[0];typeof e=="string"&&(e={name:e,style:t[1],chars:(h=t[2])==null?void 0:h.chars,resolution:(c=t[2])==null?void 0:c.resolution,padding:(u=t[2])==null?void 0:u.padding,skipKerning:(f=t[2])==null?void 0:f.skipKerning},V(Z,"BitmapFontManager.install(name, style, options) is deprecated, use BitmapFontManager.install({name, style, ...options})"));const n=e==null?void 0:e.name;if(!n)throw new Error("[BitmapFontManager] Property `name` is required.");e={...this.defaultOptions,...e};const r=e.style,i=r instanceof kt?r:new kt(r),o=i._fill.fill!==null&&i._fill.fill!==void 0,a=new po({style:i,overrideFill:o,skipKerning:e.skipKerning,padding:e.padding,resolution:e.resolution,overrideSize:!1,textureStyle:e.textureStyle}),l=ff(e.chars);return a.ensureCharacters(l.join("")),rt.set(`${n}-bitmap`,a),a.once("destroy",()=>rt.remove(`${n}-bitmap`)),a}uninstall(t){const e=`${t}-bitmap`,n=rt.get(e);n&&n.destroy()}}const mo=new pf;class fl extends $a{constructor(t,e){super();const{textures:n,data:r}=t;Object.keys(r.pages).forEach(i=>{const o=r.pages[parseInt(i,10)],a=n[o.id];this.pages.push({texture:a})}),Object.keys(r.chars).forEach(i=>{const o=r.chars[i],{frame:a,source:l}=n[o.page],h=new q(o.x+a.x,o.y+a.y,o.width,o.height),c=new $({source:l,frame:h});this.chars[i]={id:i.codePointAt(0),xOffset:o.xOffset,yOffset:o.yOffset,xAdvance:o.xAdvance,kerning:o.kerning??{},texture:c}}),this.baseRenderedFontSize=r.fontSize,this.baseMeasurementFontSize=r.fontSize,this.fontMetrics={ascent:0,descent:0,fontSize:r.fontSize},this.baseLineOffset=r.baseLineOffset,this.lineHeight=r.lineHeight,this.fontFamily=r.fontFamily,this.distanceField=r.distanceField??{type:"none",range:0},this.url=e}destroy(){super.destroy();for(let t=0;t<this.pages.length;t++){const{texture:e}=this.pages[t];e.destroy(!0)}this.pages=null}static install(t){mo.install(t)}static uninstall(t){mo.uninstall(t)}}const Qn={test(s){return typeof s=="string"&&s.startsWith("info face=")},parse(s){const t=s.match(/^[a-z]+\s+.+$/gm),e={info:[],common:[],page:[],char:[],chars:[],kerning:[],kernings:[],distanceField:[]};for(const u in t){const f=t[u].match(/^[a-z]+/gm)[0],d=t[u].match(/[a-zA-Z]+=([^\s"']+|"([^"]*)")/gm),p={};for(const g in d){const m=d[g].split("="),x=m[0],y=m[1].replace(/"/gm,""),b=parseFloat(y),w=isNaN(b)?y:b;p[x]=w}e[f].push(p)}const n={chars:{},pages:[],lineHeight:0,fontSize:0,fontFamily:"",distanceField:null,baseLineOffset:0},[r]=e.info,[i]=e.common,[o]=e.distanceField??[];o&&(n.distanceField={range:parseInt(o.distanceRange,10),type:o.fieldType}),n.fontSize=parseInt(r.size,10),n.fontFamily=r.face,n.lineHeight=parseInt(i.lineHeight,10);const a=e.page;for(let u=0;u<a.length;u++)n.pages.push({id:parseInt(a[u].id,10)||0,file:a[u].file});const l={};n.baseLineOffset=n.lineHeight-parseInt(i.base,10);const h=e.char;for(let u=0;u<h.length;u++){const f=h[u],d=parseInt(f.id,10);let p=f.letter??f.char??String.fromCharCode(d);p==="space"&&(p=" "),l[d]=p,n.chars[p]={id:d,page:parseInt(f.page,10)||0,x:parseInt(f.x,10),y:parseInt(f.y,10),width:parseInt(f.width,10),height:parseInt(f.height,10),xOffset:parseInt(f.xoffset,10),yOffset:parseInt(f.yoffset,10),xAdvance:parseInt(f.xadvance,10),kerning:{}}}const c=e.kerning||[];for(let u=0;u<c.length;u++){const f=parseInt(c[u].first,10),d=parseInt(c[u].second,10),p=parseInt(c[u].amount,10);n.chars[l[d]].kerning[l[f]]=p}return n}},go={test(s){const t=s;return typeof t!="string"&&"getElementsByTagName"in t&&t.getElementsByTagName("page").length&&t.getElementsByTagName("info")[0].getAttribute("face")!==null},parse(s){const t={chars:{},pages:[],lineHeight:0,fontSize:0,fontFamily:"",distanceField:null,baseLineOffset:0},e=s.getElementsByTagName("info")[0],n=s.getElementsByTagName("common")[0],r=s.getElementsByTagName("distanceField")[0];r&&(t.distanceField={type:r.getAttribute("fieldType"),range:parseInt(r.getAttribute("distanceRange"),10)});const i=s.getElementsByTagName("page"),o=s.getElementsByTagName("char"),a=s.getElementsByTagName("kerning");t.fontSize=parseInt(e.getAttribute("size"),10),t.fontFamily=e.getAttribute("face"),t.lineHeight=parseInt(n.getAttribute("lineHeight"),10);for(let h=0;h<i.length;h++)t.pages.push({id:parseInt(i[h].getAttribute("id"),10)||0,file:i[h].getAttribute("file")});const l={};t.baseLineOffset=t.lineHeight-parseInt(n.getAttribute("base"),10);for(let h=0;h<o.length;h++){const c=o[h],u=parseInt(c.getAttribute("id"),10);let f=c.getAttribute("letter")??c.getAttribute("char")??String.fromCharCode(u);f==="space"&&(f=" "),l[u]=f,t.chars[f]={id:u,page:parseInt(c.getAttribute("page"),10)||0,x:parseInt(c.getAttribute("x"),10),y:parseInt(c.getAttribute("y"),10),width:parseInt(c.getAttribute("width"),10),height:parseInt(c.getAttribute("height"),10),xOffset:parseInt(c.getAttribute("xoffset"),10),yOffset:parseInt(c.getAttribute("yoffset"),10),xAdvance:parseInt(c.getAttribute("xadvance"),10),kerning:{}}}for(let h=0;h<a.length;h++){const c=parseInt(a[h].getAttribute("first"),10),u=parseInt(a[h].getAttribute("second"),10),f=parseInt(a[h].getAttribute("amount"),10);t.chars[l[u]].kerning[l[c]]=f}return t}},xo={test(s){return typeof s=="string"&&s.includes("<font>")?go.test(at.get().parseXML(s)):!1},parse(s){return go.parse(at.get().parseXML(s))}},mf=[".xml",".fnt"],gf={extension:{type:N.CacheParser,name:"cacheBitmapFont"},test:s=>s instanceof fl,getCacheableAssets(s,t){const e={};return s.forEach(n=>{e[n]=t,e[`${n}-bitmap`]=t}),e[`${t.fontFamily}-bitmap`]=t,e}},xf={extension:{type:N.LoadParser,priority:xe.Normal},name:"loadBitmapFont",test(s){return mf.includes(Ct.extname(s).toLowerCase())},async testParse(s){return Qn.test(s)||xo.test(s)},async parse(s,t,e){const n=Qn.test(s)?Qn.parse(s):xo.parse(s),{src:r}=t,{pages:i}=n,o=[],a=n.distanceField?{scaleMode:"linear",alphaMode:"premultiply-alpha-on-upload",autoGenerateMipmaps:!1,resolution:1}:{};for(let u=0;u<i.length;++u){const f=i[u].file;let d=Ct.join(Ct.dirname(r),f);d=xr(d,r),o.push({src:d,data:a})}const l=await e.load(o),h=o.map(u=>l[u.src]);return new fl({data:n,textures:h},r)},async load(s,t){return await(await at.get().fetch(s)).text()},async unload(s,t,e){await Promise.all(s.pages.map(n=>e.unload(n.texture.source._sourceOrigin))),s.destroy()}};class yf{constructor(t,e=!1){this._loader=t,this._assetList=[],this._isLoading=!1,this._maxConcurrent=1,this.verbose=e}add(t){t.forEach(e=>{this._assetList.push(e)}),this.verbose&&console.log("[BackgroundLoader] assets: ",this._assetList),this._isActive&&!this._isLoading&&this._next()}async _next(){if(this._assetList.length&&this._isActive){this._isLoading=!0;const t=[],e=Math.min(this._assetList.length,this._maxConcurrent);for(let n=0;n<e;n++)t.push(this._assetList.pop());await this._loader.load(t),this._isLoading=!1,this._next()}}get active(){return this._isActive}set active(t){this._isActive!==t&&(this._isActive=t,t&&!this._isLoading&&this._next())}}const bf={extension:{type:N.CacheParser,name:"cacheTextureArray"},test:s=>Array.isArray(s)&&s.every(t=>t instanceof $),getCacheableAssets:(s,t)=>{const e={};return s.forEach(n=>{t.forEach((r,i)=>{e[n+(i===0?"":i+1)]=r})}),e}};async function pl(s){if("Image"in globalThis)return new Promise(t=>{const e=new Image;e.onload=()=>{t(!0)},e.onerror=()=>{t(!1)},e.src=s});if("createImageBitmap"in globalThis&&"fetch"in globalThis){try{const t=await(await fetch(s)).blob();await createImageBitmap(t)}catch{return!1}return!0}return!1}const wf={extension:{type:N.DetectionParser,priority:1},test:async()=>pl("data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAAB0AAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAIAAAACAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQ0MAAAAABNjb2xybmNseAACAAIAAYAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAACVtZGF0EgAKCBgANogQEAwgMg8f8D///8WfhwB8+ErK42A="),add:async s=>[...s,"avif"],remove:async s=>s.filter(t=>t!=="avif")},yo=["png","jpg","jpeg"],_f={extension:{type:N.DetectionParser,priority:-1},test:()=>Promise.resolve(!0),add:async s=>[...s,...yo],remove:async s=>s.filter(t=>!yo.includes(t))},vf="WorkerGlobalScope"in globalThis&&globalThis instanceof globalThis.WorkerGlobalScope;function Zr(s){return vf?!1:document.createElement("video").canPlayType(s)!==""}const Af={extension:{type:N.DetectionParser,priority:0},test:async()=>Zr("video/mp4"),add:async s=>[...s,"mp4","m4v"],remove:async s=>s.filter(t=>t!=="mp4"&&t!=="m4v")},Sf={extension:{type:N.DetectionParser,priority:0},test:async()=>Zr("video/ogg"),add:async s=>[...s,"ogv"],remove:async s=>s.filter(t=>t!=="ogv")},Cf={extension:{type:N.DetectionParser,priority:0},test:async()=>Zr("video/webm"),add:async s=>[...s,"webm"],remove:async s=>s.filter(t=>t!=="webm")},kf={extension:{type:N.DetectionParser,priority:0},test:async()=>pl("data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAAAAAAfQ//73v/+BiOh/AAA="),add:async s=>[...s,"webp"],remove:async s=>s.filter(t=>t!=="webp")};class Pf{constructor(){this._parsers=[],this._parsersValidated=!1,this.parsers=new Proxy(this._parsers,{set:(t,e,n)=>(this._parsersValidated=!1,t[e]=n,!0)}),this.promiseCache={}}reset(){this._parsersValidated=!1,this.promiseCache={}}_getLoadPromiseAndParser(t,e){const n={promise:null,parser:null};return n.promise=(async()=>{var o,a;let r=null,i=null;if(e.loadParser&&(i=this._parserHash[e.loadParser],i||it(`[Assets] specified load parser "${e.loadParser}" not found while loading ${t}`)),!i){for(let l=0;l<this.parsers.length;l++){const h=this.parsers[l];if(h.load&&((o=h.test)!=null&&o.call(h,t,e,this))){i=h;break}}if(!i)return it(`[Assets] ${t} could not be loaded as we don't know how to parse it, ensure the correct parser has been added`),null}r=await i.load(t,e,this),n.parser=i;for(let l=0;l<this.parsers.length;l++){const h=this.parsers[l];h.parse&&h.parse&&await((a=h.testParse)==null?void 0:a.call(h,r,e,this))&&(r=await h.parse(r,e,this)||r,n.parser=h)}return r})(),n}async load(t,e){this._parsersValidated||this._validateParsers();let n=0;const r={},i=Zs(t),o=Nt(t,h=>({alias:[h],src:h,data:{}})),a=o.length,l=o.map(async h=>{const c=Ct.toAbsolute(h.src);if(!r[h.src])try{this.promiseCache[c]||(this.promiseCache[c]=this._getLoadPromiseAndParser(c,h)),r[h.src]=await this.promiseCache[c].promise,e&&e(++n/a)}catch(u){throw delete this.promiseCache[c],delete r[h.src],new Error(`[Loader.load] Failed to load ${c}.
${u}`)}});return await Promise.all(l),i?r[o[0].src]:r}async unload(t){const n=Nt(t,r=>({alias:[r],src:r})).map(async r=>{var a,l;const i=Ct.toAbsolute(r.src),o=this.promiseCache[i];if(o){const h=await o.promise;delete this.promiseCache[i],await((l=(a=o.parser)==null?void 0:a.unload)==null?void 0:l.call(a,h,r,this))}});await Promise.all(n)}_validateParsers(){this._parsersValidated=!0,this._parserHash=this._parsers.filter(t=>t.name).reduce((t,e)=>(e.name?t[e.name]&&it(`[Assets] loadParser name conflict "${e.name}"`):it("[Assets] loadParser should have a name"),{...t,[e.name]:e}),{})}}function ts(s,t){if(Array.isArray(t)){for(const e of t)if(s.startsWith(`data:${e}`))return!0;return!1}return s.startsWith(`data:${t}`)}function es(s,t){const e=s.split("?")[0],n=Ct.extname(e).toLowerCase();return Array.isArray(t)?t.includes(n):n===t}const Mf=".json",Tf="application/json",Ef={extension:{type:N.LoadParser,priority:xe.Low},name:"loadJson",test(s){return ts(s,Tf)||es(s,Mf)},async load(s){return await(await at.get().fetch(s)).json()}},If=".txt",Bf="text/plain",Ff={name:"loadTxt",extension:{type:N.LoadParser,priority:xe.Low,name:"loadTxt"},test(s){return ts(s,Bf)||es(s,If)},async load(s){return await(await at.get().fetch(s)).text()}},Rf=["normal","bold","100","200","300","400","500","600","700","800","900"],Lf=[".ttf",".otf",".woff",".woff2"],zf=["font/ttf","font/otf","font/woff","font/woff2"],Gf=/^(--|-?[A-Z_])[0-9A-Z_-]*$/i;function Of(s){const t=Ct.extname(s),r=Ct.basename(s,t).replace(/(-|_)/g," ").toLowerCase().split(" ").map(a=>a.charAt(0).toUpperCase()+a.slice(1));let i=r.length>0;for(const a of r)if(!a.match(Gf)){i=!1;break}let o=r.join(" ");return i||(o=`"${o.replace(/[\\"]/g,"\\$&")}"`),o}const Nf=/^[0-9A-Za-z%:/?#\[\]@!\$&'()\*\+,;=\-._~]*$/;function Uf(s){return Nf.test(s)?s:encodeURI(s)}const Df={extension:{type:N.LoadParser,priority:xe.Low},name:"loadWebFont",test(s){return ts(s,zf)||es(s,Lf)},async load(s,t){var n,r,i;const e=at.get().getFontFaceSet();if(e){const o=[],a=((n=t.data)==null?void 0:n.family)??Of(s),l=((i=(r=t.data)==null?void 0:r.weights)==null?void 0:i.filter(c=>Rf.includes(c)))??["normal"],h=t.data??{};for(let c=0;c<l.length;c++){const u=l[c],f=new FontFace(a,`url(${Uf(s)})`,{...h,weight:u});await f.load(),e.add(f),o.push(f)}return rt.set(`${a}-and-url`,{url:s,fontFaces:o}),o.length===1?o[0]:o}return it("[loadWebFont] FontFace API is not supported. Skipping loading font"),null},unload(s){(Array.isArray(s)?s:[s]).forEach(t=>{rt.remove(`${t.family}-and-url`),at.get().getFontFaceSet().delete(t)})}};function Qr(s,t=1){var n;const e=(n=Qe.RETINA_PREFIX)==null?void 0:n.exec(s);return e?parseFloat(e[1]):t}function Jr(s,t,e){s.label=e,s._sourceOrigin=e;const n=new $({source:s,label:e}),r=()=>{delete t.promiseCache[e],rt.has(e)&&rt.remove(e)};return n.source.once("destroy",()=>{t.promiseCache[e]&&(it("[Assets] A TextureSource managed by Assets was destroyed instead of unloaded! Use Assets.unload() instead of destroying the TextureSource."),r())}),n.once("destroy",()=>{s.destroyed||(it("[Assets] A Texture managed by Assets was destroyed instead of unloaded! Use Assets.unload() instead of destroying the Texture."),r())}),n}const Hf=".svg",Wf="image/svg+xml",jf={extension:{type:N.LoadParser,priority:xe.Low,name:"loadSVG"},name:"loadSVG",config:{crossOrigin:"anonymous",parseAsGraphicsContext:!1},test(s){return ts(s,Wf)||es(s,Hf)},async load(s,t,e){var n;return((n=t.data)==null?void 0:n.parseAsGraphicsContext)??this.config.parseAsGraphicsContext?Vf(s):$f(s,t,e,this.config.crossOrigin)},unload(s){s.destroy(!0)}};async function $f(s,t,e,n){var m,x,y;const i=await(await at.get().fetch(s)).blob(),o=URL.createObjectURL(i),a=new Image;a.src=o,a.crossOrigin=n,await a.decode(),URL.revokeObjectURL(o);const l=document.createElement("canvas"),h=l.getContext("2d"),c=((m=t.data)==null?void 0:m.resolution)||Qr(s),u=((x=t.data)==null?void 0:x.width)??a.width,f=((y=t.data)==null?void 0:y.height)??a.height;l.width=u*c,l.height=f*c,h.drawImage(a,0,0,u*c,f*c);const{parseAsGraphicsContext:d,...p}=t.data??{},g=new ze({resource:l,alphaMode:"premultiply-alpha-on-upload",resolution:c,...p});return Jr(g,e,s)}async function Vf(s){const e=await(await at.get().fetch(s)).text(),n=new Bt;return n.svg(e),n}const Yf=`(function () {
    'use strict';

    const WHITE_PNG = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mP8/x8AAwMCAO+ip1sAAAAASUVORK5CYII=";
    async function checkImageBitmap() {
      try {
        if (typeof createImageBitmap !== "function")
          return false;
        const response = await fetch(WHITE_PNG);
        const imageBlob = await response.blob();
        const imageBitmap = await createImageBitmap(imageBlob);
        return imageBitmap.width === 1 && imageBitmap.height === 1;
      } catch (_e) {
        return false;
      }
    }
    void checkImageBitmap().then((result) => {
      self.postMessage(result);
    });

})();
`;let We=null,Ir=class{constructor(){We||(We=URL.createObjectURL(new Blob([Yf],{type:"application/javascript"}))),this.worker=new Worker(We)}};Ir.revokeObjectURL=function(){We&&(URL.revokeObjectURL(We),We=null)};const Xf=`(function () {
    'use strict';

    async function loadImageBitmap(url, alphaMode) {
      const response = await fetch(url);
      if (!response.ok) {
        throw new Error(\`[WorkerManager.loadImageBitmap] Failed to fetch \${url}: \${response.status} \${response.statusText}\`);
      }
      const imageBlob = await response.blob();
      return alphaMode === "premultiplied-alpha" ? createImageBitmap(imageBlob, { premultiplyAlpha: "none" }) : createImageBitmap(imageBlob);
    }
    self.onmessage = async (event) => {
      try {
        const imageBitmap = await loadImageBitmap(event.data.data[0], event.data.data[1]);
        self.postMessage({
          data: imageBitmap,
          uuid: event.data.uuid,
          id: event.data.id
        }, [imageBitmap]);
      } catch (e) {
        self.postMessage({
          error: e,
          uuid: event.data.uuid,
          id: event.data.id
        });
      }
    };

})();
`;let je=null;class ml{constructor(){je||(je=URL.createObjectURL(new Blob([Xf],{type:"application/javascript"}))),this.worker=new Worker(je)}}ml.revokeObjectURL=function(){je&&(URL.revokeObjectURL(je),je=null)};let bo=0,Jn;class qf{constructor(){this._initialized=!1,this._createdWorkers=0,this._workerPool=[],this._queue=[],this._resolveHash={}}isImageBitmapSupported(){return this._isImageBitmapSupported!==void 0?this._isImageBitmapSupported:(this._isImageBitmapSupported=new Promise(t=>{const{worker:e}=new Ir;e.addEventListener("message",n=>{e.terminate(),Ir.revokeObjectURL(),t(n.data)})}),this._isImageBitmapSupported)}loadImageBitmap(t,e){var n;return this._run("loadImageBitmap",[t,(n=e==null?void 0:e.data)==null?void 0:n.alphaMode])}async _initWorkers(){this._initialized||(this._initialized=!0)}_getWorker(){Jn===void 0&&(Jn=navigator.hardwareConcurrency||4);let t=this._workerPool.pop();return!t&&this._createdWorkers<Jn&&(this._createdWorkers++,t=new ml().worker,t.addEventListener("message",e=>{this._complete(e.data),this._returnWorker(e.target),this._next()})),t}_returnWorker(t){this._workerPool.push(t)}_complete(t){t.error!==void 0?this._resolveHash[t.uuid].reject(t.error):this._resolveHash[t.uuid].resolve(t.data),this._resolveHash[t.uuid]=null}async _run(t,e){await this._initWorkers();const n=new Promise((r,i)=>{this._queue.push({id:t,arguments:e,resolve:r,reject:i})});return this._next(),n}_next(){if(!this._queue.length)return;const t=this._getWorker();if(!t)return;const e=this._queue.pop(),n=e.id;this._resolveHash[bo]={resolve:e.resolve,reject:e.reject},t.postMessage({data:e.arguments,uuid:bo++,id:n})}}const wo=new qf,Kf=[".jpeg",".jpg",".png",".webp",".avif"],Zf=["image/jpeg","image/png","image/webp","image/avif"];async function Qf(s,t){var r;const e=await at.get().fetch(s);if(!e.ok)throw new Error(`[loadImageBitmap] Failed to fetch ${s}: ${e.status} ${e.statusText}`);const n=await e.blob();return((r=t==null?void 0:t.data)==null?void 0:r.alphaMode)==="premultiplied-alpha"?createImageBitmap(n,{premultiplyAlpha:"none"}):createImageBitmap(n)}const gl={name:"loadTextures",extension:{type:N.LoadParser,priority:xe.High,name:"loadTextures"},config:{preferWorkers:!0,preferCreateImageBitmap:!0,crossOrigin:"anonymous"},test(s){return ts(s,Zf)||es(s,Kf)},async load(s,t,e){var i;let n=null;globalThis.createImageBitmap&&this.config.preferCreateImageBitmap?this.config.preferWorkers&&await wo.isImageBitmapSupported()?n=await wo.loadImageBitmap(s,t):n=await Qf(s,t):n=await new Promise((o,a)=>{n=new Image,n.crossOrigin=this.config.crossOrigin,n.src=s,n.complete?o(n):(n.onload=()=>{o(n)},n.onerror=a)});const r=new ze({resource:n,alphaMode:"premultiply-alpha-on-upload",resolution:((i=t.data)==null?void 0:i.resolution)||Qr(s),...t.data});return Jr(r,e,s)},unload(s){s.destroy(!0)}},xl=[".mp4",".m4v",".webm",".ogg",".ogv",".h264",".avi",".mov"],Jf=xl.map(s=>`video/${s.substring(1)}`);function tp(s,t,e){e===void 0&&!t.startsWith("data:")?s.crossOrigin=sp(t):e!==!1&&(s.crossOrigin=typeof e=="string"?e:"anonymous")}function ep(s){return new Promise((t,e)=>{s.addEventListener("canplaythrough",n),s.addEventListener("error",r),s.load();function n(){i(),t()}function r(o){i(),e(o)}function i(){s.removeEventListener("canplaythrough",n),s.removeEventListener("error",r)}})}function sp(s,t=globalThis.location){if(s.startsWith("data:"))return"";t||(t=globalThis.location);const e=new URL(s,document.baseURI);return e.hostname!==t.hostname||e.port!==t.port||e.protocol!==t.protocol?"anonymous":""}const np={name:"loadVideo",extension:{type:N.LoadParser,name:"loadVideo"},test(s){const t=ts(s,Jf),e=es(s,xl);return t||e},async load(s,t,e){var l,h;const n={...Ys.defaultOptions,resolution:((l=t.data)==null?void 0:l.resolution)||Qr(s),alphaMode:((h=t.data)==null?void 0:h.alphaMode)||await ba(),...t.data},r=document.createElement("video"),i={preload:n.autoLoad!==!1?"auto":void 0,"webkit-playsinline":n.playsinline!==!1?"":void 0,playsinline:n.playsinline!==!1?"":void 0,muted:n.muted===!0?"":void 0,loop:n.loop===!0?"":void 0,autoplay:n.autoPlay!==!1?"":void 0};Object.keys(i).forEach(c=>{const u=i[c];u!==void 0&&r.setAttribute(c,u)}),n.muted===!0&&(r.muted=!0),tp(r,s,n.crossorigin);const o=document.createElement("source");let a;if(s.startsWith("data:"))a=s.slice(5,s.indexOf(";"));else if(!s.startsWith("blob:")){const c=s.split("?")[0].slice(s.lastIndexOf(".")+1).toLowerCase();a=Ys.MIME_TYPES[c]||`video/${c}`}return o.src=s,a&&(o.type=a),new Promise(c=>{const u=async()=>{const f=new Ys({...n,resource:r});r.removeEventListener("canplay",u),t.data.preload&&await ep(r),c(Jr(f,e,s))};n.preload&&!n.autoPlay&&r.load(),r.addEventListener("canplay",u),r.appendChild(o)})},unload(s){s.destroy(!0)}},yl={extension:{type:N.ResolveParser,name:"resolveTexture"},test:gl.test,parse:s=>{var t;return{resolution:parseFloat(((t=Qe.RETINA_PREFIX.exec(s))==null?void 0:t[1])??"1"),format:s.split(".").pop(),src:s}}},rp={extension:{type:N.ResolveParser,priority:-2,name:"resolveJson"},test:s=>Qe.RETINA_PREFIX.test(s)&&s.endsWith(".json"),parse:yl.parse};class ip{constructor(){this._detections=[],this._initialized=!1,this.resolver=new Qe,this.loader=new Pf,this.cache=rt,this._backgroundLoader=new yf(this.loader),this._backgroundLoader.active=!0,this.reset()}async init(t={}){var i,o;if(this._initialized){it("[Assets]AssetManager already initialized, did you load before calling this Assets.init()?");return}if(this._initialized=!0,t.defaultSearchParams&&this.resolver.setDefaultSearchParams(t.defaultSearchParams),t.basePath&&(this.resolver.basePath=t.basePath),t.bundleIdentifier&&this.resolver.setBundleIdentifier(t.bundleIdentifier),t.manifest){let a=t.manifest;typeof a=="string"&&(a=await this.load(a)),this.resolver.addManifest(a)}const e=((i=t.texturePreference)==null?void 0:i.resolution)??1,n=typeof e=="number"?[e]:e,r=await this._detectFormats({preferredFormats:(o=t.texturePreference)==null?void 0:o.format,skipDetections:t.skipDetections,detections:this._detections});this.resolver.prefer({params:{format:r,resolution:n}}),t.preferences&&this.setPreferences(t.preferences)}add(t){this.resolver.add(t)}async load(t,e){this._initialized||await this.init();const n=Zs(t),r=Nt(t).map(a=>{if(typeof a!="string"){const l=this.resolver.getAlias(a);return l.some(h=>!this.resolver.hasKey(h))&&this.add(a),Array.isArray(l)?l[0]:l}return this.resolver.hasKey(a)||this.add({alias:a,src:a}),a}),i=this.resolver.resolve(r),o=await this._mapLoadToResolve(i,e);return n?o[r[0]]:o}addBundle(t,e){this.resolver.addBundle(t,e)}async loadBundle(t,e){this._initialized||await this.init();let n=!1;typeof t=="string"&&(n=!0,t=[t]);const r=this.resolver.resolveBundle(t),i={},o=Object.keys(r);let a=0,l=0;const h=()=>{e==null||e(++a/l)},c=o.map(u=>{const f=r[u];return l+=Object.keys(f).length,this._mapLoadToResolve(f,h).then(d=>{i[u]=d})});return await Promise.all(c),n?i[t[0]]:i}async backgroundLoad(t){this._initialized||await this.init(),typeof t=="string"&&(t=[t]);const e=this.resolver.resolve(t);this._backgroundLoader.add(Object.values(e))}async backgroundLoadBundle(t){this._initialized||await this.init(),typeof t=="string"&&(t=[t]);const e=this.resolver.resolveBundle(t);Object.values(e).forEach(n=>{this._backgroundLoader.add(Object.values(n))})}reset(){this.resolver.reset(),this.loader.reset(),this.cache.reset(),this._initialized=!1}get(t){if(typeof t=="string")return rt.get(t);const e={};for(let n=0;n<t.length;n++)e[n]=rt.get(t[n]);return e}async _mapLoadToResolve(t,e){const n=[...new Set(Object.values(t))];this._backgroundLoader.active=!1;const r=await this.loader.load(n,e);this._backgroundLoader.active=!0;const i={};return n.forEach(o=>{const a=r[o.src],l=[o.src];o.alias&&l.push(...o.alias),l.forEach(h=>{i[h]=a}),rt.set(l,a)}),i}async unload(t){this._initialized||await this.init();const e=Nt(t).map(r=>typeof r!="string"?r.src:r),n=this.resolver.resolve(e);await this._unloadFromResolved(n)}async unloadBundle(t){this._initialized||await this.init(),t=Nt(t);const e=this.resolver.resolveBundle(t),n=Object.keys(e).map(r=>this._unloadFromResolved(e[r]));await Promise.all(n)}async _unloadFromResolved(t){const e=Object.values(t);e.forEach(n=>{rt.remove(n.src)}),await this.loader.unload(e)}async _detectFormats(t){let e=[];t.preferredFormats&&(e=Array.isArray(t.preferredFormats)?t.preferredFormats:[t.preferredFormats]);for(const n of t.detections)t.skipDetections||await n.test()?e=await n.add(e):t.skipDetections||(e=await n.remove(e));return e=e.filter((n,r)=>e.indexOf(n)===r),e}get detections(){return this._detections}setPreferences(t){this.loader.parsers.forEach(e=>{e.config&&Object.keys(e.config).filter(n=>n in t).forEach(n=>{e.config[n]=t[n]})})}}const St=new ip;dt.handleByList(N.LoadParser,St.loader.parsers).handleByList(N.ResolveParser,St.resolver.parsers).handleByList(N.CacheParser,St.cache.parsers).handleByList(N.DetectionParser,St.detections);dt.add(bf,_f,wf,kf,Af,Sf,Cf,Ef,Ff,Df,jf,gl,np,xf,gf,yl,rp);const _o={loader:N.LoadParser,resolver:N.ResolveParser,cache:N.CacheParser,detection:N.DetectionParser};dt.handle(N.Asset,s=>{const t=s.ref;Object.entries(_o).filter(([e])=>!!t[e]).forEach(([e,n])=>dt.add(Object.assign(t[e],{extension:t[e].extension??n})))},s=>{const t=s.ref;Object.keys(_o).filter(e=>!!t[e]).forEach(e=>dt.remove(t[e]))});class Jt extends Hr{constructor(t){t instanceof Bt&&(t={context:t});const{context:e,roundPixels:n,...r}=t||{};super({label:"Graphics",...r}),this.renderPipeId="graphics",e?this._context=e:this._context=this._ownedContext=new Bt,this._context.on("update",this.onViewUpdate,this),this.didViewUpdate=!0,this.allowChildren=!1,this.roundPixels=n??!1}set context(t){t!==this._context&&(this._context.off("update",this.onViewUpdate,this),this._context=t,this._context.on("update",this.onViewUpdate,this),this.onViewUpdate())}get context(){return this._context}get bounds(){return this._context.bounds}updateBounds(){}containsPoint(t){return this._context.containsPoint(t)}destroy(t){this._ownedContext&&!t?this._ownedContext.destroy(t):(t===!0||(t==null?void 0:t.context)===!0)&&this._context.destroy(t),this._ownedContext=null,this._context=null,super.destroy(t)}_callContextMethod(t,e){return this.context[t](...e),this}setFillStyle(...t){return this._callContextMethod("setFillStyle",t)}setStrokeStyle(...t){return this._callContextMethod("setStrokeStyle",t)}fill(...t){return this._callContextMethod("fill",t)}stroke(...t){return this._callContextMethod("stroke",t)}texture(...t){return this._callContextMethod("texture",t)}beginPath(){return this._callContextMethod("beginPath",[])}cut(){return this._callContextMethod("cut",[])}arc(...t){return this._callContextMethod("arc",t)}arcTo(...t){return this._callContextMethod("arcTo",t)}arcToSvg(...t){return this._callContextMethod("arcToSvg",t)}bezierCurveTo(...t){return this._callContextMethod("bezierCurveTo",t)}closePath(){return this._callContextMethod("closePath",[])}ellipse(...t){return this._callContextMethod("ellipse",t)}circle(...t){return this._callContextMethod("circle",t)}path(...t){return this._callContextMethod("path",t)}lineTo(...t){return this._callContextMethod("lineTo",t)}moveTo(...t){return this._callContextMethod("moveTo",t)}quadraticCurveTo(...t){return this._callContextMethod("quadraticCurveTo",t)}rect(...t){return this._callContextMethod("rect",t)}roundRect(...t){return this._callContextMethod("roundRect",t)}poly(...t){return this._callContextMethod("poly",t)}regularPoly(...t){return this._callContextMethod("regularPoly",t)}roundPoly(...t){return this._callContextMethod("roundPoly",t)}roundShape(...t){return this._callContextMethod("roundShape",t)}filletRect(...t){return this._callContextMethod("filletRect",t)}chamferRect(...t){return this._callContextMethod("chamferRect",t)}star(...t){return this._callContextMethod("star",t)}svg(...t){return this._callContextMethod("svg",t)}restore(...t){return this._callContextMethod("restore",t)}save(){return this._callContextMethod("save",[])}getTransform(){return this.context.getTransform()}resetTransform(){return this._callContextMethod("resetTransform",[])}rotateTransform(...t){return this._callContextMethod("rotate",t)}scaleTransform(...t){return this._callContextMethod("scale",t)}setTransform(...t){return this._callContextMethod("setTransform",t)}transform(...t){return this._callContextMethod("transform",t)}translateTransform(...t){return this._callContextMethod("translate",t)}clear(){return this._callContextMethod("clear",[])}get fillStyle(){return this._context.fillStyle}set fillStyle(t){this._context.fillStyle=t}get strokeStyle(){return this._context.strokeStyle}set strokeStyle(t){this._context.strokeStyle=t}clone(t=!1){return t?new Jt(this._context.clone()):(this._ownedContext=null,new Jt(this._context))}lineStyle(t,e,n){V(Z,"Graphics#lineStyle is no longer needed. Use Graphics#setStrokeStyle to set the stroke style.");const r={};return t&&(r.width=t),e&&(r.color=e),n&&(r.alpha=n),this.context.strokeStyle=r,this}beginFill(t,e){V(Z,"Graphics#beginFill is no longer needed. Use Graphics#fill to fill the shape with the desired style.");const n={};return t!==void 0&&(n.color=t),e!==void 0&&(n.alpha=e),this.context.fillStyle=n,this}endFill(){V(Z,"Graphics#endFill is no longer needed. Use Graphics#fill to fill the shape with the desired style."),this.context.fill();const t=this.context.strokeStyle;return(t.width!==Bt.defaultStrokeStyle.width||t.color!==Bt.defaultStrokeStyle.color||t.alpha!==Bt.defaultStrokeStyle.alpha)&&this.context.stroke(),this}drawCircle(...t){return V(Z,"Graphics#drawCircle has been renamed to Graphics#circle"),this._callContextMethod("circle",t)}drawEllipse(...t){return V(Z,"Graphics#drawEllipse has been renamed to Graphics#ellipse"),this._callContextMethod("ellipse",t)}drawPolygon(...t){return V(Z,"Graphics#drawPolygon has been renamed to Graphics#poly"),this._callContextMethod("poly",t)}drawRect(...t){return V(Z,"Graphics#drawRect has been renamed to Graphics#rect"),this._callContextMethod("rect",t)}drawRoundedRect(...t){return V(Z,"Graphics#drawRoundedRect has been renamed to Graphics#roundRect"),this._callContextMethod("roundRect",t)}drawStar(...t){return V(Z,"Graphics#drawStar has been renamed to Graphics#star"),this._callContextMethod("star",t)}}class sn extends Ht{constructor(...t){let e=t[0];Array.isArray(t[0])&&(e={textures:t[0],autoUpdate:t[1]});const{animationSpeed:n=1,autoPlay:r=!1,autoUpdate:i=!0,loop:o=!0,onComplete:a=null,onFrameChange:l=null,onLoop:h=null,textures:c,updateAnchor:u=!1,...f}=e,[d]=c;super({...f,texture:d instanceof $?d:d.texture}),this._textures=null,this._durations=null,this._autoUpdate=i,this._isConnectedToTicker=!1,this.animationSpeed=n,this.loop=o,this.updateAnchor=u,this.onComplete=a,this.onFrameChange=l,this.onLoop=h,this._currentTime=0,this._playing=!1,this._previousFrame=null,this.textures=c,r&&this.play()}stop(){this._playing&&(this._playing=!1,this._autoUpdate&&this._isConnectedToTicker&&(Ut.shared.remove(this.update,this),this._isConnectedToTicker=!1))}play(){this._playing||(this._playing=!0,this._autoUpdate&&!this._isConnectedToTicker&&(Ut.shared.add(this.update,this,Ks.HIGH),this._isConnectedToTicker=!0))}gotoAndStop(t){this.stop(),this.currentFrame=t}gotoAndPlay(t){this.currentFrame=t,this.play()}update(t){if(!this._playing)return;const e=t.deltaTime,n=this.animationSpeed*e,r=this.currentFrame;if(this._durations!==null){let i=this._currentTime%1*this._durations[this.currentFrame];for(i+=n/60*1e3;i<0;)this._currentTime--,i+=this._durations[this.currentFrame];const o=Math.sign(this.animationSpeed*e);for(this._currentTime=Math.floor(this._currentTime);i>=this._durations[this.currentFrame];)i-=this._durations[this.currentFrame]*o,this._currentTime+=o;this._currentTime+=i/this._durations[this.currentFrame]}else this._currentTime+=n;this._currentTime<0&&!this.loop?(this.gotoAndStop(0),this.onComplete&&this.onComplete()):this._currentTime>=this._textures.length&&!this.loop?(this.gotoAndStop(this._textures.length-1),this.onComplete&&this.onComplete()):r!==this.currentFrame&&(this.loop&&this.onLoop&&(this.animationSpeed>0&&this.currentFrame<r||this.animationSpeed<0&&this.currentFrame>r)&&this.onLoop(),this._updateTexture())}_updateTexture(){const t=this.currentFrame;this._previousFrame!==t&&(this._previousFrame=t,this.texture=this._textures[t],this.updateAnchor&&this.texture.defaultAnchor&&this.anchor.copyFrom(this.texture.defaultAnchor),this.onFrameChange&&this.onFrameChange(this.currentFrame))}destroy(){this.stop(),super.destroy(),this.onComplete=null,this.onFrameChange=null,this.onLoop=null}static fromFrames(t){const e=[];for(let n=0;n<t.length;++n)e.push($.from(t[n]));return new sn(e)}static fromImages(t){const e=[];for(let n=0;n<t.length;++n)e.push($.from(t[n]));return new sn(e)}get totalFrames(){return this._textures.length}get textures(){return this._textures}set textures(t){if(t[0]instanceof $)this._textures=t,this._durations=null;else{this._textures=[],this._durations=[];for(let e=0;e<t.length;e++)this._textures.push(t[e].texture),this._durations.push(t[e].time)}this._previousFrame=null,this.gotoAndStop(0),this._updateTexture()}get currentFrame(){let t=Math.floor(this._currentTime)%this._textures.length;return t<0&&(t+=this._textures.length),t}set currentFrame(t){if(t<0||t>this.totalFrames-1)throw new Error(`[AnimatedSprite]: Invalid frame index value ${t}, expected to be between 0 and totalFrames ${this.totalFrames}.`);const e=this.currentFrame;this._currentTime=t,e!==this.currentFrame&&this._updateTexture()}get playing(){return this._playing}get autoUpdate(){return this._autoUpdate}set autoUpdate(t){t!==this._autoUpdate&&(this._autoUpdate=t,!this._autoUpdate&&this._isConnectedToTicker?(Ut.shared.remove(this.update,this),this._isConnectedToTicker=!1):this._autoUpdate&&!this._isConnectedToTicker&&this._playing&&(Ut.shared.add(this.update,this),this._isConnectedToTicker=!0))}}class op extends Hr{constructor(t,e){const{text:n,resolution:r,style:i,anchor:o,width:a,height:l,roundPixels:h,...c}=t;super({...c}),this.batched=!0,this._resolution=null,this._autoResolution=!0,this._didTextUpdate=!0,this._styleClass=e,this.text=n??"",this.style=i,this.resolution=r??null,this.allowChildren=!1,this._anchor=new bt({_onUpdate:()=>{this.onViewUpdate()}}),o&&(this.anchor=o),this.roundPixels=h??!1,a!==void 0&&(this.width=a),l!==void 0&&(this.height=l)}get anchor(){return this._anchor}set anchor(t){typeof t=="number"?this._anchor.set(t):this._anchor.copyFrom(t)}set text(t){t=t.toString(),this._text!==t&&(this._text=t,this.onViewUpdate())}get text(){return this._text}set resolution(t){this._autoResolution=t===null,this._resolution=t,this.onViewUpdate()}get resolution(){return this._resolution}get style(){return this._style}set style(t){var e;t||(t={}),(e=this._style)==null||e.off("update",this.onViewUpdate,this),t instanceof this._styleClass?this._style=t:this._style=new this._styleClass(t),this._style.on("update",this.onViewUpdate,this),this.onViewUpdate()}get width(){return Math.abs(this.scale.x)*this.bounds.width}set width(t){this._setWidth(t,this.bounds.width)}get height(){return Math.abs(this.scale.y)*this.bounds.height}set height(t){this._setHeight(t,this.bounds.height)}getSize(t){return t||(t={}),t.width=Math.abs(this.scale.x)*this.bounds.width,t.height=Math.abs(this.scale.y)*this.bounds.height,t}setSize(t,e){typeof t=="object"?(e=t.height??t.width,t=t.width):e??(e=t),t!==void 0&&this._setWidth(t,this.bounds.width),e!==void 0&&this._setHeight(e,this.bounds.height)}containsPoint(t){const e=this.bounds.width,n=this.bounds.height,r=-e*this.anchor.x;let i=0;return t.x>=r&&t.x<=r+e&&(i=-n*this.anchor.y,t.y>=i&&t.y<=i+n)}onViewUpdate(){this.didViewUpdate||(this._didTextUpdate=!0),super.onViewUpdate()}destroy(t=!1){super.destroy(t),this.owner=null,this._bounds=null,this._anchor=null,(typeof t=="boolean"?t:t!=null&&t.style)&&this._style.destroy(t),this._style=null,this._text=null}}function ap(s,t){let e=s[0]??{};return(typeof e=="string"||s[1])&&(V(Z,`use new ${t}({ text: "hi!", style }) instead`),e={text:e,style:s[1]}),e}let ve=null,ie=null;function lp(s,t){ve||(ve=at.get().createCanvas(256,128),ie=ve.getContext("2d",{willReadFrequently:!0}),ie.globalCompositeOperation="copy",ie.globalAlpha=1),(ve.width<s||ve.height<t)&&(ve.width=$e(s),ve.height=$e(t))}function vo(s,t,e){for(let n=0,r=4*e*t;n<t;++n,r+=4)if(s[r+3]!==0)return!1;return!0}function Ao(s,t,e,n,r){const i=4*t;for(let o=n,a=n*i+4*e;o<=r;++o,a+=i)if(s[a+3]!==0)return!1;return!0}function cp(...s){let t=s[0];t.canvas||(t={canvas:s[0],resolution:s[1]});const{canvas:e}=t,n=Math.min(t.resolution??1,1),r=t.width??e.width,i=t.height??e.height;let o=t.output;if(lp(r,i),!ie)throw new TypeError("Failed to get canvas 2D context");ie.drawImage(e,0,0,r,i,0,0,r*n,i*n);const l=ie.getImageData(0,0,r,i).data;let h=0,c=0,u=r-1,f=i-1;for(;c<i&&vo(l,r,c);)++c;if(c===i)return q.EMPTY;for(;vo(l,r,f);)--f;for(;Ao(l,r,h,c,f);)++h;for(;Ao(l,r,u,c,f);)--u;return++u,++f,ie.globalCompositeOperation="source-over",ie.strokeRect(h,c,u-h,f-c),ie.globalCompositeOperation="copy",o??(o=new q),o.set(h/n,c/n,(u-h)/n,(f-c)/n),o}const So=new q;class hp{getCanvasAndContext(t){const{text:e,style:n,resolution:r=1}=t,i=n._getFinalPadding(),o=qt.measureText(e||" ",n),a=Math.ceil(Math.ceil(Math.max(1,o.width)+i*2)*r),l=Math.ceil(Math.ceil(Math.max(1,o.height)+i*2)*r),h=tn.getOptimalCanvasAndContext(a,l);this._renderTextToCanvas(e,n,i,r,h);const c=n.trim?cp({canvas:h.canvas,width:a,height:l,resolution:1,output:So}):So.set(0,0,a,l);return{canvasAndContext:h,frame:c}}returnCanvasAndContext(t){tn.returnCanvasAndContext(t)}_renderTextToCanvas(t,e,n,r,i){var b,w,_,A;const{canvas:o,context:a}=i,l=Qs(e),h=qt.measureText(t||" ",e),c=h.lines,u=h.lineHeight,f=h.lineWidths,d=h.maxLineWidth,p=h.fontProperties,g=o.height;if(a.resetTransform(),a.scale(r,r),a.textBaseline=e.textBaseline,(b=e._stroke)!=null&&b.width){const C=e._stroke;a.lineWidth=C.width,a.miterLimit=C.miterLimit,a.lineJoin=C.join,a.lineCap=C.cap}a.font=l;let m,x;const y=e.dropShadow?2:1;for(let C=0;C<y;++C){const P=e.dropShadow&&C===0,v=P?Math.ceil(Math.max(1,g)+n*2):0,k=v*r;if(P){a.fillStyle="black",a.strokeStyle="black";const E=e.dropShadow,F=E.color,R=E.alpha;a.shadowColor=ot.shared.setValue(F).setAlpha(R).toRgbaString();const T=E.blur*r,I=E.distance*r;a.shadowBlur=T,a.shadowOffsetX=Math.cos(E.angle)*I,a.shadowOffsetY=Math.sin(E.angle)*I+k}else{if(a.fillStyle=e._fill?en(e._fill,a,h):null,(w=e._stroke)!=null&&w.width){const E=e._stroke.width*e._stroke.alignment;a.strokeStyle=en(e._stroke,a,h,E)}a.shadowColor="black"}let S=(u-p.fontSize)/2;u-p.fontSize<0&&(S=0);const M=((_=e._stroke)==null?void 0:_.width)??0;for(let E=0;E<c.length;E++)m=M/2,x=M/2+E*u+p.ascent+S,e.align==="right"?m+=d-f[E]:e.align==="center"&&(m+=(d-f[E])/2),(A=e._stroke)!=null&&A.width&&this._drawLetterSpacing(c[E],e,i,m+n,x+n-v,!0),e._fill!==void 0&&this._drawLetterSpacing(c[E],e,i,m+n,x+n-v)}}_drawLetterSpacing(t,e,n,r,i,o=!1){const{context:a}=n,l=e.letterSpacing;let h=!1;if(qt.experimentalLetterSpacingSupported&&(qt.experimentalLetterSpacing?(a.letterSpacing=`${l}px`,a.textLetterSpacing=`${l}px`,h=!0):(a.letterSpacing="0px",a.textLetterSpacing="0px")),l===0||h){o?a.strokeText(t,r,i):a.fillText(t,r,i);return}let c=r;const u=qt.graphemeSegmenter(t);let f=a.measureText(t).width,d=0;for(let p=0;p<u.length;++p){const g=u[p];o?a.strokeText(g,c,i):a.fillText(g,c,i);let m="";for(let x=p+1;x<u.length;++x)m+=u[x];d=a.measureText(m).width,c+=f-d+l,f=d}}}const Co=new hp;class Qt extends op{constructor(...t){const e=ap(t,"Text");super(e,kt),this.renderPipeId="text",e.textureStyle&&(this.textureStyle=e.textureStyle instanceof Ve?e.textureStyle:new Ve(e.textureStyle))}updateBounds(){const t=this._bounds,e=this._anchor;let n=0,r=0;if(this._style.trim){const{frame:i,canvasAndContext:o}=Co.getCanvasAndContext({text:this.text,style:this._style,resolution:1});Co.returnCanvasAndContext(o),n=i.width,r=i.height}else{const i=qt.measureText(this._text,this._style);n=i.width,r=i.height}t.minX=-e._x*n,t.maxX=t.minX+n,t.minY=-e._y*r,t.maxY=t.minY+r}}dt.add(fc,pc);const up="game-imgs/btc-net-sim",ko=["circle-btn","ctx-option","reset","zoom-btn-up","zoom-btn-dn","ms-default","ms-grabbing","ms-grab","ms-pointer","server-anim-coin","server-off"],dp=()=>{const s={};return{createSprite:e=>new Ht(s[e]),getTexture:e=>s[e],load:async()=>{St.reset();for(const n of ko)St.add({alias:n,src:`${up}/${n}.png`});const e=await St.load(ko);for(const n of Object.keys(e))s[n]=e[n],s[n].source.scaleMode="nearest"}}},fp=()=>{const s={x:0,y:0},t=854,e=480;let n=1,r=1,i=1;return{getAppZeroPos:()=>s,virtWidth:t,virtHeight:e,getBaseScale:()=>n,updateBaseScaleFromScreen:({screenWidth:f,screenHeight:d})=>{const p=f/d,g=t/e;if(p>g){n=d/t;const m=(f-t*n)/2;s.x=m,s.y=0}else{n=f/t;const m=(d-e*n)/2;s.x=0,s.y=m}i=n*r},getGameScale:()=>i,zoom:f=>{const d=1+f;r=r*d,r<.4&&(r=.4),r>1.75&&(r=1.75)},setZoom:f=>{r=f,r<.4&&(r=.4),r>1.75&&(r=1.75)}}},pp=s=>({resize:(t,e)=>{const{width:n,height:r}=t.screen;s.updateBaseScaleFromScreen({screenWidth:n,screenHeight:r});const i=s.getGameScale(),o=s.getAppZeroPos();e.scale.set(i,i),e.position.set(o.x,o.y)}}),mp=s=>{const{gameVars:t,bounds:e,clampCamera:n=!0}=s,{app:r,game:i,scaler:o}=t,a={width:0,height:0};let l=0;const h=y=>{l=y},c=y=>o.setZoom(y),u=()=>o.setZoom(1);let f=null,d=.1;return{lookAt:y=>{try{if(!y)return;a.width=r.screen.width,a.height=r.screen.height;let b=-y.x+a.width*.5,w=-y.y+a.height*.5;if(n){const A=-(e.width*o.getGameScale()-a.width);b=Math.min(Math.max(b,A),0);const v=-(e.height*o.getGameScale()-a.height);w=Math.min(Math.max(w,v),0)}i.position.set(b,w)}catch{}},viewport:a,zoom:h,resetZoom:u,update:y=>{if(l!==0&&(o.zoom(l*y.deltaMS),l=0),f){a.width=r.screen.width,a.height=r.screen.height;let b=-f.x+a.width*.5,w=-f.y+a.height*.5;if(n){const k=-(e.width*o.getGameScale()-a.width);b=Math.min(Math.max(b,k),0);const E=-(e.height*o.getGameScale()-a.height);w=Math.min(Math.max(w,E),0)}const _=b-i.position.x,A=w-i.position.y,C=Math.sqrt(_*_+A*A),P=d*y.deltaMS;if(C<P)i.position.set(b,w),f=null;else{const v=P/C;i.position.x+=_*v,i.position.y+=A*v}}},moveTo:(y,b=.1)=>{f={x:y.x,y:y.y},d=b},getCameraCenter:()=>{const y=r.screen.width*.5,b=r.screen.height*.5,w=-i.position.x+y,_=-i.position.y+b;return{x:w/o.getGameScale(),y:_/o.getGameScale()}},setZoom:c,atTargetPos:()=>f===null}};var gp=`in vec2 aPosition;
out vec2 vTextureCoord;

uniform vec4 uInputSize;
uniform vec4 uOutputFrame;
uniform vec4 uOutputTexture;

vec4 filterVertexPosition( void )
{
    vec2 position = aPosition * uOutputFrame.zw + uOutputFrame.xy;
    
    position.x = position.x * (2.0 / uOutputTexture.x) - 1.0;
    position.y = position.y * (2.0*uOutputTexture.z / uOutputTexture.y) - uOutputTexture.z;

    return vec4(position, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aPosition * (uOutputFrame.zw * uInputSize.zw);
}

void main(void)
{
    gl_Position = filterVertexPosition();
    vTextureCoord = filterTextureCoord();
}
`,xp=`struct GlobalFilterUniforms {
  uInputSize:vec4<f32>,
  uInputPixel:vec4<f32>,
  uInputClamp:vec4<f32>,
  uOutputFrame:vec4<f32>,
  uGlobalFrame:vec4<f32>,
  uOutputTexture:vec4<f32>,
};

@group(0) @binding(0) var<uniform> gfu: GlobalFilterUniforms;

struct VSOutput {
    @builtin(position) position: vec4<f32>,
    @location(0) uv : vec2<f32>
  };

fn filterVertexPosition(aPosition:vec2<f32>) -> vec4<f32>
{
    var position = aPosition * gfu.uOutputFrame.zw + gfu.uOutputFrame.xy;

    position.x = position.x * (2.0 / gfu.uOutputTexture.x) - 1.0;
    position.y = position.y * (2.0*gfu.uOutputTexture.z / gfu.uOutputTexture.y) - gfu.uOutputTexture.z;

    return vec4(position, 0.0, 1.0);
}

fn filterTextureCoord( aPosition:vec2<f32> ) -> vec2<f32>
{
    return aPosition * (gfu.uOutputFrame.zw * gfu.uInputSize.zw);
}

fn globalTextureCoord( aPosition:vec2<f32> ) -> vec2<f32>
{
  return  (aPosition.xy / gfu.uGlobalFrame.zw) + (gfu.uGlobalFrame.xy / gfu.uGlobalFrame.zw);  
}

fn getSize() -> vec2<f32>
{
  return gfu.uGlobalFrame.zw;
}
  
@vertex
fn mainVertex(
  @location(0) aPosition : vec2<f32>, 
) -> VSOutput {
  return VSOutput(
   filterVertexPosition(aPosition),
   filterTextureCoord(aPosition)
  );
}`,yp=`precision highp float;
in vec2 vTextureCoord;
out vec4 finalColor;

uniform sampler2D uTexture;
uniform vec2 uThickness;
uniform vec3 uColor;
uniform float uAlpha;
uniform float uKnockout;

uniform vec4 uInputClamp;

const float DOUBLE_PI = 2. * 3.14159265358979323846264;
const float ANGLE_STEP = \${ANGLE_STEP};

float outlineMaxAlphaAtPos(vec2 pos) {
    if (uThickness.x == 0. || uThickness.y == 0.) {
        return 0.;
    }

    vec4 displacedColor;
    vec2 displacedPos;
    float maxAlpha = 0.;

    for (float angle = 0.; angle <= DOUBLE_PI; angle += ANGLE_STEP) {
        displacedPos.x = vTextureCoord.x + uThickness.x * cos(angle);
        displacedPos.y = vTextureCoord.y + uThickness.y * sin(angle);
        displacedColor = texture(uTexture, clamp(displacedPos, uInputClamp.xy, uInputClamp.zw));
        maxAlpha = max(maxAlpha, displacedColor.a);
    }

    return maxAlpha;
}

void main(void) {
    vec4 sourceColor = texture(uTexture, vTextureCoord);
    vec4 contentColor = sourceColor * float(uKnockout < 0.5);
    float outlineAlpha = uAlpha * outlineMaxAlphaAtPos(vTextureCoord.xy) * (1.-sourceColor.a);
    vec4 outlineColor = vec4(vec3(uColor) * outlineAlpha, outlineAlpha);
    finalColor = contentColor + outlineColor;
}
`,bp=`struct OutlineUniforms {
  uThickness:vec2<f32>,
  uColor:vec3<f32>,
  uAlpha:f32,
  uAngleStep:f32,
  uKnockout:f32,
};

struct GlobalFilterUniforms {
  uInputSize:vec4<f32>,
  uInputPixel:vec4<f32>,
  uInputClamp:vec4<f32>,
  uOutputFrame:vec4<f32>,
  uGlobalFrame:vec4<f32>,
  uOutputTexture:vec4<f32>,
};

@group(0) @binding(0) var<uniform> gfu: GlobalFilterUniforms;

@group(0) @binding(1) var uTexture: texture_2d<f32>; 
@group(0) @binding(2) var uSampler: sampler;
@group(1) @binding(0) var<uniform> outlineUniforms : OutlineUniforms;

@fragment
fn mainFragment(
  @builtin(position) position: vec4<f32>,
  @location(0) uv : vec2<f32>
) -> @location(0) vec4<f32> {
  let sourceColor: vec4<f32> = textureSample(uTexture, uSampler, uv);
  let contentColor: vec4<f32> = sourceColor * (1. - outlineUniforms.uKnockout);
  
  let outlineAlpha: f32 = outlineUniforms.uAlpha * outlineMaxAlphaAtPos(uv) * (1. - sourceColor.a);
  let outlineColor: vec4<f32> = vec4<f32>(vec3<f32>(outlineUniforms.uColor) * outlineAlpha, outlineAlpha);
  
  return contentColor + outlineColor;
}

fn outlineMaxAlphaAtPos(uv: vec2<f32>) -> f32 {
  let thickness = outlineUniforms.uThickness;

  if (thickness.x == 0. || thickness.y == 0.) {
    return 0.;
  }
  
  let angleStep = outlineUniforms.uAngleStep;

  var displacedColor: vec4<f32>;
  var displacedPos: vec2<f32>;

  var maxAlpha: f32 = 0.;
  var displaced: vec2<f32>;
  var curColor: vec4<f32>;

  for (var angle = 0.; angle <= DOUBLE_PI; angle += angleStep)
  {
    displaced.x = uv.x + thickness.x * cos(angle);
    displaced.y = uv.y + thickness.y * sin(angle);
    curColor = textureSample(uTexture, uSampler, clamp(displaced, gfu.uInputClamp.xy, gfu.uInputClamp.zw));
    maxAlpha = max(maxAlpha, curColor.a);
  }

  return maxAlpha;
}

const DOUBLE_PI: f32 = 3.14159265358979323846264 * 2.;`,wp=Object.defineProperty,_p=(s,t,e)=>t in s?wp(s,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):s[t]=e,Ie=(s,t,e)=>(_p(s,typeof t!="symbol"?t+"":t,e),e);const mn=class Te extends zh{constructor(...t){let e=t[0]??{};typeof e=="number"&&(V("6.0.0","OutlineFilter constructor params are now options object. See params: { thickness, color, quality, alpha, knockout }"),e={thickness:e},t[1]!==void 0&&(e.color=t[1]),t[2]!==void 0&&(e.quality=t[2]),t[3]!==void 0&&(e.alpha=t[3]),t[4]!==void 0&&(e.knockout=t[4])),e={...Te.DEFAULT_OPTIONS,...e};const n=e.quality??.1,r=Je.from({vertex:{source:xp,entryPoint:"mainVertex"},fragment:{source:bp,entryPoint:"mainFragment"}}),i=un.from({vertex:gp,fragment:yp.replace(/\$\{ANGLE_STEP\}/,Te.getAngleStep(n).toFixed(7)),name:"outline-filter"});super({gpuProgram:r,glProgram:i,resources:{outlineUniforms:{uThickness:{value:new Float32Array(2),type:"vec2<f32>"},uColor:{value:new Float32Array(3),type:"vec3<f32>"},uAlpha:{value:e.alpha,type:"f32"},uAngleStep:{value:0,type:"f32"},uKnockout:{value:e.knockout?1:0,type:"f32"}}}}),Ie(this,"uniforms"),Ie(this,"_thickness"),Ie(this,"_quality"),Ie(this,"_color"),this.uniforms=this.resources.outlineUniforms.uniforms,this.uniforms.uAngleStep=Te.getAngleStep(n),this._color=new ot,this.color=e.color??0,Object.assign(this,e)}apply(t,e,n,r){this.uniforms.uThickness[0]=this.thickness/e.source.width,this.uniforms.uThickness[1]=this.thickness/e.source.height,t.applyFilter(this,e,n,r)}static getAngleStep(t){return parseFloat((Math.PI*2/Math.max(t*Te.MAX_SAMPLES,Te.MIN_SAMPLES)).toFixed(7))}get thickness(){return this._thickness}set thickness(t){this._thickness=this.padding=t}get color(){return this._color.value}set color(t){this._color.setValue(t);const[e,n,r]=this._color.toArray();this.uniforms.uColor[0]=e,this.uniforms.uColor[1]=n,this.uniforms.uColor[2]=r}get alpha(){return this.uniforms.uAlpha}set alpha(t){this.uniforms.uAlpha=t}get quality(){return this._quality}set quality(t){this._quality=t,this.uniforms.uAngleStep=Te.getAngleStep(t)}get knockout(){return this.uniforms.uKnockout===1}set knockout(t){this.uniforms.uKnockout=t?1:0}};Ie(mn,"DEFAULT_OPTIONS",{thickness:1,color:0,alpha:1,quality:.1,knockout:!1});Ie(mn,"MIN_SAMPLES",1);Ie(mn,"MAX_SAMPLES",100);let vp=mn;var gn=(s=>(s[s.bottom=0]="bottom",s[s.mid=1]="mid",s[s.top=2]="top",s))(gn||{});const Ap=s=>{const t=new Map;return{connect:a=>{a.ip()!==s&&(t.has(a.ip())||t.set(a.ip(),a))},disconnect:()=>{t.clear()},connectCount:()=>t.size,isConnectedTo:a=>t.has(a.ip()),getAll:()=>{const a=[];for(const l of t.values())a.push(l);return a}}},Sp=()=>{const s=[];return{clearTxs:()=>{s.length=0},hasTx:t=>s.some(e=>e.hash===t.hash),getAllTxs:()=>s,add:t=>s.push(t),displayJsonData:()=>Cp()}},Cp=()=>`{
  "inputs": [
    {
      "id": "utxo-abc123def456",
      "value": "50000000",
      "owner": "alice_address_xyz"
    },
    {
      "id": "utxo-ghi789jkl012",
      "value": "20000000",
      "owner": "alice_address_xyz"
    }
  ],
  "outputs": [
    {
      "id": "utxo-newTx123_0",
      "value": "60000000",
      "owner": "bob_address_pqr"
    },
    {
      "id": "utxo-newTx123_1",
      "value": "9990000",
      "owner": "alice_address_xyz"
    }
  ],
  "pubKey": "038e88e88e88e88e88e88e88e88e88e88e88e88e88e88e88e88e88e88e88e88e88",
  "fee": "10000",
  "sig": "3045022100a7b8f9d0c2e1d4b6a7c8e9f0a1b2c3d4e5f6a7b8c9d0e1f2a3b4c5d6e7f8a9b02200a7b8f9d0c2e1d4b6a7c8e9f0a1b2c3d4e5f6a7b8c9d0e1f2a3b4c5d6e7f8a9b0",
  "hash": "a1b2c3d4e5f6a7b8c9d0e1f2a3b4c5d6e7f8a9b0c1d2e3f4a5b6c7d8e9f0a1b2"
}`,Ue=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */function ti(s){return s instanceof Uint8Array||ArrayBuffer.isView(s)&&s.constructor.name==="Uint8Array"}function Br(s){if(!Number.isSafeInteger(s)||s<0)throw new Error("positive integer expected, got "+s)}function he(s,...t){if(!ti(s))throw new Error("Uint8Array expected");if(t.length>0&&!t.includes(s.length))throw new Error("Uint8Array expected of length "+t+", got length="+s.length)}function kp(s){if(typeof s!="function"||typeof s.create!="function")throw new Error("Hash should be wrapped by utils.createHasher");Br(s.outputLen),Br(s.blockLen)}function nn(s,t=!0){if(s.destroyed)throw new Error("Hash instance has been destroyed");if(t&&s.finished)throw new Error("Hash#digest() has already been called")}function Pp(s,t){he(s);const e=t.outputLen;if(s.length<e)throw new Error("digestInto() expects output buffer of length at least "+e)}function Ke(...s){for(let t=0;t<s.length;t++)s[t].fill(0)}function tr(s){return new DataView(s.buffer,s.byteOffset,s.byteLength)}function $t(s,t){return s<<32-t|s>>>t}function Os(s,t){return s<<t|s>>>32-t>>>0}const bl=typeof Uint8Array.from([]).toHex=="function"&&typeof Uint8Array.fromHex=="function",Mp=Array.from({length:256},(s,t)=>t.toString(16).padStart(2,"0"));function ge(s){if(he(s),bl)return s.toHex();let t="";for(let e=0;e<s.length;e++)t+=Mp[s[e]];return t}const se={_0:48,_9:57,A:65,F:70,a:97,f:102};function Po(s){if(s>=se._0&&s<=se._9)return s-se._0;if(s>=se.A&&s<=se.F)return s-(se.A-10);if(s>=se.a&&s<=se.f)return s-(se.a-10)}function ei(s){if(typeof s!="string")throw new Error("hex string expected, got "+typeof s);if(bl)return Uint8Array.fromHex(s);const t=s.length,e=t/2;if(t%2)throw new Error("hex string expected, got unpadded hex of length "+t);const n=new Uint8Array(e);for(let r=0,i=0;r<e;r++,i+=2){const o=Po(s.charCodeAt(i)),a=Po(s.charCodeAt(i+1));if(o===void 0||a===void 0){const l=s[i]+s[i+1];throw new Error('hex string expected, got non-hex character "'+l+'" at index '+i)}n[r]=o*16+a}return n}function Tp(s){if(typeof s!="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(s))}function si(s){return typeof s=="string"&&(s=Tp(s)),he(s),s}function Be(...s){let t=0;for(let n=0;n<s.length;n++){const r=s[n];he(r),t+=r.length}const e=new Uint8Array(t);for(let n=0,r=0;n<s.length;n++){const i=s[n];e.set(i,r),r+=i.length}return e}class wl{}function _l(s){const t=n=>s().update(si(n)).digest(),e=s();return t.outputLen=e.outputLen,t.blockLen=e.blockLen,t.create=()=>s(),t}function Ep(s=32){if(Ue&&typeof Ue.getRandomValues=="function")return Ue.getRandomValues(new Uint8Array(s));if(Ue&&typeof Ue.randomBytes=="function")return Uint8Array.from(Ue.randomBytes(s));throw new Error("crypto.getRandomValues must be defined")}function Ip(s,t,e,n){if(typeof s.setBigUint64=="function")return s.setBigUint64(t,e,n);const r=BigInt(32),i=BigInt(4294967295),o=Number(e>>r&i),a=Number(e&i),l=n?4:0,h=n?0:4;s.setUint32(t+l,o,n),s.setUint32(t+h,a,n)}function Bp(s,t,e){return s&t^~s&e}function Fp(s,t,e){return s&t^s&e^t&e}class vl extends wl{constructor(t,e,n,r){super(),this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.blockLen=t,this.outputLen=e,this.padOffset=n,this.isLE=r,this.buffer=new Uint8Array(t),this.view=tr(this.buffer)}update(t){nn(this),t=si(t),he(t);const{view:e,buffer:n,blockLen:r}=this,i=t.length;for(let o=0;o<i;){const a=Math.min(r-this.pos,i-o);if(a===r){const l=tr(t);for(;r<=i-o;o+=r)this.process(l,o);continue}n.set(t.subarray(o,o+a),this.pos),this.pos+=a,o+=a,this.pos===r&&(this.process(e,0),this.pos=0)}return this.length+=t.length,this.roundClean(),this}digestInto(t){nn(this),Pp(t,this),this.finished=!0;const{buffer:e,view:n,blockLen:r,isLE:i}=this;let{pos:o}=this;e[o++]=128,Ke(this.buffer.subarray(o)),this.padOffset>r-o&&(this.process(n,0),o=0);for(let u=o;u<r;u++)e[u]=0;Ip(n,r-8,BigInt(this.length*8),i),this.process(n,0);const a=tr(t),l=this.outputLen;if(l%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const h=l/4,c=this.get();if(h>c.length)throw new Error("_sha2: outputLen bigger than state");for(let u=0;u<h;u++)a.setUint32(4*u,c[u],i)}digest(){const{buffer:t,outputLen:e}=this;this.digestInto(t);const n=t.slice(0,e);return this.destroy(),n}_cloneInto(t){t||(t=new this.constructor),t.set(...this.get());const{blockLen:e,buffer:n,length:r,finished:i,destroyed:o,pos:a}=this;return t.destroyed=o,t.finished=i,t.length=r,t.pos=a,r%e&&t.buffer.set(n),t}clone(){return this._cloneInto()}}const ue=Uint32Array.from([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),Rp=Uint32Array.from([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),de=new Uint32Array(64);class Lp extends vl{constructor(t=32){super(64,t,8,!1),this.A=ue[0]|0,this.B=ue[1]|0,this.C=ue[2]|0,this.D=ue[3]|0,this.E=ue[4]|0,this.F=ue[5]|0,this.G=ue[6]|0,this.H=ue[7]|0}get(){const{A:t,B:e,C:n,D:r,E:i,F:o,G:a,H:l}=this;return[t,e,n,r,i,o,a,l]}set(t,e,n,r,i,o,a,l){this.A=t|0,this.B=e|0,this.C=n|0,this.D=r|0,this.E=i|0,this.F=o|0,this.G=a|0,this.H=l|0}process(t,e){for(let u=0;u<16;u++,e+=4)de[u]=t.getUint32(e,!1);for(let u=16;u<64;u++){const f=de[u-15],d=de[u-2],p=$t(f,7)^$t(f,18)^f>>>3,g=$t(d,17)^$t(d,19)^d>>>10;de[u]=g+de[u-7]+p+de[u-16]|0}let{A:n,B:r,C:i,D:o,E:a,F:l,G:h,H:c}=this;for(let u=0;u<64;u++){const f=$t(a,6)^$t(a,11)^$t(a,25),d=c+f+Bp(a,l,h)+Rp[u]+de[u]|0,g=($t(n,2)^$t(n,13)^$t(n,22))+Fp(n,r,i)|0;c=h,h=l,l=a,a=o+d|0,o=i,i=r,r=n,n=d+g|0}n=n+this.A|0,r=r+this.B|0,i=i+this.C|0,o=o+this.D|0,a=a+this.E|0,l=l+this.F|0,h=h+this.G|0,c=c+this.H|0,this.set(n,r,i,o,a,l,h,c)}roundClean(){Ke(de)}destroy(){this.set(0,0,0,0,0,0,0,0),Ke(this.buffer)}}const rn=_l(()=>new Lp);class Al extends wl{constructor(t,e){super(),this.finished=!1,this.destroyed=!1,kp(t);const n=si(e);if(this.iHash=t.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const r=this.blockLen,i=new Uint8Array(r);i.set(n.length>r?t.create().update(n).digest():n);for(let o=0;o<i.length;o++)i[o]^=54;this.iHash.update(i),this.oHash=t.create();for(let o=0;o<i.length;o++)i[o]^=106;this.oHash.update(i),Ke(i)}update(t){return nn(this),this.iHash.update(t),this}digestInto(t){nn(this),he(t,this.outputLen),this.finished=!0,this.iHash.digestInto(t),this.oHash.update(t),this.oHash.digestInto(t),this.destroy()}digest(){const t=new Uint8Array(this.oHash.outputLen);return this.digestInto(t),t}_cloneInto(t){t||(t=Object.create(Object.getPrototypeOf(this),{}));const{oHash:e,iHash:n,finished:r,destroyed:i,blockLen:o,outputLen:a}=this;return t=t,t.finished=r,t.destroyed=i,t.blockLen=o,t.outputLen=a,t.oHash=e._cloneInto(t.oHash),t.iHash=n._cloneInto(t.iHash),t}clone(){return this._cloneInto()}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}const Sl=(s,t,e)=>new Al(s,t).update(e).digest();Sl.create=(s,t)=>new Al(s,t);/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const ni=BigInt(0),Fr=BigInt(1);function on(s,t){if(typeof t!="boolean")throw new Error(s+" boolean expected, got "+t)}function Ns(s){const t=s.toString(16);return t.length&1?"0"+t:t}function Cl(s){if(typeof s!="string")throw new Error("hex string expected, got "+typeof s);return s===""?ni:BigInt("0x"+s)}function xn(s){return Cl(ge(s))}function kl(s){return he(s),Cl(ge(Uint8Array.from(s).reverse()))}function ri(s,t){return ei(s.toString(16).padStart(t*2,"0"))}function Pl(s,t){return ri(s,t).reverse()}function Et(s,t,e){let n;if(typeof t=="string")try{n=ei(t)}catch(i){throw new Error(s+" must be hex string or Uint8Array, cause: "+i)}else if(ti(t))n=Uint8Array.from(t);else throw new Error(s+" must be hex string or Uint8Array");const r=n.length;if(typeof e=="number"&&r!==e)throw new Error(s+" of length "+e+" expected, got "+r);return n}const er=s=>typeof s=="bigint"&&ni<=s;function zp(s,t,e){return er(s)&&er(t)&&er(e)&&t<=s&&s<e}function Gp(s,t,e,n){if(!zp(t,e,n))throw new Error("expected valid "+s+": "+e+" <= n < "+n+", got "+t)}function Op(s){let t;for(t=0;s>ni;s>>=Fr,t+=1);return t}const yn=s=>(Fr<<BigInt(s))-Fr;function Np(s,t,e){if(typeof s!="number"||s<2)throw new Error("hashLen must be a number");if(typeof t!="number"||t<2)throw new Error("qByteLen must be a number");if(typeof e!="function")throw new Error("hmacFn must be a function");const n=d=>new Uint8Array(d),r=d=>Uint8Array.of(d);let i=n(s),o=n(s),a=0;const l=()=>{i.fill(1),o.fill(0),a=0},h=(...d)=>e(o,i,...d),c=(d=n(0))=>{o=h(r(0),d),i=h(),d.length!==0&&(o=h(r(1),d),i=h())},u=()=>{if(a++>=1e3)throw new Error("drbg: tried 1000 values");let d=0;const p=[];for(;d<t;){i=h();const g=i.slice();p.push(g),d+=i.length}return Be(...p)};return(d,p)=>{l(),c(d);let g;for(;!(g=p(u()));)c();return l(),g}}function ii(s,t,e={}){if(!s||typeof s!="object")throw new Error("expected valid options object");function n(r,i,o){const a=s[r];if(o&&a===void 0)return;const l=typeof a;if(l!==i||a===null)throw new Error(`param "${r}" is invalid: expected ${i}, got ${l}`)}Object.entries(t).forEach(([r,i])=>n(r,i,!1)),Object.entries(e).forEach(([r,i])=>n(r,i,!0))}function Mo(s){const t=new WeakMap;return(e,...n)=>{const r=t.get(e);if(r!==void 0)return r;const i=s(e,...n);return t.set(e,i),i}}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const _t=BigInt(0),gt=BigInt(1),Fe=BigInt(2),Up=BigInt(3),Ml=BigInt(4),Tl=BigInt(5),El=BigInt(8);function It(s,t){const e=s%t;return e>=_t?e:t+e}function Tt(s,t,e){let n=s;for(;t-- >_t;)n*=n,n%=e;return n}function To(s,t){if(s===_t)throw new Error("invert: expected non-zero number");if(t<=_t)throw new Error("invert: expected positive modulus, got "+t);let e=It(s,t),n=t,r=_t,i=gt;for(;e!==_t;){const a=n/e,l=n%e,h=r-i*a;n=e,e=l,r=i,i=h}if(n!==gt)throw new Error("invert: does not exist");return It(r,t)}function Il(s,t){const e=(s.ORDER+gt)/Ml,n=s.pow(t,e);if(!s.eql(s.sqr(n),t))throw new Error("Cannot find square root");return n}function Dp(s,t){const e=(s.ORDER-Tl)/El,n=s.mul(t,Fe),r=s.pow(n,e),i=s.mul(t,r),o=s.mul(s.mul(i,Fe),r),a=s.mul(i,s.sub(o,s.ONE));if(!s.eql(s.sqr(a),t))throw new Error("Cannot find square root");return a}function Hp(s){if(s<BigInt(3))throw new Error("sqrt is not defined for small field");let t=s-gt,e=0;for(;t%Fe===_t;)t/=Fe,e++;let n=Fe;const r=bn(s);for(;Eo(r,n)===1;)if(n++>1e3)throw new Error("Cannot find square root: probably non-prime P");if(e===1)return Il;let i=r.pow(n,t);const o=(t+gt)/Fe;return function(l,h){if(l.is0(h))return h;if(Eo(l,h)!==1)throw new Error("Cannot find square root");let c=e,u=l.mul(l.ONE,i),f=l.pow(h,t),d=l.pow(h,o);for(;!l.eql(f,l.ONE);){if(l.is0(f))return l.ZERO;let p=1,g=l.sqr(f);for(;!l.eql(g,l.ONE);)if(p++,g=l.sqr(g),p===c)throw new Error("Cannot find square root");const m=gt<<BigInt(c-p-1),x=l.pow(u,m);c=p,u=l.sqr(x),f=l.mul(f,u),d=l.mul(d,x)}return d}}function Wp(s){return s%Ml===Up?Il:s%El===Tl?Dp:Hp(s)}const jp=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function $p(s){const t={ORDER:"bigint",MASK:"bigint",BYTES:"number",BITS:"number"},e=jp.reduce((n,r)=>(n[r]="function",n),t);return ii(s,e),s}function Vp(s,t,e){if(e<_t)throw new Error("invalid exponent, negatives unsupported");if(e===_t)return s.ONE;if(e===gt)return t;let n=s.ONE,r=t;for(;e>_t;)e&gt&&(n=s.mul(n,r)),r=s.sqr(r),e>>=gt;return n}function Bl(s,t,e=!1){const n=new Array(t.length).fill(e?s.ZERO:void 0),r=t.reduce((o,a,l)=>s.is0(a)?o:(n[l]=o,s.mul(o,a)),s.ONE),i=s.inv(r);return t.reduceRight((o,a,l)=>s.is0(a)?o:(n[l]=s.mul(o,n[l]),s.mul(o,a)),i),n}function Eo(s,t){const e=(s.ORDER-gt)/Fe,n=s.pow(t,e),r=s.eql(n,s.ONE),i=s.eql(n,s.ZERO),o=s.eql(n,s.neg(s.ONE));if(!r&&!i&&!o)throw new Error("invalid Legendre symbol result");return r?1:i?0:-1}function Yp(s,t){t!==void 0&&Br(t);const e=t!==void 0?t:s.toString(2).length,n=Math.ceil(e/8);return{nBitLength:e,nByteLength:n}}function bn(s,t,e=!1,n={}){if(s<=_t)throw new Error("invalid field: expected ORDER > 0, got "+s);let r,i;if(typeof t=="object"&&t!=null){if(n.sqrt||e)throw new Error("cannot specify opts in two arguments");const c=t;c.BITS&&(r=c.BITS),c.sqrt&&(i=c.sqrt),typeof c.isLE=="boolean"&&(e=c.isLE)}else typeof t=="number"&&(r=t),n.sqrt&&(i=n.sqrt);const{nBitLength:o,nByteLength:a}=Yp(s,r);if(a>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");let l;const h=Object.freeze({ORDER:s,isLE:e,BITS:o,BYTES:a,MASK:yn(o),ZERO:_t,ONE:gt,create:c=>It(c,s),isValid:c=>{if(typeof c!="bigint")throw new Error("invalid field element: expected bigint, got "+typeof c);return _t<=c&&c<s},is0:c=>c===_t,isValidNot0:c=>!h.is0(c)&&h.isValid(c),isOdd:c=>(c&gt)===gt,neg:c=>It(-c,s),eql:(c,u)=>c===u,sqr:c=>It(c*c,s),add:(c,u)=>It(c+u,s),sub:(c,u)=>It(c-u,s),mul:(c,u)=>It(c*u,s),pow:(c,u)=>Vp(h,c,u),div:(c,u)=>It(c*To(u,s),s),sqrN:c=>c*c,addN:(c,u)=>c+u,subN:(c,u)=>c-u,mulN:(c,u)=>c*u,inv:c=>To(c,s),sqrt:i||(c=>(l||(l=Wp(s)),l(h,c))),toBytes:c=>e?Pl(c,a):ri(c,a),fromBytes:c=>{if(c.length!==a)throw new Error("Field.fromBytes: expected "+a+" bytes, got "+c.length);return e?kl(c):xn(c)},invertBatch:c=>Bl(h,c),cmov:(c,u,f)=>f?u:c});return Object.freeze(h)}function Fl(s){if(typeof s!="bigint")throw new Error("field order must be bigint");const t=s.toString(2).length;return Math.ceil(t/8)}function Rl(s){const t=Fl(s);return t+Math.ceil(t/2)}function Xp(s,t,e=!1){const n=s.length,r=Fl(t),i=Rl(t);if(n<16||n<i||n>1024)throw new Error("expected "+i+"-1024 bytes of input, got "+n);const o=e?kl(s):xn(s),a=It(o,t-gt)+gt;return e?Pl(a,r):ri(a,r)}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Ze=BigInt(0),Re=BigInt(1);function xs(s,t){const e=t.negate();return s?e:t}function qp(s,t,e){const n=o=>o.pz,r=Bl(s.Fp,e.map(n));return e.map((o,a)=>o.toAffine(r[a])).map(s.fromAffine)}function Ll(s,t){if(!Number.isSafeInteger(s)||s<=0||s>t)throw new Error("invalid window size, expected [1.."+t+"], got W="+s)}function sr(s,t){Ll(s,t);const e=Math.ceil(t/s)+1,n=2**(s-1),r=2**s,i=yn(s),o=BigInt(s);return{windows:e,windowSize:n,mask:i,maxNumber:r,shiftBy:o}}function Io(s,t,e){const{windowSize:n,mask:r,maxNumber:i,shiftBy:o}=e;let a=Number(s&r),l=s>>o;a>n&&(a-=i,l+=Re);const h=t*n,c=h+Math.abs(a)-1,u=a===0,f=a<0,d=t%2!==0;return{nextN:l,offset:c,isZero:u,isNeg:f,isNegF:d,offsetF:h}}function Kp(s,t){if(!Array.isArray(s))throw new Error("array expected");s.forEach((e,n)=>{if(!(e instanceof t))throw new Error("invalid point at index "+n)})}function Zp(s,t){if(!Array.isArray(s))throw new Error("array of scalars expected");s.forEach((e,n)=>{if(!t.isValid(e))throw new Error("invalid scalar at index "+n)})}const nr=new WeakMap,zl=new WeakMap;function rr(s){return zl.get(s)||1}function Bo(s){if(s!==Ze)throw new Error("invalid wNAF")}function Qp(s,t){return{constTimeNegate:xs,hasPrecomputes(e){return rr(e)!==1},unsafeLadder(e,n,r=s.ZERO){let i=e;for(;n>Ze;)n&Re&&(r=r.add(i)),i=i.double(),n>>=Re;return r},precomputeWindow(e,n){const{windows:r,windowSize:i}=sr(n,t),o=[];let a=e,l=a;for(let h=0;h<r;h++){l=a,o.push(l);for(let c=1;c<i;c++)l=l.add(a),o.push(l);a=l.double()}return o},wNAF(e,n,r){let i=s.ZERO,o=s.BASE;const a=sr(e,t);for(let l=0;l<a.windows;l++){const{nextN:h,offset:c,isZero:u,isNeg:f,isNegF:d,offsetF:p}=Io(r,l,a);r=h,u?o=o.add(xs(d,n[p])):i=i.add(xs(f,n[c]))}return Bo(r),{p:i,f:o}},wNAFUnsafe(e,n,r,i=s.ZERO){const o=sr(e,t);for(let a=0;a<o.windows&&r!==Ze;a++){const{nextN:l,offset:h,isZero:c,isNeg:u}=Io(r,a,o);if(r=l,!c){const f=n[h];i=i.add(u?f.negate():f)}}return Bo(r),i},getPrecomputes(e,n,r){let i=nr.get(n);return i||(i=this.precomputeWindow(n,e),e!==1&&(typeof r=="function"&&(i=r(i)),nr.set(n,i))),i},wNAFCached(e,n,r){const i=rr(e);return this.wNAF(i,this.getPrecomputes(i,e,r),n)},wNAFCachedUnsafe(e,n,r,i){const o=rr(e);return o===1?this.unsafeLadder(e,n,i):this.wNAFUnsafe(o,this.getPrecomputes(o,e,r),n,i)},setWindowSize(e,n){Ll(n,t),zl.set(e,n),nr.delete(e)}}}function Jp(s,t,e,n){let r=t,i=s.ZERO,o=s.ZERO;for(;e>Ze||n>Ze;)e&Re&&(i=i.add(r)),n&Re&&(o=o.add(r)),r=r.double(),e>>=Re,n>>=Re;return{p1:i,p2:o}}function tm(s,t,e,n){Kp(e,s),Zp(n,t);const r=e.length,i=n.length;if(r!==i)throw new Error("arrays of points and scalars must have equal length");const o=s.ZERO,a=Op(BigInt(r));let l=1;a>12?l=a-3:a>4?l=a-2:a>0&&(l=2);const h=yn(l),c=new Array(Number(h)+1).fill(o),u=Math.floor((t.BITS-1)/l)*l;let f=o;for(let d=u;d>=0;d-=l){c.fill(o);for(let g=0;g<i;g++){const m=n[g],x=Number(m>>BigInt(d)&h);c[x]=c[x].add(e[g])}let p=o;for(let g=c.length-1,m=o;g>0;g--)m=m.add(c[g]),p=p.add(m);if(f=f.add(p),d!==0)for(let g=0;g<l;g++)f=f.double()}return f}function Fo(s,t){if(t){if(t.ORDER!==s)throw new Error("Field.ORDER must match order: Fp == p, Fn == n");return $p(t),t}else return bn(s)}function em(s,t,e={}){if(!t||typeof t!="object")throw new Error(`expected valid ${s} CURVE object`);for(const a of["p","n","h"]){const l=t[a];if(!(typeof l=="bigint"&&l>Ze))throw new Error(`CURVE.${a} must be positive bigint`)}const n=Fo(t.p,e.Fp),r=Fo(t.n,e.Fn),o=["Gx","Gy","a","b"];for(const a of o)if(!n.isValid(t[a]))throw new Error(`CURVE.${a} must be valid field element of CURVE.Fp`);return{Fp:n,Fn:r}}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */function Ro(s){s.lowS!==void 0&&on("lowS",s.lowS),s.prehash!==void 0&&on("prehash",s.prehash)}class sm extends Error{constructor(t=""){super(t)}}const oe={Err:sm,_tlv:{encode:(s,t)=>{const{Err:e}=oe;if(s<0||s>256)throw new e("tlv.encode: wrong tag");if(t.length&1)throw new e("tlv.encode: unpadded data");const n=t.length/2,r=Ns(n);if(r.length/2&128)throw new e("tlv.encode: long form length too big");const i=n>127?Ns(r.length/2|128):"";return Ns(s)+i+r+t},decode(s,t){const{Err:e}=oe;let n=0;if(s<0||s>256)throw new e("tlv.encode: wrong tag");if(t.length<2||t[n++]!==s)throw new e("tlv.decode: wrong tlv");const r=t[n++],i=!!(r&128);let o=0;if(!i)o=r;else{const l=r&127;if(!l)throw new e("tlv.decode(long): indefinite length not supported");if(l>4)throw new e("tlv.decode(long): byte length is too big");const h=t.subarray(n,n+l);if(h.length!==l)throw new e("tlv.decode: length bytes not complete");if(h[0]===0)throw new e("tlv.decode(long): zero leftmost byte");for(const c of h)o=o<<8|c;if(n+=l,o<128)throw new e("tlv.decode(long): not minimal encoding")}const a=t.subarray(n,n+o);if(a.length!==o)throw new e("tlv.decode: wrong value length");return{v:a,l:t.subarray(n+o)}}},_int:{encode(s){const{Err:t}=oe;if(s<ys)throw new t("integer: negative integers are not allowed");let e=Ns(s);if(Number.parseInt(e[0],16)&8&&(e="00"+e),e.length&1)throw new t("unexpected DER parsing assertion: unpadded hex");return e},decode(s){const{Err:t}=oe;if(s[0]&128)throw new t("invalid signature integer: negative");if(s[0]===0&&!(s[1]&128))throw new t("invalid signature integer: unnecessary leading zero");return xn(s)}},toSig(s){const{Err:t,_int:e,_tlv:n}=oe,r=Et("signature",s),{v:i,l:o}=n.decode(48,r);if(o.length)throw new t("invalid signature: left bytes after parsing");const{v:a,l}=n.decode(2,i),{v:h,l:c}=n.decode(2,l);if(c.length)throw new t("invalid signature: left bytes after parsing");return{r:e.decode(a),s:e.decode(h)}},hexFromSig(s){const{_tlv:t,_int:e}=oe,n=t.encode(2,e.encode(s.r)),r=t.encode(2,e.encode(s.s)),i=n+r;return t.encode(48,i)}},ys=BigInt(0),bs=BigInt(1),nm=BigInt(2),Us=BigInt(3),rm=BigInt(4);function im(s,t,e){function n(r){const i=s.sqr(r),o=s.mul(i,r);return s.add(s.add(o,s.mul(r,t)),e)}return n}function Gl(s,t,e){const{BYTES:n}=s;function r(i){let o;if(typeof i=="bigint")o=i;else{let a=Et("private key",i);if(t){if(!t.includes(a.length*2))throw new Error("invalid private key");const l=new Uint8Array(n);l.set(a,l.length-a.length),a=l}try{o=s.fromBytes(a)}catch{throw new Error(`invalid private key: expected ui8a of size ${n}, got ${typeof i}`)}}if(e&&(o=s.create(o)),!s.isValidNot0(o))throw new Error("invalid private key: out of range [1..N-1]");return o}return r}function om(s,t={}){const{Fp:e,Fn:n}=em("weierstrass",s,t),{h:r,n:i}=s;ii(t,{},{allowInfinityPoint:"boolean",clearCofactor:"function",isTorsionFree:"function",fromBytes:"function",toBytes:"function",endo:"object",wrapPrivateKey:"boolean"});const{endo:o}=t;if(o&&(!e.is0(s.a)||typeof o.beta!="bigint"||typeof o.splitScalar!="function"))throw new Error('invalid endo: expected "beta": bigint and "splitScalar": function');function a(){if(!e.isOdd)throw new Error("compression is not supported: Field does not have .isOdd()")}function l(P,v,k){const{x:S,y:M}=v.toAffine(),E=e.toBytes(S);if(on("isCompressed",k),k){a();const F=!e.isOdd(M);return Be(Ol(F),E)}else return Be(Uint8Array.of(4),E,e.toBytes(M))}function h(P){he(P);const v=e.BYTES,k=v+1,S=2*v+1,M=P.length,E=P[0],F=P.subarray(1);if(M===k&&(E===2||E===3)){const R=e.fromBytes(F);if(!e.isValid(R))throw new Error("bad point: is not on curve, wrong x");const T=f(R);let I;try{I=e.sqrt(T)}catch(W){const U=W instanceof Error?": "+W.message:"";throw new Error("bad point: is not on curve, sqrt error"+U)}a();const B=e.isOdd(I);return(E&1)===1!==B&&(I=e.neg(I)),{x:R,y:I}}else if(M===S&&E===4){const R=e.fromBytes(F.subarray(v*0,v*1)),T=e.fromBytes(F.subarray(v*1,v*2));if(!d(R,T))throw new Error("bad point: is not on curve");return{x:R,y:T}}else throw new Error(`bad point: got length ${M}, expected compressed=${k} or uncompressed=${S}`)}const c=t.toBytes||l,u=t.fromBytes||h,f=im(e,s.a,s.b);function d(P,v){const k=e.sqr(v),S=f(P);return e.eql(k,S)}if(!d(s.Gx,s.Gy))throw new Error("bad curve params: generator point");const p=e.mul(e.pow(s.a,Us),rm),g=e.mul(e.sqr(s.b),BigInt(27));if(e.is0(e.add(p,g)))throw new Error("bad curve params: a or b");function m(P,v,k=!1){if(!e.isValid(v)||k&&e.is0(v))throw new Error(`bad point coordinate ${P}`);return v}function x(P){if(!(P instanceof _))throw new Error("ProjectivePoint expected")}const y=Mo((P,v)=>{const{px:k,py:S,pz:M}=P;if(e.eql(M,e.ONE))return{x:k,y:S};const E=P.is0();v==null&&(v=E?e.ONE:e.inv(M));const F=e.mul(k,v),R=e.mul(S,v),T=e.mul(M,v);if(E)return{x:e.ZERO,y:e.ZERO};if(!e.eql(T,e.ONE))throw new Error("invZ was invalid");return{x:F,y:R}}),b=Mo(P=>{if(P.is0()){if(t.allowInfinityPoint&&!e.is0(P.py))return;throw new Error("bad point: ZERO")}const{x:v,y:k}=P.toAffine();if(!e.isValid(v)||!e.isValid(k))throw new Error("bad point: x or y not field elements");if(!d(v,k))throw new Error("bad point: equation left != right");if(!P.isTorsionFree())throw new Error("bad point: not in prime-order subgroup");return!0});function w(P,v,k,S,M){return k=new _(e.mul(k.px,P),k.py,k.pz),v=xs(S,v),k=xs(M,k),v.add(k)}class _{constructor(v,k,S){this.px=m("x",v),this.py=m("y",k,!0),this.pz=m("z",S),Object.freeze(this)}static fromAffine(v){const{x:k,y:S}=v||{};if(!v||!e.isValid(k)||!e.isValid(S))throw new Error("invalid affine point");if(v instanceof _)throw new Error("projective point not allowed");return e.is0(k)&&e.is0(S)?_.ZERO:new _(k,S,e.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(v){return qp(_,"pz",v)}static fromBytes(v){return he(v),_.fromHex(v)}static fromHex(v){const k=_.fromAffine(u(Et("pointHex",v)));return k.assertValidity(),k}static fromPrivateKey(v){const k=Gl(n,t.allowedPrivateKeyLengths,t.wrapPrivateKey);return _.BASE.multiply(k(v))}static msm(v,k){return tm(_,n,v,k)}precompute(v=8,k=!0){return C.setWindowSize(this,v),k||this.multiply(Us),this}_setWindowSize(v){this.precompute(v)}assertValidity(){b(this)}hasEvenY(){const{y:v}=this.toAffine();if(!e.isOdd)throw new Error("Field doesn't support isOdd");return!e.isOdd(v)}equals(v){x(v);const{px:k,py:S,pz:M}=this,{px:E,py:F,pz:R}=v,T=e.eql(e.mul(k,R),e.mul(E,M)),I=e.eql(e.mul(S,R),e.mul(F,M));return T&&I}negate(){return new _(this.px,e.neg(this.py),this.pz)}double(){const{a:v,b:k}=s,S=e.mul(k,Us),{px:M,py:E,pz:F}=this;let R=e.ZERO,T=e.ZERO,I=e.ZERO,B=e.mul(M,M),D=e.mul(E,E),W=e.mul(F,F),U=e.mul(M,E);return U=e.add(U,U),I=e.mul(M,F),I=e.add(I,I),R=e.mul(v,I),T=e.mul(S,W),T=e.add(R,T),R=e.sub(D,T),T=e.add(D,T),T=e.mul(R,T),R=e.mul(U,R),I=e.mul(S,I),W=e.mul(v,W),U=e.sub(B,W),U=e.mul(v,U),U=e.add(U,I),I=e.add(B,B),B=e.add(I,B),B=e.add(B,W),B=e.mul(B,U),T=e.add(T,B),W=e.mul(E,F),W=e.add(W,W),B=e.mul(W,U),R=e.sub(R,B),I=e.mul(W,D),I=e.add(I,I),I=e.add(I,I),new _(R,T,I)}add(v){x(v);const{px:k,py:S,pz:M}=this,{px:E,py:F,pz:R}=v;let T=e.ZERO,I=e.ZERO,B=e.ZERO;const D=s.a,W=e.mul(s.b,Us);let U=e.mul(k,E),Q=e.mul(S,F),H=e.mul(M,R),K=e.add(k,S),Y=e.add(E,F);K=e.mul(K,Y),Y=e.add(U,Q),K=e.sub(K,Y),Y=e.add(k,M);let tt=e.add(E,R);return Y=e.mul(Y,tt),tt=e.add(U,H),Y=e.sub(Y,tt),tt=e.add(S,M),T=e.add(F,R),tt=e.mul(tt,T),T=e.add(Q,H),tt=e.sub(tt,T),B=e.mul(D,Y),T=e.mul(W,H),B=e.add(T,B),T=e.sub(Q,B),B=e.add(Q,B),I=e.mul(T,B),Q=e.add(U,U),Q=e.add(Q,U),H=e.mul(D,H),Y=e.mul(W,Y),Q=e.add(Q,H),H=e.sub(U,H),H=e.mul(D,H),Y=e.add(Y,H),U=e.mul(Q,Y),I=e.add(I,U),U=e.mul(tt,Y),T=e.mul(K,T),T=e.sub(T,U),U=e.mul(K,Q),B=e.mul(tt,B),B=e.add(B,U),new _(T,I,B)}subtract(v){return this.add(v.negate())}is0(){return this.equals(_.ZERO)}multiply(v){const{endo:k}=t;if(!n.isValidNot0(v))throw new Error("invalid scalar: out of range");let S,M;const E=F=>C.wNAFCached(this,F,_.normalizeZ);if(k){const{k1neg:F,k1:R,k2neg:T,k2:I}=k.splitScalar(v),{p:B,f:D}=E(R),{p:W,f:U}=E(I);M=D.add(U),S=w(k.beta,B,W,F,T)}else{const{p:F,f:R}=E(v);S=F,M=R}return _.normalizeZ([S,M])[0]}multiplyUnsafe(v){const{endo:k}=t,S=this;if(!n.isValid(v))throw new Error("invalid scalar: out of range");if(v===ys||S.is0())return _.ZERO;if(v===bs)return S;if(C.hasPrecomputes(this))return this.multiply(v);if(k){const{k1neg:M,k1:E,k2neg:F,k2:R}=k.splitScalar(v),{p1:T,p2:I}=Jp(_,S,E,R);return w(k.beta,T,I,M,F)}else return C.wNAFCachedUnsafe(S,v)}multiplyAndAddUnsafe(v,k,S){const M=this.multiplyUnsafe(k).add(v.multiplyUnsafe(S));return M.is0()?void 0:M}toAffine(v){return y(this,v)}isTorsionFree(){const{isTorsionFree:v}=t;return r===bs?!0:v?v(_,this):C.wNAFCachedUnsafe(this,i).is0()}clearCofactor(){const{clearCofactor:v}=t;return r===bs?this:v?v(_,this):this.multiplyUnsafe(r)}toBytes(v=!0){return on("isCompressed",v),this.assertValidity(),c(_,this,v)}toRawBytes(v=!0){return this.toBytes(v)}toHex(v=!0){return ge(this.toBytes(v))}toString(){return`<Point ${this.is0()?"ZERO":this.toHex()}>`}}_.BASE=new _(s.Gx,s.Gy,e.ONE),_.ZERO=new _(e.ZERO,e.ONE,e.ZERO),_.Fp=e,_.Fn=n;const A=n.BITS,C=Qp(_,t.endo?Math.ceil(A/2):A);return _}function Ol(s){return Uint8Array.of(s?2:3)}function am(s,t,e={}){ii(t,{hash:"function"},{hmac:"function",lowS:"boolean",randomBytes:"function",bits2int:"function",bits2int_modN:"function"});const n=t.randomBytes||Ep,r=t.hmac||((S,...M)=>Sl(t.hash,S,Be(...M))),{Fp:i,Fn:o}=s,{ORDER:a,BITS:l}=o;function h(S){const M=a>>bs;return S>M}function c(S){return h(S)?o.neg(S):S}function u(S,M){if(!o.isValidNot0(M))throw new Error(`invalid signature ${S}: out of range 1..CURVE.n`)}class f{constructor(M,E,F){u("r",M),u("s",E),this.r=M,this.s=E,F!=null&&(this.recovery=F),Object.freeze(this)}static fromCompact(M){const E=o.BYTES,F=Et("compactSignature",M,E*2);return new f(o.fromBytes(F.subarray(0,E)),o.fromBytes(F.subarray(E,E*2)))}static fromDER(M){const{r:E,s:F}=oe.toSig(Et("DER",M));return new f(E,F)}assertValidity(){}addRecoveryBit(M){return new f(this.r,this.s,M)}recoverPublicKey(M){const E=i.ORDER,{r:F,s:R,recovery:T}=this;if(T==null||![0,1,2,3].includes(T))throw new Error("recovery id invalid");if(a*nm<E&&T>1)throw new Error("recovery id is ambiguous for h>1 curve");const B=T===2||T===3?F+a:F;if(!i.isValid(B))throw new Error("recovery id 2 or 3 invalid");const D=i.toBytes(B),W=s.fromHex(Be(Ol((T&1)===0),D)),U=o.inv(B),Q=b(Et("msgHash",M)),H=o.create(-Q*U),K=o.create(R*U),Y=s.BASE.multiplyUnsafe(H).add(W.multiplyUnsafe(K));if(Y.is0())throw new Error("point at infinify");return Y.assertValidity(),Y}hasHighS(){return h(this.s)}normalizeS(){return this.hasHighS()?new f(this.r,o.neg(this.s),this.recovery):this}toBytes(M){if(M==="compact")return Be(o.toBytes(this.r),o.toBytes(this.s));if(M==="der")return ei(oe.hexFromSig(this));throw new Error("invalid format")}toDERRawBytes(){return this.toBytes("der")}toDERHex(){return ge(this.toBytes("der"))}toCompactRawBytes(){return this.toBytes("compact")}toCompactHex(){return ge(this.toBytes("compact"))}}const d=Gl(o,e.allowedPrivateKeyLengths,e.wrapPrivateKey),p={isValidPrivateKey(S){try{return d(S),!0}catch{return!1}},normPrivateKeyToScalar:d,randomPrivateKey:()=>{const S=a;return Xp(n(Rl(S)),S)},precompute(S=8,M=s.BASE){return M.precompute(S,!1)}};function g(S,M=!0){return s.fromPrivateKey(S).toBytes(M)}function m(S){if(typeof S=="bigint")return!1;if(S instanceof s)return!0;const E=Et("key",S).length,F=i.BYTES,R=F+1,T=2*F+1;if(!(e.allowedPrivateKeyLengths||o.BYTES===R))return E===R||E===T}function x(S,M,E=!0){if(m(S)===!0)throw new Error("first arg must be private key");if(m(M)===!1)throw new Error("second arg must be public key");return s.fromHex(M).multiply(d(S)).toBytes(E)}const y=t.bits2int||function(S){if(S.length>8192)throw new Error("input is too large");const M=xn(S),E=S.length*8-l;return E>0?M>>BigInt(E):M},b=t.bits2int_modN||function(S){return o.create(y(S))},w=yn(l);function _(S){return Gp("num < 2^"+l,S,ys,w),o.toBytes(S)}function A(S,M,E=C){if(["recovered","canonical"].some(K=>K in E))throw new Error("sign() legacy options not supported");const{hash:F}=t;let{lowS:R,prehash:T,extraEntropy:I}=E;R==null&&(R=!0),S=Et("msgHash",S),Ro(E),T&&(S=Et("prehashed msgHash",F(S)));const B=b(S),D=d(M),W=[_(D),_(B)];if(I!=null&&I!==!1){const K=I===!0?n(i.BYTES):I;W.push(Et("extraEntropy",K))}const U=Be(...W),Q=B;function H(K){const Y=y(K);if(!o.isValidNot0(Y))return;const tt=o.inv(Y),J=s.BASE.multiply(Y).toAffine(),Pt=o.create(J.x);if(Pt===ys)return;const ut=o.create(tt*o.create(Q+Pt*D));if(ut===ys)return;let vt=(J.x===Pt?0:2)|Number(J.y&bs),xt=ut;return R&&h(ut)&&(xt=c(ut),vt^=1),new f(Pt,xt,vt)}return{seed:U,k2sig:H}}const C={lowS:t.lowS,prehash:!1},P={lowS:t.lowS,prehash:!1};function v(S,M,E=C){const{seed:F,k2sig:R}=A(S,M,E);return Np(t.hash.outputLen,o.BYTES,r)(F,R)}s.BASE.precompute(8);function k(S,M,E,F=P){const R=S;M=Et("msgHash",M),E=Et("publicKey",E),Ro(F);const{lowS:T,prehash:I,format:B}=F;if("strict"in F)throw new Error("options.strict was renamed to lowS");if(B!==void 0&&!["compact","der","js"].includes(B))throw new Error('format must be "compact", "der" or "js"');const D=typeof R=="string"||ti(R),W=!D&&!B&&typeof R=="object"&&R!==null&&typeof R.r=="bigint"&&typeof R.s=="bigint";if(!D&&!W)throw new Error("invalid signature, expected Uint8Array, hex string or Signature instance");let U,Q;try{if(W)if(B===void 0||B==="js")U=new f(R.r,R.s);else throw new Error("invalid format");if(D){try{B!=="compact"&&(U=f.fromDER(R))}catch(xt){if(!(xt instanceof oe.Err))throw xt}!U&&B!=="der"&&(U=f.fromCompact(R))}Q=s.fromHex(E)}catch{return!1}if(!U||T&&U.hasHighS())return!1;I&&(M=t.hash(M));const{r:H,s:K}=U,Y=b(M),tt=o.inv(K),J=o.create(Y*tt),Pt=o.create(H*tt),ut=s.BASE.multiplyUnsafe(J).add(Q.multiplyUnsafe(Pt));return ut.is0()?!1:o.create(ut.x)===H}return Object.freeze({getPublicKey:g,getSharedSecret:x,sign:v,verify:k,utils:p,Point:s,Signature:f})}function lm(s){const t={a:s.a,b:s.b,p:s.Fp.ORDER,n:s.n,h:s.h,Gx:s.Gx,Gy:s.Gy},e=s.Fp,n=bn(t.n,s.nBitLength),r={Fp:e,Fn:n,allowedPrivateKeyLengths:s.allowedPrivateKeyLengths,allowInfinityPoint:s.allowInfinityPoint,endo:s.endo,wrapPrivateKey:s.wrapPrivateKey,isTorsionFree:s.isTorsionFree,clearCofactor:s.clearCofactor,fromBytes:s.fromBytes,toBytes:s.toBytes};return{CURVE:t,curveOpts:r}}function cm(s){const{CURVE:t,curveOpts:e}=lm(s),n={hash:s.hash,hmac:s.hmac,randomBytes:s.randomBytes,lowS:s.lowS,bits2int:s.bits2int,bits2int_modN:s.bits2int_modN};return{CURVE:t,curveOpts:e,ecdsaOpts:n}}function hm(s,t){return Object.assign({},t,{ProjectivePoint:t.Point,CURVE:s})}function um(s){const{CURVE:t,curveOpts:e,ecdsaOpts:n}=cm(s),r=om(t,e),i=am(r,n,e);return hm(s,i)}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */function dm(s,t){const e=n=>um({...s,hash:n});return{...e(t),create:e}}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const an={p:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),n:BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),h:BigInt(1),a:BigInt(0),b:BigInt(7),Gx:BigInt("0x79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798"),Gy:BigInt("0x483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8")};BigInt(0);const fm=BigInt(1),Rr=BigInt(2),Lo=(s,t)=>(s+t/Rr)/t;function pm(s){const t=an.p,e=BigInt(3),n=BigInt(6),r=BigInt(11),i=BigInt(22),o=BigInt(23),a=BigInt(44),l=BigInt(88),h=s*s*s%t,c=h*h*s%t,u=Tt(c,e,t)*c%t,f=Tt(u,e,t)*c%t,d=Tt(f,Rr,t)*h%t,p=Tt(d,r,t)*d%t,g=Tt(p,i,t)*p%t,m=Tt(g,a,t)*g%t,x=Tt(m,l,t)*m%t,y=Tt(x,a,t)*g%t,b=Tt(y,e,t)*c%t,w=Tt(b,o,t)*p%t,_=Tt(w,n,t)*h%t,A=Tt(_,Rr,t);if(!Lr.eql(Lr.sqr(A),s))throw new Error("Cannot find square root");return A}const Lr=bn(an.p,void 0,void 0,{sqrt:pm}),ir=dm({...an,Fp:Lr,lowS:!0,endo:{beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar:s=>{const t=an.n,e=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),n=-fm*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),r=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),i=e,o=BigInt("0x100000000000000000000000000000000"),a=Lo(i*s,t),l=Lo(-n*s,t);let h=It(s-a*e-l*r,t),c=It(-a*n-l*i,t);const u=h>o,f=c>o;if(u&&(h=t-h),f&&(c=t-c),h>o||c>o)throw new Error("splitScalar: Endomorphism failed, k="+s);return{k1neg:u,k1:h,k2neg:f,k2:c}}}},rn),mm=Uint8Array.from([7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8]),Nl=Uint8Array.from(new Array(16).fill(0).map((s,t)=>t)),gm=Nl.map(s=>(9*s+5)%16),Ul=(()=>{const e=[[Nl],[gm]];for(let n=0;n<4;n++)for(let r of e)r.push(r[n].map(i=>mm[i]));return e})(),Dl=Ul[0],Hl=Ul[1],Wl=[[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8],[12,13,11,15,6,9,9,7,12,15,11,13,7,8,7,7],[13,15,14,11,7,7,6,8,13,14,13,12,5,5,6,9],[14,11,12,14,8,6,5,5,15,12,15,14,9,9,8,6],[15,12,13,13,9,5,8,6,14,11,12,11,8,6,5,5]].map(s=>Uint8Array.from(s)),xm=Dl.map((s,t)=>s.map(e=>Wl[t][e])),ym=Hl.map((s,t)=>s.map(e=>Wl[t][e])),bm=Uint32Array.from([0,1518500249,1859775393,2400959708,2840853838]),wm=Uint32Array.from([1352829926,1548603684,1836072691,2053994217,0]);function zo(s,t,e,n){return s===0?t^e^n:s===1?t&e|~t&n:s===2?(t|~e)^n:s===3?t&n|e&~n:t^(e|~n)}const Ds=new Uint32Array(16);class _m extends vl{constructor(){super(64,20,8,!0),this.h0=1732584193,this.h1=-271733879,this.h2=-1732584194,this.h3=271733878,this.h4=-1009589776}get(){const{h0:t,h1:e,h2:n,h3:r,h4:i}=this;return[t,e,n,r,i]}set(t,e,n,r,i){this.h0=t|0,this.h1=e|0,this.h2=n|0,this.h3=r|0,this.h4=i|0}process(t,e){for(let d=0;d<16;d++,e+=4)Ds[d]=t.getUint32(e,!0);let n=this.h0|0,r=n,i=this.h1|0,o=i,a=this.h2|0,l=a,h=this.h3|0,c=h,u=this.h4|0,f=u;for(let d=0;d<5;d++){const p=4-d,g=bm[d],m=wm[d],x=Dl[d],y=Hl[d],b=xm[d],w=ym[d];for(let _=0;_<16;_++){const A=Os(n+zo(d,i,a,h)+Ds[x[_]]+g,b[_])+u|0;n=u,u=h,h=Os(a,10)|0,a=i,i=A}for(let _=0;_<16;_++){const A=Os(r+zo(p,o,l,c)+Ds[y[_]]+m,w[_])+f|0;r=f,f=c,c=Os(l,10)|0,l=o,o=A}}this.set(this.h1+a+c|0,this.h2+h+f|0,this.h3+u+r|0,this.h4+n+o|0,this.h0+i+l|0)}roundClean(){Ke(Ds)}destroy(){this.destroyed=!0,Ke(this.buffer),this.set(0,0,0,0,0)}}const vm=_l(()=>new _m);var Ae={},Go;function Am(){if(Go)return Ae;Go=1,Object.defineProperty(Ae,"__esModule",{value:!0}),Ae.bech32m=Ae.bech32=void 0;const s="qpzry9x8gf2tvdw0s3jn54khce6mua7l",t={};for(let h=0;h<s.length;h++){const c=s.charAt(h);t[c]=h}function e(h){const c=h>>25;return(h&33554431)<<5^-(c>>0&1)&996825010^-(c>>1&1)&642813549^-(c>>2&1)&513874426^-(c>>3&1)&1027748829^-(c>>4&1)&705979059}function n(h){let c=1;for(let u=0;u<h.length;++u){const f=h.charCodeAt(u);if(f<33||f>126)return"Invalid prefix ("+h+")";c=e(c)^f>>5}c=e(c);for(let u=0;u<h.length;++u){const f=h.charCodeAt(u);c=e(c)^f&31}return c}function r(h,c,u,f){let d=0,p=0;const g=(1<<u)-1,m=[];for(let x=0;x<h.length;++x)for(d=d<<c|h[x],p+=c;p>=u;)p-=u,m.push(d>>p&g);if(f)p>0&&m.push(d<<u-p&g);else{if(p>=c)return"Excess padding";if(d<<u-p&g)return"Non-zero padding"}return m}function i(h){return r(h,8,5,!0)}function o(h){const c=r(h,5,8,!1);if(Array.isArray(c))return c}function a(h){const c=r(h,5,8,!1);if(Array.isArray(c))return c;throw new Error(c)}function l(h){let c;h==="bech32"?c=1:c=734539939;function u(g,m,x){if(x=x||90,g.length+7+m.length>x)throw new TypeError("Exceeds length limit");g=g.toLowerCase();let y=n(g);if(typeof y=="string")throw new Error(y);let b=g+"1";for(let w=0;w<m.length;++w){const _=m[w];if(_>>5!==0)throw new Error("Non 5-bit word");y=e(y)^_,b+=s.charAt(_)}for(let w=0;w<6;++w)y=e(y);y^=c;for(let w=0;w<6;++w){const _=y>>(5-w)*5&31;b+=s.charAt(_)}return b}function f(g,m){if(m=m||90,g.length<8)return g+" too short";if(g.length>m)return"Exceeds length limit";const x=g.toLowerCase(),y=g.toUpperCase();if(g!==x&&g!==y)return"Mixed-case string "+g;g=x;const b=g.lastIndexOf("1");if(b===-1)return"No separator character for "+g;if(b===0)return"Missing prefix for "+g;const w=g.slice(0,b),_=g.slice(b+1);if(_.length<6)return"Data too short";let A=n(w);if(typeof A=="string")return A;const C=[];for(let P=0;P<_.length;++P){const v=_.charAt(P),k=t[v];if(k===void 0)return"Unknown character "+v;A=e(A)^k,!(P+6>=_.length)&&C.push(k)}return A!==c?"Invalid checksum for "+g:{prefix:w,words:C}}function d(g,m){const x=f(g,m);if(typeof x=="object")return x}function p(g,m){const x=f(g,m);if(typeof x=="object")return x;throw new Error(x)}return{decodeUnsafe:d,decode:p,encode:u,toWords:i,fromWordsUnsafe:o,fromWords:a}}return Ae.bech32=l("bech32"),Ae.bech32m=l("bech32m"),Ae}var Oo=Am();const Ot={idStr:()=>crypto.randomUUID().replaceAll("-","").slice(0,25),numAsStr:s=>s.toFixed(8),hash:s=>{const t=typeof s=="object"?JSON.stringify(s):`${s}`,e=new TextEncoder().encode(t),n=rn(e);return ge(n)},round:s=>Math.round(s*1e9)/1e9,randomIp:()=>{const s=n=>{const[r,i]=n.split(".").map(Number);return r===10||r===172&&i>=16&&i<=31||r===192&&i===168},t=()=>{const n=Kt({min:65,max:172}),r=Kt({min:20,max:256}),i=Kt({min:20,max:256}),o=Kt({min:20,max:256});return`${n}.${r}.${i}.${o}`};let e;do e=t();while(s(e));return e}},Kt=s=>{const{min:t,max:e,decimal:n=!1}=s,r=Math.random()*(e-t+1)+t;return n?r:Math.floor(r)},Sm=()=>{const s=ir.utils.randomPrivateKey(),t=ir.getPublicKey(s,!0),e=ge(t);let n=[];const r=c=>{let u=0;for(let f=0;f<c.length;f++)u+=c[f];return Ot.round(u)},i=()=>r(n.map(c=>Number(c.value))),o=(()=>{const c=vm(rn(t)),u=Oo.bech32.toWords(c);return u.unshift(0),`addr${Oo.bech32.encode("tb",u)}`})(),a=c=>{let u;for(const f of n){if(!u){u=f;continue}const d=Math.abs(c-Number(u.value));Math.abs(c-Number(f.value))<d&&(u=f)}return u},l=({units:c,recAddr:u})=>{const f=c*.0012345;if(i()<c+f){const A=`NSF ERROR
addr: ${o}
 balance: ${i()}`;throw new Error(A)}n.sort((A,C)=>Number(A.value)-Number(C.value));const d=[],p=()=>r(d.map(A=>Number(A.value)));for(;p()<c+f;){const A=c-p(),C=a(A);if(!C)throw new Error("unknown reason utxo not found :(");n=n.filter(P=>P.id!==C.id),d.push(C)}const g=A=>{const C=JSON.stringify(A),P=rn(new TextEncoder().encode(C)),v=ir.sign(P,s).toDERRawBytes();return ge(v)},m={inputs:d,outputs:[{id:Ot.idStr(),value:Ot.numAsStr(c),owner:u}],pubKey:e,fee:Ot.numAsStr(f)},y=d.map(A=>Number(A.value)).reduce((A,C)=>A+C)-(c+f);y>0&&m.outputs.push({id:Ot.idStr(),value:Ot.numAsStr(y),owner:o});const b=g(m),w={...m,sig:b},_=Ot.hash(w);return{...w,hash:_}},h=c=>{n.length=0,c.map(u=>{u.owner=o,n.push(u)})};return h(Array.from({length:1e3}).map(()=>({id:Ot.idStr(),value:Ot.numAsStr(Math.random()*(1-.001+1)+.001),owner:""}))),{addr:()=>o,pubKey:()=>e,utxos:()=>n,setNewUTXOs:h,balance:i,createTx:l}},Cm=s=>{const{gameVars:t,pos:e}=s,{game:n,assets:r}=t,i=new Date,o=Ot.randomIp(),a=Sm(),l=Sp(),h=Ap(o),c=37,u=43,f=5,d=1.25,p=r.getTexture("server-anim-coin");let g=0;const m=Array.from({length:f},(C,P)=>{const v=new $({source:p.source,frame:new q(c*P+g,0,c,u)});return g+=1,v.source.scaleMode="nearest",v}),x=new sn({textures:m});x.scale.set(d),x.animationSpeed=.07,x.play(),x.currentFrame=Kt({min:0,max:f-1});const y=new vp({thickness:2,color:"#FFFFFF"});return x.interactive=!0,x.on("pointerenter",()=>{x.filters=[y],x.cursor="pointer"}),x.on("pointerdown",()=>{}),x.on("pointerleave",()=>{x.filters=[],x.cursor="default"}),x.zIndex=gn.mid,n.addChild(x),x.x=e?e.x-x.width*.5:0,x.y=e?e.y-x.height*.5:0,{anim:x,createdAt:()=>i,ip:()=>o,destroy:()=>{x.parent&&x.parent.removeChild(x),x.destroy()},toRect:()=>new q(x.x,x.y,x.width,x.height),connections:()=>h,sendBtc:C=>{const{units:P,node:v}=C,k=v.wallet.addr(),S=a.createTx({units:P,recAddr:k});l.add(S),Ft.fire("newTx",{originId:o,tx:S})},receiveTx:C=>l.hasTx(C)?!1:(l.add(C),!0),wallet:a,mempool:l,pos:()=>({x:x.x+x.width*.5,y:x.y+x.height*.5})}},km=s=>{const{gameVars:t,store:e}=s,{game:n,scaler:r}=t,i=()=>({width:n.width/r.getGameScale(),height:n.height/r.getGameScale()});return{create:()=>{const a=Tm(e.data(),i());return Cm({gameVars:t,pos:a})}}},Pm=s=>{const t={top:new q,topLeft:new q,topRight:new q,bottom:new q,bottomLeft:new q,bottomRight:new q},e=2,n=175,r=s.anim.x+s.anim.width*.5,i=s.anim.y+s.anim.height*.5;return[{key:"top",angle:Math.PI*1.5},{key:"topRight",angle:Math.PI*1.85},{key:"bottomRight",angle:Math.PI*.15},{key:"bottom",angle:Math.PI*.5},{key:"bottomLeft",angle:Math.PI*.85},{key:"topLeft",angle:Math.PI*1.15}].map(a=>{const l=a.angle,h=r+Math.cos(l)*n,c=i+Math.sin(l)*n;t[a.key]=new q(h-e*.5,c-e*.5,e,e)}),t},Mm=s=>{const{rectA:t,rectB:e,buffer:n=0}=s,r=new q(t.x-n,t.y-n,t.width+n*2,t.height+n*2),i=new q(e.x-n,e.y-n,e.width+n*2,e.height+n*2);return!(!(r.x<i.x+i.width)||!(r.x+r.width>i.x)||!(r.y<i.y+i.height)||!(r.y+r.height>i.y))},Tm=(s,t)=>{if(s.length===0)return{x:t.width*.5-25,y:t.height*.5-25};const e=50;for(let n=0;n<s.length;n++){const r=s[n],i=Pm(r),o=["top","topRight","bottomRight","bottom","bottomLeft","topLeft"];for(const a of o){const l=i[a];if(!(l.x<10||l.y<10||l.x+l.width+e>t.width||l.y+l.height+e>t.height||s.some(c=>Mm({rectA:l,rectB:c.toRect(),buffer:e}))))return{x:l.x+l.width*.5,y:l.y+l.height*.5}}}return console.warn("No open position found around any existing nodes."),{x:-1,y:-1}},Em=(s,t,e)=>{const n=fp(),r=()=>({width:t.width/n.getGameScale(),height:t.height/n.getGameScale()});let i={x:0,y:0};return{app:s,game:t,assets:e,resizer:pp(n),scaler:n,getWindowSize:r,mouse:{getPos:()=>i,setPos:o=>{i=o}}}},Im=()=>{const s=[];return{push:t=>s.push(t),pop:()=>s.pop(),count:()=>s.length,data:()=>s}},Bm=s=>{const t=[];return{displayMovement:r=>{const{fromNode:i,toNode:o,txMsg:a}=r,l=Fm({start:i,end:o,container:s.game,txMsg:a});t.push(l)},update:r=>{for(let i=t.length-1;i>=0;i--){const o=t[i];if(o.update(r)){o.destroy(),t.splice(i,1);const l={originId:o.endId(),tx:o.txMsg()};Ft.fire("newTx",l)}}}}},Fm=s=>{const{container:t,start:e,end:n,txMsg:r,speed:i=7.5}=s,o=e.pos(),a=n.pos(),l=new Jt().circle(0,0,5).fill({color:"#ff8f45"});l.x=o.x,l.y=o.y,t.addChild(l);const h=a.x-o.x,c=a.y-o.y,u=Math.sqrt(h*h+c*c),f=u===0?0:h/u,d=u===0?0:c/u;return{update:m=>{if(u===0)return!0;const x=a.x-l.x,y=a.y-l.y,b=Math.sqrt(x*x+y*y),w=i*m.deltaTime;return w>=b?(l.x=a.x,l.y=a.y,!0):(l.x+=f*w,l.y+=d*w,!1)},destroy:()=>{l.parent&&l.parent.removeChild(l),l.destroy()},txMsg:()=>r,startId:()=>e.ip(),endId:()=>n.ip()}},Rm=s=>{const{gameVars:t,store:e}=s,{game:n}=t,r=l=>{const{node1:h,node2:c}=l,u={x:h.anim.x+h.anim.width*.5,y:h.anim.y+h.anim.height*.5},f={x:c.anim.x+c.anim.width*.5,y:c.anim.y+c.anim.height*.5},d=new Jt,p=2,g=p*7.5,m="#FFFFFF",x=f.x-u.x,y=f.y-u.y,b=Math.sqrt(x*x+y*y),w=Math.atan2(y,x);for(let _=0;_<b;_+=g){const A=u.x+Math.cos(w)*_,C=u.y+Math.sin(w)*_;d.circle(A,C,p).fill({color:m})}return d.zIndex=gn.bottom,d},i=[];return{setup:()=>{for(;i.length>0;){const l=i.pop();l&&n.removeChild(l),l==null||l.destroy()}for(const l of e.data())l.connections().disconnect();for(const l of e.data())l.connections().connectCount()>=8||Lm({node:l,count:6,store:e}).map(h=>{l.connections().connect(h),h.connections().connect(l);const c=r({node1:l,node2:h});i.push(c)});for(const l of i)n.addChild(l)},update:l=>{}}},Lm=s=>{const{node:t,count:e,store:n}=s,r=n.data(),i=[],o=(l,h)=>{const c=l.x-h.x,u=l.y-h.y;return Math.sqrt(c*c+u*u)};for(const l of r){if(l.connections().isConnectedTo(t)||l.ip()===t.ip()||l.connections().connectCount()>=6)continue;const h=o(t.anim,l.anim);h>=200||i.push({node:l,distance:h})}return i.sort((l,h)=>l.distance-h.distance),i.slice(0,e+1).map(l=>l.node)},zm=s=>{const{gameVars:t,bounds:e}=s,{app:n,game:r,scaler:i}=t;let o={x:n.screen.width*.5,y:n.screen.height*.5},a=!1,l=null,h=null;r.eventMode="static",r.on("pointerdown",d=>{a=!0,l=d.global.clone(),h={...o},r.cursor="grabbing"}),r.on("pointermove",d=>{if(!a||!l||!h)return;const p=d.global,g=p.x-l.x,m=p.y-l.y;o={x:h.x-g,y:h.y-m};const x=e.width*i.getGameScale();o.x=Math.min(o.x,x-n.screen.width*.5),o.x=Math.max(o.x,n.screen.width*.5);const y=e.height*i.getGameScale();o.y=Math.min(o.y,y-n.screen.height*.5),o.y=Math.max(o.y,n.screen.height*.5)});const c=()=>{a=!1,l=null,h=null,r.cursor="default"};return r.on("pointerup",c),r.on("pointerupoutside",c),{getFocusPoint:()=>o,setFocusPoint:d=>{d&&(o=d)},isDragging:()=>a}},Gm=s=>{const{store:t}=s,e=()=>{const i=t.data(),o=Kt({min:0,max:i.length,decimal:!1});let a=Kt({min:0,max:i.length,decimal:!1});if(a===o&&a!==i.length-1)a++;else if(a===o&&a!==0)a--;else if(a===o)throw new Error("cant send btc to self");return{sendIdx:o,recIdx:a}},n=()=>{try{const i=t.data();if(i.length<2)return;const{sendIdx:o,recIdx:a}=e(),l=i[o],h=i[a],c=l.wallet.balance(),u=Kt({min:c*1e-5,max:c*.01,decimal:!0}),f=Ot.round(u);Ft.fire("randSend",{fromId:l.ip(),toId:h.ip(),units:f})}catch{}},r=(()=>{let i=Kt({min:1500,max:3e3}),o=0;return{update:a=>{o>=i&&(o=0,i=Kt({min:500,max:3e3}),n()),o+=a.deltaMS}}})();return{update:i=>{r.update(i)}}},Om=({rows:s,cols:t})=>{const n="#4E505F",r=new Jt;r.zIndex=gn.bottom;const i=[],o=new kt({fontFamily:"GraphPix",fontSize:8});for(let h=0;h<s;h++)for(let c=0;c<t;c++){const u=c*50,f=h*50;r.rect(u,f,50,50).fill(n);const d=new Qt({style:o,text:`${h+1},${c+1}`});d.resolution=2,d.anchor.set(.5,.5),d.position.set(u+50*.5,f+50*.5),i.push(d)}const a=1,l="#b6cdd5";for(let h=0;h<=s;h++)for(let c=0;c<=t;c++){const u=c*50,f=h*50;r.circle(u,f,a).fill({color:l,alpha:.25})}return{size:{width:t*50,height:s*50},graphic:r,texts:i}},Nm=s=>{const t="game-imgs/btc-net-sim",e=n=>`url(${t}/${n}.png),auto`;s.renderer.events.cursorStyles.default=e("ms-default"),s.renderer.events.cursorStyles.pointer=e("ms-pointer"),s.renderer.events.cursorStyles.grabbing=e("ms-grabbing"),s.renderer.events.cursorStyles.grab=e("ms-grab")},jl={white:"#FFFFFF"};class Le{constructor(){yt(this,"on",!1);yt(this,"onOnce",!1);yt(this,"off",!1);yt(this,"offOnce",!1);yt(this,"lastReleaseMs",0);yt(this,"lastPressMs",0);yt(this,"press",()=>{this.on=!0,this.onOnce=!0,this.offOnce=!1,this.off=!1,this.lastPressMs=performance.now()});yt(this,"release",()=>{this.on=!1,this.onOnce=!1,this.offOnce=!0,this.off=!0,this.lastReleaseMs=performance.now()});yt(this,"pressHeldAfter",t=>this.on?performance.now()-this.lastPress>t:!1)}get lastPress(){return this.lastPressMs}get lastRelease(){return this.lastReleaseMs}get wasPressedOnce(){return this.onOnce?(this.onOnce=!1,this.on=!0,this.lastPressMs=performance.now(),!0):!1}get wasReleasedOnce(){return this.offOnce?(this.offOnce=!1,this.lastReleaseMs=performance.now(),!0):!1}get data(){return{pressed:this.on,released:this.off}}}const Um=()=>{const s=new Le,t=new Le,e=new Le,n=a=>{a.preventDefault(),a.deltaY>0&&Ft.fire("zoom","out"),a.deltaY<0&&Ft.fire("zoom","in")},r=a=>{switch(a.key){case"Control":a.preventDefault(),s.press();break;case"+":case"=":a.preventDefault(),t.press();break;case"-":a.preventDefault(),e.press();break}},i=a=>{switch(a.key){case"Control":s.release();break;case"+":case"=":t.release();break;case"-":e.release();break}};return window.addEventListener("keydown",r),window.addEventListener("keyup",i),window.addEventListener("wheel",n,{passive:!1}),{zoomIn:t,zoomOut:e,destroy:()=>{window.removeEventListener("keydown",r),window.removeEventListener("keyup",i),window.removeEventListener("wheel",n)}}},Dm=s=>{const{gameVars:t}=s,{app:e,scaler:n}=t,r=new zt,i=new Jt,o=61,a=300;i.rect(0,0,o,a).fill({color:jl.white,alpha:0});const l=5,h=Hm(),c=Hs({pixelSize:4.25,width:14,height:14,pos:{x:0,y:42},text:{value:"MAX",size:14}}),u=Hs({pixelSize:4.25,width:14,height:14,pos:{x:0,y:c.ctr.y+c.ctr.height+l},text:{value:"+",size:20}}),f=Hs({pixelSize:4.25,width:14,height:14,pos:{x:0,y:u.ctr.y+u.ctr.height+l},text:{value:"-",size:20}}),d=Hs({pixelSize:4.25,width:14,height:14,pos:{x:0,y:f.ctr.y+f.ctr.height+l},text:{value:"MIN",size:14}}),p=new Wm;c.onClick(p.max.press),c.onRelease(p.max.release),u.onClick(p.plus.press),u.onRelease(p.plus.release),f.onClick(p.minus.press),f.onRelease(p.minus.release),d.onClick(p.min.press),d.onRelease(p.min.release),r.addChild(i,h.nodes,h.count,c.ctr,u.ctr,f.ctr,d.ctr),e.stage.addChild(r);const g=()=>{r.width=o*n.getGameScale(),r.height=a*n.getGameScale(),r.x=e.screen.width-r.width,r.y=e.screen.height*.5-r.height*.5,r.y-=50};g();const m={min:1,max:127};let x=19,y=!1,b=!1;const w=()=>{const{count:A,nodes:C}=h;A.text=`${x}`,A.x=C.width*.5-A.width*.5,Ft.fire("node",{count:x})};return w(),{resize:g,update:A=>{if(y){if(x>=m.max){y=!1;return}x+=5,x=x>=m.max?m.max:x,w();return}if(b){if(x<=m.min){b=!1;return}x-=4,x=x<=m.min?m.min:x,w();return}if(p.max.wasPressedOnce&&(y=!0),p.plus.wasPressedOnce||p.plus.pressHeldAfter(500)){if(x>=m.max)return;x++,w()}if(p.minus.wasPressedOnce||p.minus.pressHeldAfter(500)){if(x<=m.min)return;x--,w()}p.min.wasPressedOnce&&(b=!0)}}},Hs=s=>{const t={white:"#FFFFFF",outBorder:"#9D5322",inBorder:"#E88744",mainBg:"#D67130"},{pixelSize:e,width:n,height:r,pos:i}=s,o=new zt,a=new Jt;a.rect(e*2,0,e*(n-4),e).fill({color:t.outBorder}),a.rect(e*2,e,e*(n-4),e).fill({color:t.inBorder}),a.rect(e,e,e,e).fill({color:t.outBorder}),a.rect(e*(n-2),e,e,e).fill({color:t.outBorder}),a.rect(0,e*2,e,e*(r-4)).fill({color:t.outBorder}),a.rect(e,e*2,e,e*(r-4)).fill({color:t.inBorder}),a.rect(e,e*(r-2),e,e).fill({color:t.outBorder}),a.rect(e*2,e*(r-1),e*(n-4),e).fill({color:t.outBorder}),a.rect(e*2,e*(r-2),e*(n-4),e).fill({color:t.inBorder}),a.rect(e*(n-2),e*(r-2),e,e).fill({color:t.outBorder}),a.rect(e*(n-1),e*2,e,e*(r-4)).fill({color:t.outBorder}),a.rect(e*(n-2),e*2,e,e*(r-4)).fill({color:t.inBorder}),a.rect(e*2,e*2,e*(n-4),e*(r-4)).fill({color:t.mainBg});const l=new Qt({style:new kt({fontSize:s.text.size,fontFamily:"GraphPix",fill:t.white}),resolution:2,text:s.text.value});l.x=a.x+a.width*.5-l.width*.5,l.y=a.y+a.height*.5-l.height*.5,o.addChild(a,l),o.x=i.x,o.y=i.y,o.interactive=!0,o.alpha=.8,o.on("pointerenter",()=>{o.alpha=.93}),o.on("pointerleave",()=>{o.alpha=.8});let h,c;return o.on("pointerdown",()=>{o.alpha=1,h==null||h()}),o.on("pointerup",()=>{o.alpha=.85,c==null||c()}),{ctr:o,onClick:u=>{h=u},onRelease:u=>{c=u}}},Hm=()=>{const s=new kt({fontFamily:"GraphPix",fontSize:14,fill:jl.white}),t=new Qt({style:s,resolution:2,text:"NODES",alpha:.85}),e=new Qt({style:s,resolution:2,text:"1",y:t.y+t.height+6.5,alpha:.85});return e.x=t.width*.5-e.width*.5,{nodes:t,count:e}};class Wm{constructor(){yt(this,"max",new Le);yt(this,"plus",new Le);yt(this,"minus",new Le);yt(this,"min",new Le)}}const Ft=Yo();async function jm(s){const t=new zt,e=dp(),n=Em(s,t,e);$m(n).next(()=>Vm(n))}const $m=s=>{let t,e;const{game:n,app:r}=s;return r.stage.addChild(n),r.stage.addEventListener("pointermove",i=>{s.mouse.setPos({x:i.screenX/s.scaler.getBaseScale(),y:i.screenY/s.scaler.getBaseScale()})}),{next:async i=>{n.removeChildren(),n.removeAllListeners(),t&&t.destroy(),e=i();const o=a=>{e==null||e.update(a)};t=new Ut().add(o),await e.load(n),t.start()}}},Vm=s=>{const{game:t,app:e,assets:n,resizer:r}=s;let i,o,a,l,h,c;const u=Im(),f=km({gameVars:s,store:u}),d=Um(),p=Om({rows:30,cols:46}),g=()=>{window.dispatchEvent(new CustomEvent("windowResize"))},m=y=>y.preventDefault(),x=()=>{r.resize(e,t),c==null||c.resize()};return window.addEventListener("resize",()=>setTimeout(g,0)),window.addEventListener("windowResize",x),e.canvas.addEventListener("contextmenu",m),e.stage.interactive=!0,Nm(e),window.addEventListener("gameModal",()=>{d.destroy(),Ft.clear();try{window.removeEventListener("resize",g),window.removeEventListener("windowResize",x),e.canvas.removeEventListener("contextmenu",m)}catch{}}),Ft.on("zoom",y=>{if(!i||!h)return;const b=.002;y==="in"&&h.zoom(b),y==="out"&&h.zoom(-b),y==="reset"&&h.resetZoom();const w=t.getSize();r.resize(e,t);const _=t.getSize(),A=_.height>w.height,C=Math.max(w.width,_.width),v=Math.min(w.width,_.width)/C,k=Math.max(w.height,_.height),M=Math.min(w.height,_.height)/k,E=i.getFocusPoint(),F={x:A?E.x/v:E.x*v,y:A?E.y/M:E.y*M};i.setFocusPoint(F),h==null||h.lookAt(i==null?void 0:i.getFocusPoint())}),Ft.on("node",y=>{if(y.count>u.count())for(;y.count>u.count();){const b=f.create();u.push(b),o==null||o.setup()}if(y.count<u.count()){for(;y.count<u.count();){const b=u.pop();b==null||b.destroy()}o==null||o.setup()}}),Ft.on("randSend",y=>{try{const b=u.data(),w=b.find(A=>A.ip()===y.toId),_=b.find(A=>A.ip()===y.fromId);if(!_||!w||w.ip()===y.fromId)return;_.sendBtc({units:y.units,node:w})}catch{}}),Ft.on("newTx",y=>{const b=u.data().find(_=>_.ip()===y.originId);if(!b)return;b.connections().getAll().map(_=>{_.receiveTx(y.tx)&&(a==null||a.displayMovement({fromNode:b,toNode:_,txMsg:y.tx}))})}),{load:async()=>{await n.load(),t.addChild(p.graphic),h=mp({gameVars:s,bounds:p.size,clampCamera:!0}),i=zm({gameVars:s,bounds:p.size}),o=Rm({gameVars:s,store:u}),a=Bm(s),l=Gm({store:u}),c=Dm({gameVars:s}),setTimeout(()=>{if(!i||!h)return;const y={x:t.width*.5,y:t.height*.5};i.setFocusPoint(y),h.lookAt(i==null?void 0:i.getFocusPoint()),Ft.fire("node",{count:19}),h==null||h.setZoom(.6),i.setFocusPoint({x:e.screen.width*.8,y:e.screen.height*.92}),window.dispatchEvent(new CustomEvent("windowResize")),h==null||h.lookAt(i==null?void 0:i.getFocusPoint())},50)},update:y=>{c==null||c.update(y),h==null||h.update(y),i!=null&&i.isDragging()&&(h==null||h.lookAt(i==null?void 0:i.getFocusPoint())),o==null||o.update(y),a==null||a.update(y),l==null||l.update(y)}}},or=854,ar=480;let Xt=1;const oi=s=>{const{width:t,height:e}=s.screen,n=t/e,r=or/ar;if(n>r){Xt=e/ar;const i=(t-or*Xt)/2;s.stage.scale.set(Xt,Xt),s.stage.position.set(i,0)}else{Xt=t/or;const i=(e-ar*Xt)/2;s.stage.scale.set(Xt,Xt),s.stage.position.set(0,i)}};let lr=0;const Ym=150,$l=s=>{try{lr+=s.ticker.deltaMS,lr>=Ym&&(oi(s),lr=0)}catch{}};var Lt=(s=>(s[s.bottom=0]="bottom",s[s.mid=1]="mid",s[s.top=2]="top",s))(Lt||{}),pe=(s=>(s[s.paused=0]="paused",s[s.play=1]="play",s))(pe||{});const Xm=s=>{const t=new Map,e=({game:o,pos:a})=>{const l=new Ht(s);l.zIndex=Lt.bottom,l.scale.set(ai),l.anchor.set(.5),l.x=a.x,l.y=a.y;const h=crypto.randomUUID().replaceAll("-","").slice(0,15),c={id:h,sprite:l};o.addChild(c.sprite),t.set(h,c)},n=()=>{const o=[];for(const[a,l]of t)o.push(l);return o},r=({game:o,id:a})=>{const l=t.get(a);l&&(o.removeChild(l.sprite),l.sprite.destroy(),t.delete(a))};return{list:n,createApple:e,remove:r,reset:o=>{for(const[a,l]of t)r({game:o,id:a})}}},qm=async()=>{const s=await St.load(`${ws}/apple.png`);return s.source.scaleMode="nearest",Xm(s)},Km=({gridSize:s,texture:t})=>{const e=[],{row:n,col:r}=s,i=new kt({fontFamily:"GraphPix",fontSize:6,fill:"#000000"});for(let h=0;h<n*r;h++){const c=new Ht(t);c.scale.set(ai),c.anchor.set(.5,.5);const u=Math.floor(h/r),f=h%r;c.x=f*c.width+c.width*.5,c.y=u*c.height+c.height*.5,c.zIndex=Lt.bottom;const d=Zm(c);e.push(d)}const o=h=>{const c=h.row*s.col+h.col;return e[c]},a=h=>{for(let c=0;c<e.length;c++){const u=e[c],f=new Qt({style:i,text:`${c}`});f.resolution=2;const{x:d,y:p}=u.sprite;f.position.set(d-18,p-18),f.zIndex=Lt.mid,h.addChild(f)}},l=h=>{for(const c of e){const u=c.getIndexPos(),f=new Qt({style:i,text:`${u.row}, ${u.col}`});f.resolution=2;const{x:d,y:p}=c.sprite;f.position.set(d-18,p-18),f.zIndex=Lt.mid,h.addChild(f)}};return{tiles:e,sizeIdx:s,size:{width:e[0].sprite.width*s.col,height:e[0].sprite.height*s.row},getTileFromIndexPos:o,displayIndexes:a,displayPosIndexes:l}},Zm=s=>({sprite:s,getIndexPos:()=>{const{x:e,y:n,width:r,height:i}=s,o=e-r*.5,a=n-i*.5,l=Math.floor(o/r),h=Math.floor(a/i);return{col:l,row:h}}}),Qm=async()=>{const s=`${ws}/game-tile.png`,t=await St.load(s);return t.source.scaleMode="nearest",t},Jm=s=>{const{game:t,app:e,bounds:n}=s,r={x:0,y:0},i={width:0,height:0};return{posZero:r,lookAt:a=>{if(!a)return;i.width=e.screen.width/Xt,i.height=e.screen.height/Xt;let l=-a.x+i.width*.5,h=-a.y+i.height*.5;const c=-(n.width-i.width);l=Math.min(Math.max(l,c),0);const f=-(n.height-i.height);h=Math.min(Math.max(h,f),0),t.position.set(l,h),r.x=-t.position.x,r.y=-t.position.y},viewport:i}};var pt=(s=>(s[s.up=0]="up",s[s.right=1]="right",s[s.down=2]="down",s[s.left=3]="left",s))(pt||{});const No=s=>{const t={x:0,y:0},e=new Ht(s);e.zIndex=Lt.mid,e.scale.set(ai),e.anchor.set(.5);const n={faceUp:()=>{e.rotation=Math.PI},faceRight:()=>{e.rotation=Math.PI*1.5},faceDown:()=>{e.rotation=0},faceLeft:()=>{e.rotation=Math.PI*.5},isFacing:{up:()=>e.rotation===Math.PI,right:()=>e.rotation===Math.PI*1.5,down:()=>e.rotation===0,left:()=>e.rotation===Math.PI*.5}},r=()=>e.x===t.x&&e.y===t.y;return{nextPos:t,direction:n,moveTo:l=>{t.x=l.x,t.y=l.y},placeAt:l=>{t.x=l.x,t.y=l.y,e.x=l.x,e.y=l.y},sprite:e,update:l=>{r()||(e.y>t.y&&(e.y-=.125*l.deltaMS,e.y<t.y&&(e.y=t.y)),e.x<t.x&&(e.x+=.125*l.deltaMS,e.x>t.x&&(e.x=t.x)),e.y<t.y&&(e.y+=.125*l.deltaMS,e.y>t.y&&(e.y=t.y)),e.x>t.x&&(e.x-=.125*l.deltaMS,e.x<t.x&&(e.x=t.x)))},isIdle:r}},tg=s=>{const{head:t,dead:e,body:n}=s,r=No(t),i=[];return{head:r,body:i,update:c=>{r.update(c);for(let u=0;u<i.length;u++)i[u].update(c)},died:()=>{r.sprite.texture=e},addSegment:c=>{const u=No(n);if(i.length===0){const{x:f,y:d}=r.sprite;u.placeAt({x:f,y:d})}else{const{x:f,y:d}=i[i.length-1].sprite;u.placeAt({x:f,y:d})}i.push(u),c.addChild(u.sprite)},reset:c=>{r.sprite.texture=t,i.map(u=>{c.removeChild(u.sprite),u.sprite.destroy()}),i.length=0}}},eg=async()=>{const s=St.load(`${ws}/snake-head.png`),t=St.load(`${ws}/snake-dead.png`),e=St.load(`${ws}/snake-body.png`),n=await Promise.all([s,t,e]);for(const r of n)r.source.scaleMode="nearest";return{head:n[0],dead:n[1],body:n[2]}},Uo=s=>{const{snake:t,gameTiles:e,initPos:n}=s;let r={...n,direction:pt.down},i={...n,direction:pt.down};sg(t).on(e).at(n),t.head.direction.faceDown(),ls(t).on(e).to(n),Zt.on("keyPressed",h=>{if(t){if(h==="up"){if(t.head.direction.isFacing.down())return;i={...r,direction:pt.up,row:r.row-1}}if(h==="right"){if(t.head.direction.isFacing.left())return;i={...r,direction:pt.right,col:r.col+1}}if(h==="down"){if(t.head.direction.isFacing.up())return;i={...r,direction:pt.down,row:r.row+1}}if(h==="left"){if(t.head.direction.isFacing.right())return;i={...r,direction:pt.left,col:r.col-1}}}});let o=0;const a=h=>{if(o<2500){o+=h.elapsedMS;return}for(let c=0;c<t.body.length;c++){const u=t.body[c];if(cn.circles(t.head.sprite,u.sprite))return!0}return!1};return{update:h=>{if(a(h)&&Zt.fire("gameEvent","gameOver"),!t.head.isIdle())return;let c=t.head;for(let u=0;u<t.body.length;u++){const{x:f,y:d}=c.sprite,p=t.body[u];p.moveTo({x:f,y:d}),c=p}r={...i},r.direction===pt.up&&(t.head.direction.faceUp(),ls(t).on(e).to(r),i={...r,direction:pt.up,row:r.row-1}),r.direction===pt.right&&(t.head.direction.faceRight(),ls(t).on(e).to(r),i={...r,direction:pt.right,col:r.col+1}),r.direction===pt.down&&(t.head.direction.faceDown(),ls(t).on(e).to(r),i={...r,direction:pt.down,row:r.row+1}),r.direction===pt.left&&(t.head.direction.faceLeft(),ls(t).on(e).to(r),i={...r,direction:pt.left,col:r.col-1})}}},sg=s=>({on:e=>({at:r=>{const{row:i,col:o}=r,{x:a,y:l}=e.getTileFromIndexPos({row:i,col:o}).sprite;s.head.placeAt({x:a,y:l})}})}),ls=s=>({on:e=>({to:r=>{const{row:i,col:o}=r,a=i<e.sizeIdx.row&&i>=0,l=o<e.sizeIdx.col&&o>=0;if(a&&l){const{x:h,y:c}=e.getTileFromIndexPos(r).sprite;s.head.moveTo({x:h,y:c})}if(o<0){const{y:h}=e.getTileFromIndexPos({row:i,col:0}).sprite,c=-e.tiles[0].sprite.width;s.head.moveTo({x:c,y:h})}if(i<0){const{x:h}=e.getTileFromIndexPos({row:0,col:o}).sprite,c=-e.tiles[0].sprite.height;s.head.moveTo({x:h,y:c})}if(i>=e.sizeIdx.row){const h=e.sizeIdx.row-1,{x:c,y:u}=e.getTileFromIndexPos({row:h,col:o}).sprite,f=u+e.tiles[0].sprite.height;s.head.moveTo({x:c,y:f})}if(o>=e.sizeIdx.col){const h=e.sizeIdx.col-1,{x:c,y:u}=e.getTileFromIndexPos({row:i,col:h}).sprite,f=c+e.tiles[0].sprite.width;s.head.moveTo({x:f,y:u})}}})}),ws="game-imgs/slither-slim";let ln=0;const ai=3.25,Zt=Yo();async function ng(s){rg(s).next((e,n)=>ig(e,n)),window.addEventListener("keydown",e=>{switch(e.code){case"ArrowUp":Zt.fire("keyPressed","up");break;case"ArrowRight":Zt.fire("keyPressed","right");break;case"ArrowDown":Zt.fire("keyPressed","down");break;case"ArrowLeft":Zt.fire("keyPressed","left");break;case"Enter":Zt.fire("keyPressed","enter");break}})}const rg=s=>{let t,e;const n=new zt;return s.stage.addChild(n),setTimeout(()=>oi(s),0),{next:async r=>{n.removeChildren(),n.removeAllListeners(),t&&t.destroy(),e=r(n,s);const i=o=>{$l(s),e==null||e.update(o)};t=new Ut().add(i),await e.load(n),t.start()}}},ig=(s,t)=>{let e,n,r,i,o;const a=og(),l=ag();let h=pe.paused;const c=()=>{if(!n||!e||!o)return;i=Uo({snake:n,gameTiles:e,initPos:{row:5,col:5}}),n.reset(s),n.addSegment(s),a.setScore(n==null?void 0:n.body.length),o.reset(s),Array.from({length:12}).map(()=>u())},u=()=>{const f=lg({gameTiles:e,snake:n,apples:o}).getRandomTile(),d={x:f.sprite.x,y:f.sprite.y};o==null||o.createApple({game:s,pos:d})};return Zt.on("keyPressed",f=>{f==="enter"&&h===pe.paused&&(h=pe.play,a.setVisible(!0),l.setVisible(!1),c())}),Zt.on("gameEvent",f=>{f==="gameOver"&&h===pe.play&&(n==null||n.died(),h=pe.paused,a.setVisible(!1),l.setVisible(!0))}),{load:async()=>{const f=await Qm();if(e=Km({texture:f,gridSize:{row:15,col:20}}),e.tiles.map(d=>s.addChild(d.sprite)),n=await eg().then(d=>tg(d)),!(n!=null&&n.head))throw new Error("snake head did not load");s.addChild(n.head.sprite),o=await qm(),i=Uo({snake:n,gameTiles:e,initPos:{row:5,col:5}}),a.addToApp(t),l.addTo(s),r=Jm({app:t,game:s,bounds:e.size})},update:f=>{if(!(!n||!e||!o)){if(h===pe.paused&&l.update(r),h===pe.play){n.update(f),i==null||i.update(f),cg({snake:n,bounds:e.size})&&Zt.fire("gameEvent","gameOver");for(const d of o.list())if(cn.circles(n.head.sprite,d.sprite)){const{id:p}=d;o.remove({game:s,id:p}),n.addSegment(s),a.setScore(n==null?void 0:n.body.length),u()}}r==null||r.lookAt(n==null?void 0:n.head.sprite.position)}}}},og=()=>{const s=new Qt({style:new kt({fontFamily:"GraphPix",fontSize:10,fill:"#FFFFFF"}),text:"LENGTH: 0"});s.resolution=2,s.zIndex=Lt.top;const t=new Jt().roundRect(0,0,100,100,6).fill({color:"#000000",alpha:.5});t.zIndex=Lt.top;const e=o=>{o.addChild(t),o.addChild(s)},n=o=>{o.stage.addChild(t),o.stage.addChild(s),t.position.set(3,3),s.position.set(7,5)},r=o=>{s.visible=o,t.visible=o};return r(!1),{addTo:e,setVisible:r,setScore:o=>{const a=(o||0)+1;s.text=`LENGTH: ${a}`,ln=Math.max(a,ln),t.width=s.width+5,t.height=s.height+5},addToApp:n}},ag=()=>{const s="GraphPix",t="#FFFFFF",e=new kt({fontFamily:s,fontSize:40,fill:t}),n=new Qt({style:e});n.resolution=2,n.text="SLITHER SLIM",n.zIndex=Lt.top;const r=new kt({fontFamily:s,fontSize:18,fill:t}),i=new Qt({style:r});i.resolution=2,i.text=`HIGH SCORE: ${ln}`,i.scale.set(.75),i.zIndex=Lt.top;const o=new Qt({style:r});o.resolution=2,o.text="Press “ENTER” to begin",o.zIndex=Lt.top;const a=new Jt().rect(0,0,100,100).fill({color:"#000000",alpha:.65});return a.zIndex=Lt.top,{addTo:u=>{u.addChild(a),u.addChild(n),u.addChild(o),u.addChild(i)},update:u=>{if(!u)return;const{posZero:f,viewport:d}=u,p=d.width===a.width,g=d.height===a.height;(!p||!g)&&(a.width=d.width+10,a.height=d.height+10),a.position.set(f.x-5,f.y-5);const m=d.width*.5-n.width*.5;n.position.set(f.x+m,f.y+50);const x=d.width*.5-i.width*.5;i.position.set(f.x+x,f.y+225);const y=d.width*.5-o.width*.5;o.position.set(f.x+y,f.y+400)},setVisible:u=>{a.visible=u,n.visible=u,i.visible=u,o.visible=u,i.text=`HIGH SCORE: ${ln}`}}},lg=({gameTiles:s,snake:t,apples:e})=>{if(!s)throw new Error("in fromOpenTiles(), gameTiles not defined");if(!t)throw new Error("in fromOpenTiles(), snake not defined");if(!e)throw new Error("in fromOpenTiles(), apples not defined");const n=[];for(let i=0;i<s.tiles.length;i++){const o=s.tiles[i];let a=!1;for(let h=0;h<t.body.length&&!a;h++){const c=t.body[h];cn.squares(c.sprite,o.sprite)&&(a=!0)}const l=e.list();for(let h=0;h<l.length&&!a;h++){const c=l[h];cn.squares(c.sprite,o.sprite)&&(a=!0)}a||n.push(o)}return{getRandomTile:()=>{if(n.length===0)throw new Error("empty game tiles");const i=Math.floor(Math.random()*n.length);return n[i]}}},cn={circles:(s,t)=>{const n={x:s.x,y:s.y,radius:s.width*.5-8},r={x:t.x,y:t.y,radius:t.width*.5},i=n.x-r.x,o=n.y-r.y;return Math.sqrt(i*i+o*o)<n.radius+r.radius},squares:(s,t)=>{const e=s.getBounds(),n=t.getBounds(),r=e.left<n.right&&e.right>n.left,i=e.top<n.bottom&&e.bottom>n.top;return r&&i}},cg=s=>{const{snake:t,bounds:e}=s,n={x:t.head.sprite.x,y:t.head.sprite.y,width:t.head.sprite.width,height:t.head.sprite.height},r=n.width*.35;return n.x-r<0||n.y-r<0||n.x+r>e.width||n.y+r>e.height};async function Ws(s){hg(s).next(ug)}const hg=s=>{let t,e;const n=new zt;return s.stage.addChild(n),setTimeout(()=>oi(s),0),{next:async r=>{n.removeChildren(),n.removeAllListeners(),t&&t.destroy(),e=r(n);const i=o=>{$l(s),e==null||e.update(o)};t=new Ut().add(i),await e.load(n),t.start()}}},ug=s=>({load:async()=>{const t=await St.load("game-imgs/space-game.png"),e=new Ht(t);e.x=0,e.y=0,s.addChild(e)},update:t=>{}});function Vl(s){var t,e,n="";if(typeof s=="string"||typeof s=="number")n+=s;else if(typeof s=="object")if(Array.isArray(s)){var r=s.length;for(t=0;t<r;t++)s[t]&&(e=Vl(s[t]))&&(n&&(n+=" "),n+=e)}else for(e in s)s[e]&&(n&&(n+=" "),n+=e);return n}function dg(){for(var s,t,e=0,n="",r=arguments.length;e<r;e++)(s=arguments[e])&&(t=Vl(s))&&(n&&(n+=" "),n+=t);return n}const li="-",fg=s=>{const t=mg(s),{conflictingClassGroups:e,conflictingClassGroupModifiers:n}=s;return{getClassGroupId:o=>{const a=o.split(li);return a[0]===""&&a.length!==1&&a.shift(),Yl(a,t)||pg(o)},getConflictingClassGroupIds:(o,a)=>{const l=e[o]||[];return a&&n[o]?[...l,...n[o]]:l}}},Yl=(s,t)=>{var o;if(s.length===0)return t.classGroupId;const e=s[0],n=t.nextPart.get(e),r=n?Yl(s.slice(1),n):void 0;if(r)return r;if(t.validators.length===0)return;const i=s.join(li);return(o=t.validators.find(({validator:a})=>a(i)))==null?void 0:o.classGroupId},Do=/^\[(.+)\]$/,pg=s=>{if(Do.test(s)){const t=Do.exec(s)[1],e=t==null?void 0:t.substring(0,t.indexOf(":"));if(e)return"arbitrary.."+e}},mg=s=>{const{theme:t,classGroups:e}=s,n={nextPart:new Map,validators:[]};for(const r in e)zr(e[r],n,r,t);return n},zr=(s,t,e,n)=>{s.forEach(r=>{if(typeof r=="string"){const i=r===""?t:Ho(t,r);i.classGroupId=e;return}if(typeof r=="function"){if(gg(r)){zr(r(n),t,e,n);return}t.validators.push({validator:r,classGroupId:e});return}Object.entries(r).forEach(([i,o])=>{zr(o,Ho(t,i),e,n)})})},Ho=(s,t)=>{let e=s;return t.split(li).forEach(n=>{e.nextPart.has(n)||e.nextPart.set(n,{nextPart:new Map,validators:[]}),e=e.nextPart.get(n)}),e},gg=s=>s.isThemeGetter,xg=s=>{if(s<1)return{get:()=>{},set:()=>{}};let t=0,e=new Map,n=new Map;const r=(i,o)=>{e.set(i,o),t++,t>s&&(t=0,n=e,e=new Map)};return{get(i){let o=e.get(i);if(o!==void 0)return o;if((o=n.get(i))!==void 0)return r(i,o),o},set(i,o){e.has(i)?e.set(i,o):r(i,o)}}},Gr="!",Or=":",yg=Or.length,bg=s=>{const{prefix:t,experimentalParseClassName:e}=s;let n=r=>{const i=[];let o=0,a=0,l=0,h;for(let p=0;p<r.length;p++){let g=r[p];if(o===0&&a===0){if(g===Or){i.push(r.slice(l,p)),l=p+yg;continue}if(g==="/"){h=p;continue}}g==="["?o++:g==="]"?o--:g==="("?a++:g===")"&&a--}const c=i.length===0?r:r.substring(l),u=wg(c),f=u!==c,d=h&&h>l?h-l:void 0;return{modifiers:i,hasImportantModifier:f,baseClassName:u,maybePostfixModifierPosition:d}};if(t){const r=t+Or,i=n;n=o=>o.startsWith(r)?i(o.substring(r.length)):{isExternal:!0,modifiers:[],hasImportantModifier:!1,baseClassName:o,maybePostfixModifierPosition:void 0}}if(e){const r=n;n=i=>e({className:i,parseClassName:r})}return n},wg=s=>s.endsWith(Gr)?s.substring(0,s.length-1):s.startsWith(Gr)?s.substring(1):s,_g=s=>{const t=Object.fromEntries(s.orderSensitiveModifiers.map(n=>[n,!0]));return n=>{if(n.length<=1)return n;const r=[];let i=[];return n.forEach(o=>{o[0]==="["||t[o]?(r.push(...i.sort(),o),i=[]):i.push(o)}),r.push(...i.sort()),r}},vg=s=>({cache:xg(s.cacheSize),parseClassName:bg(s),sortModifiers:_g(s),...fg(s)}),Ag=/\s+/,Sg=(s,t)=>{const{parseClassName:e,getClassGroupId:n,getConflictingClassGroupIds:r,sortModifiers:i}=t,o=[],a=s.trim().split(Ag);let l="";for(let h=a.length-1;h>=0;h-=1){const c=a[h],{isExternal:u,modifiers:f,hasImportantModifier:d,baseClassName:p,maybePostfixModifierPosition:g}=e(c);if(u){l=c+(l.length>0?" "+l:l);continue}let m=!!g,x=n(m?p.substring(0,g):p);if(!x){if(!m){l=c+(l.length>0?" "+l:l);continue}if(x=n(p),!x){l=c+(l.length>0?" "+l:l);continue}m=!1}const y=i(f).join(":"),b=d?y+Gr:y,w=b+x;if(o.includes(w))continue;o.push(w);const _=r(x,m);for(let A=0;A<_.length;++A){const C=_[A];o.push(b+C)}l=c+(l.length>0?" "+l:l)}return l};function Cg(){let s=0,t,e,n="";for(;s<arguments.length;)(t=arguments[s++])&&(e=Xl(t))&&(n&&(n+=" "),n+=e);return n}const Xl=s=>{if(typeof s=="string")return s;let t,e="";for(let n=0;n<s.length;n++)s[n]&&(t=Xl(s[n]))&&(e&&(e+=" "),e+=t);return e};function kg(s,...t){let e,n,r,i=o;function o(l){const h=t.reduce((c,u)=>u(c),s());return e=vg(h),n=e.cache.get,r=e.cache.set,i=a,a(l)}function a(l){const h=n(l);if(h)return h;const c=Sg(l,e);return r(l,c),c}return function(){return i(Cg.apply(null,arguments))}}const ct=s=>{const t=e=>e[s]||[];return t.isThemeGetter=!0,t},ql=/^\[(?:(\w[\w-]*):)?(.+)\]$/i,Kl=/^\((?:(\w[\w-]*):)?(.+)\)$/i,Pg=/^\d+\/\d+$/,Mg=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,Tg=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,Eg=/^(rgba?|hsla?|hwb|(ok)?(lab|lch)|color-mix)\(.+\)$/,Ig=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,Bg=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,De=s=>Pg.test(s),j=s=>!!s&&!Number.isNaN(Number(s)),fe=s=>!!s&&Number.isInteger(Number(s)),cr=s=>s.endsWith("%")&&j(s.slice(0,-1)),ne=s=>Mg.test(s),Fg=()=>!0,Rg=s=>Tg.test(s)&&!Eg.test(s),Zl=()=>!1,Lg=s=>Ig.test(s),zg=s=>Bg.test(s),Gg=s=>!L(s)&&!z(s),Og=s=>ss(s,tc,Zl),L=s=>ql.test(s),Se=s=>ss(s,ec,Rg),hr=s=>ss(s,Wg,j),Wo=s=>ss(s,Ql,Zl),Ng=s=>ss(s,Jl,zg),js=s=>ss(s,sc,Lg),z=s=>Kl.test(s),cs=s=>ns(s,ec),Ug=s=>ns(s,jg),jo=s=>ns(s,Ql),Dg=s=>ns(s,tc),Hg=s=>ns(s,Jl),$s=s=>ns(s,sc,!0),ss=(s,t,e)=>{const n=ql.exec(s);return n?n[1]?t(n[1]):e(n[2]):!1},ns=(s,t,e=!1)=>{const n=Kl.exec(s);return n?n[1]?t(n[1]):e:!1},Ql=s=>s==="position"||s==="percentage",Jl=s=>s==="image"||s==="url",tc=s=>s==="length"||s==="size"||s==="bg-size",ec=s=>s==="length",Wg=s=>s==="number",jg=s=>s==="family-name",sc=s=>s==="shadow",$g=()=>{const s=ct("color"),t=ct("font"),e=ct("text"),n=ct("font-weight"),r=ct("tracking"),i=ct("leading"),o=ct("breakpoint"),a=ct("container"),l=ct("spacing"),h=ct("radius"),c=ct("shadow"),u=ct("inset-shadow"),f=ct("text-shadow"),d=ct("drop-shadow"),p=ct("blur"),g=ct("perspective"),m=ct("aspect"),x=ct("ease"),y=ct("animate"),b=()=>["auto","avoid","all","avoid-page","page","left","right","column"],w=()=>["center","top","bottom","left","right","top-left","left-top","top-right","right-top","bottom-right","right-bottom","bottom-left","left-bottom"],_=()=>[...w(),z,L],A=()=>["auto","hidden","clip","visible","scroll"],C=()=>["auto","contain","none"],P=()=>[z,L,l],v=()=>[De,"full","auto",...P()],k=()=>[fe,"none","subgrid",z,L],S=()=>["auto",{span:["full",fe,z,L]},fe,z,L],M=()=>[fe,"auto",z,L],E=()=>["auto","min","max","fr",z,L],F=()=>["start","end","center","between","around","evenly","stretch","baseline","center-safe","end-safe"],R=()=>["start","end","center","stretch","center-safe","end-safe"],T=()=>["auto",...P()],I=()=>[De,"auto","full","dvw","dvh","lvw","lvh","svw","svh","min","max","fit",...P()],B=()=>[s,z,L],D=()=>[...w(),jo,Wo,{position:[z,L]}],W=()=>["no-repeat",{repeat:["","x","y","space","round"]}],U=()=>["auto","cover","contain",Dg,Og,{size:[z,L]}],Q=()=>[cr,cs,Se],H=()=>["","none","full",h,z,L],K=()=>["",j,cs,Se],Y=()=>["solid","dashed","dotted","double"],tt=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],J=()=>[j,cr,jo,Wo],Pt=()=>["","none",p,z,L],ut=()=>["none",j,z,L],vt=()=>["none",j,z,L],xt=()=>[j,z,L],Mt=()=>[De,"full",...P()];return{cacheSize:500,theme:{animate:["spin","ping","pulse","bounce"],aspect:["video"],blur:[ne],breakpoint:[ne],color:[Fg],container:[ne],"drop-shadow":[ne],ease:["in","out","in-out"],font:[Gg],"font-weight":["thin","extralight","light","normal","medium","semibold","bold","extrabold","black"],"inset-shadow":[ne],leading:["none","tight","snug","normal","relaxed","loose"],perspective:["dramatic","near","normal","midrange","distant","none"],radius:[ne],shadow:[ne],spacing:["px",j],text:[ne],"text-shadow":[ne],tracking:["tighter","tight","normal","wide","wider","widest"]},classGroups:{aspect:[{aspect:["auto","square",De,L,z,m]}],container:["container"],columns:[{columns:[j,L,z,a]}],"break-after":[{"break-after":b()}],"break-before":[{"break-before":b()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],sr:["sr-only","not-sr-only"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:_()}],overflow:[{overflow:A()}],"overflow-x":[{"overflow-x":A()}],"overflow-y":[{"overflow-y":A()}],overscroll:[{overscroll:C()}],"overscroll-x":[{"overscroll-x":C()}],"overscroll-y":[{"overscroll-y":C()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:v()}],"inset-x":[{"inset-x":v()}],"inset-y":[{"inset-y":v()}],start:[{start:v()}],end:[{end:v()}],top:[{top:v()}],right:[{right:v()}],bottom:[{bottom:v()}],left:[{left:v()}],visibility:["visible","invisible","collapse"],z:[{z:[fe,"auto",z,L]}],basis:[{basis:[De,"full","auto",a,...P()]}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["nowrap","wrap","wrap-reverse"]}],flex:[{flex:[j,De,"auto","initial","none",L]}],grow:[{grow:["",j,z,L]}],shrink:[{shrink:["",j,z,L]}],order:[{order:[fe,"first","last","none",z,L]}],"grid-cols":[{"grid-cols":k()}],"col-start-end":[{col:S()}],"col-start":[{"col-start":M()}],"col-end":[{"col-end":M()}],"grid-rows":[{"grid-rows":k()}],"row-start-end":[{row:S()}],"row-start":[{"row-start":M()}],"row-end":[{"row-end":M()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":E()}],"auto-rows":[{"auto-rows":E()}],gap:[{gap:P()}],"gap-x":[{"gap-x":P()}],"gap-y":[{"gap-y":P()}],"justify-content":[{justify:[...F(),"normal"]}],"justify-items":[{"justify-items":[...R(),"normal"]}],"justify-self":[{"justify-self":["auto",...R()]}],"align-content":[{content:["normal",...F()]}],"align-items":[{items:[...R(),{baseline:["","last"]}]}],"align-self":[{self:["auto",...R(),{baseline:["","last"]}]}],"place-content":[{"place-content":F()}],"place-items":[{"place-items":[...R(),"baseline"]}],"place-self":[{"place-self":["auto",...R()]}],p:[{p:P()}],px:[{px:P()}],py:[{py:P()}],ps:[{ps:P()}],pe:[{pe:P()}],pt:[{pt:P()}],pr:[{pr:P()}],pb:[{pb:P()}],pl:[{pl:P()}],m:[{m:T()}],mx:[{mx:T()}],my:[{my:T()}],ms:[{ms:T()}],me:[{me:T()}],mt:[{mt:T()}],mr:[{mr:T()}],mb:[{mb:T()}],ml:[{ml:T()}],"space-x":[{"space-x":P()}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":P()}],"space-y-reverse":["space-y-reverse"],size:[{size:I()}],w:[{w:[a,"screen",...I()]}],"min-w":[{"min-w":[a,"screen","none",...I()]}],"max-w":[{"max-w":[a,"screen","none","prose",{screen:[o]},...I()]}],h:[{h:["screen","lh",...I()]}],"min-h":[{"min-h":["screen","lh","none",...I()]}],"max-h":[{"max-h":["screen","lh",...I()]}],"font-size":[{text:["base",e,cs,Se]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:[n,z,hr]}],"font-stretch":[{"font-stretch":["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded",cr,L]}],"font-family":[{font:[Ug,L,t]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:[r,z,L]}],"line-clamp":[{"line-clamp":[j,"none",z,hr]}],leading:[{leading:[i,...P()]}],"list-image":[{"list-image":["none",z,L]}],"list-style-position":[{list:["inside","outside"]}],"list-style-type":[{list:["disc","decimal","none",z,L]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"placeholder-color":[{placeholder:B()}],"text-color":[{text:B()}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...Y(),"wavy"]}],"text-decoration-thickness":[{decoration:[j,"from-font","auto",z,Se]}],"text-decoration-color":[{decoration:B()}],"underline-offset":[{"underline-offset":[j,"auto",z,L]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:P()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",z,L]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],wrap:[{wrap:["break-word","anywhere","normal"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",z,L]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:D()}],"bg-repeat":[{bg:W()}],"bg-size":[{bg:U()}],"bg-image":[{bg:["none",{linear:[{to:["t","tr","r","br","b","bl","l","tl"]},fe,z,L],radial:["",z,L],conic:[fe,z,L]},Hg,Ng]}],"bg-color":[{bg:B()}],"gradient-from-pos":[{from:Q()}],"gradient-via-pos":[{via:Q()}],"gradient-to-pos":[{to:Q()}],"gradient-from":[{from:B()}],"gradient-via":[{via:B()}],"gradient-to":[{to:B()}],rounded:[{rounded:H()}],"rounded-s":[{"rounded-s":H()}],"rounded-e":[{"rounded-e":H()}],"rounded-t":[{"rounded-t":H()}],"rounded-r":[{"rounded-r":H()}],"rounded-b":[{"rounded-b":H()}],"rounded-l":[{"rounded-l":H()}],"rounded-ss":[{"rounded-ss":H()}],"rounded-se":[{"rounded-se":H()}],"rounded-ee":[{"rounded-ee":H()}],"rounded-es":[{"rounded-es":H()}],"rounded-tl":[{"rounded-tl":H()}],"rounded-tr":[{"rounded-tr":H()}],"rounded-br":[{"rounded-br":H()}],"rounded-bl":[{"rounded-bl":H()}],"border-w":[{border:K()}],"border-w-x":[{"border-x":K()}],"border-w-y":[{"border-y":K()}],"border-w-s":[{"border-s":K()}],"border-w-e":[{"border-e":K()}],"border-w-t":[{"border-t":K()}],"border-w-r":[{"border-r":K()}],"border-w-b":[{"border-b":K()}],"border-w-l":[{"border-l":K()}],"divide-x":[{"divide-x":K()}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":K()}],"divide-y-reverse":["divide-y-reverse"],"border-style":[{border:[...Y(),"hidden","none"]}],"divide-style":[{divide:[...Y(),"hidden","none"]}],"border-color":[{border:B()}],"border-color-x":[{"border-x":B()}],"border-color-y":[{"border-y":B()}],"border-color-s":[{"border-s":B()}],"border-color-e":[{"border-e":B()}],"border-color-t":[{"border-t":B()}],"border-color-r":[{"border-r":B()}],"border-color-b":[{"border-b":B()}],"border-color-l":[{"border-l":B()}],"divide-color":[{divide:B()}],"outline-style":[{outline:[...Y(),"none","hidden"]}],"outline-offset":[{"outline-offset":[j,z,L]}],"outline-w":[{outline:["",j,cs,Se]}],"outline-color":[{outline:B()}],shadow:[{shadow:["","none",c,$s,js]}],"shadow-color":[{shadow:B()}],"inset-shadow":[{"inset-shadow":["none",u,$s,js]}],"inset-shadow-color":[{"inset-shadow":B()}],"ring-w":[{ring:K()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:B()}],"ring-offset-w":[{"ring-offset":[j,Se]}],"ring-offset-color":[{"ring-offset":B()}],"inset-ring-w":[{"inset-ring":K()}],"inset-ring-color":[{"inset-ring":B()}],"text-shadow":[{"text-shadow":["none",f,$s,js]}],"text-shadow-color":[{"text-shadow":B()}],opacity:[{opacity:[j,z,L]}],"mix-blend":[{"mix-blend":[...tt(),"plus-darker","plus-lighter"]}],"bg-blend":[{"bg-blend":tt()}],"mask-clip":[{"mask-clip":["border","padding","content","fill","stroke","view"]},"mask-no-clip"],"mask-composite":[{mask:["add","subtract","intersect","exclude"]}],"mask-image-linear-pos":[{"mask-linear":[j]}],"mask-image-linear-from-pos":[{"mask-linear-from":J()}],"mask-image-linear-to-pos":[{"mask-linear-to":J()}],"mask-image-linear-from-color":[{"mask-linear-from":B()}],"mask-image-linear-to-color":[{"mask-linear-to":B()}],"mask-image-t-from-pos":[{"mask-t-from":J()}],"mask-image-t-to-pos":[{"mask-t-to":J()}],"mask-image-t-from-color":[{"mask-t-from":B()}],"mask-image-t-to-color":[{"mask-t-to":B()}],"mask-image-r-from-pos":[{"mask-r-from":J()}],"mask-image-r-to-pos":[{"mask-r-to":J()}],"mask-image-r-from-color":[{"mask-r-from":B()}],"mask-image-r-to-color":[{"mask-r-to":B()}],"mask-image-b-from-pos":[{"mask-b-from":J()}],"mask-image-b-to-pos":[{"mask-b-to":J()}],"mask-image-b-from-color":[{"mask-b-from":B()}],"mask-image-b-to-color":[{"mask-b-to":B()}],"mask-image-l-from-pos":[{"mask-l-from":J()}],"mask-image-l-to-pos":[{"mask-l-to":J()}],"mask-image-l-from-color":[{"mask-l-from":B()}],"mask-image-l-to-color":[{"mask-l-to":B()}],"mask-image-x-from-pos":[{"mask-x-from":J()}],"mask-image-x-to-pos":[{"mask-x-to":J()}],"mask-image-x-from-color":[{"mask-x-from":B()}],"mask-image-x-to-color":[{"mask-x-to":B()}],"mask-image-y-from-pos":[{"mask-y-from":J()}],"mask-image-y-to-pos":[{"mask-y-to":J()}],"mask-image-y-from-color":[{"mask-y-from":B()}],"mask-image-y-to-color":[{"mask-y-to":B()}],"mask-image-radial":[{"mask-radial":[z,L]}],"mask-image-radial-from-pos":[{"mask-radial-from":J()}],"mask-image-radial-to-pos":[{"mask-radial-to":J()}],"mask-image-radial-from-color":[{"mask-radial-from":B()}],"mask-image-radial-to-color":[{"mask-radial-to":B()}],"mask-image-radial-shape":[{"mask-radial":["circle","ellipse"]}],"mask-image-radial-size":[{"mask-radial":[{closest:["side","corner"],farthest:["side","corner"]}]}],"mask-image-radial-pos":[{"mask-radial-at":w()}],"mask-image-conic-pos":[{"mask-conic":[j]}],"mask-image-conic-from-pos":[{"mask-conic-from":J()}],"mask-image-conic-to-pos":[{"mask-conic-to":J()}],"mask-image-conic-from-color":[{"mask-conic-from":B()}],"mask-image-conic-to-color":[{"mask-conic-to":B()}],"mask-mode":[{mask:["alpha","luminance","match"]}],"mask-origin":[{"mask-origin":["border","padding","content","fill","stroke","view"]}],"mask-position":[{mask:D()}],"mask-repeat":[{mask:W()}],"mask-size":[{mask:U()}],"mask-type":[{"mask-type":["alpha","luminance"]}],"mask-image":[{mask:["none",z,L]}],filter:[{filter:["","none",z,L]}],blur:[{blur:Pt()}],brightness:[{brightness:[j,z,L]}],contrast:[{contrast:[j,z,L]}],"drop-shadow":[{"drop-shadow":["","none",d,$s,js]}],"drop-shadow-color":[{"drop-shadow":B()}],grayscale:[{grayscale:["",j,z,L]}],"hue-rotate":[{"hue-rotate":[j,z,L]}],invert:[{invert:["",j,z,L]}],saturate:[{saturate:[j,z,L]}],sepia:[{sepia:["",j,z,L]}],"backdrop-filter":[{"backdrop-filter":["","none",z,L]}],"backdrop-blur":[{"backdrop-blur":Pt()}],"backdrop-brightness":[{"backdrop-brightness":[j,z,L]}],"backdrop-contrast":[{"backdrop-contrast":[j,z,L]}],"backdrop-grayscale":[{"backdrop-grayscale":["",j,z,L]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[j,z,L]}],"backdrop-invert":[{"backdrop-invert":["",j,z,L]}],"backdrop-opacity":[{"backdrop-opacity":[j,z,L]}],"backdrop-saturate":[{"backdrop-saturate":[j,z,L]}],"backdrop-sepia":[{"backdrop-sepia":["",j,z,L]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":P()}],"border-spacing-x":[{"border-spacing-x":P()}],"border-spacing-y":[{"border-spacing-y":P()}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["","all","colors","opacity","shadow","transform","none",z,L]}],"transition-behavior":[{transition:["normal","discrete"]}],duration:[{duration:[j,"initial",z,L]}],ease:[{ease:["linear","initial",x,z,L]}],delay:[{delay:[j,z,L]}],animate:[{animate:["none",y,z,L]}],backface:[{backface:["hidden","visible"]}],perspective:[{perspective:[g,z,L]}],"perspective-origin":[{"perspective-origin":_()}],rotate:[{rotate:ut()}],"rotate-x":[{"rotate-x":ut()}],"rotate-y":[{"rotate-y":ut()}],"rotate-z":[{"rotate-z":ut()}],scale:[{scale:vt()}],"scale-x":[{"scale-x":vt()}],"scale-y":[{"scale-y":vt()}],"scale-z":[{"scale-z":vt()}],"scale-3d":["scale-3d"],skew:[{skew:xt()}],"skew-x":[{"skew-x":xt()}],"skew-y":[{"skew-y":xt()}],transform:[{transform:[z,L,"","none","gpu","cpu"]}],"transform-origin":[{origin:_()}],"transform-style":[{transform:["3d","flat"]}],translate:[{translate:Mt()}],"translate-x":[{"translate-x":Mt()}],"translate-y":[{"translate-y":Mt()}],"translate-z":[{"translate-z":Mt()}],"translate-none":["translate-none"],accent:[{accent:B()}],appearance:[{appearance:["none","auto"]}],"caret-color":[{caret:B()}],"color-scheme":[{scheme:["normal","dark","light","light-dark","only-dark","only-light"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",z,L]}],"field-sizing":[{"field-sizing":["fixed","content"]}],"pointer-events":[{"pointer-events":["auto","none"]}],resize:[{resize:["none","","y","x"]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":P()}],"scroll-mx":[{"scroll-mx":P()}],"scroll-my":[{"scroll-my":P()}],"scroll-ms":[{"scroll-ms":P()}],"scroll-me":[{"scroll-me":P()}],"scroll-mt":[{"scroll-mt":P()}],"scroll-mr":[{"scroll-mr":P()}],"scroll-mb":[{"scroll-mb":P()}],"scroll-ml":[{"scroll-ml":P()}],"scroll-p":[{"scroll-p":P()}],"scroll-px":[{"scroll-px":P()}],"scroll-py":[{"scroll-py":P()}],"scroll-ps":[{"scroll-ps":P()}],"scroll-pe":[{"scroll-pe":P()}],"scroll-pt":[{"scroll-pt":P()}],"scroll-pr":[{"scroll-pr":P()}],"scroll-pb":[{"scroll-pb":P()}],"scroll-pl":[{"scroll-pl":P()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",z,L]}],fill:[{fill:["none",...B()]}],"stroke-w":[{stroke:[j,cs,Se,hr]}],stroke:[{stroke:["none",...B()]}],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-x","border-w-y","border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-x","border-color-y","border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],translate:["translate-x","translate-y","translate-none"],"translate-none":["translate","translate-x","translate-y","translate-z"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]},orderSensitiveModifiers:["*","**","after","backdrop","before","details-content","file","first-letter","first-line","marker","placeholder","selection"]}},Vg=kg($g);function nc(...s){return Vg(dg(s))}function rx({}){return[{title:"Canvas Games"},{name:"description",content:"Just here to learn making games with the canvas"}]}const Yg=[{id:"slither-slim",title:"Slither Slim",image:"game-imgs/slither-slim/game-img.png",init:ng},{id:"bitcoin-sim",title:"Bitcoin Network Sim",image:"game-imgs/space-game.png",init:jm},{id:"placeholder3",title:"Placeholder",image:"game-imgs/space-game.png",init:Ws},{id:"placeholder4",title:"Placeholder",image:"game-imgs/space-game.png",init:Ws},{id:"placeholder5",title:"Placeholder",image:"game-imgs/space-game.png",init:Ws},{id:"placeholder6",title:"Placeholder",image:"game-imgs/space-game.png",init:Ws}],ix=lc(function(){const[t,e]=cc(),n=t.get("game"),r=hc();return G.jsxs("div",{className:"mx-auto max-w-[100rem]",children:[G.jsx(Xg,{}),G.jsx("div",{id:"about"}),G.jsxs("div",{className:"px-8",children:[G.jsxs("div",{className:"flex items-center mt-[8rem]",children:[G.jsx("img",{className:"mr-5",src:"assets/vr-boy.png",alt:"boy vr headset"}),G.jsx("h1",{className:"font-font md:text-xl sm:text-md font-bold text-white",children:"About"})]}),G.jsx("div",{className:"w-full flex justify-center mt-3",children:G.jsxs("div",{className:"max-w-[50rem] text-gray-200",children:[G.jsx("div",{children:"Welcome! This site is a personal project where I'm collecting and showcasing projects I've built as part of my learning journey. Think of it as my digital playground for exploring game development and various html canvas ideas."}),G.jsx("div",{className:"mt-8",children:"Thanks for stopping by!"})]})})]}),G.jsx("div",{id:"collection"}),G.jsxs("div",{className:"px-8",children:[G.jsxs("div",{className:"flex items-center mt-[8rem]",children:[G.jsx("img",{className:"mr-5",src:"assets/rocket.png",alt:"rocket ship"}),G.jsx("h1",{className:"font-font md:text-xl sm:text-md font-bold text-white",children:"Collection"})]}),G.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-8 mt-8",children:Yg.map(i=>G.jsxs("div",{onClick:()=>{n||r(`?game=${i.id}#collection`)},className:nc("relative overflow-hidden rounded-lg shadow-lg group border-3 border-transparent hover:border-sky-400 transition",{"cursor-pointer":!n}),children:[G.jsx("img",{src:i.image,alt:i.title,className:"w-full h-full object-cover opacity-70 group-hover:opacity-100 transition"}),G.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:G.jsx("span",{className:"text-white text-xl font-bold bg-black/40 px-4 py-2 rounded",children:i.title})}),G.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-4",children:[G.jsx(qg,{title:"Example Game",onClick:()=>e({game:i.id})},i.id),n===i.id&&G.jsx(Kg,{createGame:i.init,onClose:()=>{location.hash.includes("collection")?r("#collection"):e(""),window.dispatchEvent(new CustomEvent("gameModal"))}})]})]},i.id))})]}),G.jsx("div",{className:"my-14",children:G.jsx("img",{src:"assets/earth-large.png",alt:"Large Earth",className:"mx-auto md:w-[35rem] w-[20rem]"})}),G.jsx(Zg,{})]})});function Xg(){return G.jsxs("div",{children:[G.jsx("div",{id:"home"}),G.jsx("div",{className:"bg-gray-800 py-6 rounded-b-lg",children:G.jsxs("div",{className:"grid grid-cols-2 px-8",children:[G.jsxs("div",{className:"flex items-center col-start-1",children:[G.jsx("img",{className:"mr-5 w-8 h-8",src:"assets/pixel-earth.png",alt:"pixel earth"}),G.jsx("h1",{className:"font-font md:text-xl sm:text-md font-bold sm:block hidden text-white",children:"Canvas Game"})]}),G.jsxs("div",{className:"flex justify-end items-center col-start-2 sm:space-x-8 space-x-4 font-font md:text-md text-sm font-bold",children:[G.jsx("a",{href:"#home",className:"text-gray-300 hover:text-white",children:"Home"}),G.jsx("a",{href:"#about",className:"text-gray-300 hover:text-white",children:"About"}),G.jsx("a",{href:"#collection",className:"text-gray-300 hover:text-white",children:"Collection"})]})]})})]})}function qg({title:s,onClick:t}){return G.jsx("div",{onClick:t,className:"p-4 bg-gray-800 shadow rounded hover:scale-105 transition",children:G.jsx("h2",{className:"text-lg font-semibold",children:s})})}function Kg({createGame:s,onClose:t}){const e=re.useRef(null),n=re.useRef(null),r=re.useRef(null),[i,o]=re.useState({width:window.innerWidth,height:window.innerHeight}),a=window.innerWidth<768||$o();re.useEffect(()=>{const u=()=>{o({width:window.innerWidth,height:window.innerHeight}),window.dispatchEvent(new CustomEvent("windowResize"))};return window.addEventListener("resize",u),()=>window.removeEventListener("resize",u)},[r]),re.useEffect(()=>((async()=>{if(!e.current)return;const f=new ja;await f.init({resizeTo:e.current,backgroundColor:"#000000",antialias:!0,autoDensity:!0}),e.current&&(e.current.innerHTML="",e.current.appendChild(f.canvas)),r.current=f,s(f)})(),()=>{r.current&&(r.current.destroy(!0),r.current=null),e.current&&(e.current=null)}),[s,$o,r]);const l=()=>{var u;document.fullscreenElement?document.exitFullscreen():(u=n.current)==null||u.requestFullscreen()},{isFullscreen:h}=Qg();Jg();const c=i.height*(16/9);return G.jsxs("div",{ref:n,className:"fixed inset-0 flex items-center justify-center z-50",children:[G.jsx("div",{className:"absolute inset-0 bg-black/40 backdrop-blur-sm",onClick:t}),G.jsxs("div",{style:{maxWidth:h?`${c}px`:void 0},className:nc("aspect-[16/9] relative bg-gray-800 z-10 w-[90vw] max-w-[1920px] rounded-lg shadow-lg",{"w-full max-w-full":h}),children:[!h&&G.jsx("div",{children:G.jsx("button",{onClick:l,title:"Toggle Fullscreen",className:"absolute bottom-2 right-3 text-gray-400 hover:text-gray-700 text-4xl cursor-pointer",children:"⛶"})}),a&&G.jsx("div",{className:"w-full h-full flex items-center justify-center bg-gray-800 text-white text-center p-4 rounded",children:G.jsx("p",{className:"text-lg font-medium",children:"Uh oh... looks like you're on mobile. Only can play the games on a desktop for now."})}),!a&&G.jsx("div",{ref:e,className:"w-full h-full overflow-hidden rounded"})]})]})}function Zg(){return G.jsxs("footer",{className:"bg-gray-800 text-gray-300 mt-20 w-full rounded-t-lg",children:[G.jsxs("div",{className:"max-w-screen-xl mx-auto px-6 py-10 grid grid-cols-1 md:grid-cols-3 gap-10",children:[G.jsxs("div",{children:[G.jsx("div",{className:"flex items-center space-x-3",children:G.jsx("span",{className:"text-xl font-bold text-white",children:"Canvas Games"})}),G.jsx("p",{className:"mt-4 text-sm text-gray-400",children:"A collection of experimental HTML canvas games built with curiosity and a bit of pixel dust."})]}),G.jsxs("div",{className:"md:col-start-3 md:text-right",children:[G.jsx("h3",{className:"text-white text-lg font-semibold mb-4",children:"Follow Me"}),G.jsxs("div",{className:"flex md:justify-end space-x-4",children:[G.jsx("a",{href:"https://github.com",target:"_blank",rel:"noopener noreferrer",className:"hover:text-white",children:"GitHub"}),G.jsx("a",{href:"https://twitter.com",target:"_blank",rel:"noopener noreferrer",className:"hover:text-white",children:"Twitter"}),G.jsx("a",{href:"https://linkedin.com",target:"_blank",rel:"noopener noreferrer",className:"hover:text-white",children:"LinkedIn"})]})]})]}),G.jsxs("div",{className:"border-t border-gray-700 text-center text-sm py-4 text-gray-500 pb-5",children:["© ",new Date().getFullYear()," Paul Q. Peters"]})]})}function Qg(){const[s,t]=re.useState(!1);return re.useEffect(()=>{const e=()=>{t(!!document.fullscreenElement)};return document.addEventListener("fullscreenchange",e),document.addEventListener("webkitfullscreenchange",e),document.addEventListener("mozfullscreenchange",e),document.addEventListener("MSFullscreenChange",e),t(!!document.fullscreenElement),()=>{document.removeEventListener("fullscreenchange",e),document.removeEventListener("webkitfullscreenchange",e),document.removeEventListener("mozfullscreenchange",e),document.removeEventListener("MSFullscreenChange",e)}},[]),{isFullscreen:s}}function Jg(){re.useEffect(()=>{const s=t=>{["ArrowUp","ArrowDown"," "].includes(t.key)&&t.preventDefault()};return window.addEventListener("keydown",s,{passive:!1}),()=>{window.removeEventListener("keydown",s)}},[])}function $o(){return/Mobi|Android|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)}export{aa as $,Ua as A,wt as B,zt as C,at as D,N as E,zh as F,Je as G,Dt as H,sh as I,Si as J,Ht as K,kh as L,X as M,Oh as N,lt as O,ft as P,q as Q,br as R,Lh as S,Ut as T,Ks as U,su as V,ki as W,Tn as X,Pi as Y,ih as Z,ot as _,Wt as a,Da as a0,V as a1,Z as a2,au as a3,Eu as a4,Au as a5,qu as a6,Zu as a7,sd as a8,rd as a9,id as aa,kt as ab,sl as ac,Wi as ad,Di as ae,Ve as af,mo as ag,qt as ah,cf as ai,rt as aj,Jt as ak,kc as al,Co as am,il as an,rx as ao,ix as ap,wu as b,Ss as c,Xs as d,dt as e,Hi as f,xu as g,Wr as h,Ga as i,xa as j,jt as k,Ea as l,tn as m,Xu as n,Ku as o,td as p,nd as q,Nc as r,dn as s,$ as t,Cc as u,un as v,it as w,ad as x,ae as y,ra as z};
