const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/browserAll-CFbNpLbv.js","assets/webworkerAll-C5aXALds.js","assets/colorToUniform-DmtBy-2V.js","assets/chunk-NL6KNZEE-CNR1cGc1.js","assets/WebGPURenderer-BZJMV5Bs.js","assets/SharedSystems-CNyiyr5I.js","assets/WebGLRenderer-CGSR0raR.js"])))=>i.map(i=>d[i]);
import{w as Vc,t as Yc,v as Xc,j as G,c as se}from"./chunk-NL6KNZEE-CNR1cGc1.js";function Ro(s){return s&&s.__esModule&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s}const Lo=()=>{const s=new Map;return{on:(o,a)=>{const c=new Date().getTime().toString().slice(-8),h=Math.floor(Math.random()*1e8),l=`evt_${c}_${h}`;return s.set(l,{id:l,event:o,callback:a}),l},fire:(o,a)=>{for(const c of s.values())c.event===o&&c.callback(a)},count:()=>s.size,remove:o=>{s.delete(o)},clear:()=>s.clear()}},qc="modulepreload",Kc=function(s){return"/canvas-games/"+s},Zn={},js=function(t,e,r){let n=Promise.resolve();if(e&&e.length>0){let o=function(h){return Promise.all(h.map(l=>Promise.resolve(l).then(d=>({status:"fulfilled",value:d}),d=>({status:"rejected",reason:d}))))};document.getElementsByTagName("link");const a=document.querySelector("meta[property=csp-nonce]"),c=(a==null?void 0:a.nonce)||(a==null?void 0:a.getAttribute("nonce"));n=o(e.map(h=>{if(h=Kc(h),h in Zn)return;Zn[h]=!0;const l=h.endsWith(".css"),d=l?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${h}"]${d}`))return;const f=document.createElement("link");if(f.rel=l?"stylesheet":qc,l||(f.as="script"),f.crossOrigin="",f.href=h,c&&f.setAttribute("nonce",c),document.head.appendChild(f),l)return new Promise((u,p)=>{f.addEventListener("load",u),f.addEventListener("error",()=>p(new Error(`Unable to preload CSS for ${h}`)))})}))}function i(o){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=o,window.dispatchEvent(a),!a.defaultPrevented)throw o}return n.then(o=>{for(const a of o||[])a.status==="rejected"&&i(a.reason);return t().catch(i)})};var O=(s=>(s.Application="application",s.WebGLPipes="webgl-pipes",s.WebGLPipesAdaptor="webgl-pipes-adaptor",s.WebGLSystem="webgl-system",s.WebGPUPipes="webgpu-pipes",s.WebGPUPipesAdaptor="webgpu-pipes-adaptor",s.WebGPUSystem="webgpu-system",s.CanvasSystem="canvas-system",s.CanvasPipesAdaptor="canvas-pipes-adaptor",s.CanvasPipes="canvas-pipes",s.Asset="asset",s.LoadParser="load-parser",s.ResolveParser="resolve-parser",s.CacheParser="cache-parser",s.DetectionParser="detection-parser",s.MaskEffect="mask-effect",s.BlendMode="blend-mode",s.TextureSource="texture-source",s.Environment="environment",s.ShapeBuilder="shape-builder",s.Batcher="batcher",s))(O||{});const Qr=s=>{if(typeof s=="function"||typeof s=="object"&&s.extension){if(!s.extension)throw new Error("Extension class must have an extension object");s={...typeof s.extension!="object"?{type:s.extension}:s.extension,ref:s}}if(typeof s=="object")s={...s};else throw new Error("Invalid extension type");return typeof s.type=="string"&&(s.type=[s.type]),s},vs=(s,t)=>Qr(s).priority??t,pt={_addHandlers:{},_removeHandlers:{},_queue:{},remove(...s){return s.map(Qr).forEach(t=>{t.type.forEach(e=>{var r,n;return(n=(r=this._removeHandlers)[e])==null?void 0:n.call(r,t)})}),this},add(...s){return s.map(Qr).forEach(t=>{t.type.forEach(e=>{var i,o;const r=this._addHandlers,n=this._queue;r[e]?(o=r[e])==null||o.call(r,t):(n[e]=n[e]||[],(i=n[e])==null||i.push(t))})}),this},handle(s,t,e){var o;const r=this._addHandlers,n=this._removeHandlers;if(r[s]||n[s])throw new Error(`Extension type ${s} already has a handler`);r[s]=t,n[s]=e;const i=this._queue;return i[s]&&((o=i[s])==null||o.forEach(a=>t(a)),delete i[s]),this},handleByMap(s,t){return this.handle(s,e=>{e.name&&(t[e.name]=e.ref)},e=>{e.name&&delete t[e.name]})},handleByNamedList(s,t,e=-1){return this.handle(s,r=>{t.findIndex(i=>i.name===r.name)>=0||(t.push({name:r.name,value:r.ref}),t.sort((i,o)=>vs(o.value,e)-vs(i.value,e)))},r=>{const n=t.findIndex(i=>i.name===r.name);n!==-1&&t.splice(n,1)})},handleByList(s,t,e=-1){return this.handle(s,r=>{t.includes(r.ref)||(t.push(r.ref),t.sort((n,i)=>vs(i,e)-vs(n,e)))},r=>{const n=t.indexOf(r.ref);n!==-1&&t.splice(n,1)})},mixin(s,...t){for(const e of t)Object.defineProperties(s.prototype,Object.getOwnPropertyDescriptors(e))}},Zc={extension:{type:O.Environment,name:"browser",priority:-1},test:()=>!0,load:async()=>{await js(()=>import("./browserAll-CFbNpLbv.js"),__vite__mapDeps([0,1,2,3]))}},Qc={extension:{type:O.Environment,name:"webworker",priority:0},test:()=>typeof self<"u"&&self.WorkerGlobalScope!==void 0,load:async()=>{await js(()=>import("./webworkerAll-C5aXALds.js"),__vite__mapDeps([1,2,3]))}};class wt{constructor(t,e,r){this._x=e||0,this._y=r||0,this._observer=t}clone(t){return new wt(t??this._observer,this._x,this._y)}set(t=0,e=t){return(this._x!==t||this._y!==e)&&(this._x=t,this._y=e,this._observer._onUpdate(this)),this}copyFrom(t){return(this._x!==t.x||this._y!==t.y)&&(this._x=t.x,this._y=t.y,this._observer._onUpdate(this)),this}copyTo(t){return t.set(this._x,this._y),t}equals(t){return t.x===this._x&&t.y===this._y}toString(){return`[pixi.js/math:ObservablePoint x=${this._x} y=${this._y} scope=${this._observer}]`}get x(){return this._x}set x(t){this._x!==t&&(this._x=t,this._observer._onUpdate(this))}get y(){return this._y}set y(t){this._y!==t&&(this._y=t,this._observer._onUpdate(this))}}var dr={exports:{}},Qn;function Jc(){return Qn||(Qn=1,function(s){var t=Object.prototype.hasOwnProperty,e="~";function r(){}Object.create&&(r.prototype=Object.create(null),new r().__proto__||(e=!1));function n(c,h,l){this.fn=c,this.context=h,this.once=l||!1}function i(c,h,l,d,f){if(typeof l!="function")throw new TypeError("The listener must be a function");var u=new n(l,d||c,f),p=e?e+h:h;return c._events[p]?c._events[p].fn?c._events[p]=[c._events[p],u]:c._events[p].push(u):(c._events[p]=u,c._eventsCount++),c}function o(c,h){--c._eventsCount===0?c._events=new r:delete c._events[h]}function a(){this._events=new r,this._eventsCount=0}a.prototype.eventNames=function(){var h=[],l,d;if(this._eventsCount===0)return h;for(d in l=this._events)t.call(l,d)&&h.push(e?d.slice(1):d);return Object.getOwnPropertySymbols?h.concat(Object.getOwnPropertySymbols(l)):h},a.prototype.listeners=function(h){var l=e?e+h:h,d=this._events[l];if(!d)return[];if(d.fn)return[d.fn];for(var f=0,u=d.length,p=new Array(u);f<u;f++)p[f]=d[f].fn;return p},a.prototype.listenerCount=function(h){var l=e?e+h:h,d=this._events[l];return d?d.fn?1:d.length:0},a.prototype.emit=function(h,l,d,f,u,p){var g=e?e+h:h;if(!this._events[g])return!1;var m=this._events[g],x=arguments.length,y,b;if(m.fn){switch(m.once&&this.removeListener(h,m.fn,void 0,!0),x){case 1:return m.fn.call(m.context),!0;case 2:return m.fn.call(m.context,l),!0;case 3:return m.fn.call(m.context,l,d),!0;case 4:return m.fn.call(m.context,l,d,f),!0;case 5:return m.fn.call(m.context,l,d,f,u),!0;case 6:return m.fn.call(m.context,l,d,f,u,p),!0}for(b=1,y=new Array(x-1);b<x;b++)y[b-1]=arguments[b];m.fn.apply(m.context,y)}else{var w=m.length,v;for(b=0;b<w;b++)switch(m[b].once&&this.removeListener(h,m[b].fn,void 0,!0),x){case 1:m[b].fn.call(m[b].context);break;case 2:m[b].fn.call(m[b].context,l);break;case 3:m[b].fn.call(m[b].context,l,d);break;case 4:m[b].fn.call(m[b].context,l,d,f);break;default:if(!y)for(v=1,y=new Array(x-1);v<x;v++)y[v-1]=arguments[v];m[b].fn.apply(m[b].context,y)}}return!0},a.prototype.on=function(h,l,d){return i(this,h,l,d,!1)},a.prototype.once=function(h,l,d){return i(this,h,l,d,!0)},a.prototype.removeListener=function(h,l,d,f){var u=e?e+h:h;if(!this._events[u])return this;if(!l)return o(this,u),this;var p=this._events[u];if(p.fn)p.fn===l&&(!f||p.once)&&(!d||p.context===d)&&o(this,u);else{for(var g=0,m=[],x=p.length;g<x;g++)(p[g].fn!==l||f&&!p[g].once||d&&p[g].context!==d)&&m.push(p[g]);m.length?this._events[u]=m.length===1?m[0]:m:o(this,u)}return this},a.prototype.removeAllListeners=function(h){var l;return h?(l=e?e+h:h,this._events[l]&&o(this,l)):(this._events=new r,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=e,a.EventEmitter=a,s.exports=a}(dr)),dr.exports}var tl=Jc();const Wt=Ro(tl),el=Math.PI*2,sl=180/Math.PI,rl=Math.PI/180;class mt{constructor(t=0,e=0){this.x=0,this.y=0,this.x=t,this.y=e}clone(){return new mt(this.x,this.y)}copyFrom(t){return this.set(t.x,t.y),this}copyTo(t){return t.set(this.x,this.y),t}equals(t){return t.x===this.x&&t.y===this.y}set(t=0,e=t){return this.x=t,this.y=e,this}toString(){return`[pixi.js/math:Point x=${this.x} y=${this.y}]`}static get shared(){return ur.x=0,ur.y=0,ur}}const ur=new mt;class X{constructor(t=1,e=0,r=0,n=1,i=0,o=0){this.array=null,this.a=t,this.b=e,this.c=r,this.d=n,this.tx=i,this.ty=o}fromArray(t){this.a=t[0],this.b=t[1],this.c=t[3],this.d=t[4],this.tx=t[2],this.ty=t[5]}set(t,e,r,n,i,o){return this.a=t,this.b=e,this.c=r,this.d=n,this.tx=i,this.ty=o,this}toArray(t,e){this.array||(this.array=new Float32Array(9));const r=e||this.array;return t?(r[0]=this.a,r[1]=this.b,r[2]=0,r[3]=this.c,r[4]=this.d,r[5]=0,r[6]=this.tx,r[7]=this.ty,r[8]=1):(r[0]=this.a,r[1]=this.c,r[2]=this.tx,r[3]=this.b,r[4]=this.d,r[5]=this.ty,r[6]=0,r[7]=0,r[8]=1),r}apply(t,e){e=e||new mt;const r=t.x,n=t.y;return e.x=this.a*r+this.c*n+this.tx,e.y=this.b*r+this.d*n+this.ty,e}applyInverse(t,e){e=e||new mt;const r=this.a,n=this.b,i=this.c,o=this.d,a=this.tx,c=this.ty,h=1/(r*o+i*-n),l=t.x,d=t.y;return e.x=o*h*l+-i*h*d+(c*i-a*o)*h,e.y=r*h*d+-n*h*l+(-c*r+a*n)*h,e}translate(t,e){return this.tx+=t,this.ty+=e,this}scale(t,e){return this.a*=t,this.d*=e,this.c*=t,this.b*=e,this.tx*=t,this.ty*=e,this}rotate(t){const e=Math.cos(t),r=Math.sin(t),n=this.a,i=this.c,o=this.tx;return this.a=n*e-this.b*r,this.b=n*r+this.b*e,this.c=i*e-this.d*r,this.d=i*r+this.d*e,this.tx=o*e-this.ty*r,this.ty=o*r+this.ty*e,this}append(t){const e=this.a,r=this.b,n=this.c,i=this.d;return this.a=t.a*e+t.b*n,this.b=t.a*r+t.b*i,this.c=t.c*e+t.d*n,this.d=t.c*r+t.d*i,this.tx=t.tx*e+t.ty*n+this.tx,this.ty=t.tx*r+t.ty*i+this.ty,this}appendFrom(t,e){const r=t.a,n=t.b,i=t.c,o=t.d,a=t.tx,c=t.ty,h=e.a,l=e.b,d=e.c,f=e.d;return this.a=r*h+n*d,this.b=r*l+n*f,this.c=i*h+o*d,this.d=i*l+o*f,this.tx=a*h+c*d+e.tx,this.ty=a*l+c*f+e.ty,this}setTransform(t,e,r,n,i,o,a,c,h){return this.a=Math.cos(a+h)*i,this.b=Math.sin(a+h)*i,this.c=-Math.sin(a-c)*o,this.d=Math.cos(a-c)*o,this.tx=t-(r*this.a+n*this.c),this.ty=e-(r*this.b+n*this.d),this}prepend(t){const e=this.tx;if(t.a!==1||t.b!==0||t.c!==0||t.d!==1){const r=this.a,n=this.c;this.a=r*t.a+this.b*t.c,this.b=r*t.b+this.b*t.d,this.c=n*t.a+this.d*t.c,this.d=n*t.b+this.d*t.d}return this.tx=e*t.a+this.ty*t.c+t.tx,this.ty=e*t.b+this.ty*t.d+t.ty,this}decompose(t){const e=this.a,r=this.b,n=this.c,i=this.d,o=t.pivot,a=-Math.atan2(-n,i),c=Math.atan2(r,e),h=Math.abs(a+c);return h<1e-5||Math.abs(el-h)<1e-5?(t.rotation=c,t.skew.x=t.skew.y=0):(t.rotation=0,t.skew.x=a,t.skew.y=c),t.scale.x=Math.sqrt(e*e+r*r),t.scale.y=Math.sqrt(n*n+i*i),t.position.x=this.tx+(o.x*e+o.y*n),t.position.y=this.ty+(o.x*r+o.y*i),t}invert(){const t=this.a,e=this.b,r=this.c,n=this.d,i=this.tx,o=t*n-e*r;return this.a=n/o,this.b=-e/o,this.c=-r/o,this.d=t/o,this.tx=(r*this.ty-n*i)/o,this.ty=-(t*this.ty-e*i)/o,this}isIdentity(){return this.a===1&&this.b===0&&this.c===0&&this.d===1&&this.tx===0&&this.ty===0}identity(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this}clone(){const t=new X;return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t}copyTo(t){return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t}copyFrom(t){return this.a=t.a,this.b=t.b,this.c=t.c,this.d=t.d,this.tx=t.tx,this.ty=t.ty,this}equals(t){return t.a===this.a&&t.b===this.b&&t.c===this.c&&t.d===this.d&&t.tx===this.tx&&t.ty===this.ty}toString(){return`[pixi.js:Matrix a=${this.a} b=${this.b} c=${this.c} d=${this.d} tx=${this.tx} ty=${this.ty}]`}static get IDENTITY(){return il.identity()}static get shared(){return nl.identity()}}const nl=new X,il=new X,Se=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],Ce=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],ke=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],Pe=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],Jr=[],zo=[],As=Math.sign;function ol(){for(let s=0;s<16;s++){const t=[];Jr.push(t);for(let e=0;e<16;e++){const r=As(Se[s]*Se[e]+ke[s]*Ce[e]),n=As(Ce[s]*Se[e]+Pe[s]*Ce[e]),i=As(Se[s]*ke[e]+ke[s]*Pe[e]),o=As(Ce[s]*ke[e]+Pe[s]*Pe[e]);for(let a=0;a<16;a++)if(Se[a]===r&&Ce[a]===n&&ke[a]===i&&Pe[a]===o){t.push(a);break}}}for(let s=0;s<16;s++){const t=new X;t.set(Se[s],Ce[s],ke[s],Pe[s],0,0),zo.push(t)}}ol();const st={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MAIN_DIAGONAL:10,MIRROR_HORIZONTAL:12,REVERSE_DIAGONAL:14,uX:s=>Se[s],uY:s=>Ce[s],vX:s=>ke[s],vY:s=>Pe[s],inv:s=>s&8?s&15:-s&7,add:(s,t)=>Jr[s][t],sub:(s,t)=>Jr[s][st.inv(t)],rotate180:s=>s^4,isVertical:s=>(s&3)===2,byDirection:(s,t)=>Math.abs(s)*2<=Math.abs(t)?t>=0?st.S:st.N:Math.abs(t)*2<=Math.abs(s)?s>0?st.E:st.W:t>0?s>0?st.SE:st.SW:s>0?st.NE:st.NW,matrixAppendRotationInv:(s,t,e=0,r=0)=>{const n=zo[st.inv(t)];n.tx=e,n.ty=r,s.append(n)}},Ss=[new mt,new mt,new mt,new mt];class q{constructor(t=0,e=0,r=0,n=0){this.type="rectangle",this.x=Number(t),this.y=Number(e),this.width=Number(r),this.height=Number(n)}get left(){return this.x}get right(){return this.x+this.width}get top(){return this.y}get bottom(){return this.y+this.height}isEmpty(){return this.left===this.right||this.top===this.bottom}static get EMPTY(){return new q(0,0,0,0)}clone(){return new q(this.x,this.y,this.width,this.height)}copyFromBounds(t){return this.x=t.minX,this.y=t.minY,this.width=t.maxX-t.minX,this.height=t.maxY-t.minY,this}copyFrom(t){return this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height,this}copyTo(t){return t.copyFrom(this),t}contains(t,e){return this.width<=0||this.height<=0?!1:t>=this.x&&t<this.x+this.width&&e>=this.y&&e<this.y+this.height}strokeContains(t,e,r,n=.5){const{width:i,height:o}=this;if(i<=0||o<=0)return!1;const a=this.x,c=this.y,h=r*(1-n),l=r-h,d=a-h,f=a+i+h,u=c-h,p=c+o+h,g=a+l,m=a+i-l,x=c+l,y=c+o-l;return t>=d&&t<=f&&e>=u&&e<=p&&!(t>g&&t<m&&e>x&&e<y)}intersects(t,e){if(!e){const P=this.x<t.x?t.x:this.x;if((this.right>t.right?t.right:this.right)<=P)return!1;const C=this.y<t.y?t.y:this.y;return(this.bottom>t.bottom?t.bottom:this.bottom)>C}const r=this.left,n=this.right,i=this.top,o=this.bottom;if(n<=r||o<=i)return!1;const a=Ss[0].set(t.left,t.top),c=Ss[1].set(t.left,t.bottom),h=Ss[2].set(t.right,t.top),l=Ss[3].set(t.right,t.bottom);if(h.x<=a.x||c.y<=a.y)return!1;const d=Math.sign(e.a*e.d-e.b*e.c);if(d===0||(e.apply(a,a),e.apply(c,c),e.apply(h,h),e.apply(l,l),Math.max(a.x,c.x,h.x,l.x)<=r||Math.min(a.x,c.x,h.x,l.x)>=n||Math.max(a.y,c.y,h.y,l.y)<=i||Math.min(a.y,c.y,h.y,l.y)>=o))return!1;const f=d*(c.y-a.y),u=d*(a.x-c.x),p=f*r+u*i,g=f*n+u*i,m=f*r+u*o,x=f*n+u*o;if(Math.max(p,g,m,x)<=f*a.x+u*a.y||Math.min(p,g,m,x)>=f*l.x+u*l.y)return!1;const y=d*(a.y-h.y),b=d*(h.x-a.x),w=y*r+b*i,v=y*n+b*i,S=y*r+b*o,k=y*n+b*o;return!(Math.max(w,v,S,k)<=y*a.x+b*a.y||Math.min(w,v,S,k)>=y*l.x+b*l.y)}pad(t=0,e=t){return this.x-=t,this.y-=e,this.width+=t*2,this.height+=e*2,this}fit(t){const e=Math.max(this.x,t.x),r=Math.min(this.x+this.width,t.x+t.width),n=Math.max(this.y,t.y),i=Math.min(this.y+this.height,t.y+t.height);return this.x=e,this.width=Math.max(r-e,0),this.y=n,this.height=Math.max(i-n,0),this}ceil(t=1,e=.001){const r=Math.ceil((this.x+this.width-e)*t)/t,n=Math.ceil((this.y+this.height-e)*t)/t;return this.x=Math.floor((this.x+e)*t)/t,this.y=Math.floor((this.y+e)*t)/t,this.width=r-this.x,this.height=n-this.y,this}enlarge(t){const e=Math.min(this.x,t.x),r=Math.max(this.x+this.width,t.x+t.width),n=Math.min(this.y,t.y),i=Math.max(this.y+this.height,t.y+t.height);return this.x=e,this.width=r-e,this.y=n,this.height=i-n,this}getBounds(t){return t||(t=new q),t.copyFrom(this),t}containsRect(t){if(this.width<=0||this.height<=0)return!1;const e=t.x,r=t.y,n=t.x+t.width,i=t.y+t.height;return e>=this.x&&e<this.x+this.width&&r>=this.y&&r<this.y+this.height&&n>=this.x&&n<this.x+this.width&&i>=this.y&&i<this.y+this.height}set(t,e,r,n){return this.x=t,this.y=e,this.width=r,this.height=n,this}toString(){return`[pixi.js/math:Rectangle x=${this.x} y=${this.y} width=${this.width} height=${this.height}]`}}const fr={default:-1};function ct(s="default"){return fr[s]===void 0&&(fr[s]=-1),++fr[s]}const Jn={},Q="8.0.0",al="8.3.4";function Y(s,t,e=3){if(Jn[t])return;let r=new Error().stack;typeof r>"u"?console.warn("PixiJS Deprecation Warning: ",`${t}
Deprecated since v${s}`):(r=r.split(`
`).splice(e).join(`
`),console.groupCollapsed?(console.groupCollapsed("%cPixiJS Deprecation Warning: %c%s","color:#614108;background:#fffbe6","font-weight:normal;color:#614108;background:#fffbe6",`${t}
Deprecated since v${s}`),console.warn(r),console.groupEnd()):(console.warn("PixiJS Deprecation Warning: ",`${t}
Deprecated since v${s}`),console.warn(r))),Jn[t]=!0}const Go=()=>{};function De(s){return s+=s===0?1:0,--s,s|=s>>>1,s|=s>>>2,s|=s>>>4,s|=s>>>8,s|=s>>>16,s+1}function ti(s){return!(s&s-1)&&!!s}function No(s){const t={};for(const e in s)s[e]!==void 0&&(t[e]=s[e]);return t}const ei=Object.create(null);function cl(s){const t=ei[s];return t===void 0&&(ei[s]=ct("resource")),t}const Oo=class Uo extends Wt{constructor(t={}){super(),this._resourceType="textureSampler",this._touched=0,this._maxAnisotropy=1,this.destroyed=!1,t={...Uo.defaultOptions,...t},this.addressMode=t.addressMode,this.addressModeU=t.addressModeU??this.addressModeU,this.addressModeV=t.addressModeV??this.addressModeV,this.addressModeW=t.addressModeW??this.addressModeW,this.scaleMode=t.scaleMode,this.magFilter=t.magFilter??this.magFilter,this.minFilter=t.minFilter??this.minFilter,this.mipmapFilter=t.mipmapFilter??this.mipmapFilter,this.lodMinClamp=t.lodMinClamp,this.lodMaxClamp=t.lodMaxClamp,this.compare=t.compare,this.maxAnisotropy=t.maxAnisotropy??1}set addressMode(t){this.addressModeU=t,this.addressModeV=t,this.addressModeW=t}get addressMode(){return this.addressModeU}set wrapMode(t){Y(Q,"TextureStyle.wrapMode is now TextureStyle.addressMode"),this.addressMode=t}get wrapMode(){return this.addressMode}set scaleMode(t){this.magFilter=t,this.minFilter=t,this.mipmapFilter=t}get scaleMode(){return this.magFilter}set maxAnisotropy(t){this._maxAnisotropy=Math.min(t,16),this._maxAnisotropy>1&&(this.scaleMode="linear")}get maxAnisotropy(){return this._maxAnisotropy}get _resourceId(){return this._sharedResourceId||this._generateResourceId()}update(){this.emit("change",this),this._sharedResourceId=null}_generateResourceId(){const t=`${this.addressModeU}-${this.addressModeV}-${this.addressModeW}-${this.magFilter}-${this.minFilter}-${this.mipmapFilter}-${this.lodMinClamp}-${this.lodMaxClamp}-${this.compare}-${this._maxAnisotropy}`;return this._sharedResourceId=cl(t),this._resourceId}destroy(){this.destroyed=!0,this.emit("destroy",this),this.emit("change",this),this.removeAllListeners()}};Oo.defaultOptions={addressMode:"clamp-to-edge",scaleMode:"linear"};let He=Oo;const Do=class Ho extends Wt{constructor(t={}){super(),this.options=t,this.uid=ct("textureSource"),this._resourceType="textureSource",this._resourceId=ct("resource"),this.uploadMethodId="unknown",this._resolution=1,this.pixelWidth=1,this.pixelHeight=1,this.width=1,this.height=1,this.sampleCount=1,this.mipLevelCount=1,this.autoGenerateMipmaps=!1,this.format="rgba8unorm",this.dimension="2d",this.antialias=!1,this._touched=0,this._batchTick=-1,this._textureBindLocation=-1,t={...Ho.defaultOptions,...t},this.label=t.label??"",this.resource=t.resource,this.autoGarbageCollect=t.autoGarbageCollect,this._resolution=t.resolution,t.width?this.pixelWidth=t.width*this._resolution:this.pixelWidth=this.resource?this.resourceWidth??1:1,t.height?this.pixelHeight=t.height*this._resolution:this.pixelHeight=this.resource?this.resourceHeight??1:1,this.width=this.pixelWidth/this._resolution,this.height=this.pixelHeight/this._resolution,this.format=t.format,this.dimension=t.dimensions,this.mipLevelCount=t.mipLevelCount,this.autoGenerateMipmaps=t.autoGenerateMipmaps,this.sampleCount=t.sampleCount,this.antialias=t.antialias,this.alphaMode=t.alphaMode,this.style=new He(No(t)),this.destroyed=!1,this._refreshPOT()}get source(){return this}get style(){return this._style}set style(t){var e,r;this.style!==t&&((e=this._style)==null||e.off("change",this._onStyleChange,this),this._style=t,(r=this._style)==null||r.on("change",this._onStyleChange,this),this._onStyleChange())}get addressMode(){return this._style.addressMode}set addressMode(t){this._style.addressMode=t}get repeatMode(){return this._style.addressMode}set repeatMode(t){this._style.addressMode=t}get magFilter(){return this._style.magFilter}set magFilter(t){this._style.magFilter=t}get minFilter(){return this._style.minFilter}set minFilter(t){this._style.minFilter=t}get mipmapFilter(){return this._style.mipmapFilter}set mipmapFilter(t){this._style.mipmapFilter=t}get lodMinClamp(){return this._style.lodMinClamp}set lodMinClamp(t){this._style.lodMinClamp=t}get lodMaxClamp(){return this._style.lodMaxClamp}set lodMaxClamp(t){this._style.lodMaxClamp=t}_onStyleChange(){this.emit("styleChange",this)}update(){if(this.resource){const t=this._resolution;if(this.resize(this.resourceWidth/t,this.resourceHeight/t))return}this.emit("update",this)}destroy(){this.destroyed=!0,this.emit("destroy",this),this.emit("change",this),this._style&&(this._style.destroy(),this._style=null),this.uploadMethodId=null,this.resource=null,this.removeAllListeners()}unload(){this._resourceId=ct("resource"),this.emit("change",this),this.emit("unload",this)}get resourceWidth(){const{resource:t}=this;return t.naturalWidth||t.videoWidth||t.displayWidth||t.width}get resourceHeight(){const{resource:t}=this;return t.naturalHeight||t.videoHeight||t.displayHeight||t.height}get resolution(){return this._resolution}set resolution(t){this._resolution!==t&&(this._resolution=t,this.width=this.pixelWidth/t,this.height=this.pixelHeight/t)}resize(t,e,r){r||(r=this._resolution),t||(t=this.width),e||(e=this.height);const n=Math.round(t*r),i=Math.round(e*r);return this.width=n/r,this.height=i/r,this._resolution=r,this.pixelWidth===n&&this.pixelHeight===i?!1:(this._refreshPOT(),this.pixelWidth=n,this.pixelHeight=i,this.emit("resize",this),this._resourceId=ct("resource"),this.emit("change",this),!0)}updateMipmaps(){this.autoGenerateMipmaps&&this.mipLevelCount>1&&this.emit("updateMipmaps",this)}set wrapMode(t){this._style.wrapMode=t}get wrapMode(){return this._style.wrapMode}set scaleMode(t){this._style.scaleMode=t}get scaleMode(){return this._style.scaleMode}_refreshPOT(){this.isPowerOfTwo=ti(this.pixelWidth)&&ti(this.pixelHeight)}static test(t){throw new Error("Unimplemented")}};Do.defaultOptions={resolution:1,format:"bgra8unorm",alphaMode:"premultiply-alpha-on-upload",dimensions:"2d",mipLevelCount:1,autoGenerateMipmaps:!1,sampleCount:1,antialias:!1,autoGarbageCollect:!1};let jt=Do;class Cn extends jt{constructor(t){const e=t.resource||new Float32Array(t.width*t.height*4);let r=t.format;r||(e instanceof Float32Array?r="rgba32float":e instanceof Int32Array||e instanceof Uint32Array?r="rgba32uint":e instanceof Int16Array||e instanceof Uint16Array?r="rgba16uint":(e instanceof Int8Array,r="bgra8unorm")),super({...t,resource:e,format:r}),this.uploadMethodId="buffer"}static test(t){return t instanceof Int8Array||t instanceof Uint8Array||t instanceof Uint8ClampedArray||t instanceof Int16Array||t instanceof Uint16Array||t instanceof Int32Array||t instanceof Uint32Array||t instanceof Float32Array}}Cn.extension=O.TextureSource;const si=new X;class ll{constructor(t,e){this.mapCoord=new X,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._textureID=-1,this._updateID=0,this.clampOffset=0,typeof e>"u"?this.clampMargin=t.width<10?0:.5:this.clampMargin=e,this.isSimple=!1,this.texture=t}get texture(){return this._texture}set texture(t){var e;this.texture!==t&&((e=this._texture)==null||e.removeListener("update",this.update,this),this._texture=t,this._texture.addListener("update",this.update,this),this.update())}multiplyUvs(t,e){e===void 0&&(e=t);const r=this.mapCoord;for(let n=0;n<t.length;n+=2){const i=t[n],o=t[n+1];e[n]=i*r.a+o*r.c+r.tx,e[n+1]=i*r.b+o*r.d+r.ty}return e}update(){const t=this._texture;this._updateID++;const e=t.uvs;this.mapCoord.set(e.x1-e.x0,e.y1-e.y0,e.x3-e.x0,e.y3-e.y0,e.x0,e.y0);const r=t.orig,n=t.trim;n&&(si.set(r.width/n.width,0,0,r.height/n.height,-n.x/n.width,-n.y/n.height),this.mapCoord.append(si));const i=t.source,o=this.uClampFrame,a=this.clampMargin/i._resolution,c=this.clampOffset/i._resolution;return o[0]=(t.frame.x+a+c)/i.width,o[1]=(t.frame.y+a+c)/i.height,o[2]=(t.frame.x+t.frame.width-a+c)/i.width,o[3]=(t.frame.y+t.frame.height-a+c)/i.height,this.uClampOffset[0]=this.clampOffset/i.pixelWidth,this.uClampOffset[1]=this.clampOffset/i.pixelHeight,this.isSimple=t.frame.width===i.width&&t.frame.height===i.height&&t.rotate===0,!0}}class $ extends Wt{constructor({source:t,label:e,frame:r,orig:n,trim:i,defaultAnchor:o,defaultBorders:a,rotate:c,dynamic:h}={}){if(super(),this.uid=ct("texture"),this.uvs={x0:0,y0:0,x1:0,y1:0,x2:0,y2:0,x3:0,y3:0},this.frame=new q,this.noFrame=!1,this.dynamic=!1,this.isTexture=!0,this.label=e,this.source=(t==null?void 0:t.source)??new jt,this.noFrame=!r,r)this.frame.copyFrom(r);else{const{width:l,height:d}=this._source;this.frame.width=l,this.frame.height=d}this.orig=n||this.frame,this.trim=i,this.rotate=c??0,this.defaultAnchor=o,this.defaultBorders=a,this.destroyed=!1,this.dynamic=h||!1,this.updateUvs()}set source(t){this._source&&this._source.off("resize",this.update,this),this._source=t,t.on("resize",this.update,this),this.emit("update",this)}get source(){return this._source}get textureMatrix(){return this._textureMatrix||(this._textureMatrix=new ll(this)),this._textureMatrix}get width(){return this.orig.width}get height(){return this.orig.height}updateUvs(){const{uvs:t,frame:e}=this,{width:r,height:n}=this._source,i=e.x/r,o=e.y/n,a=e.width/r,c=e.height/n;let h=this.rotate;if(h){const l=a/2,d=c/2,f=i+l,u=o+d;h=st.add(h,st.NW),t.x0=f+l*st.uX(h),t.y0=u+d*st.uY(h),h=st.add(h,2),t.x1=f+l*st.uX(h),t.y1=u+d*st.uY(h),h=st.add(h,2),t.x2=f+l*st.uX(h),t.y2=u+d*st.uY(h),h=st.add(h,2),t.x3=f+l*st.uX(h),t.y3=u+d*st.uY(h)}else t.x0=i,t.y0=o,t.x1=i+a,t.y1=o,t.x2=i+a,t.y2=o+c,t.x3=i,t.y3=o+c}destroy(t=!1){this._source&&t&&(this._source.destroy(),this._source=null),this._textureMatrix=null,this.destroyed=!0,this.emit("destroy",this),this.removeAllListeners()}update(){this.noFrame&&(this.frame.width=this._source.width,this.frame.height=this._source.height),this.updateUvs(),this.emit("update",this)}get baseTexture(){return Y(Q,"Texture.baseTexture is now Texture.source"),this._source}}$.EMPTY=new $({label:"EMPTY",source:new jt({label:"EMPTY"})});$.EMPTY.destroy=Go;$.WHITE=new $({source:new Cn({resource:new Uint8Array([255,255,255,255]),width:1,height:1,alphaMode:"premultiply-alpha-on-upload",label:"WHITE"}),label:"WHITE"});$.WHITE.destroy=Go;function hl(s,t,e){const{width:r,height:n}=e.orig,i=e.trim;if(i){const o=i.width,a=i.height;s.minX=i.x-t._x*r,s.maxX=s.minX+o,s.minY=i.y-t._y*n,s.maxY=s.minY+a}else s.minX=-t._x*r,s.maxX=s.minX+r,s.minY=-t._y*n,s.maxY=s.minY+n}const ri=new X;class Ht{constructor(t=1/0,e=1/0,r=-1/0,n=-1/0){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.matrix=ri,this.minX=t,this.minY=e,this.maxX=r,this.maxY=n}isEmpty(){return this.minX>this.maxX||this.minY>this.maxY}get rectangle(){this._rectangle||(this._rectangle=new q);const t=this._rectangle;return this.minX>this.maxX||this.minY>this.maxY?(t.x=0,t.y=0,t.width=0,t.height=0):t.copyFromBounds(this),t}clear(){return this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.matrix=ri,this}set(t,e,r,n){this.minX=t,this.minY=e,this.maxX=r,this.maxY=n}addFrame(t,e,r,n,i){i||(i=this.matrix);const o=i.a,a=i.b,c=i.c,h=i.d,l=i.tx,d=i.ty;let f=this.minX,u=this.minY,p=this.maxX,g=this.maxY,m=o*t+c*e+l,x=a*t+h*e+d;m<f&&(f=m),x<u&&(u=x),m>p&&(p=m),x>g&&(g=x),m=o*r+c*e+l,x=a*r+h*e+d,m<f&&(f=m),x<u&&(u=x),m>p&&(p=m),x>g&&(g=x),m=o*t+c*n+l,x=a*t+h*n+d,m<f&&(f=m),x<u&&(u=x),m>p&&(p=m),x>g&&(g=x),m=o*r+c*n+l,x=a*r+h*n+d,m<f&&(f=m),x<u&&(u=x),m>p&&(p=m),x>g&&(g=x),this.minX=f,this.minY=u,this.maxX=p,this.maxY=g}addRect(t,e){this.addFrame(t.x,t.y,t.x+t.width,t.y+t.height,e)}addBounds(t,e){this.addFrame(t.minX,t.minY,t.maxX,t.maxY,e)}addBoundsMask(t){this.minX=this.minX>t.minX?this.minX:t.minX,this.minY=this.minY>t.minY?this.minY:t.minY,this.maxX=this.maxX<t.maxX?this.maxX:t.maxX,this.maxY=this.maxY<t.maxY?this.maxY:t.maxY}applyMatrix(t){const e=this.minX,r=this.minY,n=this.maxX,i=this.maxY,{a:o,b:a,c,d:h,tx:l,ty:d}=t;let f=o*e+c*r+l,u=a*e+h*r+d;this.minX=f,this.minY=u,this.maxX=f,this.maxY=u,f=o*n+c*r+l,u=a*n+h*r+d,this.minX=f<this.minX?f:this.minX,this.minY=u<this.minY?u:this.minY,this.maxX=f>this.maxX?f:this.maxX,this.maxY=u>this.maxY?u:this.maxY,f=o*e+c*i+l,u=a*e+h*i+d,this.minX=f<this.minX?f:this.minX,this.minY=u<this.minY?u:this.minY,this.maxX=f>this.maxX?f:this.maxX,this.maxY=u>this.maxY?u:this.maxY,f=o*n+c*i+l,u=a*n+h*i+d,this.minX=f<this.minX?f:this.minX,this.minY=u<this.minY?u:this.minY,this.maxX=f>this.maxX?f:this.maxX,this.maxY=u>this.maxY?u:this.maxY}fit(t){return this.minX<t.left&&(this.minX=t.left),this.maxX>t.right&&(this.maxX=t.right),this.minY<t.top&&(this.minY=t.top),this.maxY>t.bottom&&(this.maxY=t.bottom),this}fitBounds(t,e,r,n){return this.minX<t&&(this.minX=t),this.maxX>e&&(this.maxX=e),this.minY<r&&(this.minY=r),this.maxY>n&&(this.maxY=n),this}pad(t,e=t){return this.minX-=t,this.maxX+=t,this.minY-=e,this.maxY+=e,this}ceil(){return this.minX=Math.floor(this.minX),this.minY=Math.floor(this.minY),this.maxX=Math.ceil(this.maxX),this.maxY=Math.ceil(this.maxY),this}clone(){return new Ht(this.minX,this.minY,this.maxX,this.maxY)}scale(t,e=t){return this.minX*=t,this.minY*=e,this.maxX*=t,this.maxY*=e,this}get x(){return this.minX}set x(t){const e=this.maxX-this.minX;this.minX=t,this.maxX=t+e}get y(){return this.minY}set y(t){const e=this.maxY-this.minY;this.minY=t,this.maxY=t+e}get width(){return this.maxX-this.minX}set width(t){this.maxX=this.minX+t}get height(){return this.maxY-this.minY}set height(t){this.maxY=this.minY+t}get left(){return this.minX}get right(){return this.maxX}get top(){return this.minY}get bottom(){return this.maxY}get isPositive(){return this.maxX-this.minX>0&&this.maxY-this.minY>0}get isValid(){return this.minX+this.minY!==1/0}addVertexData(t,e,r,n){let i=this.minX,o=this.minY,a=this.maxX,c=this.maxY;n||(n=this.matrix);const h=n.a,l=n.b,d=n.c,f=n.d,u=n.tx,p=n.ty;for(let g=e;g<r;g+=2){const m=t[g],x=t[g+1],y=h*m+d*x+u,b=l*m+f*x+p;i=y<i?y:i,o=b<o?b:o,a=y>a?y:a,c=b>c?b:c}this.minX=i,this.minY=o,this.maxX=a,this.maxY=c}containsPoint(t,e){return this.minX<=t&&this.minY<=e&&this.maxX>=t&&this.maxY>=e}toString(){return`[pixi.js:Bounds minX=${this.minX} minY=${this.minY} maxX=${this.maxX} maxY=${this.maxY} width=${this.width} height=${this.height}]`}copyFrom(t){return this.minX=t.minX,this.minY=t.minY,this.maxX=t.maxX,this.maxY=t.maxY,this}}var dl={grad:.9,turn:360,rad:360/(2*Math.PI)},Jt=function(s){return typeof s=="string"?s.length>0:typeof s=="number"},dt=function(s,t,e){return t===void 0&&(t=0),e===void 0&&(e=Math.pow(10,t)),Math.round(e*s)/e+0},Lt=function(s,t,e){return t===void 0&&(t=0),e===void 0&&(e=1),s>e?e:s>t?s:t},Wo=function(s){return(s=isFinite(s)?s%360:0)>0?s:s+360},ni=function(s){return{r:Lt(s.r,0,255),g:Lt(s.g,0,255),b:Lt(s.b,0,255),a:Lt(s.a)}},pr=function(s){return{r:dt(s.r),g:dt(s.g),b:dt(s.b),a:dt(s.a,3)}},ul=/^#([0-9a-f]{3,8})$/i,Cs=function(s){var t=s.toString(16);return t.length<2?"0"+t:t},jo=function(s){var t=s.r,e=s.g,r=s.b,n=s.a,i=Math.max(t,e,r),o=i-Math.min(t,e,r),a=o?i===t?(e-r)/o:i===e?2+(r-t)/o:4+(t-e)/o:0;return{h:60*(a<0?a+6:a),s:i?o/i*100:0,v:i/255*100,a:n}},$o=function(s){var t=s.h,e=s.s,r=s.v,n=s.a;t=t/360*6,e/=100,r/=100;var i=Math.floor(t),o=r*(1-e),a=r*(1-(t-i)*e),c=r*(1-(1-t+i)*e),h=i%6;return{r:255*[r,a,o,o,c,r][h],g:255*[c,r,r,a,o,o][h],b:255*[o,o,c,r,r,a][h],a:n}},ii=function(s){return{h:Wo(s.h),s:Lt(s.s,0,100),l:Lt(s.l,0,100),a:Lt(s.a)}},oi=function(s){return{h:dt(s.h),s:dt(s.s),l:dt(s.l),a:dt(s.a,3)}},ai=function(s){return $o((e=(t=s).s,{h:t.h,s:(e*=((r=t.l)<50?r:100-r)/100)>0?2*e/(r+e)*100:0,v:r+e,a:t.a}));var t,e,r},ls=function(s){return{h:(t=jo(s)).h,s:(n=(200-(e=t.s))*(r=t.v)/100)>0&&n<200?e*r/100/(n<=100?n:200-n)*100:0,l:n/2,a:t.a};var t,e,r,n},fl=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s*,\s*([+-]?\d*\.?\d+)%\s*,\s*([+-]?\d*\.?\d+)%\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,pl=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s+([+-]?\d*\.?\d+)%\s+([+-]?\d*\.?\d+)%\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,ml=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,gl=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,tn={string:[[function(s){var t=ul.exec(s);return t?(s=t[1]).length<=4?{r:parseInt(s[0]+s[0],16),g:parseInt(s[1]+s[1],16),b:parseInt(s[2]+s[2],16),a:s.length===4?dt(parseInt(s[3]+s[3],16)/255,2):1}:s.length===6||s.length===8?{r:parseInt(s.substr(0,2),16),g:parseInt(s.substr(2,2),16),b:parseInt(s.substr(4,2),16),a:s.length===8?dt(parseInt(s.substr(6,2),16)/255,2):1}:null:null},"hex"],[function(s){var t=ml.exec(s)||gl.exec(s);return t?t[2]!==t[4]||t[4]!==t[6]?null:ni({r:Number(t[1])/(t[2]?100/255:1),g:Number(t[3])/(t[4]?100/255:1),b:Number(t[5])/(t[6]?100/255:1),a:t[7]===void 0?1:Number(t[7])/(t[8]?100:1)}):null},"rgb"],[function(s){var t=fl.exec(s)||pl.exec(s);if(!t)return null;var e,r,n=ii({h:(e=t[1],r=t[2],r===void 0&&(r="deg"),Number(e)*(dl[r]||1)),s:Number(t[3]),l:Number(t[4]),a:t[5]===void 0?1:Number(t[5])/(t[6]?100:1)});return ai(n)},"hsl"]],object:[[function(s){var t=s.r,e=s.g,r=s.b,n=s.a,i=n===void 0?1:n;return Jt(t)&&Jt(e)&&Jt(r)?ni({r:Number(t),g:Number(e),b:Number(r),a:Number(i)}):null},"rgb"],[function(s){var t=s.h,e=s.s,r=s.l,n=s.a,i=n===void 0?1:n;if(!Jt(t)||!Jt(e)||!Jt(r))return null;var o=ii({h:Number(t),s:Number(e),l:Number(r),a:Number(i)});return ai(o)},"hsl"],[function(s){var t=s.h,e=s.s,r=s.v,n=s.a,i=n===void 0?1:n;if(!Jt(t)||!Jt(e)||!Jt(r))return null;var o=function(a){return{h:Wo(a.h),s:Lt(a.s,0,100),v:Lt(a.v,0,100),a:Lt(a.a)}}({h:Number(t),s:Number(e),v:Number(r),a:Number(i)});return $o(o)},"hsv"]]},ci=function(s,t){for(var e=0;e<t.length;e++){var r=t[e][0](s);if(r)return[r,t[e][1]]}return[null,void 0]},xl=function(s){return typeof s=="string"?ci(s.trim(),tn.string):typeof s=="object"&&s!==null?ci(s,tn.object):[null,void 0]},mr=function(s,t){var e=ls(s);return{h:e.h,s:Lt(e.s+100*t,0,100),l:e.l,a:e.a}},gr=function(s){return(299*s.r+587*s.g+114*s.b)/1e3/255},li=function(s,t){var e=ls(s);return{h:e.h,s:e.s,l:Lt(e.l+100*t,0,100),a:e.a}},en=function(){function s(t){this.parsed=xl(t)[0],this.rgba=this.parsed||{r:0,g:0,b:0,a:1}}return s.prototype.isValid=function(){return this.parsed!==null},s.prototype.brightness=function(){return dt(gr(this.rgba),2)},s.prototype.isDark=function(){return gr(this.rgba)<.5},s.prototype.isLight=function(){return gr(this.rgba)>=.5},s.prototype.toHex=function(){return t=pr(this.rgba),e=t.r,r=t.g,n=t.b,o=(i=t.a)<1?Cs(dt(255*i)):"","#"+Cs(e)+Cs(r)+Cs(n)+o;var t,e,r,n,i,o},s.prototype.toRgb=function(){return pr(this.rgba)},s.prototype.toRgbString=function(){return t=pr(this.rgba),e=t.r,r=t.g,n=t.b,(i=t.a)<1?"rgba("+e+", "+r+", "+n+", "+i+")":"rgb("+e+", "+r+", "+n+")";var t,e,r,n,i},s.prototype.toHsl=function(){return oi(ls(this.rgba))},s.prototype.toHslString=function(){return t=oi(ls(this.rgba)),e=t.h,r=t.s,n=t.l,(i=t.a)<1?"hsla("+e+", "+r+"%, "+n+"%, "+i+")":"hsl("+e+", "+r+"%, "+n+"%)";var t,e,r,n,i},s.prototype.toHsv=function(){return t=jo(this.rgba),{h:dt(t.h),s:dt(t.s),v:dt(t.v),a:dt(t.a,3)};var t},s.prototype.invert=function(){return Vt({r:255-(t=this.rgba).r,g:255-t.g,b:255-t.b,a:t.a});var t},s.prototype.saturate=function(t){return t===void 0&&(t=.1),Vt(mr(this.rgba,t))},s.prototype.desaturate=function(t){return t===void 0&&(t=.1),Vt(mr(this.rgba,-t))},s.prototype.grayscale=function(){return Vt(mr(this.rgba,-1))},s.prototype.lighten=function(t){return t===void 0&&(t=.1),Vt(li(this.rgba,t))},s.prototype.darken=function(t){return t===void 0&&(t=.1),Vt(li(this.rgba,-t))},s.prototype.rotate=function(t){return t===void 0&&(t=15),this.hue(this.hue()+t)},s.prototype.alpha=function(t){return typeof t=="number"?Vt({r:(e=this.rgba).r,g:e.g,b:e.b,a:t}):dt(this.rgba.a,3);var e},s.prototype.hue=function(t){var e=ls(this.rgba);return typeof t=="number"?Vt({h:t,s:e.s,l:e.l,a:e.a}):dt(e.h)},s.prototype.isEqual=function(t){return this.toHex()===Vt(t).toHex()},s}(),Vt=function(s){return s instanceof en?s:new en(s)},hi=[],yl=function(s){s.forEach(function(t){hi.indexOf(t)<0&&(t(en,tn),hi.push(t))})};function bl(s,t){var e={white:"#ffffff",bisque:"#ffe4c4",blue:"#0000ff",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",antiquewhite:"#faebd7",aqua:"#00ffff",azure:"#f0ffff",whitesmoke:"#f5f5f5",papayawhip:"#ffefd5",plum:"#dda0dd",blanchedalmond:"#ffebcd",black:"#000000",gold:"#ffd700",goldenrod:"#daa520",gainsboro:"#dcdcdc",cornsilk:"#fff8dc",cornflowerblue:"#6495ed",burlywood:"#deb887",aquamarine:"#7fffd4",beige:"#f5f5dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkkhaki:"#bdb76b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",peachpuff:"#ffdab9",darkmagenta:"#8b008b",darkred:"#8b0000",darkorchid:"#9932cc",darkorange:"#ff8c00",darkslateblue:"#483d8b",gray:"#808080",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",deeppink:"#ff1493",deepskyblue:"#00bfff",wheat:"#f5deb3",firebrick:"#b22222",floralwhite:"#fffaf0",ghostwhite:"#f8f8ff",darkviolet:"#9400d3",magenta:"#ff00ff",green:"#008000",dodgerblue:"#1e90ff",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",blueviolet:"#8a2be2",forestgreen:"#228b22",lawngreen:"#7cfc00",indianred:"#cd5c5c",indigo:"#4b0082",fuchsia:"#ff00ff",brown:"#a52a2a",maroon:"#800000",mediumblue:"#0000cd",lightcoral:"#f08080",darkturquoise:"#00ced1",lightcyan:"#e0ffff",ivory:"#fffff0",lightyellow:"#ffffe0",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",linen:"#faf0e6",mediumaquamarine:"#66cdaa",lemonchiffon:"#fffacd",lime:"#00ff00",khaki:"#f0e68c",mediumseagreen:"#3cb371",limegreen:"#32cd32",mediumspringgreen:"#00fa9a",lightskyblue:"#87cefa",lightblue:"#add8e6",midnightblue:"#191970",lightpink:"#ffb6c1",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",mintcream:"#f5fffa",lightslategray:"#778899",lightslategrey:"#778899",navajowhite:"#ffdead",navy:"#000080",mediumvioletred:"#c71585",powderblue:"#b0e0e6",palegoldenrod:"#eee8aa",oldlace:"#fdf5e6",paleturquoise:"#afeeee",mediumturquoise:"#48d1cc",mediumorchid:"#ba55d3",rebeccapurple:"#663399",lightsteelblue:"#b0c4de",mediumslateblue:"#7b68ee",thistle:"#d8bfd8",tan:"#d2b48c",orchid:"#da70d6",mediumpurple:"#9370db",purple:"#800080",pink:"#ffc0cb",skyblue:"#87ceeb",springgreen:"#00ff7f",palegreen:"#98fb98",red:"#ff0000",yellow:"#ffff00",slateblue:"#6a5acd",lavenderblush:"#fff0f5",peru:"#cd853f",palevioletred:"#db7093",violet:"#ee82ee",teal:"#008080",slategray:"#708090",slategrey:"#708090",aliceblue:"#f0f8ff",darkseagreen:"#8fbc8f",darkolivegreen:"#556b2f",greenyellow:"#adff2f",seagreen:"#2e8b57",seashell:"#fff5ee",tomato:"#ff6347",silver:"#c0c0c0",sienna:"#a0522d",lavender:"#e6e6fa",lightgreen:"#90ee90",orange:"#ffa500",orangered:"#ff4500",steelblue:"#4682b4",royalblue:"#4169e1",turquoise:"#40e0d0",yellowgreen:"#9acd32",salmon:"#fa8072",saddlebrown:"#8b4513",sandybrown:"#f4a460",rosybrown:"#bc8f8f",darksalmon:"#e9967a",lightgoldenrodyellow:"#fafad2",snow:"#fffafa",lightgrey:"#d3d3d3",lightgray:"#d3d3d3",dimgray:"#696969",dimgrey:"#696969",olivedrab:"#6b8e23",olive:"#808000"},r={};for(var n in e)r[e[n]]=n;var i={};s.prototype.toName=function(o){if(!(this.rgba.a||this.rgba.r||this.rgba.g||this.rgba.b))return"transparent";var a,c,h=r[this.toHex()];if(h)return h;if(o!=null&&o.closest){var l=this.toRgb(),d=1/0,f="black";if(!i.length)for(var u in e)i[u]=new s(e[u]).toRgb();for(var p in e){var g=(a=l,c=i[p],Math.pow(a.r-c.r,2)+Math.pow(a.g-c.g,2)+Math.pow(a.b-c.b,2));g<d&&(d=g,f=p)}return f}},t.string.push([function(o){var a=o.toLowerCase(),c=a==="transparent"?"#0000":e[a];return c?new s(c).toRgb():null},"name"])}yl([bl]);const We=class is{constructor(t=16777215){this._value=null,this._components=new Float32Array(4),this._components.fill(1),this._int=16777215,this.value=t}get red(){return this._components[0]}get green(){return this._components[1]}get blue(){return this._components[2]}get alpha(){return this._components[3]}setValue(t){return this.value=t,this}set value(t){if(t instanceof is)this._value=this._cloneSource(t._value),this._int=t._int,this._components.set(t._components);else{if(t===null)throw new Error("Cannot set Color#value to null");(this._value===null||!this._isSourceEqual(this._value,t))&&(this._value=this._cloneSource(t),this._normalize(this._value))}}get value(){return this._value}_cloneSource(t){return typeof t=="string"||typeof t=="number"||t instanceof Number||t===null?t:Array.isArray(t)||ArrayBuffer.isView(t)?t.slice(0):typeof t=="object"&&t!==null?{...t}:t}_isSourceEqual(t,e){const r=typeof t;if(r!==typeof e)return!1;if(r==="number"||r==="string"||t instanceof Number)return t===e;if(Array.isArray(t)&&Array.isArray(e)||ArrayBuffer.isView(t)&&ArrayBuffer.isView(e))return t.length!==e.length?!1:t.every((i,o)=>i===e[o]);if(t!==null&&e!==null){const i=Object.keys(t),o=Object.keys(e);return i.length!==o.length?!1:i.every(a=>t[a]===e[a])}return t===e}toRgba(){const[t,e,r,n]=this._components;return{r:t,g:e,b:r,a:n}}toRgb(){const[t,e,r]=this._components;return{r:t,g:e,b:r}}toRgbaString(){const[t,e,r]=this.toUint8RgbArray();return`rgba(${t},${e},${r},${this.alpha})`}toUint8RgbArray(t){const[e,r,n]=this._components;return this._arrayRgb||(this._arrayRgb=[]),t||(t=this._arrayRgb),t[0]=Math.round(e*255),t[1]=Math.round(r*255),t[2]=Math.round(n*255),t}toArray(t){this._arrayRgba||(this._arrayRgba=[]),t||(t=this._arrayRgba);const[e,r,n,i]=this._components;return t[0]=e,t[1]=r,t[2]=n,t[3]=i,t}toRgbArray(t){this._arrayRgb||(this._arrayRgb=[]),t||(t=this._arrayRgb);const[e,r,n]=this._components;return t[0]=e,t[1]=r,t[2]=n,t}toNumber(){return this._int}toBgrNumber(){const[t,e,r]=this.toUint8RgbArray();return(r<<16)+(e<<8)+t}toLittleEndianNumber(){const t=this._int;return(t>>16)+(t&65280)+((t&255)<<16)}multiply(t){const[e,r,n,i]=is._temp.setValue(t)._components;return this._components[0]*=e,this._components[1]*=r,this._components[2]*=n,this._components[3]*=i,this._refreshInt(),this._value=null,this}premultiply(t,e=!0){return e&&(this._components[0]*=t,this._components[1]*=t,this._components[2]*=t),this._components[3]=t,this._refreshInt(),this._value=null,this}toPremultiplied(t,e=!0){if(t===1)return(255<<24)+this._int;if(t===0)return e?0:this._int;let r=this._int>>16&255,n=this._int>>8&255,i=this._int&255;return e&&(r=r*t+.5|0,n=n*t+.5|0,i=i*t+.5|0),(t*255<<24)+(r<<16)+(n<<8)+i}toHex(){const t=this._int.toString(16);return`#${"000000".substring(0,6-t.length)+t}`}toHexa(){const e=Math.round(this._components[3]*255).toString(16);return this.toHex()+"00".substring(0,2-e.length)+e}setAlpha(t){return this._components[3]=this._clamp(t),this}_normalize(t){let e,r,n,i;if((typeof t=="number"||t instanceof Number)&&t>=0&&t<=16777215){const o=t;e=(o>>16&255)/255,r=(o>>8&255)/255,n=(o&255)/255,i=1}else if((Array.isArray(t)||t instanceof Float32Array)&&t.length>=3&&t.length<=4)t=this._clamp(t),[e,r,n,i=1]=t;else if((t instanceof Uint8Array||t instanceof Uint8ClampedArray)&&t.length>=3&&t.length<=4)t=this._clamp(t,0,255),[e,r,n,i=255]=t,e/=255,r/=255,n/=255,i/=255;else if(typeof t=="string"||typeof t=="object"){if(typeof t=="string"){const a=is.HEX_PATTERN.exec(t);a&&(t=`#${a[2]}`)}const o=Vt(t);o.isValid()&&({r:e,g:r,b:n,a:i}=o.rgba,e/=255,r/=255,n/=255)}if(e!==void 0)this._components[0]=e,this._components[1]=r,this._components[2]=n,this._components[3]=i,this._refreshInt();else throw new Error(`Unable to convert color ${t}`)}_refreshInt(){this._clamp(this._components);const[t,e,r]=this._components;this._int=(t*255<<16)+(e*255<<8)+(r*255|0)}_clamp(t,e=0,r=1){return typeof t=="number"?Math.min(Math.max(t,e),r):(t.forEach((n,i)=>{t[i]=Math.min(Math.max(n,e),r)}),t)}static isColorLike(t){return typeof t=="number"||typeof t=="string"||t instanceof Number||t instanceof is||Array.isArray(t)||t instanceof Uint8Array||t instanceof Uint8ClampedArray||t instanceof Float32Array||t.r!==void 0&&t.g!==void 0&&t.b!==void 0||t.r!==void 0&&t.g!==void 0&&t.b!==void 0&&t.a!==void 0||t.h!==void 0&&t.s!==void 0&&t.l!==void 0||t.h!==void 0&&t.s!==void 0&&t.l!==void 0&&t.a!==void 0||t.h!==void 0&&t.s!==void 0&&t.v!==void 0||t.h!==void 0&&t.s!==void 0&&t.v!==void 0&&t.a!==void 0}};We.shared=new We;We._temp=new We;We.HEX_PATTERN=/^(#|0x)?(([a-f0-9]{3}){1,2}([a-f0-9]{2})?)$/i;let lt=We;const wl={cullArea:null,cullable:!1,cullableChildren:!0};class kn{constructor(t,e){this._pool=[],this._count=0,this._index=0,this._classType=t,e&&this.prepopulate(e)}prepopulate(t){for(let e=0;e<t;e++)this._pool[this._index++]=new this._classType;this._count+=t}get(t){var r;let e;return this._index>0?e=this._pool[--this._index]:e=new this._classType,(r=e.init)==null||r.call(e,t),e}return(t){var e;(e=t.reset)==null||e.call(t),this._pool[this._index++]=t}get totalSize(){return this._count}get totalFree(){return this._index}get totalUsed(){return this._count-this._index}clear(){this._pool.length=0,this._index=0}}class _l{constructor(){this._poolsByClass=new Map}prepopulate(t,e){this.getPool(t).prepopulate(e)}get(t,e){return this.getPool(t).get(e)}return(t){this.getPool(t.constructor).return(t)}getPool(t){return this._poolsByClass.has(t)||this._poolsByClass.set(t,new kn(t)),this._poolsByClass.get(t)}stats(){const t={};return this._poolsByClass.forEach(e=>{const r=t[e._classType.name]?e._classType.name+e._classType.ID:e._classType.name;t[r]={free:e.totalFree,used:e.totalUsed,size:e.totalSize}}),t}}const oe=new _l,vl={get isCachedAsTexture(){var s;return!!((s=this.renderGroup)!=null&&s.isCachedAsTexture)},cacheAsTexture(s){typeof s=="boolean"&&s===!1?this.disableRenderGroup():(this.enableRenderGroup(),this.renderGroup.enableCacheAsTexture(s===!0?{}:s))},updateCacheTexture(){var s;(s=this.renderGroup)==null||s.updateCacheTexture()},get cacheAsBitmap(){return this.isCachedAsTexture},set cacheAsBitmap(s){Y("v8.6.0","cacheAsBitmap is deprecated, use cacheAsTexture instead."),this.cacheAsTexture(s)}};function Al(s,t,e){const r=s.length;let n;if(t>=r||e===0)return;e=t+e>r?r-t:e;const i=r-e;for(n=t;n<i;++n)s[n]=s[n+e];s.length=i}const Sl={allowChildren:!0,removeChildren(s=0,t){var i;const e=t??this.children.length,r=e-s,n=[];if(r>0&&r<=e){for(let a=e-1;a>=s;a--){const c=this.children[a];c&&(n.push(c),c.parent=null)}Al(this.children,s,e);const o=this.renderGroup||this.parentRenderGroup;o&&o.removeChildren(n);for(let a=0;a<n.length;++a){const c=n[a];(i=c.parentRenderLayer)==null||i.detach(c),this.emit("childRemoved",c,this,a),n[a].emit("removed",this)}return n.length>0&&this._didViewChangeTick++,n}else if(r===0&&this.children.length===0)return n;throw new RangeError("removeChildren: numeric values are outside the acceptable range.")},removeChildAt(s){const t=this.getChildAt(s);return this.removeChild(t)},getChildAt(s){if(s<0||s>=this.children.length)throw new Error(`getChildAt: Index (${s}) does not exist.`);return this.children[s]},setChildIndex(s,t){if(t<0||t>=this.children.length)throw new Error(`The index ${t} supplied is out of bounds ${this.children.length}`);this.getChildIndex(s),this.addChildAt(s,t)},getChildIndex(s){const t=this.children.indexOf(s);if(t===-1)throw new Error("The supplied Container must be a child of the caller");return t},addChildAt(s,t){this.allowChildren||Y(Q,"addChildAt: Only Containers will be allowed to add children in v8.0.0");const{children:e}=this;if(t<0||t>e.length)throw new Error(`${s}addChildAt: The index ${t} supplied is out of bounds ${e.length}`);if(s.parent){const n=s.parent.children.indexOf(s);if(s.parent===this&&n===t)return s;n!==-1&&s.parent.children.splice(n,1)}t===e.length?e.push(s):e.splice(t,0,s),s.parent=this,s.didChange=!0,s._updateFlags=15;const r=this.renderGroup||this.parentRenderGroup;return r&&r.addChild(s),this.sortableChildren&&(this.sortDirty=!0),this.emit("childAdded",s,this,t),s.emit("added",this),s},swapChildren(s,t){if(s===t)return;const e=this.getChildIndex(s),r=this.getChildIndex(t);this.children[e]=t,this.children[r]=s;const n=this.renderGroup||this.parentRenderGroup;n&&(n.structureDidChange=!0),this._didContainerChangeTick++},removeFromParent(){var s;(s=this.parent)==null||s.removeChild(this)},reparentChild(...s){return s.length===1?this.reparentChildAt(s[0],this.children.length):(s.forEach(t=>this.reparentChildAt(t,this.children.length)),s[0])},reparentChildAt(s,t){if(s.parent===this)return this.setChildIndex(s,t),s;const e=s.worldTransform.clone();s.removeFromParent(),this.addChildAt(s,t);const r=this.worldTransform.clone();return r.invert(),e.prepend(r),s.setFromMatrix(e),s}},Cl={collectRenderables(s,t,e){this.parentRenderLayer&&this.parentRenderLayer!==e||this.globalDisplayStatus<7||!this.includeInBuild||(this.sortableChildren&&this.sortChildren(),this.isSimple?this.collectRenderablesSimple(s,t,e):this.renderGroup?t.renderPipes.renderGroup.addRenderGroup(this.renderGroup,s):this.collectRenderablesWithEffects(s,t,e))},collectRenderablesSimple(s,t,e){const r=this.children,n=r.length;for(let i=0;i<n;i++)r[i].collectRenderables(s,t,e)},collectRenderablesWithEffects(s,t,e){const{renderPipes:r}=t;for(let n=0;n<this.effects.length;n++){const i=this.effects[n];r[i.pipe].push(i,this,s)}this.collectRenderablesSimple(s,t,e);for(let n=this.effects.length-1;n>=0;n--){const i=this.effects[n];r[i.pipe].pop(i,this,s)}}};class di{constructor(){this.pipe="filter",this.priority=1}destroy(){for(let t=0;t<this.filters.length;t++)this.filters[t].destroy();this.filters=null,this.filterArea=null}}class kl{constructor(){this._effectClasses=[],this._tests=[],this._initialized=!1}init(){this._initialized||(this._initialized=!0,this._effectClasses.forEach(t=>{this.add({test:t.test,maskClass:t})}))}add(t){this._tests.push(t)}getMaskEffect(t){this._initialized||this.init();for(let e=0;e<this._tests.length;e++){const r=this._tests[e];if(r.test(t))return oe.get(r.maskClass,t)}return t}returnMaskEffect(t){oe.return(t)}}const sn=new kl;pt.handleByList(O.MaskEffect,sn._effectClasses);const Pl={_maskEffect:null,_maskOptions:{inverse:!1},_filterEffect:null,effects:[],_markStructureAsChanged(){const s=this.renderGroup||this.parentRenderGroup;s&&(s.structureDidChange=!0)},addEffect(s){this.effects.indexOf(s)===-1&&(this.effects.push(s),this.effects.sort((e,r)=>e.priority-r.priority),this._markStructureAsChanged(),this._updateIsSimple())},removeEffect(s){const t=this.effects.indexOf(s);t!==-1&&(this.effects.splice(t,1),this._markStructureAsChanged(),this._updateIsSimple())},set mask(s){const t=this._maskEffect;(t==null?void 0:t.mask)!==s&&(t&&(this.removeEffect(t),sn.returnMaskEffect(t),this._maskEffect=null),s!=null&&(this._maskEffect=sn.getMaskEffect(s),this.addEffect(this._maskEffect)))},get mask(){var s;return(s=this._maskEffect)==null?void 0:s.mask},setMask(s){this._maskOptions={...this._maskOptions,...s},s.mask&&(this.mask=s.mask),this._markStructureAsChanged()},set filters(s){var i;!Array.isArray(s)&&s&&(s=[s]);const t=this._filterEffect||(this._filterEffect=new di);s=s;const e=(s==null?void 0:s.length)>0,r=((i=t.filters)==null?void 0:i.length)>0,n=e!==r;s=Array.isArray(s)?s.slice(0):s,t.filters=Object.freeze(s),n&&(e?this.addEffect(t):(this.removeEffect(t),t.filters=s??null))},get filters(){var s;return(s=this._filterEffect)==null?void 0:s.filters},set filterArea(s){this._filterEffect||(this._filterEffect=new di),this._filterEffect.filterArea=s},get filterArea(){var s;return(s=this._filterEffect)==null?void 0:s.filterArea}},Ml={label:null,get name(){return Y(Q,"Container.name property has been removed, use Container.label instead"),this.label},set name(s){Y(Q,"Container.name property has been removed, use Container.label instead"),this.label=s},getChildByName(s,t=!1){return this.getChildByLabel(s,t)},getChildByLabel(s,t=!1){const e=this.children;for(let r=0;r<e.length;r++){const n=e[r];if(n.label===s||s instanceof RegExp&&s.test(n.label))return n}if(t)for(let r=0;r<e.length;r++){const i=e[r].getChildByLabel(s,!0);if(i)return i}return null},getChildrenByLabel(s,t=!1,e=[]){const r=this.children;for(let n=0;n<r.length;n++){const i=r[n];(i.label===s||s instanceof RegExp&&s.test(i.label))&&e.push(i)}if(t)for(let n=0;n<r.length;n++)r[n].getChildrenByLabel(s,!0,e);return e}},xt=new kn(X),ae=new kn(Ht),Tl=new X,El={getFastGlobalBounds(s,t){t||(t=new Ht),t.clear(),this._getGlobalBoundsRecursive(!!s,t,this.parentRenderLayer),t.isValid||t.set(0,0,0,0);const e=this.renderGroup||this.parentRenderGroup;return t.applyMatrix(e.worldTransform),t},_getGlobalBoundsRecursive(s,t,e){let r=t;if(s&&this.parentRenderLayer&&this.parentRenderLayer!==e||this.localDisplayStatus!==7||!this.measurable)return;const n=!!this.effects.length;if((this.renderGroup||n)&&(r=ae.get().clear()),this.boundsArea)t.addRect(this.boundsArea,this.worldTransform);else{if(this.renderPipeId){const o=this.bounds;r.addFrame(o.minX,o.minY,o.maxX,o.maxY,this.groupTransform)}const i=this.children;for(let o=0;o<i.length;o++)i[o]._getGlobalBoundsRecursive(s,r,e)}if(n){let i=!1;const o=this.renderGroup||this.parentRenderGroup;for(let a=0;a<this.effects.length;a++)this.effects[a].addBounds&&(i||(i=!0,r.applyMatrix(o.worldTransform)),this.effects[a].addBounds(r,!0));i&&(r.applyMatrix(o.worldTransform.copyTo(Tl).invert()),t.addBounds(r,this.relativeGroupTransform)),t.addBounds(r),ae.return(r)}else this.renderGroup&&(t.addBounds(r,this.relativeGroupTransform),ae.return(r))}};function Vo(s,t,e){e.clear();let r,n;return s.parent?t?r=s.parent.worldTransform:(n=xt.get().identity(),r=Pn(s,n)):r=X.IDENTITY,Yo(s,e,r,t),n&&xt.return(n),e.isValid||e.set(0,0,0,0),e}function Yo(s,t,e,r){var a,c;if(!s.visible||!s.measurable)return;let n;r?n=s.worldTransform:(s.updateLocalTransform(),n=xt.get(),n.appendFrom(s.localTransform,e));const i=t,o=!!s.effects.length;if(o&&(t=ae.get().clear()),s.boundsArea)t.addRect(s.boundsArea,n);else{s.bounds&&(t.matrix=n,t.addBounds(s.bounds));for(let h=0;h<s.children.length;h++)Yo(s.children[h],t,n,r)}if(o){for(let h=0;h<s.effects.length;h++)(c=(a=s.effects[h]).addBounds)==null||c.call(a,t);i.addBounds(t,X.IDENTITY),ae.return(t)}r||xt.return(n)}function Pn(s,t){const e=s.parent;return e&&(Pn(e,t),e.updateLocalTransform(),t.append(e.localTransform)),t}function Xo(s,t){if(s===16777215||!t)return t;if(t===16777215||!s)return s;const e=s>>16&255,r=s>>8&255,n=s&255,i=t>>16&255,o=t>>8&255,a=t&255,c=e*i/255|0,h=r*o/255|0,l=n*a/255|0;return(c<<16)+(h<<8)+l}const ui=16777215;function fi(s,t){return s===ui?t:t===ui?s:Xo(s,t)}function Ds(s){return((s&255)<<16)+(s&65280)+(s>>16&255)}const Il={getGlobalAlpha(s){if(s)return this.renderGroup?this.renderGroup.worldAlpha:this.parentRenderGroup?this.parentRenderGroup.worldAlpha*this.alpha:this.alpha;let t=this.alpha,e=this.parent;for(;e;)t*=e.alpha,e=e.parent;return t},getGlobalTransform(s,t){if(t)return s.copyFrom(this.worldTransform);this.updateLocalTransform();const e=Pn(this,xt.get().identity());return s.appendFrom(this.localTransform,e),xt.return(e),s},getGlobalTint(s){if(s)return this.renderGroup?Ds(this.renderGroup.worldColor):this.parentRenderGroup?Ds(fi(this.localColor,this.parentRenderGroup.worldColor)):this.tint;let t=this.localColor,e=this.parent;for(;e;)t=fi(t,e.localColor),e=e.parent;return Ds(t)}};function qo(s,t,e){return t.clear(),e||(e=X.IDENTITY),Ko(s,t,e,s,!0),t.isValid||t.set(0,0,0,0),t}function Ko(s,t,e,r,n){var c,h;let i;if(n)i=xt.get(),i=e.copyTo(i);else{if(!s.visible||!s.measurable)return;s.updateLocalTransform();const l=s.localTransform;i=xt.get(),i.appendFrom(l,e)}const o=t,a=!!s.effects.length;if(a&&(t=ae.get().clear()),s.boundsArea)t.addRect(s.boundsArea,i);else{s.renderPipeId&&(t.matrix=i,t.addBounds(s.bounds));const l=s.children;for(let d=0;d<l.length;d++)Ko(l[d],t,i,r,!1)}if(a){for(let l=0;l<s.effects.length;l++)(h=(c=s.effects[l]).addLocalBounds)==null||h.call(c,t,r);o.addBounds(t,X.IDENTITY),ae.return(t)}xt.return(i)}function Zo(s,t){const e=s.children;for(let r=0;r<e.length;r++){const n=e[r],i=n.uid,o=(n._didViewChangeTick&65535)<<16|n._didContainerChangeTick&65535,a=t.index;(t.data[a]!==i||t.data[a+1]!==o)&&(t.data[t.index]=i,t.data[t.index+1]=o,t.didChange=!0),t.index=a+2,n.children.length&&Zo(n,t)}return t.didChange}const Bl=new X,Fl={_localBoundsCacheId:-1,_localBoundsCacheData:null,_setWidth(s,t){const e=Math.sign(this.scale.x)||1;t!==0?this.scale.x=s/t*e:this.scale.x=e},_setHeight(s,t){const e=Math.sign(this.scale.y)||1;t!==0?this.scale.y=s/t*e:this.scale.y=e},getLocalBounds(){this._localBoundsCacheData||(this._localBoundsCacheData={data:[],index:1,didChange:!1,localBounds:new Ht});const s=this._localBoundsCacheData;return s.index=1,s.didChange=!1,s.data[0]!==this._didViewChangeTick&&(s.didChange=!0,s.data[0]=this._didViewChangeTick),Zo(this,s),s.didChange&&qo(this,s.localBounds,Bl),s.localBounds},getBounds(s,t){return Vo(this,s,t||new Ht)}},Rl={_onRender:null,set onRender(s){const t=this.renderGroup||this.parentRenderGroup;if(!s){this._onRender&&(t==null||t.removeOnRender(this)),this._onRender=null;return}this._onRender||t==null||t.addOnRender(this),this._onRender=s},get onRender(){return this._onRender}},Ll={_zIndex:0,sortDirty:!1,sortableChildren:!1,get zIndex(){return this._zIndex},set zIndex(s){this._zIndex!==s&&(this._zIndex=s,this.depthOfChildModified())},depthOfChildModified(){this.parent&&(this.parent.sortableChildren=!0,this.parent.sortDirty=!0),this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0)},sortChildren(){this.sortDirty&&(this.sortDirty=!1,this.children.sort(zl))}};function zl(s,t){return s._zIndex-t._zIndex}const Gl={getGlobalPosition(s=new mt,t=!1){return this.parent?this.parent.toGlobal(this._position,s,t):(s.x=this._position.x,s.y=this._position.y),s},toGlobal(s,t,e=!1){const r=this.getGlobalTransform(xt.get(),e);return t=r.apply(s,t),xt.return(r),t},toLocal(s,t,e,r){t&&(s=t.toGlobal(s,e,r));const n=this.getGlobalTransform(xt.get(),r);return e=n.applyInverse(s,e),xt.return(n),e}};class Qo{constructor(){this.uid=ct("instructionSet"),this.instructions=[],this.instructionSize=0,this.renderables=[],this.gcTick=0}reset(){this.instructionSize=0}add(t){this.instructions[this.instructionSize++]=t}log(){this.instructions.length=this.instructionSize,console.table(this.instructions,["type","action"])}}let Nl=0;class Ol{constructor(t){this._poolKeyHash=Object.create(null),this._texturePool={},this.textureOptions=t||{},this.enableFullScreen=!1,this.textureStyle=new He(this.textureOptions)}createTexture(t,e,r){const n=new jt({...this.textureOptions,width:t,height:e,resolution:1,antialias:r,autoGarbageCollect:!1});return new $({source:n,label:`texturePool_${Nl++}`})}getOptimalTexture(t,e,r=1,n){let i=Math.ceil(t*r-1e-6),o=Math.ceil(e*r-1e-6);i=De(i),o=De(o);const a=(i<<17)+(o<<1)+(n?1:0);this._texturePool[a]||(this._texturePool[a]=[]);let c=this._texturePool[a].pop();return c||(c=this.createTexture(i,o,n)),c.source._resolution=r,c.source.width=i/r,c.source.height=o/r,c.source.pixelWidth=i,c.source.pixelHeight=o,c.frame.x=0,c.frame.y=0,c.frame.width=t,c.frame.height=e,c.updateUvs(),this._poolKeyHash[c.uid]=a,c}getSameSizeTexture(t,e=!1){const r=t.source;return this.getOptimalTexture(t.width,t.height,r._resolution,e)}returnTexture(t,e=!1){const r=this._poolKeyHash[t.uid];e&&(t.source.style=this.textureStyle),this._texturePool[r].push(t)}clear(t){if(t=t!==!1,t)for(const e in this._texturePool){const r=this._texturePool[e];if(r)for(let n=0;n<r.length;n++)r[n].destroy(!0)}this._texturePool={}}}const Ul=new Ol;class Dl{constructor(){this.renderPipeId="renderGroup",this.root=null,this.canBundle=!1,this.renderGroupParent=null,this.renderGroupChildren=[],this.worldTransform=new X,this.worldColorAlpha=4294967295,this.worldColor=16777215,this.worldAlpha=1,this.childrenToUpdate=Object.create(null),this.updateTick=0,this.gcTick=0,this.childrenRenderablesToUpdate={list:[],index:0},this.structureDidChange=!0,this.instructionSet=new Qo,this._onRenderContainers=[],this.textureNeedsUpdate=!0,this.isCachedAsTexture=!1,this._matrixDirty=7}init(t){this.root=t,t._onRender&&this.addOnRender(t),t.didChange=!0;const e=t.children;for(let r=0;r<e.length;r++){const n=e[r];n._updateFlags=15,this.addChild(n)}}enableCacheAsTexture(t={}){this.textureOptions=t,this.isCachedAsTexture=!0,this.textureNeedsUpdate=!0}disableCacheAsTexture(){this.isCachedAsTexture=!1,this.texture&&(Ul.returnTexture(this.texture),this.texture=null)}updateCacheTexture(){this.textureNeedsUpdate=!0}reset(){this.renderGroupChildren.length=0;for(const t in this.childrenToUpdate){const e=this.childrenToUpdate[t];e.list.fill(null),e.index=0}this.childrenRenderablesToUpdate.index=0,this.childrenRenderablesToUpdate.list.fill(null),this.root=null,this.updateTick=0,this.structureDidChange=!0,this._onRenderContainers.length=0,this.renderGroupParent=null,this.disableCacheAsTexture()}get localTransform(){return this.root.localTransform}addRenderGroupChild(t){t.renderGroupParent&&t.renderGroupParent._removeRenderGroupChild(t),t.renderGroupParent=this,this.renderGroupChildren.push(t)}_removeRenderGroupChild(t){const e=this.renderGroupChildren.indexOf(t);e>-1&&this.renderGroupChildren.splice(e,1),t.renderGroupParent=null}addChild(t){if(this.structureDidChange=!0,t.parentRenderGroup=this,t.updateTick=-1,t.parent===this.root?t.relativeRenderGroupDepth=1:t.relativeRenderGroupDepth=t.parent.relativeRenderGroupDepth+1,t.didChange=!0,this.onChildUpdate(t),t.renderGroup){this.addRenderGroupChild(t.renderGroup);return}t._onRender&&this.addOnRender(t);const e=t.children;for(let r=0;r<e.length;r++)this.addChild(e[r])}removeChild(t){if(this.structureDidChange=!0,t._onRender&&(t.renderGroup||this.removeOnRender(t)),t.parentRenderGroup=null,t.renderGroup){this._removeRenderGroupChild(t.renderGroup);return}const e=t.children;for(let r=0;r<e.length;r++)this.removeChild(e[r])}removeChildren(t){for(let e=0;e<t.length;e++)this.removeChild(t[e])}onChildUpdate(t){let e=this.childrenToUpdate[t.relativeRenderGroupDepth];e||(e=this.childrenToUpdate[t.relativeRenderGroupDepth]={index:0,list:[]}),e.list[e.index++]=t}updateRenderable(t){t.globalDisplayStatus<7||(this.instructionSet.renderPipes[t.renderPipeId].updateRenderable(t),t.didViewUpdate=!1)}onChildViewUpdate(t){this.childrenRenderablesToUpdate.list[this.childrenRenderablesToUpdate.index++]=t}get isRenderable(){return this.root.localDisplayStatus===7&&this.worldAlpha>0}addOnRender(t){this._onRenderContainers.push(t)}removeOnRender(t){this._onRenderContainers.splice(this._onRenderContainers.indexOf(t),1)}runOnRender(t){for(let e=0;e<this._onRenderContainers.length;e++)this._onRenderContainers[e]._onRender(t)}destroy(){this.disableCacheAsTexture(),this.renderGroupParent=null,this.root=null,this.childrenRenderablesToUpdate=null,this.childrenToUpdate=null,this.renderGroupChildren=null,this._onRenderContainers=null,this.instructionSet=null}getChildren(t=[]){const e=this.root.children;for(let r=0;r<e.length;r++)this._getChildren(e[r],t);return t}_getChildren(t,e=[]){if(e.push(t),t.renderGroup)return e;const r=t.children;for(let n=0;n<r.length;n++)this._getChildren(r[n],e);return e}invalidateMatrices(){this._matrixDirty=7}get inverseWorldTransform(){return(this._matrixDirty&1)===0?this._inverseWorldTransform:(this._matrixDirty&=-2,this._inverseWorldTransform||(this._inverseWorldTransform=new X),this._inverseWorldTransform.copyFrom(this.worldTransform).invert())}get textureOffsetInverseTransform(){return(this._matrixDirty&2)===0?this._textureOffsetInverseTransform:(this._matrixDirty&=-3,this._textureOffsetInverseTransform||(this._textureOffsetInverseTransform=new X),this._textureOffsetInverseTransform.copyFrom(this.inverseWorldTransform).translate(-this._textureBounds.x,-this._textureBounds.y))}get inverseParentTextureTransform(){if((this._matrixDirty&4)===0)return this._inverseParentTextureTransform;this._matrixDirty&=-5;const t=this._parentCacheAsTextureRenderGroup;return t?(this._inverseParentTextureTransform||(this._inverseParentTextureTransform=new X),this._inverseParentTextureTransform.copyFrom(this.worldTransform).prepend(t.inverseWorldTransform).translate(-t._textureBounds.x,-t._textureBounds.y)):this.worldTransform}get cacheToLocalTransform(){return this._parentCacheAsTextureRenderGroup?this._parentCacheAsTextureRenderGroup.textureOffsetInverseTransform:null}}function Hl(s,t,e={}){for(const r in t)!e[r]&&t[r]!==void 0&&(s[r]=t[r])}const xr=new wt(null),yr=new wt(null),br=new wt(null,1,1),pi=1,Wl=2,wr=4;class ut extends Wt{constructor(t={}){var e,r;super(),this.uid=ct("renderable"),this._updateFlags=15,this.renderGroup=null,this.parentRenderGroup=null,this.parentRenderGroupIndex=0,this.didChange=!1,this.didViewUpdate=!1,this.relativeRenderGroupDepth=0,this.children=[],this.parent=null,this.includeInBuild=!0,this.measurable=!0,this.isSimple=!0,this.updateTick=-1,this.localTransform=new X,this.relativeGroupTransform=new X,this.groupTransform=this.relativeGroupTransform,this.destroyed=!1,this._position=new wt(this,0,0),this._scale=br,this._pivot=yr,this._skew=xr,this._cx=1,this._sx=0,this._cy=0,this._sy=1,this._rotation=0,this.localColor=16777215,this.localAlpha=1,this.groupAlpha=1,this.groupColor=16777215,this.groupColorAlpha=4294967295,this.localBlendMode="inherit",this.groupBlendMode="normal",this.localDisplayStatus=7,this.globalDisplayStatus=7,this._didContainerChangeTick=0,this._didViewChangeTick=0,this._didLocalTransformChangeId=-1,this.effects=[],Hl(this,t,{children:!0,parent:!0,effects:!0}),(e=t.children)==null||e.forEach(n=>this.addChild(n)),(r=t.parent)==null||r.addChild(this)}static mixin(t){Y("8.8.0","Container.mixin is deprecated, please use extensions.mixin instead."),pt.mixin(ut,t)}set _didChangeId(t){this._didViewChangeTick=t>>12&4095,this._didContainerChangeTick=t&4095}get _didChangeId(){return this._didContainerChangeTick&4095|(this._didViewChangeTick&4095)<<12}addChild(...t){if(this.allowChildren||Y(Q,"addChild: Only Containers will be allowed to add children in v8.0.0"),t.length>1){for(let n=0;n<t.length;n++)this.addChild(t[n]);return t[0]}const e=t[0],r=this.renderGroup||this.parentRenderGroup;return e.parent===this?(this.children.splice(this.children.indexOf(e),1),this.children.push(e),r&&(r.structureDidChange=!0),e):(e.parent&&e.parent.removeChild(e),this.children.push(e),this.sortableChildren&&(this.sortDirty=!0),e.parent=this,e.didChange=!0,e._updateFlags=15,r&&r.addChild(e),this.emit("childAdded",e,this,this.children.length-1),e.emit("added",this),this._didViewChangeTick++,e._zIndex!==0&&e.depthOfChildModified(),e)}removeChild(...t){if(t.length>1){for(let n=0;n<t.length;n++)this.removeChild(t[n]);return t[0]}const e=t[0],r=this.children.indexOf(e);return r>-1&&(this._didViewChangeTick++,this.children.splice(r,1),this.renderGroup?this.renderGroup.removeChild(e):this.parentRenderGroup&&this.parentRenderGroup.removeChild(e),e.parentRenderLayer&&e.parentRenderLayer.detach(e),e.parent=null,this.emit("childRemoved",e,this,r),e.emit("removed",this)),e}_onUpdate(t){t&&t===this._skew&&this._updateSkew(),this._didContainerChangeTick++,!this.didChange&&(this.didChange=!0,this.parentRenderGroup&&this.parentRenderGroup.onChildUpdate(this))}set isRenderGroup(t){!!this.renderGroup!==t&&(t?this.enableRenderGroup():this.disableRenderGroup())}get isRenderGroup(){return!!this.renderGroup}enableRenderGroup(){if(this.renderGroup)return;const t=this.parentRenderGroup;t==null||t.removeChild(this),this.renderGroup=oe.get(Dl,this),this.groupTransform=X.IDENTITY,t==null||t.addChild(this),this._updateIsSimple()}disableRenderGroup(){if(!this.renderGroup)return;const t=this.parentRenderGroup;t==null||t.removeChild(this),oe.return(this.renderGroup),this.renderGroup=null,this.groupTransform=this.relativeGroupTransform,t==null||t.addChild(this),this._updateIsSimple()}_updateIsSimple(){this.isSimple=!this.renderGroup&&this.effects.length===0}get worldTransform(){return this._worldTransform||(this._worldTransform=new X),this.renderGroup?this._worldTransform.copyFrom(this.renderGroup.worldTransform):this.parentRenderGroup&&this._worldTransform.appendFrom(this.relativeGroupTransform,this.parentRenderGroup.worldTransform),this._worldTransform}get x(){return this._position.x}set x(t){this._position.x=t}get y(){return this._position.y}set y(t){this._position.y=t}get position(){return this._position}set position(t){this._position.copyFrom(t)}get rotation(){return this._rotation}set rotation(t){this._rotation!==t&&(this._rotation=t,this._onUpdate(this._skew))}get angle(){return this.rotation*sl}set angle(t){this.rotation=t*rl}get pivot(){return this._pivot===yr&&(this._pivot=new wt(this,0,0)),this._pivot}set pivot(t){this._pivot===yr&&(this._pivot=new wt(this,0,0)),typeof t=="number"?this._pivot.set(t):this._pivot.copyFrom(t)}get skew(){return this._skew===xr&&(this._skew=new wt(this,0,0)),this._skew}set skew(t){this._skew===xr&&(this._skew=new wt(this,0,0)),this._skew.copyFrom(t)}get scale(){return this._scale===br&&(this._scale=new wt(this,1,1)),this._scale}set scale(t){this._scale===br&&(this._scale=new wt(this,0,0)),typeof t=="number"?this._scale.set(t):this._scale.copyFrom(t)}get width(){return Math.abs(this.scale.x*this.getLocalBounds().width)}set width(t){const e=this.getLocalBounds().width;this._setWidth(t,e)}get height(){return Math.abs(this.scale.y*this.getLocalBounds().height)}set height(t){const e=this.getLocalBounds().height;this._setHeight(t,e)}getSize(t){t||(t={});const e=this.getLocalBounds();return t.width=Math.abs(this.scale.x*e.width),t.height=Math.abs(this.scale.y*e.height),t}setSize(t,e){const r=this.getLocalBounds();typeof t=="object"?(e=t.height??t.width,t=t.width):e??(e=t),t!==void 0&&this._setWidth(t,r.width),e!==void 0&&this._setHeight(e,r.height)}_updateSkew(){const t=this._rotation,e=this._skew;this._cx=Math.cos(t+e._y),this._sx=Math.sin(t+e._y),this._cy=-Math.sin(t-e._x),this._sy=Math.cos(t-e._x)}updateTransform(t){return this.position.set(typeof t.x=="number"?t.x:this.position.x,typeof t.y=="number"?t.y:this.position.y),this.scale.set(typeof t.scaleX=="number"?t.scaleX||1:this.scale.x,typeof t.scaleY=="number"?t.scaleY||1:this.scale.y),this.rotation=typeof t.rotation=="number"?t.rotation:this.rotation,this.skew.set(typeof t.skewX=="number"?t.skewX:this.skew.x,typeof t.skewY=="number"?t.skewY:this.skew.y),this.pivot.set(typeof t.pivotX=="number"?t.pivotX:this.pivot.x,typeof t.pivotY=="number"?t.pivotY:this.pivot.y),this}setFromMatrix(t){t.decompose(this)}updateLocalTransform(){const t=this._didContainerChangeTick;if(this._didLocalTransformChangeId===t)return;this._didLocalTransformChangeId=t;const e=this.localTransform,r=this._scale,n=this._pivot,i=this._position,o=r._x,a=r._y,c=n._x,h=n._y;e.a=this._cx*o,e.b=this._sx*o,e.c=this._cy*a,e.d=this._sy*a,e.tx=i._x-(c*e.a+h*e.c),e.ty=i._y-(c*e.b+h*e.d)}set alpha(t){t!==this.localAlpha&&(this.localAlpha=t,this._updateFlags|=pi,this._onUpdate())}get alpha(){return this.localAlpha}set tint(t){const r=lt.shared.setValue(t??16777215).toBgrNumber();r!==this.localColor&&(this.localColor=r,this._updateFlags|=pi,this._onUpdate())}get tint(){return Ds(this.localColor)}set blendMode(t){this.localBlendMode!==t&&(this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0),this._updateFlags|=Wl,this.localBlendMode=t,this._onUpdate())}get blendMode(){return this.localBlendMode}get visible(){return!!(this.localDisplayStatus&2)}set visible(t){const e=t?2:0;(this.localDisplayStatus&2)!==e&&(this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0),this._updateFlags|=wr,this.localDisplayStatus^=2,this._onUpdate())}get culled(){return!(this.localDisplayStatus&4)}set culled(t){const e=t?0:4;(this.localDisplayStatus&4)!==e&&(this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0),this._updateFlags|=wr,this.localDisplayStatus^=4,this._onUpdate())}get renderable(){return!!(this.localDisplayStatus&1)}set renderable(t){const e=t?1:0;(this.localDisplayStatus&1)!==e&&(this._updateFlags|=wr,this.localDisplayStatus^=1,this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0),this._onUpdate())}get isRenderable(){return this.localDisplayStatus===7&&this.groupAlpha>0}destroy(t=!1){var n;if(this.destroyed)return;this.destroyed=!0;let e;if(this.children.length&&(e=this.removeChildren(0,this.children.length)),this.removeFromParent(),this.parent=null,this._maskEffect=null,this._filterEffect=null,this.effects=null,this._position=null,this._scale=null,this._pivot=null,this._skew=null,this.emit("destroyed",this),this.removeAllListeners(),(typeof t=="boolean"?t:t==null?void 0:t.children)&&e)for(let i=0;i<e.length;++i)e[i].destroy(t);(n=this.renderGroup)==null||n.destroy(),this.renderGroup=null}}pt.mixin(ut,Sl,El,Gl,Rl,Fl,Pl,Ml,Ll,wl,vl,Il,Cl);class Mn extends ut{constructor(t){super(t),this.canBundle=!0,this.allowChildren=!1,this._roundPixels=0,this._lastUsed=-1,this._gpuData=Object.create(null),this._bounds=new Ht(0,1,0,0),this._boundsDirty=!0}get bounds(){return this._boundsDirty?(this.updateBounds(),this._boundsDirty=!1,this._bounds):this._bounds}get roundPixels(){return!!this._roundPixels}set roundPixels(t){this._roundPixels=t?1:0}containsPoint(t){const e=this.bounds,{x:r,y:n}=t;return r>=e.minX&&r<=e.maxX&&n>=e.minY&&n<=e.maxY}onViewUpdate(){if(this._didViewChangeTick++,this._boundsDirty=!0,this.didViewUpdate)return;this.didViewUpdate=!0;const t=this.renderGroup||this.parentRenderGroup;t&&t.onChildViewUpdate(this)}destroy(t){var e,r;super.destroy(t),this._bounds=null;for(const n in this._gpuData)(r=(e=this._gpuData[n]).destroy)==null||r.call(e);this._gpuData=null}collectRenderablesSimple(t,e,r){const{renderPipes:n}=e;n.blendMode.setBlendMode(this,this.groupBlendMode,t),n[this.renderPipeId].addRenderable(this,t),this.didViewUpdate=!1;const o=this.children,a=o.length;for(let c=0;c<a;c++)o[c].collectRenderables(t,e,r)}}class Gt extends Mn{constructor(t=$.EMPTY){t instanceof $&&(t={texture:t});const{texture:e=$.EMPTY,anchor:r,roundPixels:n,width:i,height:o,...a}=t;super({label:"Sprite",...a}),this.renderPipeId="sprite",this.batched=!0,this._visualBounds={minX:0,maxX:1,minY:0,maxY:0},this._anchor=new wt({_onUpdate:()=>{this.onViewUpdate()}}),r?this.anchor=r:e.defaultAnchor&&(this.anchor=e.defaultAnchor),this.texture=e,this.allowChildren=!1,this.roundPixels=n??!1,i!==void 0&&(this.width=i),o!==void 0&&(this.height=o)}static from(t,e=!1){return t instanceof $?new Gt(t):new Gt($.from(t,e))}set texture(t){t||(t=$.EMPTY);const e=this._texture;e!==t&&(e&&e.dynamic&&e.off("update",this.onViewUpdate,this),t.dynamic&&t.on("update",this.onViewUpdate,this),this._texture=t,this._width&&this._setWidth(this._width,this._texture.orig.width),this._height&&this._setHeight(this._height,this._texture.orig.height),this.onViewUpdate())}get texture(){return this._texture}get visualBounds(){return hl(this._visualBounds,this._anchor,this._texture),this._visualBounds}get sourceBounds(){return Y("8.6.1","Sprite.sourceBounds is deprecated, use visualBounds instead."),this.visualBounds}updateBounds(){const t=this._anchor,e=this._texture,r=this._bounds,{width:n,height:i}=e.orig;r.minX=-t._x*n,r.maxX=r.minX+n,r.minY=-t._y*i,r.maxY=r.minY+i}destroy(t=!1){if(super.destroy(t),typeof t=="boolean"?t:t==null?void 0:t.texture){const r=typeof t=="boolean"?t:t==null?void 0:t.textureSource;this._texture.destroy(r)}this._texture=null,this._visualBounds=null,this._bounds=null,this._anchor=null,this._gpuData=null}get anchor(){return this._anchor}set anchor(t){typeof t=="number"?this._anchor.set(t):this._anchor.copyFrom(t)}get width(){return Math.abs(this.scale.x)*this._texture.orig.width}set width(t){this._setWidth(t,this._texture.orig.width),this._width=t}get height(){return Math.abs(this.scale.y)*this._texture.orig.height}set height(t){this._setHeight(t,this._texture.orig.height),this._height=t}getSize(t){return t||(t={}),t.width=Math.abs(this.scale.x)*this._texture.orig.width,t.height=Math.abs(this.scale.y)*this._texture.orig.height,t}setSize(t,e){typeof t=="object"?(e=t.height??t.width,t=t.width):e??(e=t),t!==void 0&&this._setWidth(t,this._texture.orig.width),e!==void 0&&this._setHeight(e,this._texture.orig.height)}}const jl=new Ht;function Jo(s,t,e){const r=jl;s.measurable=!0,Vo(s,e,r),t.addBoundsMask(r),s.measurable=!1}let _r=0;const mi=500;function ot(...s){_r!==mi&&(_r++,_r===mi?console.warn("PixiJS Warning: too many warnings, no more warnings will be reported to the console by PixiJS."):console.warn("PixiJS Warning: ",...s))}function ta(s,t,e){const r=ae.get();s.measurable=!0;const n=xt.get().identity(),i=ea(s,e,n);qo(s,r,i),s.measurable=!1,t.addBoundsMask(r),xt.return(n),ae.return(r)}function ea(s,t,e){return s?(s!==t&&(ea(s.parent,t,e),s.updateLocalTransform(),e.append(s.localTransform)),e):(ot("Mask bounds, renderable is not inside the root container"),e)}class sa{constructor(t){this.priority=0,this.inverse=!1,this.pipe="alphaMask",t!=null&&t.mask&&this.init(t.mask)}init(t){this.mask=t,this.renderMaskToTexture=!(t instanceof Gt),this.mask.renderable=this.renderMaskToTexture,this.mask.includeInBuild=!this.renderMaskToTexture,this.mask.measurable=!1}reset(){this.mask.measurable=!0,this.mask=null}addBounds(t,e){this.inverse||Jo(this.mask,t,e)}addLocalBounds(t,e){ta(this.mask,t,e)}containsPoint(t,e){const r=this.mask;return e(r,t)}destroy(){this.reset()}static test(t){return t instanceof Gt}}sa.extension=O.MaskEffect;class ra{constructor(t){this.priority=0,this.pipe="colorMask",t!=null&&t.mask&&this.init(t.mask)}init(t){this.mask=t}destroy(){}static test(t){return typeof t=="number"}}ra.extension=O.MaskEffect;class na{constructor(t){this.priority=0,this.pipe="stencilMask",t!=null&&t.mask&&this.init(t.mask)}init(t){this.mask=t,this.mask.includeInBuild=!1,this.mask.measurable=!1}reset(){this.mask.measurable=!0,this.mask.includeInBuild=!0,this.mask=null}addBounds(t,e){Jo(this.mask,t,e)}addLocalBounds(t,e){ta(this.mask,t,e)}containsPoint(t,e){const r=this.mask;return e(r,t)}destroy(){this.reset()}static test(t){return t instanceof ut}}na.extension=O.MaskEffect;const $l={createCanvas:(s,t)=>{const e=document.createElement("canvas");return e.width=s,e.height=t,e},getCanvasRenderingContext2D:()=>CanvasRenderingContext2D,getWebGLRenderingContext:()=>WebGLRenderingContext,getNavigator:()=>navigator,getBaseUrl:()=>document.baseURI??window.location.href,getFontFaceSet:()=>document.fonts,fetch:(s,t)=>fetch(s,t),parseXML:s=>new DOMParser().parseFromString(s,"text/xml")};let gi=$l;const at={get(){return gi},set(s){gi=s}};class ia extends jt{constructor(t){t.resource||(t.resource=at.get().createCanvas()),t.width||(t.width=t.resource.width,t.autoDensity||(t.width/=t.resolution)),t.height||(t.height=t.resource.height,t.autoDensity||(t.height/=t.resolution)),super(t),this.uploadMethodId="image",this.autoDensity=t.autoDensity,this.resizeCanvas(),this.transparent=!!t.transparent}resizeCanvas(){this.autoDensity&&"style"in this.resource&&(this.resource.style.width=`${this.width}px`,this.resource.style.height=`${this.height}px`),(this.resource.width!==this.pixelWidth||this.resource.height!==this.pixelHeight)&&(this.resource.width=this.pixelWidth,this.resource.height=this.pixelHeight)}resize(t=this.width,e=this.height,r=this._resolution){const n=super.resize(t,e,r);return n&&this.resizeCanvas(),n}static test(t){return globalThis.HTMLCanvasElement&&t instanceof HTMLCanvasElement||globalThis.OffscreenCanvas&&t instanceof OffscreenCanvas}get context2D(){return this._context2D||(this._context2D=this.resource.getContext("2d"))}}ia.extension=O.TextureSource;class Be extends jt{constructor(t){super(t),this.uploadMethodId="image",this.autoGarbageCollect=!0}static test(t){return globalThis.HTMLImageElement&&t instanceof HTMLImageElement||typeof ImageBitmap<"u"&&t instanceof ImageBitmap||globalThis.VideoFrame&&t instanceof VideoFrame}}Be.extension=O.TextureSource;var $s=(s=>(s[s.INTERACTION=50]="INTERACTION",s[s.HIGH=25]="HIGH",s[s.NORMAL=0]="NORMAL",s[s.LOW=-25]="LOW",s[s.UTILITY=-50]="UTILITY",s))($s||{});class vr{constructor(t,e=null,r=0,n=!1){this.next=null,this.previous=null,this._destroyed=!1,this._fn=t,this._context=e,this.priority=r,this._once=n}match(t,e=null){return this._fn===t&&this._context===e}emit(t){this._fn&&(this._context?this._fn.call(this._context,t):this._fn(t));const e=this.next;return this._once&&this.destroy(!0),this._destroyed&&(this.next=null),e}connect(t){this.previous=t,t.next&&(t.next.previous=this),this.next=t.next,t.next=this}destroy(t=!1){this._destroyed=!0,this._fn=null,this._context=null,this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous);const e=this.next;return this.next=t?null:e,this.previous=null,e}}const oa=class Ct{constructor(){this.autoStart=!1,this.deltaTime=1,this.lastTime=-1,this.speed=1,this.started=!1,this._requestId=null,this._maxElapsedMS=100,this._minElapsedMS=0,this._protected=!1,this._lastFrame=-1,this._head=new vr(null,null,1/0),this.deltaMS=1/Ct.targetFPMS,this.elapsedMS=1/Ct.targetFPMS,this._tick=t=>{this._requestId=null,this.started&&(this.update(t),this.started&&this._requestId===null&&this._head.next&&(this._requestId=requestAnimationFrame(this._tick)))}}_requestIfNeeded(){this._requestId===null&&this._head.next&&(this.lastTime=performance.now(),this._lastFrame=this.lastTime,this._requestId=requestAnimationFrame(this._tick))}_cancelIfNeeded(){this._requestId!==null&&(cancelAnimationFrame(this._requestId),this._requestId=null)}_startIfPossible(){this.started?this._requestIfNeeded():this.autoStart&&this.start()}add(t,e,r=$s.NORMAL){return this._addListener(new vr(t,e,r))}addOnce(t,e,r=$s.NORMAL){return this._addListener(new vr(t,e,r,!0))}_addListener(t){let e=this._head.next,r=this._head;if(!e)t.connect(r);else{for(;e;){if(t.priority>e.priority){t.connect(r);break}r=e,e=e.next}t.previous||t.connect(r)}return this._startIfPossible(),this}remove(t,e){let r=this._head.next;for(;r;)r.match(t,e)?r=r.destroy():r=r.next;return this._head.next||this._cancelIfNeeded(),this}get count(){if(!this._head)return 0;let t=0,e=this._head;for(;e=e.next;)t++;return t}start(){this.started||(this.started=!0,this._requestIfNeeded())}stop(){this.started&&(this.started=!1,this._cancelIfNeeded())}destroy(){if(!this._protected){this.stop();let t=this._head.next;for(;t;)t=t.destroy(!0);this._head.destroy(),this._head=null}}update(t=performance.now()){let e;if(t>this.lastTime){if(e=this.elapsedMS=t-this.lastTime,e>this._maxElapsedMS&&(e=this._maxElapsedMS),e*=this.speed,this._minElapsedMS){const i=t-this._lastFrame|0;if(i<this._minElapsedMS)return;this._lastFrame=t-i%this._minElapsedMS}this.deltaMS=e,this.deltaTime=this.deltaMS*Ct.targetFPMS;const r=this._head;let n=r.next;for(;n;)n=n.emit(this);r.next||this._cancelIfNeeded()}else this.deltaTime=this.deltaMS=this.elapsedMS=0;this.lastTime=t}get FPS(){return 1e3/this.elapsedMS}get minFPS(){return 1e3/this._maxElapsedMS}set minFPS(t){const e=Math.min(this.maxFPS,t),r=Math.min(Math.max(0,e)/1e3,Ct.targetFPMS);this._maxElapsedMS=1/r}get maxFPS(){return this._minElapsedMS?Math.round(1e3/this._minElapsedMS):0}set maxFPS(t){if(t===0)this._minElapsedMS=0;else{const e=Math.max(this.minFPS,t);this._minElapsedMS=1/(e/1e3)}}static get shared(){if(!Ct._shared){const t=Ct._shared=new Ct;t.autoStart=!0,t._protected=!0}return Ct._shared}static get system(){if(!Ct._system){const t=Ct._system=new Ct;t.autoStart=!0,t._protected=!0}return Ct._system}};oa.targetFPMS=.06;let Dt=oa,Ar;async function aa(){return Ar??(Ar=(async()=>{var o;const t=document.createElement("canvas").getContext("webgl");if(!t)return"premultiply-alpha-on-upload";const e=await new Promise(a=>{const c=document.createElement("video");c.onloadeddata=()=>a(c),c.onerror=()=>a(null),c.autoplay=!1,c.crossOrigin="anonymous",c.preload="auto",c.src="data:video/webm;base64,GkXfo59ChoEBQveBAULygQRC84EIQoKEd2VibUKHgQJChYECGFOAZwEAAAAAAAHTEU2bdLpNu4tTq4QVSalmU6yBoU27i1OrhBZUrmtTrIHGTbuMU6uEElTDZ1OsggEXTbuMU6uEHFO7a1OsggG97AEAAAAAAABZAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAVSalmoCrXsYMPQkBNgIRMYXZmV0GETGF2ZkSJiEBEAAAAAAAAFlSua8yuAQAAAAAAAEPXgQFzxYgAAAAAAAAAAZyBACK1nIN1bmSIgQCGhVZfVlA5g4EBI+ODhAJiWgDglLCBArqBApqBAlPAgQFVsIRVuYEBElTDZ9Vzc9JjwItjxYgAAAAAAAAAAWfInEWjh0VOQ09ERVJEh49MYXZjIGxpYnZweC12cDlnyKJFo4hEVVJBVElPTkSHlDAwOjAwOjAwLjA0MDAwMDAwMAAAH0O2dcfngQCgwqGggQAAAIJJg0IAABAAFgA4JBwYSgAAICAAEb///4r+AAB1oZ2mm+6BAaWWgkmDQgAAEAAWADgkHBhKAAAgIABIQBxTu2uRu4+zgQC3iveBAfGCAXHwgQM=",c.load()});if(!e)return"premultiply-alpha-on-upload";const r=t.createTexture();t.bindTexture(t.TEXTURE_2D,r);const n=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,n),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,r,0),t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),t.pixelStorei(t.UNPACK_COLORSPACE_CONVERSION_WEBGL,t.NONE),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,e);const i=new Uint8Array(4);return t.readPixels(0,0,1,1,t.RGBA,t.UNSIGNED_BYTE,i),t.deleteFramebuffer(n),t.deleteTexture(r),(o=t.getExtension("WEBGL_lose_context"))==null||o.loseContext(),i[0]<=i[3]?"premultiplied-alpha":"premultiply-alpha-on-upload"})()),Ar}const nr=class ca extends jt{constructor(t){super(t),this.isReady=!1,this.uploadMethodId="video",t={...ca.defaultOptions,...t},this._autoUpdate=!0,this._isConnectedToTicker=!1,this._updateFPS=t.updateFPS||0,this._msToNextUpdate=0,this.autoPlay=t.autoPlay!==!1,this.alphaMode=t.alphaMode??"premultiply-alpha-on-upload",this._videoFrameRequestCallback=this._videoFrameRequestCallback.bind(this),this._videoFrameRequestCallbackHandle=null,this._load=null,this._resolve=null,this._reject=null,this._onCanPlay=this._onCanPlay.bind(this),this._onCanPlayThrough=this._onCanPlayThrough.bind(this),this._onError=this._onError.bind(this),this._onPlayStart=this._onPlayStart.bind(this),this._onPlayStop=this._onPlayStop.bind(this),this._onSeeked=this._onSeeked.bind(this),t.autoLoad!==!1&&this.load()}updateFrame(){if(!this.destroyed){if(this._updateFPS){const t=Dt.shared.elapsedMS*this.resource.playbackRate;this._msToNextUpdate=Math.floor(this._msToNextUpdate-t)}(!this._updateFPS||this._msToNextUpdate<=0)&&(this._msToNextUpdate=this._updateFPS?Math.floor(1e3/this._updateFPS):0),this.isValid&&this.update()}}_videoFrameRequestCallback(){this.updateFrame(),this.destroyed?this._videoFrameRequestCallbackHandle=null:this._videoFrameRequestCallbackHandle=this.resource.requestVideoFrameCallback(this._videoFrameRequestCallback)}get isValid(){return!!this.resource.videoWidth&&!!this.resource.videoHeight}async load(){if(this._load)return this._load;const t=this.resource,e=this.options;return(t.readyState===t.HAVE_ENOUGH_DATA||t.readyState===t.HAVE_FUTURE_DATA)&&t.width&&t.height&&(t.complete=!0),t.addEventListener("play",this._onPlayStart),t.addEventListener("pause",this._onPlayStop),t.addEventListener("seeked",this._onSeeked),this._isSourceReady()?this._mediaReady():(e.preload||t.addEventListener("canplay",this._onCanPlay),t.addEventListener("canplaythrough",this._onCanPlayThrough),t.addEventListener("error",this._onError,!0)),this.alphaMode=await aa(),this._load=new Promise((r,n)=>{this.isValid?r(this):(this._resolve=r,this._reject=n,e.preloadTimeoutMs!==void 0&&(this._preloadTimeout=setTimeout(()=>{this._onError(new ErrorEvent(`Preload exceeded timeout of ${e.preloadTimeoutMs}ms`))})),t.load())}),this._load}_onError(t){this.resource.removeEventListener("error",this._onError,!0),this.emit("error",t),this._reject&&(this._reject(t),this._reject=null,this._resolve=null)}_isSourcePlaying(){const t=this.resource;return!t.paused&&!t.ended}_isSourceReady(){return this.resource.readyState>2}_onPlayStart(){this.isValid||this._mediaReady(),this._configureAutoUpdate()}_onPlayStop(){this._configureAutoUpdate()}_onSeeked(){this._autoUpdate&&!this._isSourcePlaying()&&(this._msToNextUpdate=0,this.updateFrame(),this._msToNextUpdate=0)}_onCanPlay(){this.resource.removeEventListener("canplay",this._onCanPlay),this._mediaReady()}_onCanPlayThrough(){this.resource.removeEventListener("canplaythrough",this._onCanPlay),this._preloadTimeout&&(clearTimeout(this._preloadTimeout),this._preloadTimeout=void 0),this._mediaReady()}_mediaReady(){const t=this.resource;this.isValid&&(this.isReady=!0,this.resize(t.videoWidth,t.videoHeight)),this._msToNextUpdate=0,this.updateFrame(),this._msToNextUpdate=0,this._resolve&&(this._resolve(this),this._resolve=null,this._reject=null),this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&this.resource.play()}destroy(){this._configureAutoUpdate();const t=this.resource;t&&(t.removeEventListener("play",this._onPlayStart),t.removeEventListener("pause",this._onPlayStop),t.removeEventListener("seeked",this._onSeeked),t.removeEventListener("canplay",this._onCanPlay),t.removeEventListener("canplaythrough",this._onCanPlayThrough),t.removeEventListener("error",this._onError,!0),t.pause(),t.src="",t.load()),super.destroy()}get autoUpdate(){return this._autoUpdate}set autoUpdate(t){t!==this._autoUpdate&&(this._autoUpdate=t,this._configureAutoUpdate())}get updateFPS(){return this._updateFPS}set updateFPS(t){t!==this._updateFPS&&(this._updateFPS=t,this._configureAutoUpdate())}_configureAutoUpdate(){this._autoUpdate&&this._isSourcePlaying()?!this._updateFPS&&this.resource.requestVideoFrameCallback?(this._isConnectedToTicker&&(Dt.shared.remove(this.updateFrame,this),this._isConnectedToTicker=!1,this._msToNextUpdate=0),this._videoFrameRequestCallbackHandle===null&&(this._videoFrameRequestCallbackHandle=this.resource.requestVideoFrameCallback(this._videoFrameRequestCallback))):(this._videoFrameRequestCallbackHandle!==null&&(this.resource.cancelVideoFrameCallback(this._videoFrameRequestCallbackHandle),this._videoFrameRequestCallbackHandle=null),this._isConnectedToTicker||(Dt.shared.add(this.updateFrame,this),this._isConnectedToTicker=!0,this._msToNextUpdate=0)):(this._videoFrameRequestCallbackHandle!==null&&(this.resource.cancelVideoFrameCallback(this._videoFrameRequestCallbackHandle),this._videoFrameRequestCallbackHandle=null),this._isConnectedToTicker&&(Dt.shared.remove(this.updateFrame,this),this._isConnectedToTicker=!1,this._msToNextUpdate=0))}static test(t){return globalThis.HTMLVideoElement&&t instanceof HTMLVideoElement}};nr.extension=O.TextureSource;nr.defaultOptions={...jt.defaultOptions,autoLoad:!0,autoPlay:!0,updateFPS:0,crossorigin:!0,loop:!1,muted:!0,playsinline:!0,preload:!1};nr.MIME_TYPES={ogv:"video/ogg",mov:"video/quicktime",m4v:"video/mp4"};let Hs=nr;const Ut=(s,t,e=!1)=>(Array.isArray(s)||(s=[s]),t?s.map(r=>typeof r=="string"||e?t(r):r):s);class Vl{constructor(){this._parsers=[],this._cache=new Map,this._cacheMap=new Map}reset(){this._cacheMap.clear(),this._cache.clear()}has(t){return this._cache.has(t)}get(t){const e=this._cache.get(t);return e||ot(`[Assets] Asset id ${t} was not found in the Cache`),e}set(t,e){const r=Ut(t);let n;for(let c=0;c<this.parsers.length;c++){const h=this.parsers[c];if(h.test(e)){n=h.getCacheableAssets(r,e);break}}const i=new Map(Object.entries(n||{}));n||r.forEach(c=>{i.set(c,e)});const o=[...i.keys()],a={cacheKeys:o,keys:r};r.forEach(c=>{this._cacheMap.set(c,a)}),o.forEach(c=>{const h=n?n[c]:e;this._cache.has(c)&&this._cache.get(c)!==h&&ot("[Cache] already has key:",c),this._cache.set(c,i.get(c))})}remove(t){if(!this._cacheMap.has(t)){ot(`[Assets] Asset id ${t} was not found in the Cache`);return}const e=this._cacheMap.get(t);e.cacheKeys.forEach(n=>{this._cache.delete(n)}),e.keys.forEach(n=>{this._cacheMap.delete(n)})}get parsers(){return this._parsers}}const it=new Vl,rn=[];pt.handleByList(O.TextureSource,rn);function la(s={}){const t=s&&s.resource,e=t?s.resource:s,r=t?s:{resource:s};for(let n=0;n<rn.length;n++){const i=rn[n];if(i.test(e))return new i(r)}throw new Error(`Could not find a source type for resource: ${r.resource}`)}function Yl(s={},t=!1){const e=s&&s.resource,r=e?s.resource:s,n=e?s:{resource:s};if(!t&&it.has(r))return it.get(r);const i=new $({source:la(n)});return i.on("destroy",()=>{it.has(r)&&it.remove(r)}),t||it.set(r,i),i}function Xl(s,t=!1){return typeof s=="string"?it.get(s):s instanceof jt?new $({source:s}):Yl(s,t)}$.from=Xl;jt.from=la;pt.add(sa,ra,na,Hs,Be,ia,Cn);var ge=(s=>(s[s.Low=0]="Low",s[s.Normal=1]="Normal",s[s.High=2]="High",s))(ge||{});function Nt(s){if(typeof s!="string")throw new TypeError(`Path must be a string. Received ${JSON.stringify(s)}`)}function Je(s){return s.split("?")[0].split("#")[0]}function ql(s){return s.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function Kl(s,t,e){return s.replace(new RegExp(ql(t),"g"),e)}function Zl(s,t){let e="",r=0,n=-1,i=0,o=-1;for(let a=0;a<=s.length;++a){if(a<s.length)o=s.charCodeAt(a);else{if(o===47)break;o=47}if(o===47){if(!(n===a-1||i===1))if(n!==a-1&&i===2){if(e.length<2||r!==2||e.charCodeAt(e.length-1)!==46||e.charCodeAt(e.length-2)!==46){if(e.length>2){const c=e.lastIndexOf("/");if(c!==e.length-1){c===-1?(e="",r=0):(e=e.slice(0,c),r=e.length-1-e.lastIndexOf("/")),n=a,i=0;continue}}else if(e.length===2||e.length===1){e="",r=0,n=a,i=0;continue}}}else e.length>0?e+=`/${s.slice(n+1,a)}`:e=s.slice(n+1,a),r=a-n-1;n=a,i=0}else o===46&&i!==-1?++i:i=-1}return e}const Pt={toPosix(s){return Kl(s,"\\","/")},isUrl(s){return/^https?:/.test(this.toPosix(s))},isDataUrl(s){return/^data:([a-z]+\/[a-z0-9-+.]+(;[a-z0-9-.!#$%*+.{}|~`]+=[a-z0-9-.!#$%*+.{}()_|~`]+)*)?(;base64)?,([a-z0-9!$&',()*+;=\-._~:@\/?%\s<>]*?)$/i.test(s)},isBlobUrl(s){return s.startsWith("blob:")},hasProtocol(s){return/^[^/:]+:/.test(this.toPosix(s))},getProtocol(s){Nt(s),s=this.toPosix(s);const t=/^file:\/\/\//.exec(s);if(t)return t[0];const e=/^[^/:]+:\/{0,2}/.exec(s);return e?e[0]:""},toAbsolute(s,t,e){if(Nt(s),this.isDataUrl(s)||this.isBlobUrl(s))return s;const r=Je(this.toPosix(t??at.get().getBaseUrl())),n=Je(this.toPosix(e??this.rootname(r)));return s=this.toPosix(s),s.startsWith("/")?Pt.join(n,s.slice(1)):this.isAbsolute(s)?s:this.join(r,s)},normalize(s){if(Nt(s),s.length===0)return".";if(this.isDataUrl(s)||this.isBlobUrl(s))return s;s=this.toPosix(s);let t="";const e=s.startsWith("/");this.hasProtocol(s)&&(t=this.rootname(s),s=s.slice(t.length));const r=s.endsWith("/");return s=Zl(s),s.length>0&&r&&(s+="/"),e?`/${s}`:t+s},isAbsolute(s){return Nt(s),s=this.toPosix(s),this.hasProtocol(s)?!0:s.startsWith("/")},join(...s){if(s.length===0)return".";let t;for(let e=0;e<s.length;++e){const r=s[e];if(Nt(r),r.length>0)if(t===void 0)t=r;else{const n=s[e-1]??"";this.joinExtensions.includes(this.extname(n).toLowerCase())?t+=`/../${r}`:t+=`/${r}`}}return t===void 0?".":this.normalize(t)},dirname(s){if(Nt(s),s.length===0)return".";s=this.toPosix(s);let t=s.charCodeAt(0);const e=t===47;let r=-1,n=!0;const i=this.getProtocol(s),o=s;s=s.slice(i.length);for(let a=s.length-1;a>=1;--a)if(t=s.charCodeAt(a),t===47){if(!n){r=a;break}}else n=!1;return r===-1?e?"/":this.isUrl(o)?i+s:i:e&&r===1?"//":i+s.slice(0,r)},rootname(s){Nt(s),s=this.toPosix(s);let t="";if(s.startsWith("/")?t="/":t=this.getProtocol(s),this.isUrl(s)){const e=s.indexOf("/",t.length);e!==-1?t=s.slice(0,e):t=s,t.endsWith("/")||(t+="/")}return t},basename(s,t){Nt(s),t&&Nt(t),s=Je(this.toPosix(s));let e=0,r=-1,n=!0,i;if(t!==void 0&&t.length>0&&t.length<=s.length){if(t.length===s.length&&t===s)return"";let o=t.length-1,a=-1;for(i=s.length-1;i>=0;--i){const c=s.charCodeAt(i);if(c===47){if(!n){e=i+1;break}}else a===-1&&(n=!1,a=i+1),o>=0&&(c===t.charCodeAt(o)?--o===-1&&(r=i):(o=-1,r=a))}return e===r?r=a:r===-1&&(r=s.length),s.slice(e,r)}for(i=s.length-1;i>=0;--i)if(s.charCodeAt(i)===47){if(!n){e=i+1;break}}else r===-1&&(n=!1,r=i+1);return r===-1?"":s.slice(e,r)},extname(s){Nt(s),s=Je(this.toPosix(s));let t=-1,e=0,r=-1,n=!0,i=0;for(let o=s.length-1;o>=0;--o){const a=s.charCodeAt(o);if(a===47){if(!n){e=o+1;break}continue}r===-1&&(n=!1,r=o+1),a===46?t===-1?t=o:i!==1&&(i=1):t!==-1&&(i=-1)}return t===-1||r===-1||i===0||i===1&&t===r-1&&t===e+1?"":s.slice(t,r)},parse(s){Nt(s);const t={root:"",dir:"",base:"",ext:"",name:""};if(s.length===0)return t;s=Je(this.toPosix(s));let e=s.charCodeAt(0);const r=this.isAbsolute(s);let n;t.root=this.rootname(s),r||this.hasProtocol(s)?n=1:n=0;let i=-1,o=0,a=-1,c=!0,h=s.length-1,l=0;for(;h>=n;--h){if(e=s.charCodeAt(h),e===47){if(!c){o=h+1;break}continue}a===-1&&(c=!1,a=h+1),e===46?i===-1?i=h:l!==1&&(l=1):i!==-1&&(l=-1)}return i===-1||a===-1||l===0||l===1&&i===a-1&&i===o+1?a!==-1&&(o===0&&r?t.base=t.name=s.slice(1,a):t.base=t.name=s.slice(o,a)):(o===0&&r?(t.name=s.slice(1,i),t.base=s.slice(1,a)):(t.name=s.slice(o,i),t.base=s.slice(o,a)),t.ext=s.slice(i,a)),t.dir=this.dirname(s),t},sep:"/",delimiter:":",joinExtensions:[".html"]};function ha(s,t,e,r,n){const i=t[e];for(let o=0;o<i.length;o++){const a=i[o];e<t.length-1?ha(s.replace(r[e],a),t,e+1,r,n):n.push(s.replace(r[e],a))}}function Ql(s){const t=/\{(.*?)\}/g,e=s.match(t),r=[];if(e){const n=[];e.forEach(i=>{const o=i.substring(1,i.length-1).split(",");n.push(o)}),ha(s,n,0,e,r)}else r.push(s);return r}const Vs=s=>!Array.isArray(s);class Xe{constructor(){this._defaultBundleIdentifierOptions={connector:"-",createBundleAssetId:(t,e)=>`${t}${this._bundleIdConnector}${e}`,extractAssetIdFromBundle:(t,e)=>e.replace(`${t}${this._bundleIdConnector}`,"")},this._bundleIdConnector=this._defaultBundleIdentifierOptions.connector,this._createBundleAssetId=this._defaultBundleIdentifierOptions.createBundleAssetId,this._extractAssetIdFromBundle=this._defaultBundleIdentifierOptions.extractAssetIdFromBundle,this._assetMap={},this._preferredOrder=[],this._parsers=[],this._resolverHash={},this._bundles={}}setBundleIdentifier(t){if(this._bundleIdConnector=t.connector??this._bundleIdConnector,this._createBundleAssetId=t.createBundleAssetId??this._createBundleAssetId,this._extractAssetIdFromBundle=t.extractAssetIdFromBundle??this._extractAssetIdFromBundle,this._extractAssetIdFromBundle("foo",this._createBundleAssetId("foo","bar"))!=="bar")throw new Error("[Resolver] GenerateBundleAssetId are not working correctly")}prefer(...t){t.forEach(e=>{this._preferredOrder.push(e),e.priority||(e.priority=Object.keys(e.params))}),this._resolverHash={}}set basePath(t){this._basePath=t}get basePath(){return this._basePath}set rootPath(t){this._rootPath=t}get rootPath(){return this._rootPath}get parsers(){return this._parsers}reset(){this.setBundleIdentifier(this._defaultBundleIdentifierOptions),this._assetMap={},this._preferredOrder=[],this._resolverHash={},this._rootPath=null,this._basePath=null,this._manifest=null,this._bundles={},this._defaultSearchParams=null}setDefaultSearchParams(t){if(typeof t=="string")this._defaultSearchParams=t;else{const e=t;this._defaultSearchParams=Object.keys(e).map(r=>`${encodeURIComponent(r)}=${encodeURIComponent(e[r])}`).join("&")}}getAlias(t){const{alias:e,src:r}=t;return Ut(e||r,i=>typeof i=="string"?i:Array.isArray(i)?i.map(o=>(o==null?void 0:o.src)??o):i!=null&&i.src?i.src:i,!0)}addManifest(t){this._manifest&&ot("[Resolver] Manifest already exists, this will be overwritten"),this._manifest=t,t.bundles.forEach(e=>{this.addBundle(e.name,e.assets)})}addBundle(t,e){const r=[];let n=e;Array.isArray(e)||(n=Object.entries(e).map(([i,o])=>typeof o=="string"||Array.isArray(o)?{alias:i,src:o}:{alias:i,...o})),n.forEach(i=>{const o=i.src,a=i.alias;let c;if(typeof a=="string"){const h=this._createBundleAssetId(t,a);r.push(h),c=[a,h]}else{const h=a.map(l=>this._createBundleAssetId(t,l));r.push(...h),c=[...a,...h]}this.add({...i,alias:c,src:o})}),this._bundles[t]=r}add(t){const e=[];Array.isArray(t)?e.push(...t):e.push(t);let r;r=i=>{this.hasKey(i)&&ot(`[Resolver] already has key: ${i} overwriting`)},Ut(e).forEach(i=>{const{src:o}=i;let{data:a,format:c,loadParser:h}=i;const l=Ut(o).map(u=>typeof u=="string"?Ql(u):Array.isArray(u)?u:[u]),d=this.getAlias(i);Array.isArray(d)?d.forEach(r):r(d);const f=[];l.forEach(u=>{u.forEach(p=>{let g={};if(typeof p!="object"){g.src=p;for(let m=0;m<this._parsers.length;m++){const x=this._parsers[m];if(x.test(p)){g=x.parse(p);break}}}else a=p.data??a,c=p.format??c,h=p.loadParser??h,g={...g,...p};if(!d)throw new Error(`[Resolver] alias is undefined for this asset: ${g.src}`);g=this._buildResolvedAsset(g,{aliases:d,data:a,format:c,loadParser:h}),f.push(g)})}),d.forEach(u=>{this._assetMap[u]=f})})}resolveBundle(t){const e=Vs(t);t=Ut(t);const r={};return t.forEach(n=>{const i=this._bundles[n];if(i){const o=this.resolve(i),a={};for(const c in o){const h=o[c];a[this._extractAssetIdFromBundle(n,c)]=h}r[n]=a}}),e?r[t[0]]:r}resolveUrl(t){const e=this.resolve(t);if(typeof t!="string"){const r={};for(const n in e)r[n]=e[n].src;return r}return e.src}resolve(t){const e=Vs(t);t=Ut(t);const r={};return t.forEach(n=>{if(!this._resolverHash[n])if(this._assetMap[n]){let i=this._assetMap[n];const o=this._getPreferredOrder(i);o==null||o.priority.forEach(a=>{o.params[a].forEach(c=>{const h=i.filter(l=>l[a]?l[a]===c:!1);h.length&&(i=h)})}),this._resolverHash[n]=i[0]}else this._resolverHash[n]=this._buildResolvedAsset({alias:[n],src:n},{});r[n]=this._resolverHash[n]}),e?r[t[0]]:r}hasKey(t){return!!this._assetMap[t]}hasBundle(t){return!!this._bundles[t]}_getPreferredOrder(t){for(let e=0;e<t.length;e++){const r=t[e],n=this._preferredOrder.find(i=>i.params.format.includes(r.format));if(n)return n}return this._preferredOrder[0]}_appendDefaultSearchParams(t){if(!this._defaultSearchParams)return t;const e=/\?/.test(t)?"&":"?";return`${t}${e}${this._defaultSearchParams}`}_buildResolvedAsset(t,e){const{aliases:r,data:n,loadParser:i,format:o}=e;return(this._basePath||this._rootPath)&&(t.src=Pt.toAbsolute(t.src,this._basePath,this._rootPath)),t.alias=r??t.alias??[t.src],t.src=this._appendDefaultSearchParams(t.src),t.data={...n||{},...t.data},t.loadParser=i??t.loadParser,t.format=o??t.format??Jl(t.src),t}}Xe.RETINA_PREFIX=/@([0-9\.]+)x/;function Jl(s){return s.split(".").pop().split("?").shift().split("#").shift()}const nn=(s,t)=>{const e=t.split("?")[1];return e&&(s+=`?${e}`),s},da=class os{constructor(t,e){this.linkedSheets=[];let r=t;(t==null?void 0:t.source)instanceof jt&&(r={texture:t,data:e});const{texture:n,data:i,cachePrefix:o=""}=r;this.cachePrefix=o,this._texture=n instanceof $?n:null,this.textureSource=n.source,this.textures={},this.animations={},this.data=i;const a=parseFloat(i.meta.scale);a?(this.resolution=a,n.source.resolution=this.resolution):this.resolution=n.source._resolution,this._frames=this.data.frames,this._frameKeys=Object.keys(this._frames),this._batchIndex=0,this._callback=null}parse(){return new Promise(t=>{this._callback=t,this._batchIndex=0,this._frameKeys.length<=os.BATCH_SIZE?(this._processFrames(0),this._processAnimations(),this._parseComplete()):this._nextBatch()})}_processFrames(t){let e=t;const r=os.BATCH_SIZE;for(;e-t<r&&e<this._frameKeys.length;){const n=this._frameKeys[e],i=this._frames[n],o=i.frame;if(o){let a=null,c=null;const h=i.trimmed!==!1&&i.sourceSize?i.sourceSize:i.frame,l=new q(0,0,Math.floor(h.w)/this.resolution,Math.floor(h.h)/this.resolution);i.rotated?a=new q(Math.floor(o.x)/this.resolution,Math.floor(o.y)/this.resolution,Math.floor(o.h)/this.resolution,Math.floor(o.w)/this.resolution):a=new q(Math.floor(o.x)/this.resolution,Math.floor(o.y)/this.resolution,Math.floor(o.w)/this.resolution,Math.floor(o.h)/this.resolution),i.trimmed!==!1&&i.spriteSourceSize&&(c=new q(Math.floor(i.spriteSourceSize.x)/this.resolution,Math.floor(i.spriteSourceSize.y)/this.resolution,Math.floor(o.w)/this.resolution,Math.floor(o.h)/this.resolution)),this.textures[n]=new $({source:this.textureSource,frame:a,orig:l,trim:c,rotate:i.rotated?2:0,defaultAnchor:i.anchor,defaultBorders:i.borders,label:n.toString()})}e++}}_processAnimations(){const t=this.data.animations||{};for(const e in t){this.animations[e]=[];for(let r=0;r<t[e].length;r++){const n=t[e][r];this.animations[e].push(this.textures[n])}}}_parseComplete(){const t=this._callback;this._callback=null,this._batchIndex=0,t.call(this,this.textures)}_nextBatch(){this._processFrames(this._batchIndex*os.BATCH_SIZE),this._batchIndex++,setTimeout(()=>{this._batchIndex*os.BATCH_SIZE<this._frameKeys.length?this._nextBatch():(this._processAnimations(),this._parseComplete())},0)}destroy(t=!1){var e;for(const r in this.textures)this.textures[r].destroy();this._frames=null,this._frameKeys=null,this.data=null,this.textures=null,t&&((e=this._texture)==null||e.destroy(),this.textureSource.destroy()),this._texture=null,this.textureSource=null,this.linkedSheets=[]}};da.BATCH_SIZE=1e3;let xi=da;const th=["jpg","png","jpeg","avif","webp","basis","etc2","bc7","bc6h","bc5","bc4","bc3","bc2","bc1","eac","astc"];function ua(s,t,e){const r={};if(s.forEach(n=>{r[n]=t}),Object.keys(t.textures).forEach(n=>{r[`${t.cachePrefix}${n}`]=t.textures[n]}),!e){const n=Pt.dirname(s[0]);t.linkedSheets.forEach((i,o)=>{const a=ua([`${n}/${t.data.meta.related_multi_packs[o]}`],i,!0);Object.assign(r,a)})}return r}const eh={extension:O.Asset,cache:{test:s=>s instanceof xi,getCacheableAssets:(s,t)=>ua(s,t,!1)},resolver:{extension:{type:O.ResolveParser,name:"resolveSpritesheet"},test:s=>{const e=s.split("?")[0].split("."),r=e.pop(),n=e.pop();return r==="json"&&th.includes(n)},parse:s=>{var e;const t=s.split(".");return{resolution:parseFloat(((e=Xe.RETINA_PREFIX.exec(s))==null?void 0:e[1])??"1"),format:t[t.length-2],src:s}}},loader:{name:"spritesheetLoader",extension:{type:O.LoadParser,priority:ge.Normal,name:"spritesheetLoader"},async testParse(s,t){return Pt.extname(t.src).toLowerCase()===".json"&&!!s.frames},async parse(s,t,e){var d,f;const{texture:r,imageFilename:n,textureOptions:i,cachePrefix:o}=(t==null?void 0:t.data)??{};let a=Pt.dirname(t.src);a&&a.lastIndexOf("/")!==a.length-1&&(a+="/");let c;if(r instanceof $)c=r;else{const u=nn(a+(n??s.meta.image),t.src);c=(await e.load([{src:u,data:i}]))[u]}const h=new xi({texture:c.source,data:s,cachePrefix:o});await h.parse();const l=(d=s==null?void 0:s.meta)==null?void 0:d.related_multi_packs;if(Array.isArray(l)){const u=[];for(const g of l){if(typeof g!="string")continue;let m=a+g;(f=t.data)!=null&&f.ignoreMultiPack||(m=nn(m,t.src),u.push(e.load({src:m,data:{textureOptions:i,ignoreMultiPack:!0}})))}const p=await Promise.all(u);h.linkedSheets=p,p.forEach(g=>{g.linkedSheets=[h].concat(h.linkedSheets.filter(m=>m!==g))})}return h},async unload(s,t,e){await e.unload(s.textureSource._sourceOrigin),s.destroy(!1)}}};pt.add(eh);const Sr=Object.create(null),yi=Object.create(null);function Tn(s,t){let e=yi[s];return e===void 0&&(Sr[t]===void 0&&(Sr[t]=1),yi[s]=e=Sr[t]++),e}let Re;function fa(){return(!Re||Re!=null&&Re.isContextLost())&&(Re=at.get().createCanvas().getContext("webgl",{})),Re}let ks;function sh(){if(!ks){ks="mediump";const s=fa();s&&s.getShaderPrecisionFormat&&(ks=s.getShaderPrecisionFormat(s.FRAGMENT_SHADER,s.HIGH_FLOAT).precision?"highp":"mediump")}return ks}function rh(s,t,e){return t?s:e?(s=s.replace("out vec4 finalColor;",""),`

        #ifdef GL_ES // This checks if it is WebGL1
        #define in varying
        #define finalColor gl_FragColor
        #define texture texture2D
        #endif
        ${s}
        `):`

        #ifdef GL_ES // This checks if it is WebGL1
        #define in attribute
        #define out varying
        #endif
        ${s}
        `}function nh(s,t,e){const r=e?t.maxSupportedFragmentPrecision:t.maxSupportedVertexPrecision;if(s.substring(0,9)!=="precision"){let n=e?t.requestedFragmentPrecision:t.requestedVertexPrecision;return n==="highp"&&r!=="highp"&&(n="mediump"),`precision ${n} float;
${s}`}else if(r!=="highp"&&s.substring(0,15)==="precision highp")return s.replace("precision highp","precision mediump");return s}function ih(s,t){return t?`#version 300 es
${s}`:s}const oh={},ah={};function ch(s,{name:t="pixi-program"},e=!0){t=t.replace(/\s+/g,"-"),t+=e?"-fragment":"-vertex";const r=e?oh:ah;return r[t]?(r[t]++,t+=`-${r[t]}`):r[t]=1,s.indexOf("#define SHADER_NAME")!==-1?s:`${`#define SHADER_NAME ${t}`}
${s}`}function lh(s,t){return t?s.replace("#version 300 es",""):s}const Cr={stripVersion:lh,ensurePrecision:nh,addProgramDefines:rh,setProgramName:ch,insertVersion:ih},kr=Object.create(null),pa=class on{constructor(t){t={...on.defaultOptions,...t};const e=t.fragment.indexOf("#version 300 es")!==-1,r={stripVersion:e,ensurePrecision:{requestedFragmentPrecision:t.preferredFragmentPrecision,requestedVertexPrecision:t.preferredVertexPrecision,maxSupportedVertexPrecision:"highp",maxSupportedFragmentPrecision:sh()},setProgramName:{name:t.name},addProgramDefines:e,insertVersion:e};let n=t.fragment,i=t.vertex;Object.keys(Cr).forEach(o=>{const a=r[o];n=Cr[o](n,a,!0),i=Cr[o](i,a,!1)}),this.fragment=n,this.vertex=i,this.transformFeedbackVaryings=t.transformFeedbackVaryings,this._key=Tn(`${this.vertex}:${this.fragment}`,"gl-program")}destroy(){this.fragment=null,this.vertex=null,this._attributeData=null,this._uniformData=null,this._uniformBlockData=null,this.transformFeedbackVaryings=null}static from(t){const e=`${t.vertex}:${t.fragment}`;return kr[e]||(kr[e]=new on(t)),kr[e]}};pa.defaultOptions={preferredVertexPrecision:"highp",preferredFragmentPrecision:"mediump"};let ma=pa;const bi={uint8x2:{size:2,stride:2,normalised:!1},uint8x4:{size:4,stride:4,normalised:!1},sint8x2:{size:2,stride:2,normalised:!1},sint8x4:{size:4,stride:4,normalised:!1},unorm8x2:{size:2,stride:2,normalised:!0},unorm8x4:{size:4,stride:4,normalised:!0},snorm8x2:{size:2,stride:2,normalised:!0},snorm8x4:{size:4,stride:4,normalised:!0},uint16x2:{size:2,stride:4,normalised:!1},uint16x4:{size:4,stride:8,normalised:!1},sint16x2:{size:2,stride:4,normalised:!1},sint16x4:{size:4,stride:8,normalised:!1},unorm16x2:{size:2,stride:4,normalised:!0},unorm16x4:{size:4,stride:8,normalised:!0},snorm16x2:{size:2,stride:4,normalised:!0},snorm16x4:{size:4,stride:8,normalised:!0},float16x2:{size:2,stride:4,normalised:!1},float16x4:{size:4,stride:8,normalised:!1},float32:{size:1,stride:4,normalised:!1},float32x2:{size:2,stride:8,normalised:!1},float32x3:{size:3,stride:12,normalised:!1},float32x4:{size:4,stride:16,normalised:!1},uint32:{size:1,stride:4,normalised:!1},uint32x2:{size:2,stride:8,normalised:!1},uint32x3:{size:3,stride:12,normalised:!1},uint32x4:{size:4,stride:16,normalised:!1},sint32:{size:1,stride:4,normalised:!1},sint32x2:{size:2,stride:8,normalised:!1},sint32x3:{size:3,stride:12,normalised:!1},sint32x4:{size:4,stride:16,normalised:!1}};function hh(s){return bi[s]??bi.float32}const dh={f32:"float32","vec2<f32>":"float32x2","vec3<f32>":"float32x3","vec4<f32>":"float32x4",vec2f:"float32x2",vec3f:"float32x3",vec4f:"float32x4",i32:"sint32","vec2<i32>":"sint32x2","vec3<i32>":"sint32x3","vec4<i32>":"sint32x4",u32:"uint32","vec2<u32>":"uint32x2","vec3<u32>":"uint32x3","vec4<u32>":"uint32x4",bool:"uint32","vec2<bool>":"uint32x2","vec3<bool>":"uint32x3","vec4<bool>":"uint32x4"};function uh({source:s,entryPoint:t}){const e={},r=s.indexOf(`fn ${t}`);if(r!==-1){const n=s.indexOf("->",r);if(n!==-1){const i=s.substring(r,n),o=/@location\((\d+)\)\s+([a-zA-Z0-9_]+)\s*:\s*([a-zA-Z0-9_<>]+)(?:,|\s|$)/g;let a;for(;(a=o.exec(i))!==null;){const c=dh[a[3]]??"float32";e[a[2]]={location:parseInt(a[1],10),format:c,stride:hh(c).stride,offset:0,instance:!1,start:0}}}}return e}function Pr(s){var d,f;const t=/(^|[^/])@(group|binding)\(\d+\)[^;]+;/g,e=/@group\((\d+)\)/,r=/@binding\((\d+)\)/,n=/var(<[^>]+>)? (\w+)/,i=/:\s*(\w+)/,o=/struct\s+(\w+)\s*{([^}]+)}/g,a=/(\w+)\s*:\s*([\w\<\>]+)/g,c=/struct\s+(\w+)/,h=(d=s.match(t))==null?void 0:d.map(u=>({group:parseInt(u.match(e)[1],10),binding:parseInt(u.match(r)[1],10),name:u.match(n)[2],isUniform:u.match(n)[1]==="<uniform>",type:u.match(i)[1]}));if(!h)return{groups:[],structs:[]};const l=((f=s.match(o))==null?void 0:f.map(u=>{const p=u.match(c)[1],g=u.match(a).reduce((m,x)=>{const[y,b]=x.split(":");return m[y.trim()]=b.trim(),m},{});return g?{name:p,members:g}:null}).filter(({name:u})=>h.some(p=>p.type===u)))??[];return{groups:h,structs:l}}var as=(s=>(s[s.VERTEX=1]="VERTEX",s[s.FRAGMENT=2]="FRAGMENT",s[s.COMPUTE=4]="COMPUTE",s))(as||{});function fh({groups:s}){const t=[];for(let e=0;e<s.length;e++){const r=s[e];t[r.group]||(t[r.group]=[]),r.isUniform?t[r.group].push({binding:r.binding,visibility:as.VERTEX|as.FRAGMENT,buffer:{type:"uniform"}}):r.type==="sampler"?t[r.group].push({binding:r.binding,visibility:as.FRAGMENT,sampler:{type:"filtering"}}):r.type==="texture_2d"&&t[r.group].push({binding:r.binding,visibility:as.FRAGMENT,texture:{sampleType:"float",viewDimension:"2d",multisampled:!1}})}return t}function ph({groups:s}){const t=[];for(let e=0;e<s.length;e++){const r=s[e];t[r.group]||(t[r.group]={}),t[r.group][r.name]=r.binding}return t}function mh(s,t){const e=new Set,r=new Set,n=[...s.structs,...t.structs].filter(o=>e.has(o.name)?!1:(e.add(o.name),!0)),i=[...s.groups,...t.groups].filter(o=>{const a=`${o.name}-${o.binding}`;return r.has(a)?!1:(r.add(a),!0)});return{structs:n,groups:i}}const Mr=Object.create(null);class ir{constructor(t){var a,c;this._layoutKey=0,this._attributeLocationsKey=0;const{fragment:e,vertex:r,layout:n,gpuLayout:i,name:o}=t;if(this.name=o,this.fragment=e,this.vertex=r,e.source===r.source){const h=Pr(e.source);this.structsAndGroups=h}else{const h=Pr(r.source),l=Pr(e.source);this.structsAndGroups=mh(h,l)}this.layout=n??ph(this.structsAndGroups),this.gpuLayout=i??fh(this.structsAndGroups),this.autoAssignGlobalUniforms=((a=this.layout[0])==null?void 0:a.globalUniforms)!==void 0,this.autoAssignLocalUniforms=((c=this.layout[1])==null?void 0:c.localUniforms)!==void 0,this._generateProgramKey()}_generateProgramKey(){const{vertex:t,fragment:e}=this,r=t.source+e.source+t.entryPoint+e.entryPoint;this._layoutKey=Tn(r,"program")}get attributeData(){return this._attributeData??(this._attributeData=uh(this.vertex)),this._attributeData}destroy(){this.gpuLayout=null,this.layout=null,this.structsAndGroups=null,this.fragment=null,this.vertex=null}static from(t){const e=`${t.vertex.source}:${t.fragment.source}:${t.fragment.entryPoint}:${t.vertex.entryPoint}`;return Mr[e]||(Mr[e]=new ir(t)),Mr[e]}}const ga=["f32","i32","vec2<f32>","vec3<f32>","vec4<f32>","mat2x2<f32>","mat3x3<f32>","mat4x4<f32>","mat3x2<f32>","mat4x2<f32>","mat2x3<f32>","mat4x3<f32>","mat2x4<f32>","mat3x4<f32>","vec2<i32>","vec3<i32>","vec4<i32>"],gh=ga.reduce((s,t)=>(s[t]=!0,s),{});function xh(s,t){switch(s){case"f32":return 0;case"vec2<f32>":return new Float32Array(2*t);case"vec3<f32>":return new Float32Array(3*t);case"vec4<f32>":return new Float32Array(4*t);case"mat2x2<f32>":return new Float32Array([1,0,0,1]);case"mat3x3<f32>":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4x4<f32>":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}return null}const xa=class ya{constructor(t,e){this._touched=0,this.uid=ct("uniform"),this._resourceType="uniformGroup",this._resourceId=ct("resource"),this.isUniformGroup=!0,this._dirtyId=0,this.destroyed=!1,e={...ya.defaultOptions,...e},this.uniformStructures=t;const r={};for(const n in t){const i=t[n];if(i.name=n,i.size=i.size??1,!gh[i.type])throw new Error(`Uniform type ${i.type} is not supported. Supported uniform types are: ${ga.join(", ")}`);i.value??(i.value=xh(i.type,i.size)),r[n]=i.value}this.uniforms=r,this._dirtyId=1,this.ubo=e.ubo,this.isStatic=e.isStatic,this._signature=Tn(Object.keys(r).map(n=>`${n}-${t[n].type}`).join("-"),"uniform-group")}update(){this._dirtyId++}};xa.defaultOptions={ubo:!1,isStatic:!1};let ba=xa;class Ws{constructor(t){this.resources=Object.create(null),this._dirty=!0;let e=0;for(const r in t){const n=t[r];this.setResource(n,e++)}this._updateKey()}_updateKey(){if(!this._dirty)return;this._dirty=!1;const t=[];let e=0;for(const r in this.resources)t[e++]=this.resources[r]._resourceId;this._key=t.join("|")}setResource(t,e){var n,i;const r=this.resources[e];t!==r&&(r&&((n=t.off)==null||n.call(t,"change",this.onResourceChange,this)),(i=t.on)==null||i.call(t,"change",this.onResourceChange,this),this.resources[e]=t,this._dirty=!0)}getResource(t){return this.resources[t]}_touch(t){const e=this.resources;for(const r in e)e[r]._touched=t}destroy(){var e;const t=this.resources;for(const r in t){const n=t[r];(e=n.off)==null||e.call(n,"change",this.onResourceChange,this)}this.resources=null}onResourceChange(t){if(this._dirty=!0,t.destroyed){const e=this.resources;for(const r in e)e[r]===t&&(e[r]=null)}else this._updateKey()}}var an=(s=>(s[s.WEBGL=1]="WEBGL",s[s.WEBGPU=2]="WEBGPU",s[s.BOTH=3]="BOTH",s))(an||{});class En extends Wt{constructor(t){super(),this.uid=ct("shader"),this._uniformBindMap=Object.create(null),this._ownedBindGroups=[];let{gpuProgram:e,glProgram:r,groups:n,resources:i,compatibleRenderers:o,groupMap:a}=t;this.gpuProgram=e,this.glProgram=r,o===void 0&&(o=0,e&&(o|=an.WEBGPU),r&&(o|=an.WEBGL)),this.compatibleRenderers=o;const c={};if(!i&&!n&&(i={}),i&&n)throw new Error("[Shader] Cannot have both resources and groups");if(!e&&n&&!a)throw new Error("[Shader] No group map or WebGPU shader provided - consider using resources instead.");if(!e&&n&&a)for(const h in a)for(const l in a[h]){const d=a[h][l];c[d]={group:h,binding:l,name:d}}else if(e&&n&&!a){const h=e.structsAndGroups.groups;a={},h.forEach(l=>{a[l.group]=a[l.group]||{},a[l.group][l.binding]=l.name,c[l.name]=l})}else if(i){n={},a={},e&&e.structsAndGroups.groups.forEach(d=>{a[d.group]=a[d.group]||{},a[d.group][d.binding]=d.name,c[d.name]=d});let h=0;for(const l in i)c[l]||(n[99]||(n[99]=new Ws,this._ownedBindGroups.push(n[99])),c[l]={group:99,binding:h,name:l},a[99]=a[99]||{},a[99][h]=l,h++);for(const l in i){const d=l;let f=i[l];!f.source&&!f._resourceType&&(f=new ba(f));const u=c[d];u&&(n[u.group]||(n[u.group]=new Ws,this._ownedBindGroups.push(n[u.group])),n[u.group].setResource(f,u.binding))}}this.groups=n,this._uniformBindMap=a,this.resources=this._buildResourceAccessor(n,c)}addResource(t,e,r){var n,i;(n=this._uniformBindMap)[e]||(n[e]={}),(i=this._uniformBindMap[e])[r]||(i[r]=t),this.groups[e]||(this.groups[e]=new Ws,this._ownedBindGroups.push(this.groups[e]))}_buildResourceAccessor(t,e){const r={};for(const n in e){const i=e[n];Object.defineProperty(r,i.name,{get(){return t[i.group].getResource(i.binding)},set(o){t[i.group].setResource(o,i.binding)}})}return r}destroy(t=!1){var e,r;this.emit("destroy",this),t&&((e=this.gpuProgram)==null||e.destroy(),(r=this.glProgram)==null||r.destroy()),this.gpuProgram=null,this.glProgram=null,this.removeAllListeners(),this._uniformBindMap=null,this._ownedBindGroups.forEach(n=>{n.destroy()}),this._ownedBindGroups=null,this.resources=null,this.groups=null}static from(t){const{gpu:e,gl:r,...n}=t;let i,o;return e&&(i=ir.from(e)),r&&(o=ma.from(r)),new En({gpuProgram:i,glProgram:o,...n})}}const cn=[];pt.handleByNamedList(O.Environment,cn);async function yh(s){if(!s)for(let t=0;t<cn.length;t++){const e=cn[t];if(e.value.test()){await e.value.load();return}}}let ts;function bh(){if(typeof ts=="boolean")return ts;try{ts=new Function("param1","param2","param3","return param1[param2] === param3;")({a:"b"},"a","b")===!0}catch{ts=!1}return ts}function wi(s,t,e=2){const r=t&&t.length,n=r?t[0]*e:s.length;let i=wa(s,0,n,e,!0);const o=[];if(!i||i.next===i.prev)return o;let a,c,h;if(r&&(i=Sh(s,t,i,e)),s.length>80*e){a=1/0,c=1/0;let l=-1/0,d=-1/0;for(let f=e;f<n;f+=e){const u=s[f],p=s[f+1];u<a&&(a=u),p<c&&(c=p),u>l&&(l=u),p>d&&(d=p)}h=Math.max(l-a,d-c),h=h!==0?32767/h:0}return gs(i,o,e,a,c,h,0),o}function wa(s,t,e,r,n){let i;if(n===Lh(s,t,e,r)>0)for(let o=t;o<e;o+=r)i=_i(o/r|0,s[o],s[o+1],i);else for(let o=e-r;o>=t;o-=r)i=_i(o/r|0,s[o],s[o+1],i);return i&&je(i,i.next)&&(ys(i),i=i.next),i}function Fe(s,t){if(!s)return s;t||(t=s);let e=s,r;do if(r=!1,!e.steiner&&(je(e,e.next)||rt(e.prev,e,e.next)===0)){if(ys(e),e=t=e.prev,e===e.next)break;r=!0}else e=e.next;while(r||e!==t);return t}function gs(s,t,e,r,n,i,o){if(!s)return;!o&&i&&Th(s,r,n,i);let a=s;for(;s.prev!==s.next;){const c=s.prev,h=s.next;if(i?_h(s,r,n,i):wh(s)){t.push(c.i,s.i,h.i),ys(s),s=h.next,a=h.next;continue}if(s=h,s===a){o?o===1?(s=vh(Fe(s),t),gs(s,t,e,r,n,i,2)):o===2&&Ah(s,t,e,r,n,i):gs(Fe(s),t,e,r,n,i,1);break}}}function wh(s){const t=s.prev,e=s,r=s.next;if(rt(t,e,r)>=0)return!1;const n=t.x,i=e.x,o=r.x,a=t.y,c=e.y,h=r.y,l=Math.min(n,i,o),d=Math.min(a,c,h),f=Math.max(n,i,o),u=Math.max(a,c,h);let p=r.next;for(;p!==t;){if(p.x>=l&&p.x<=f&&p.y>=d&&p.y<=u&&cs(n,a,i,c,o,h,p.x,p.y)&&rt(p.prev,p,p.next)>=0)return!1;p=p.next}return!0}function _h(s,t,e,r){const n=s.prev,i=s,o=s.next;if(rt(n,i,o)>=0)return!1;const a=n.x,c=i.x,h=o.x,l=n.y,d=i.y,f=o.y,u=Math.min(a,c,h),p=Math.min(l,d,f),g=Math.max(a,c,h),m=Math.max(l,d,f),x=ln(u,p,t,e,r),y=ln(g,m,t,e,r);let b=s.prevZ,w=s.nextZ;for(;b&&b.z>=x&&w&&w.z<=y;){if(b.x>=u&&b.x<=g&&b.y>=p&&b.y<=m&&b!==n&&b!==o&&cs(a,l,c,d,h,f,b.x,b.y)&&rt(b.prev,b,b.next)>=0||(b=b.prevZ,w.x>=u&&w.x<=g&&w.y>=p&&w.y<=m&&w!==n&&w!==o&&cs(a,l,c,d,h,f,w.x,w.y)&&rt(w.prev,w,w.next)>=0))return!1;w=w.nextZ}for(;b&&b.z>=x;){if(b.x>=u&&b.x<=g&&b.y>=p&&b.y<=m&&b!==n&&b!==o&&cs(a,l,c,d,h,f,b.x,b.y)&&rt(b.prev,b,b.next)>=0)return!1;b=b.prevZ}for(;w&&w.z<=y;){if(w.x>=u&&w.x<=g&&w.y>=p&&w.y<=m&&w!==n&&w!==o&&cs(a,l,c,d,h,f,w.x,w.y)&&rt(w.prev,w,w.next)>=0)return!1;w=w.nextZ}return!0}function vh(s,t){let e=s;do{const r=e.prev,n=e.next.next;!je(r,n)&&va(r,e,e.next,n)&&xs(r,n)&&xs(n,r)&&(t.push(r.i,e.i,n.i),ys(e),ys(e.next),e=s=n),e=e.next}while(e!==s);return Fe(e)}function Ah(s,t,e,r,n,i){let o=s;do{let a=o.next.next;for(;a!==o.prev;){if(o.i!==a.i&&Bh(o,a)){let c=Aa(o,a);o=Fe(o,o.next),c=Fe(c,c.next),gs(o,t,e,r,n,i,0),gs(c,t,e,r,n,i,0);return}a=a.next}o=o.next}while(o!==s)}function Sh(s,t,e,r){const n=[];for(let i=0,o=t.length;i<o;i++){const a=t[i]*r,c=i<o-1?t[i+1]*r:s.length,h=wa(s,a,c,r,!1);h===h.next&&(h.steiner=!0),n.push(Ih(h))}n.sort(Ch);for(let i=0;i<n.length;i++)e=kh(n[i],e);return e}function Ch(s,t){let e=s.x-t.x;if(e===0&&(e=s.y-t.y,e===0)){const r=(s.next.y-s.y)/(s.next.x-s.x),n=(t.next.y-t.y)/(t.next.x-t.x);e=r-n}return e}function kh(s,t){const e=Ph(s,t);if(!e)return t;const r=Aa(e,s);return Fe(r,r.next),Fe(e,e.next)}function Ph(s,t){let e=t;const r=s.x,n=s.y;let i=-1/0,o;if(je(s,e))return e;do{if(je(s,e.next))return e.next;if(n<=e.y&&n>=e.next.y&&e.next.y!==e.y){const d=e.x+(n-e.y)*(e.next.x-e.x)/(e.next.y-e.y);if(d<=r&&d>i&&(i=d,o=e.x<e.next.x?e:e.next,d===r))return o}e=e.next}while(e!==t);if(!o)return null;const a=o,c=o.x,h=o.y;let l=1/0;e=o;do{if(r>=e.x&&e.x>=c&&r!==e.x&&_a(n<h?r:i,n,c,h,n<h?i:r,n,e.x,e.y)){const d=Math.abs(n-e.y)/(r-e.x);xs(e,s)&&(d<l||d===l&&(e.x>o.x||e.x===o.x&&Mh(o,e)))&&(o=e,l=d)}e=e.next}while(e!==a);return o}function Mh(s,t){return rt(s.prev,s,t.prev)<0&&rt(t.next,s,s.next)<0}function Th(s,t,e,r){let n=s;do n.z===0&&(n.z=ln(n.x,n.y,t,e,r)),n.prevZ=n.prev,n.nextZ=n.next,n=n.next;while(n!==s);n.prevZ.nextZ=null,n.prevZ=null,Eh(n)}function Eh(s){let t,e=1;do{let r=s,n;s=null;let i=null;for(t=0;r;){t++;let o=r,a=0;for(let h=0;h<e&&(a++,o=o.nextZ,!!o);h++);let c=e;for(;a>0||c>0&&o;)a!==0&&(c===0||!o||r.z<=o.z)?(n=r,r=r.nextZ,a--):(n=o,o=o.nextZ,c--),i?i.nextZ=n:s=n,n.prevZ=i,i=n;r=o}i.nextZ=null,e*=2}while(t>1);return s}function ln(s,t,e,r,n){return s=(s-e)*n|0,t=(t-r)*n|0,s=(s|s<<8)&16711935,s=(s|s<<4)&252645135,s=(s|s<<2)&858993459,s=(s|s<<1)&1431655765,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,t=(t|t<<1)&1431655765,s|t<<1}function Ih(s){let t=s,e=s;do(t.x<e.x||t.x===e.x&&t.y<e.y)&&(e=t),t=t.next;while(t!==s);return e}function _a(s,t,e,r,n,i,o,a){return(n-o)*(t-a)>=(s-o)*(i-a)&&(s-o)*(r-a)>=(e-o)*(t-a)&&(e-o)*(i-a)>=(n-o)*(r-a)}function cs(s,t,e,r,n,i,o,a){return!(s===o&&t===a)&&_a(s,t,e,r,n,i,o,a)}function Bh(s,t){return s.next.i!==t.i&&s.prev.i!==t.i&&!Fh(s,t)&&(xs(s,t)&&xs(t,s)&&Rh(s,t)&&(rt(s.prev,s,t.prev)||rt(s,t.prev,t))||je(s,t)&&rt(s.prev,s,s.next)>0&&rt(t.prev,t,t.next)>0)}function rt(s,t,e){return(t.y-s.y)*(e.x-t.x)-(t.x-s.x)*(e.y-t.y)}function je(s,t){return s.x===t.x&&s.y===t.y}function va(s,t,e,r){const n=Ms(rt(s,t,e)),i=Ms(rt(s,t,r)),o=Ms(rt(e,r,s)),a=Ms(rt(e,r,t));return!!(n!==i&&o!==a||n===0&&Ps(s,e,t)||i===0&&Ps(s,r,t)||o===0&&Ps(e,s,r)||a===0&&Ps(e,t,r))}function Ps(s,t,e){return t.x<=Math.max(s.x,e.x)&&t.x>=Math.min(s.x,e.x)&&t.y<=Math.max(s.y,e.y)&&t.y>=Math.min(s.y,e.y)}function Ms(s){return s>0?1:s<0?-1:0}function Fh(s,t){let e=s;do{if(e.i!==s.i&&e.next.i!==s.i&&e.i!==t.i&&e.next.i!==t.i&&va(e,e.next,s,t))return!0;e=e.next}while(e!==s);return!1}function xs(s,t){return rt(s.prev,s,s.next)<0?rt(s,t,s.next)>=0&&rt(s,s.prev,t)>=0:rt(s,t,s.prev)<0||rt(s,s.next,t)<0}function Rh(s,t){let e=s,r=!1;const n=(s.x+t.x)/2,i=(s.y+t.y)/2;do e.y>i!=e.next.y>i&&e.next.y!==e.y&&n<(e.next.x-e.x)*(i-e.y)/(e.next.y-e.y)+e.x&&(r=!r),e=e.next;while(e!==s);return r}function Aa(s,t){const e=hn(s.i,s.x,s.y),r=hn(t.i,t.x,t.y),n=s.next,i=t.prev;return s.next=t,t.prev=s,e.next=n,n.prev=e,r.next=e,e.prev=r,i.next=r,r.prev=i,r}function _i(s,t,e,r){const n=hn(s,t,e);return r?(n.next=r.next,n.prev=r,r.next.prev=n,r.next=n):(n.prev=n,n.next=n),n}function ys(s){s.next.prev=s.prev,s.prev.next=s.next,s.prevZ&&(s.prevZ.nextZ=s.nextZ),s.nextZ&&(s.nextZ.prevZ=s.prevZ)}function hn(s,t,e){return{i:s,x:t,y:e,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}function Lh(s,t,e,r){let n=0;for(let i=t,o=e-r;i<e;i+=r)n+=(s[o]-s[i])*(s[i+1]+s[o+1]),o=i;return n}const zh=wi.default||wi;var Sa=(s=>(s[s.NONE=0]="NONE",s[s.COLOR=16384]="COLOR",s[s.STENCIL=1024]="STENCIL",s[s.DEPTH=256]="DEPTH",s[s.COLOR_DEPTH=16640]="COLOR_DEPTH",s[s.COLOR_STENCIL=17408]="COLOR_STENCIL",s[s.DEPTH_STENCIL=1280]="DEPTH_STENCIL",s[s.ALL=17664]="ALL",s))(Sa||{});class Gh{constructor(t){this.items=[],this._name=t}emit(t,e,r,n,i,o,a,c){const{name:h,items:l}=this;for(let d=0,f=l.length;d<f;d++)l[d][h](t,e,r,n,i,o,a,c);return this}add(t){return t[this._name]&&(this.remove(t),this.items.push(t)),this}remove(t){const e=this.items.indexOf(t);return e!==-1&&this.items.splice(e,1),this}contains(t){return this.items.indexOf(t)!==-1}removeAll(){return this.items.length=0,this}destroy(){this.removeAll(),this.items=null,this._name=null}get empty(){return this.items.length===0}get name(){return this._name}}const Nh=["init","destroy","contextChange","resolutionChange","resetState","renderEnd","renderStart","render","update","postrender","prerender"],Ca=class ka extends Wt{constructor(t){super(),this.uid=ct("renderer"),this.runners=Object.create(null),this.renderPipes=Object.create(null),this._initOptions={},this._systemsHash=Object.create(null),this.type=t.type,this.name=t.name,this.config=t;const e=[...Nh,...this.config.runners??[]];this._addRunners(...e),this._unsafeEvalCheck()}async init(t={}){const e=t.skipExtensionImports===!0?!0:t.manageImports===!1;await yh(e),this._addSystems(this.config.systems),this._addPipes(this.config.renderPipes,this.config.renderPipeAdaptors);for(const r in this._systemsHash)t={...this._systemsHash[r].constructor.defaultOptions,...t};t={...ka.defaultOptions,...t},this._roundPixels=t.roundPixels?1:0;for(let r=0;r<this.runners.init.items.length;r++)await this.runners.init.items[r].init(t);this._initOptions=t}render(t,e){let r=t;if(r instanceof ut&&(r={container:r},e&&(Y(Q,"passing a second argument is deprecated, please use render options instead"),r.target=e.renderTexture)),r.target||(r.target=this.view.renderTarget),r.target===this.view.renderTarget&&(this._lastObjectRendered=r.container,r.clearColor??(r.clearColor=this.background.colorRgba),r.clear??(r.clear=this.background.clearBeforeRender)),r.clearColor){const n=Array.isArray(r.clearColor)&&r.clearColor.length===4;r.clearColor=n?r.clearColor:lt.shared.setValue(r.clearColor).toArray()}r.transform||(r.container.updateLocalTransform(),r.transform=r.container.localTransform),r.container.enableRenderGroup(),this.runners.prerender.emit(r),this.runners.renderStart.emit(r),this.runners.render.emit(r),this.runners.renderEnd.emit(r),this.runners.postrender.emit(r)}resize(t,e,r){const n=this.view.resolution;this.view.resize(t,e,r),this.emit("resize",this.view.screen.width,this.view.screen.height,this.view.resolution),r!==void 0&&r!==n&&this.runners.resolutionChange.emit(r)}clear(t={}){const e=this;t.target||(t.target=e.renderTarget.renderTarget),t.clearColor||(t.clearColor=this.background.colorRgba),t.clear??(t.clear=Sa.ALL);const{clear:r,clearColor:n,target:i}=t;lt.shared.setValue(n??this.background.colorRgba),e.renderTarget.clear(i,r,lt.shared.toArray())}get resolution(){return this.view.resolution}set resolution(t){this.view.resolution=t,this.runners.resolutionChange.emit(t)}get width(){return this.view.texture.frame.width}get height(){return this.view.texture.frame.height}get canvas(){return this.view.canvas}get lastObjectRendered(){return this._lastObjectRendered}get renderingToScreen(){return this.renderTarget.renderingToScreen}get screen(){return this.view.screen}_addRunners(...t){t.forEach(e=>{this.runners[e]=new Gh(e)})}_addSystems(t){let e;for(e in t){const r=t[e];this._addSystem(r.value,r.name)}}_addSystem(t,e){const r=new t(this);if(this[e])throw new Error(`Whoops! The name "${e}" is already in use`);this[e]=r,this._systemsHash[e]=r;for(const n in this.runners)this.runners[n].add(r);return this}_addPipes(t,e){const r=e.reduce((n,i)=>(n[i.name]=i.value,n),{});t.forEach(n=>{const i=n.value,o=n.name,a=r[o];this.renderPipes[o]=new i(this,a?new a:null)})}destroy(t=!1){this.runners.destroy.items.reverse(),this.runners.destroy.emit(t),Object.values(this.runners).forEach(e=>{e.destroy()}),this._systemsHash=null,this.renderPipes=null}generateTexture(t){return this.textureGenerator.generateTexture(t)}get roundPixels(){return!!this._roundPixels}_unsafeEvalCheck(){if(!bh())throw new Error("Current environment does not allow unsafe-eval, please use pixi.js/unsafe-eval module to enable support.")}resetState(){this.runners.resetState.emit()}};Ca.defaultOptions={resolution:1,failIfMajorPerformanceCaveat:!1,roundPixels:!1};let Pa=Ca,Ts;function Oh(s){return Ts!==void 0||(Ts=(()=>{var e;const t={stencil:!0,failIfMajorPerformanceCaveat:s??Pa.defaultOptions.failIfMajorPerformanceCaveat};try{if(!at.get().getWebGLRenderingContext())return!1;let n=at.get().createCanvas().getContext("webgl",t);const i=!!((e=n==null?void 0:n.getContextAttributes())!=null&&e.stencil);if(n){const o=n.getExtension("WEBGL_lose_context");o&&o.loseContext()}return n=null,i}catch{return!1}})()),Ts}let Es;async function Uh(s={}){return Es!==void 0||(Es=await(async()=>{const t=at.get().getNavigator().gpu;if(!t)return!1;try{return await(await t.requestAdapter(s)).requestDevice(),!0}catch{return!1}})()),Es}const vi=["webgl","webgpu","canvas"];async function Dh(s){let t=[];s.preference?(t.push(s.preference),vi.forEach(i=>{i!==s.preference&&t.push(i)})):t=vi.slice();let e,r={};for(let i=0;i<t.length;i++){const o=t[i];if(o==="webgpu"&&await Uh()){const{WebGPURenderer:a}=await js(async()=>{const{WebGPURenderer:c}=await import("./WebGPURenderer-BZJMV5Bs.js");return{WebGPURenderer:c}},__vite__mapDeps([4,2,5,3]));e=a,r={...s,...s.webgpu};break}else if(o==="webgl"&&Oh(s.failIfMajorPerformanceCaveat??Pa.defaultOptions.failIfMajorPerformanceCaveat)){const{WebGLRenderer:a}=await js(async()=>{const{WebGLRenderer:c}=await import("./WebGLRenderer-CGSR0raR.js");return{WebGLRenderer:c}},__vite__mapDeps([6,2,5,3]));e=a,r={...s,...s.webgl};break}else if(o==="canvas")throw r={...s},new Error("CanvasRenderer is not yet implemented")}if(delete r.webgpu,delete r.webgl,!e)throw new Error("No available renderer for the current environment");const n=new e;return await n.init(r),n}const Ma="8.10.1";class Ta{static init(){var t;(t=globalThis.__PIXI_APP_INIT__)==null||t.call(globalThis,this,Ma)}static destroy(){}}Ta.extension=O.Application;class Hh{constructor(t){this._renderer=t}init(){var t;(t=globalThis.__PIXI_RENDERER_INIT__)==null||t.call(globalThis,this._renderer,Ma)}destroy(){this._renderer=null}}Hh.extension={type:[O.WebGLSystem,O.WebGPUSystem],name:"initHook",priority:-10};const Ea=class dn{constructor(...t){this.stage=new ut,t[0]!==void 0&&Y(Q,"Application constructor options are deprecated, please use Application.init() instead.")}async init(t){t={...t},this.renderer=await Dh(t),dn._plugins.forEach(e=>{e.init.call(this,t)})}render(){this.renderer.render({container:this.stage})}get canvas(){return this.renderer.canvas}get view(){return Y(Q,"Application.view is deprecated, please use Application.canvas instead."),this.renderer.canvas}get screen(){return this.renderer.screen}destroy(t=!1,e=!1){const r=dn._plugins.slice(0);r.reverse(),r.forEach(n=>{n.destroy.call(this)}),this.stage.destroy(e),this.stage=null,this.renderer.destroy(t),this.renderer=null}};Ea._plugins=[];let Ia=Ea;pt.handleByList(O.Application,Ia._plugins);pt.add(Ta);class Ba extends Wt{constructor(){super(...arguments),this.chars=Object.create(null),this.lineHeight=0,this.fontFamily="",this.fontMetrics={fontSize:0,ascent:0,descent:0},this.baseLineOffset=0,this.distanceField={type:"none",range:0},this.pages=[],this.applyFillAsTint=!0,this.baseMeasurementFontSize=100,this.baseRenderedFontSize=100}get font(){return Y(Q,"BitmapFont.font is deprecated, please use BitmapFont.fontFamily instead."),this.fontFamily}get pageTextures(){return Y(Q,"BitmapFont.pageTextures is deprecated, please use BitmapFont.pages instead."),this.pages}get size(){return Y(Q,"BitmapFont.size is deprecated, please use BitmapFont.fontMetrics.fontSize instead."),this.fontMetrics.fontSize}get distanceFieldRange(){return Y(Q,"BitmapFont.distanceFieldRange is deprecated, please use BitmapFont.distanceField.range instead."),this.distanceField.range}get distanceFieldType(){return Y(Q,"BitmapFont.distanceFieldType is deprecated, please use BitmapFont.distanceField.type instead."),this.distanceField.type}destroy(t=!1){var e;this.emit("destroy",this),this.removeAllListeners();for(const r in this.chars)(e=this.chars[r].texture)==null||e.destroy();this.chars=null,t&&(this.pages.forEach(r=>r.texture.destroy(!0)),this.pages=null)}}const Wh=["serif","sans-serif","monospace","cursive","fantasy","system-ui"];function Ys(s){const t=typeof s.fontSize=="number"?`${s.fontSize}px`:s.fontSize;let e=s.fontFamily;Array.isArray(s.fontFamily)||(e=s.fontFamily.split(","));for(let r=e.length-1;r>=0;r--){let n=e[r].trim();!/([\"\'])[^\'\"]+\1/.test(n)&&!Wh.includes(n)&&(n=`"${n}"`),e[r]=n}return`${s.fontStyle} ${s.fontVariant} ${s.fontWeight} ${t} ${e.join(",")}`}const Tr={willReadFrequently:!0},Qt=class N{static get experimentalLetterSpacingSupported(){let t=N._experimentalLetterSpacingSupported;if(t===void 0){const e=at.get().getCanvasRenderingContext2D().prototype;t=N._experimentalLetterSpacingSupported="letterSpacing"in e||"textLetterSpacing"in e}return t}constructor(t,e,r,n,i,o,a,c,h){this.text=t,this.style=e,this.width=r,this.height=n,this.lines=i,this.lineWidths=o,this.lineHeight=a,this.maxLineWidth=c,this.fontProperties=h}static measureText(t=" ",e,r=N._canvas,n=e.wordWrap){var x;const i=Ys(e),o=N.measureFont(i);o.fontSize===0&&(o.fontSize=e.fontSize,o.ascent=e.fontSize);const a=N.__context;a.font=i;const h=(n?N._wordWrap(t,e,r):t).split(/(?:\r\n|\r|\n)/),l=new Array(h.length);let d=0;for(let y=0;y<h.length;y++){const b=N._measureText(h[y],e.letterSpacing,a);l[y]=b,d=Math.max(d,b)}const f=((x=e._stroke)==null?void 0:x.width)||0;let u=d+f;e.dropShadow&&(u+=e.dropShadow.distance);const p=e.lineHeight||o.fontSize;let g=Math.max(p,o.fontSize+f)+(h.length-1)*(p+e.leading);return e.dropShadow&&(g+=e.dropShadow.distance),new N(t,e,u,g,h,l,p+e.leading,d,o)}static _measureText(t,e,r){let n=!1;N.experimentalLetterSpacingSupported&&(N.experimentalLetterSpacing?(r.letterSpacing=`${e}px`,r.textLetterSpacing=`${e}px`,n=!0):(r.letterSpacing="0px",r.textLetterSpacing="0px"));const i=r.measureText(t);let o=i.width;const a=-i.actualBoundingBoxLeft;let h=i.actualBoundingBoxRight-a;if(o>0)if(n)o-=e,h-=e;else{const l=(N.graphemeSegmenter(t).length-1)*e;o+=l,h+=l}return Math.max(o,h)}static _wordWrap(t,e,r=N._canvas){const n=r.getContext("2d",Tr);let i=0,o="",a="";const c=Object.create(null),{letterSpacing:h,whiteSpace:l}=e,d=N._collapseSpaces(l),f=N._collapseNewlines(l);let u=!d;const p=e.wordWrapWidth+h,g=N._tokenize(t);for(let m=0;m<g.length;m++){let x=g[m];if(N._isNewline(x)){if(!f){a+=N._addLine(o),u=!d,o="",i=0;continue}x=" "}if(d){const b=N.isBreakingSpace(x),w=N.isBreakingSpace(o[o.length-1]);if(b&&w)continue}const y=N._getFromCache(x,h,c,n);if(y>p)if(o!==""&&(a+=N._addLine(o),o="",i=0),N.canBreakWords(x,e.breakWords)){const b=N.wordWrapSplit(x);for(let w=0;w<b.length;w++){let v=b[w],S=v,k=1;for(;b[w+k];){const _=b[w+k];if(!N.canBreakChars(S,_,x,w,e.breakWords))v+=_;else break;S=_,k++}w+=k-1;const P=N._getFromCache(v,h,c,n);P+i>p&&(a+=N._addLine(o),u=!1,o="",i=0),o+=v,i+=P}}else{o.length>0&&(a+=N._addLine(o),o="",i=0);const b=m===g.length-1;a+=N._addLine(x,!b),u=!1,o="",i=0}else y+i>p&&(u=!1,a+=N._addLine(o),o="",i=0),(o.length>0||!N.isBreakingSpace(x)||u)&&(o+=x,i+=y)}return a+=N._addLine(o,!1),a}static _addLine(t,e=!0){return t=N._trimRight(t),t=e?`${t}
`:t,t}static _getFromCache(t,e,r,n){let i=r[t];return typeof i!="number"&&(i=N._measureText(t,e,n)+e,r[t]=i),i}static _collapseSpaces(t){return t==="normal"||t==="pre-line"}static _collapseNewlines(t){return t==="normal"}static _trimRight(t){if(typeof t!="string")return"";for(let e=t.length-1;e>=0;e--){const r=t[e];if(!N.isBreakingSpace(r))break;t=t.slice(0,-1)}return t}static _isNewline(t){return typeof t!="string"?!1:N._newlines.includes(t.charCodeAt(0))}static isBreakingSpace(t,e){return typeof t!="string"?!1:N._breakingSpaces.includes(t.charCodeAt(0))}static _tokenize(t){const e=[];let r="";if(typeof t!="string")return e;for(let n=0;n<t.length;n++){const i=t[n],o=t[n+1];if(N.isBreakingSpace(i,o)||N._isNewline(i)){r!==""&&(e.push(r),r=""),e.push(i);continue}r+=i}return r!==""&&e.push(r),e}static canBreakWords(t,e){return e}static canBreakChars(t,e,r,n,i){return!0}static wordWrapSplit(t){return N.graphemeSegmenter(t)}static measureFont(t){if(N._fonts[t])return N._fonts[t];const e=N._context;e.font=t;const r=e.measureText(N.METRICS_STRING+N.BASELINE_SYMBOL),n={ascent:r.actualBoundingBoxAscent,descent:r.actualBoundingBoxDescent,fontSize:r.actualBoundingBoxAscent+r.actualBoundingBoxDescent};return N._fonts[t]=n,n}static clearMetrics(t=""){t?delete N._fonts[t]:N._fonts={}}static get _canvas(){if(!N.__canvas){let t;try{const e=new OffscreenCanvas(0,0),r=e.getContext("2d",Tr);if(r!=null&&r.measureText)return N.__canvas=e,e;t=at.get().createCanvas()}catch{t=at.get().createCanvas()}t.width=t.height=10,N.__canvas=t}return N.__canvas}static get _context(){return N.__context||(N.__context=N._canvas.getContext("2d",Tr)),N.__context}};Qt.METRICS_STRING="|ÉqÅ";Qt.BASELINE_SYMBOL="M";Qt.BASELINE_MULTIPLIER=1.4;Qt.HEIGHT_MULTIPLIER=2;Qt.graphemeSegmenter=(()=>{if(typeof(Intl==null?void 0:Intl.Segmenter)=="function"){const s=new Intl.Segmenter;return t=>{const e=s.segment(t),r=[];let n=0;for(const i of e)r[n++]=i.segment;return r}}return s=>[...s]})();Qt.experimentalLetterSpacing=!1;Qt._fonts={};Qt._newlines=[10,13];Qt._breakingSpaces=[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288];let qt=Qt;const Ai=[{offset:0,color:"white"},{offset:1,color:"black"}],In=class un{constructor(...t){this.uid=ct("fillGradient"),this.type="linear",this.colorStops=[];let e=jh(t);e={...e.type==="radial"?un.defaultRadialOptions:un.defaultLinearOptions,...No(e)},this._textureSize=e.textureSize,this._wrapMode=e.wrapMode,e.type==="radial"?(this.center=e.center,this.outerCenter=e.outerCenter??this.center,this.innerRadius=e.innerRadius,this.outerRadius=e.outerRadius,this.scale=e.scale,this.rotation=e.rotation):(this.start=e.start,this.end=e.end),this.textureSpace=e.textureSpace,this.type=e.type,e.colorStops.forEach(n=>{this.addColorStop(n.offset,n.color)})}addColorStop(t,e){return this.colorStops.push({offset:t,color:lt.shared.setValue(e).toHexa()}),this}buildLinearGradient(){if(this.texture)return;let{x:t,y:e}=this.start,{x:r,y:n}=this.end,i=r-t,o=n-e;const a=i<0||o<0;if(this._wrapMode==="clamp-to-edge"){if(i<0){const m=t;t=r,r=m,i*=-1}if(o<0){const m=e;e=n,n=m,o*=-1}}const c=this.colorStops.length?this.colorStops:Ai,h=this._textureSize,{canvas:l,context:d}=Ci(h,1),f=a?d.createLinearGradient(this._textureSize,0,0,0):d.createLinearGradient(0,0,this._textureSize,0);Si(f,c),d.fillStyle=f,d.fillRect(0,0,h,1),this.texture=new $({source:new Be({resource:l,addressMode:this._wrapMode})});const u=Math.sqrt(i*i+o*o),p=Math.atan2(o,i),g=new X;g.scale(u/h,1),g.rotate(p),g.translate(t,e),this.textureSpace==="local"&&g.scale(h,h),this.transform=g}buildGradient(){this.type==="linear"?this.buildLinearGradient():this.buildRadialGradient()}buildRadialGradient(){if(this.texture)return;const t=this.colorStops.length?this.colorStops:Ai,e=this._textureSize,{canvas:r,context:n}=Ci(e,e),{x:i,y:o}=this.center,{x:a,y:c}=this.outerCenter,h=this.innerRadius,l=this.outerRadius,d=a-l,f=c-l,u=e/(l*2),p=(i-d)*u,g=(o-f)*u,m=n.createRadialGradient(p,g,h*u,(a-d)*u,(c-f)*u,l*u);Si(m,t),n.fillStyle=t[t.length-1].color,n.fillRect(0,0,e,e),n.fillStyle=m,n.translate(p,g),n.rotate(this.rotation),n.scale(1,this.scale),n.translate(-p,-g),n.fillRect(0,0,e,e),this.texture=new $({source:new Be({resource:r,addressMode:this._wrapMode})});const x=new X;x.scale(1/u,1/u),x.translate(d,f),this.textureSpace==="local"&&x.scale(e,e),this.transform=x}get styleKey(){return this.uid}destroy(){var t;(t=this.texture)==null||t.destroy(!0),this.texture=null}};In.defaultLinearOptions={start:{x:0,y:0},end:{x:0,y:1},colorStops:[],textureSpace:"local",type:"linear",textureSize:256,wrapMode:"clamp-to-edge"};In.defaultRadialOptions={center:{x:.5,y:.5},innerRadius:0,outerRadius:.5,colorStops:[],scale:1,textureSpace:"local",type:"radial",textureSize:256,wrapMode:"clamp-to-edge"};let ce=In;function Si(s,t){for(let e=0;e<t.length;e++){const r=t[e];s.addColorStop(r.offset,r.color)}}function Ci(s,t){const e=at.get().createCanvas(s,t),r=e.getContext("2d");return{canvas:e,context:r}}function jh(s){let t=s[0]??{};return(typeof t=="number"||s[1])&&(Y("8.5.2","use options object instead"),t={type:"linear",start:{x:s[0],y:s[1]},end:{x:s[2],y:s[3]},textureSpace:s[4],textureSize:s[5]??ce.defaultLinearOptions.textureSize}),t}const ki={repeat:{addressModeU:"repeat",addressModeV:"repeat"},"repeat-x":{addressModeU:"repeat",addressModeV:"clamp-to-edge"},"repeat-y":{addressModeU:"clamp-to-edge",addressModeV:"repeat"},"no-repeat":{addressModeU:"clamp-to-edge",addressModeV:"clamp-to-edge"}};class or{constructor(t,e){this.uid=ct("fillPattern"),this.transform=new X,this._styleKey=null,this.texture=t,this.transform.scale(1/t.frame.width,1/t.frame.height),e&&(t.source.style.addressModeU=ki[e].addressModeU,t.source.style.addressModeV=ki[e].addressModeV)}setTransform(t){const e=this.texture;this.transform.copyFrom(t),this.transform.invert(),this.transform.scale(1/e.frame.width,1/e.frame.height),this._styleKey=null}get styleKey(){return this._styleKey?this._styleKey:(this._styleKey=`fill-pattern-${this.uid}-${this.texture.uid}-${this.transform.toArray().join("-")}`,this._styleKey)}}var Er,Pi;function $h(){if(Pi)return Er;Pi=1,Er=e;var s={a:7,c:6,h:1,l:2,m:2,q:4,s:4,t:2,v:1,z:0},t=/([astvzqmhlc])([^astvzqmhlc]*)/ig;function e(i){var o=[];return i.replace(t,function(a,c,h){var l=c.toLowerCase();for(h=n(h),l=="m"&&h.length>2&&(o.push([c].concat(h.splice(0,2))),l="l",c=c=="m"?"l":"L");;){if(h.length==s[l])return h.unshift(c),o.push(h);if(h.length<s[l])throw new Error("malformed path data");o.push([c].concat(h.splice(0,s[l])))}}),o}var r=/-?[0-9]*\.?[0-9]+(?:e[-+]?\d+)?/ig;function n(i){var o=i.match(r);return o?o.map(Number):[]}return Er}var Vh=$h();const Yh=Ro(Vh);function Xh(s,t){const e=Yh(s),r=[];let n=null,i=0,o=0;for(let a=0;a<e.length;a++){const c=e[a],h=c[0],l=c;switch(h){case"M":i=l[1],o=l[2],t.moveTo(i,o);break;case"m":i+=l[1],o+=l[2],t.moveTo(i,o);break;case"H":i=l[1],t.lineTo(i,o);break;case"h":i+=l[1],t.lineTo(i,o);break;case"V":o=l[1],t.lineTo(i,o);break;case"v":o+=l[1],t.lineTo(i,o);break;case"L":i=l[1],o=l[2],t.lineTo(i,o);break;case"l":i+=l[1],o+=l[2],t.lineTo(i,o);break;case"C":i=l[5],o=l[6],t.bezierCurveTo(l[1],l[2],l[3],l[4],i,o);break;case"c":t.bezierCurveTo(i+l[1],o+l[2],i+l[3],o+l[4],i+l[5],o+l[6]),i+=l[5],o+=l[6];break;case"S":i=l[3],o=l[4],t.bezierCurveToShort(l[1],l[2],i,o);break;case"s":t.bezierCurveToShort(i+l[1],o+l[2],i+l[3],o+l[4]),i+=l[3],o+=l[4];break;case"Q":i=l[3],o=l[4],t.quadraticCurveTo(l[1],l[2],i,o);break;case"q":t.quadraticCurveTo(i+l[1],o+l[2],i+l[3],o+l[4]),i+=l[3],o+=l[4];break;case"T":i=l[1],o=l[2],t.quadraticCurveToShort(i,o);break;case"t":i+=l[1],o+=l[2],t.quadraticCurveToShort(i,o);break;case"A":i=l[6],o=l[7],t.arcToSvg(l[1],l[2],l[3],l[4],l[5],i,o);break;case"a":i+=l[6],o+=l[7],t.arcToSvg(l[1],l[2],l[3],l[4],l[5],i,o);break;case"Z":case"z":t.closePath(),r.length>0&&(n=r.pop(),n?(i=n.startX,o=n.startY):(i=0,o=0)),n=null;break;default:ot(`Unknown SVG path command: ${h}`)}h!=="Z"&&h!=="z"&&n===null&&(n={startX:i,startY:o},r.push(n))}return t}class Bn{constructor(t=0,e=0,r=0){this.type="circle",this.x=t,this.y=e,this.radius=r}clone(){return new Bn(this.x,this.y,this.radius)}contains(t,e){if(this.radius<=0)return!1;const r=this.radius*this.radius;let n=this.x-t,i=this.y-e;return n*=n,i*=i,n+i<=r}strokeContains(t,e,r,n=.5){if(this.radius===0)return!1;const i=this.x-t,o=this.y-e,a=this.radius,c=(1-n)*r,h=Math.sqrt(i*i+o*o);return h<=a+c&&h>a-(r-c)}getBounds(t){return t||(t=new q),t.x=this.x-this.radius,t.y=this.y-this.radius,t.width=this.radius*2,t.height=this.radius*2,t}copyFrom(t){return this.x=t.x,this.y=t.y,this.radius=t.radius,this}copyTo(t){return t.copyFrom(this),t}toString(){return`[pixi.js/math:Circle x=${this.x} y=${this.y} radius=${this.radius}]`}}class Fn{constructor(t=0,e=0,r=0,n=0){this.type="ellipse",this.x=t,this.y=e,this.halfWidth=r,this.halfHeight=n}clone(){return new Fn(this.x,this.y,this.halfWidth,this.halfHeight)}contains(t,e){if(this.halfWidth<=0||this.halfHeight<=0)return!1;let r=(t-this.x)/this.halfWidth,n=(e-this.y)/this.halfHeight;return r*=r,n*=n,r+n<=1}strokeContains(t,e,r,n=.5){const{halfWidth:i,halfHeight:o}=this;if(i<=0||o<=0)return!1;const a=r*(1-n),c=r-a,h=i-c,l=o-c,d=i+a,f=o+a,u=t-this.x,p=e-this.y,g=u*u/(h*h)+p*p/(l*l),m=u*u/(d*d)+p*p/(f*f);return g>1&&m<=1}getBounds(t){return t||(t=new q),t.x=this.x-this.halfWidth,t.y=this.y-this.halfHeight,t.width=this.halfWidth*2,t.height=this.halfHeight*2,t}copyFrom(t){return this.x=t.x,this.y=t.y,this.halfWidth=t.halfWidth,this.halfHeight=t.halfHeight,this}copyTo(t){return t.copyFrom(this),t}toString(){return`[pixi.js/math:Ellipse x=${this.x} y=${this.y} halfWidth=${this.halfWidth} halfHeight=${this.halfHeight}]`}}function qh(s,t,e,r,n,i){const o=s-e,a=t-r,c=n-e,h=i-r,l=o*c+a*h,d=c*c+h*h;let f=-1;d!==0&&(f=l/d);let u,p;f<0?(u=e,p=r):f>1?(u=n,p=i):(u=e+f*c,p=r+f*h);const g=s-u,m=t-p;return g*g+m*m}let Kh,Zh;class hs{constructor(...t){this.type="polygon";let e=Array.isArray(t[0])?t[0]:t;if(typeof e[0]!="number"){const r=[];for(let n=0,i=e.length;n<i;n++)r.push(e[n].x,e[n].y);e=r}this.points=e,this.closePath=!0}isClockwise(){let t=0;const e=this.points,r=e.length;for(let n=0;n<r;n+=2){const i=e[n],o=e[n+1],a=e[(n+2)%r],c=e[(n+3)%r];t+=(a-i)*(c+o)}return t<0}containsPolygon(t){const e=this.getBounds(Kh),r=t.getBounds(Zh);if(!e.containsRect(r))return!1;const n=t.points;for(let i=0;i<n.length;i+=2){const o=n[i],a=n[i+1];if(!this.contains(o,a))return!1}return!0}clone(){const t=this.points.slice(),e=new hs(t);return e.closePath=this.closePath,e}contains(t,e){let r=!1;const n=this.points.length/2;for(let i=0,o=n-1;i<n;o=i++){const a=this.points[i*2],c=this.points[i*2+1],h=this.points[o*2],l=this.points[o*2+1];c>e!=l>e&&t<(h-a)*((e-c)/(l-c))+a&&(r=!r)}return r}strokeContains(t,e,r,n=.5){const i=r*r,o=i*(1-n),a=i-o,{points:c}=this,h=c.length-(this.closePath?0:2);for(let l=0;l<h;l+=2){const d=c[l],f=c[l+1],u=c[(l+2)%c.length],p=c[(l+3)%c.length],g=qh(t,e,d,f,u,p),m=Math.sign((u-d)*(e-f)-(p-f)*(t-d));if(g<=(m<0?a:o))return!0}return!1}getBounds(t){t||(t=new q);const e=this.points;let r=1/0,n=-1/0,i=1/0,o=-1/0;for(let a=0,c=e.length;a<c;a+=2){const h=e[a],l=e[a+1];r=h<r?h:r,n=h>n?h:n,i=l<i?l:i,o=l>o?l:o}return t.x=r,t.width=n-r,t.y=i,t.height=o-i,t}copyFrom(t){return this.points=t.points.slice(),this.closePath=t.closePath,this}copyTo(t){return t.copyFrom(this),t}toString(){return`[pixi.js/math:PolygoncloseStroke=${this.closePath}points=${this.points.reduce((t,e)=>`${t}, ${e}`,"")}]`}get lastX(){return this.points[this.points.length-2]}get lastY(){return this.points[this.points.length-1]}get x(){return this.points[this.points.length-2]}get y(){return this.points[this.points.length-1]}}const Is=(s,t,e,r,n,i,o)=>{const a=s-e,c=t-r,h=Math.sqrt(a*a+c*c);return h>=n-i&&h<=n+o};class Rn{constructor(t=0,e=0,r=0,n=0,i=20){this.type="roundedRectangle",this.x=t,this.y=e,this.width=r,this.height=n,this.radius=i}getBounds(t){return t||(t=new q),t.x=this.x,t.y=this.y,t.width=this.width,t.height=this.height,t}clone(){return new Rn(this.x,this.y,this.width,this.height,this.radius)}copyFrom(t){return this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height,this}copyTo(t){return t.copyFrom(this),t}contains(t,e){if(this.width<=0||this.height<=0)return!1;if(t>=this.x&&t<=this.x+this.width&&e>=this.y&&e<=this.y+this.height){const r=Math.max(0,Math.min(this.radius,Math.min(this.width,this.height)/2));if(e>=this.y+r&&e<=this.y+this.height-r||t>=this.x+r&&t<=this.x+this.width-r)return!0;let n=t-(this.x+r),i=e-(this.y+r);const o=r*r;if(n*n+i*i<=o||(n=t-(this.x+this.width-r),n*n+i*i<=o)||(i=e-(this.y+this.height-r),n*n+i*i<=o)||(n=t-(this.x+r),n*n+i*i<=o))return!0}return!1}strokeContains(t,e,r,n=.5){const{x:i,y:o,width:a,height:c,radius:h}=this,l=r*(1-n),d=r-l,f=i+h,u=o+h,p=a-h*2,g=c-h*2,m=i+a,x=o+c;return(t>=i-l&&t<=i+d||t>=m-d&&t<=m+l)&&e>=u&&e<=u+g||(e>=o-l&&e<=o+d||e>=x-d&&e<=x+l)&&t>=f&&t<=f+p?!0:t<f&&e<u&&Is(t,e,f,u,h,d,l)||t>m-h&&e<u&&Is(t,e,m-h,u,h,d,l)||t>m-h&&e>x-h&&Is(t,e,m-h,x-h,h,d,l)||t<f&&e>x-h&&Is(t,e,f,x-h,h,d,l)}toString(){return`[pixi.js/math:RoundedRectangle x=${this.x} y=${this.y}width=${this.width} height=${this.height} radius=${this.radius}]`}}const Fa={};function Qh(s,t,e){let r=2166136261;for(let n=0;n<t;n++)r^=s[n].uid,r=Math.imul(r,16777619),r>>>=0;return Fa[r]||Jh(s,t,r,e)}function Jh(s,t,e,r){const n={};let i=0;for(let a=0;a<r;a++){const c=a<t?s[a]:$.EMPTY.source;n[i++]=c.source,n[i++]=c.style}const o=new Ws(n);return Fa[e]=o,o}class Mi{constructor(t){typeof t=="number"?this.rawBinaryData=new ArrayBuffer(t):t instanceof Uint8Array?this.rawBinaryData=t.buffer:this.rawBinaryData=t,this.uint32View=new Uint32Array(this.rawBinaryData),this.float32View=new Float32Array(this.rawBinaryData),this.size=this.rawBinaryData.byteLength}get int8View(){return this._int8View||(this._int8View=new Int8Array(this.rawBinaryData)),this._int8View}get uint8View(){return this._uint8View||(this._uint8View=new Uint8Array(this.rawBinaryData)),this._uint8View}get int16View(){return this._int16View||(this._int16View=new Int16Array(this.rawBinaryData)),this._int16View}get int32View(){return this._int32View||(this._int32View=new Int32Array(this.rawBinaryData)),this._int32View}get float64View(){return this._float64Array||(this._float64Array=new Float64Array(this.rawBinaryData)),this._float64Array}get bigUint64View(){return this._bigUint64Array||(this._bigUint64Array=new BigUint64Array(this.rawBinaryData)),this._bigUint64Array}view(t){return this[`${t}View`]}destroy(){this.rawBinaryData=null,this._int8View=null,this._uint8View=null,this._int16View=null,this.uint16View=null,this._int32View=null,this.uint32View=null,this.float32View=null}static sizeOf(t){switch(t){case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;default:throw new Error(`${t} isn't a valid view type`)}}}function Ti(s,t){const e=s.byteLength/8|0,r=new Float64Array(s,0,e);new Float64Array(t,0,e).set(r);const i=s.byteLength-e*8;if(i>0){const o=new Uint8Array(s,e*8,i);new Uint8Array(t,e*8,i).set(o)}}const td={normal:"normal-npm",add:"add-npm",screen:"screen-npm"};var ed=(s=>(s[s.DISABLED=0]="DISABLED",s[s.RENDERING_MASK_ADD=1]="RENDERING_MASK_ADD",s[s.MASK_ACTIVE=2]="MASK_ACTIVE",s[s.INVERSE_MASK_ACTIVE=3]="INVERSE_MASK_ACTIVE",s[s.RENDERING_MASK_REMOVE=4]="RENDERING_MASK_REMOVE",s[s.NONE=5]="NONE",s))(ed||{});function Ei(s,t){return t.alphaMode==="no-premultiply-alpha"&&td[s]||s}const sd=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%","gl_FragColor = vec4(0.0);","}"].join(`
`);function rd(s){let t="";for(let e=0;e<s;++e)e>0&&(t+=`
else `),e<s-1&&(t+=`if(test == ${e}.0){}`);return t}function nd(s,t){if(s===0)throw new Error("Invalid value of `0` passed to `checkMaxIfStatementsInShader`");const e=t.createShader(t.FRAGMENT_SHADER);try{for(;;){const r=sd.replace(/%forloop%/gi,rd(s));if(t.shaderSource(e,r),t.compileShader(e),!t.getShaderParameter(e,t.COMPILE_STATUS))s=s/2|0;else break}}finally{t.deleteShader(e)}return s}let Le=null;function id(){var t;if(Le)return Le;const s=fa();return Le=s.getParameter(s.MAX_TEXTURE_IMAGE_UNITS),Le=nd(Le,s),(t=s.getExtension("WEBGL_lose_context"))==null||t.loseContext(),Le}class od{constructor(){this.ids=Object.create(null),this.textures=[],this.count=0}clear(){for(let t=0;t<this.count;t++){const e=this.textures[t];this.textures[t]=null,this.ids[e.uid]=null}this.count=0}}class ad{constructor(){this.renderPipeId="batch",this.action="startBatch",this.start=0,this.size=0,this.textures=new od,this.blendMode="normal",this.topology="triangle-strip",this.canBundle=!0}destroy(){this.textures=null,this.gpuBindGroup=null,this.bindGroup=null,this.batcher=null}}const Ra=[];let fn=0;function Ii(){return fn>0?Ra[--fn]:new ad}function Bi(s){Ra[fn++]=s}let es=0;const La=class za{constructor(t){this.uid=ct("batcher"),this.dirty=!0,this.batchIndex=0,this.batches=[],this._elements=[],t={...za.defaultOptions,...t},t.maxTextures||(Y("v8.8.0","maxTextures is a required option for Batcher now, please pass it in the options"),t.maxTextures=id());const{maxTextures:e,attributesInitialSize:r,indicesInitialSize:n}=t;this.attributeBuffer=new Mi(r*4),this.indexBuffer=new Uint16Array(n),this.maxTextures=e}begin(){this.elementSize=0,this.elementStart=0,this.indexSize=0,this.attributeSize=0;for(let t=0;t<this.batchIndex;t++)Bi(this.batches[t]);this.batchIndex=0,this._batchIndexStart=0,this._batchIndexSize=0,this.dirty=!0}add(t){this._elements[this.elementSize++]=t,t._indexStart=this.indexSize,t._attributeStart=this.attributeSize,t._batcher=this,this.indexSize+=t.indexSize,this.attributeSize+=t.attributeSize*this.vertexSize}checkAndUpdateTexture(t,e){const r=t._batch.textures.ids[e._source.uid];return!r&&r!==0?!1:(t._textureId=r,t.texture=e,!0)}updateElement(t){this.dirty=!0;const e=this.attributeBuffer;t.packAsQuad?this.packQuadAttributes(t,e.float32View,e.uint32View,t._attributeStart,t._textureId):this.packAttributes(t,e.float32View,e.uint32View,t._attributeStart,t._textureId)}break(t){const e=this._elements;if(!e[this.elementStart])return;let r=Ii(),n=r.textures;n.clear();const i=e[this.elementStart];let o=Ei(i.blendMode,i.texture._source),a=i.topology;this.attributeSize*4>this.attributeBuffer.size&&this._resizeAttributeBuffer(this.attributeSize*4),this.indexSize>this.indexBuffer.length&&this._resizeIndexBuffer(this.indexSize);const c=this.attributeBuffer.float32View,h=this.attributeBuffer.uint32View,l=this.indexBuffer;let d=this._batchIndexSize,f=this._batchIndexStart,u="startBatch";const p=this.maxTextures;for(let g=this.elementStart;g<this.elementSize;++g){const m=e[g];e[g]=null;const y=m.texture._source,b=Ei(m.blendMode,y),w=o!==b||a!==m.topology;if(y._batchTick===es&&!w){m._textureId=y._textureBindLocation,d+=m.indexSize,m.packAsQuad?(this.packQuadAttributes(m,c,h,m._attributeStart,m._textureId),this.packQuadIndex(l,m._indexStart,m._attributeStart/this.vertexSize)):(this.packAttributes(m,c,h,m._attributeStart,m._textureId),this.packIndex(m,l,m._indexStart,m._attributeStart/this.vertexSize)),m._batch=r;continue}y._batchTick=es,(n.count>=p||w)&&(this._finishBatch(r,f,d-f,n,o,a,t,u),u="renderBatch",f=d,o=b,a=m.topology,r=Ii(),n=r.textures,n.clear(),++es),m._textureId=y._textureBindLocation=n.count,n.ids[y.uid]=n.count,n.textures[n.count++]=y,m._batch=r,d+=m.indexSize,m.packAsQuad?(this.packQuadAttributes(m,c,h,m._attributeStart,m._textureId),this.packQuadIndex(l,m._indexStart,m._attributeStart/this.vertexSize)):(this.packAttributes(m,c,h,m._attributeStart,m._textureId),this.packIndex(m,l,m._indexStart,m._attributeStart/this.vertexSize))}n.count>0&&(this._finishBatch(r,f,d-f,n,o,a,t,u),f=d,++es),this.elementStart=this.elementSize,this._batchIndexStart=f,this._batchIndexSize=d}_finishBatch(t,e,r,n,i,o,a,c){t.gpuBindGroup=null,t.bindGroup=null,t.action=c,t.batcher=this,t.textures=n,t.blendMode=i,t.topology=o,t.start=e,t.size=r,++es,this.batches[this.batchIndex++]=t,a.add(t)}finish(t){this.break(t)}ensureAttributeBuffer(t){t*4<=this.attributeBuffer.size||this._resizeAttributeBuffer(t*4)}ensureIndexBuffer(t){t<=this.indexBuffer.length||this._resizeIndexBuffer(t)}_resizeAttributeBuffer(t){const e=Math.max(t,this.attributeBuffer.size*2),r=new Mi(e);Ti(this.attributeBuffer.rawBinaryData,r.rawBinaryData),this.attributeBuffer=r}_resizeIndexBuffer(t){const e=this.indexBuffer;let r=Math.max(t,e.length*1.5);r+=r%2;const n=r>65535?new Uint32Array(r):new Uint16Array(r);if(n.BYTES_PER_ELEMENT!==e.BYTES_PER_ELEMENT)for(let i=0;i<e.length;i++)n[i]=e[i];else Ti(e.buffer,n.buffer);this.indexBuffer=n}packQuadIndex(t,e,r){t[e]=r+0,t[e+1]=r+1,t[e+2]=r+2,t[e+3]=r+0,t[e+4]=r+2,t[e+5]=r+3}packIndex(t,e,r,n){const i=t.indices,o=t.indexSize,a=t.indexOffset,c=t.attributeOffset;for(let h=0;h<o;h++)e[r++]=n+i[h+a]-c}destroy(){for(let t=0;t<this.batches.length;t++)Bi(this.batches[t]);this.batches=null;for(let t=0;t<this._elements.length;t++)this._elements[t]._batch=null;this._elements=null,this.indexBuffer=null,this.attributeBuffer.destroy(),this.attributeBuffer=null}};La.defaultOptions={maxTextures:null,attributesInitialSize:4,indicesInitialSize:6};let cd=La;var _t=(s=>(s[s.MAP_READ=1]="MAP_READ",s[s.MAP_WRITE=2]="MAP_WRITE",s[s.COPY_SRC=4]="COPY_SRC",s[s.COPY_DST=8]="COPY_DST",s[s.INDEX=16]="INDEX",s[s.VERTEX=32]="VERTEX",s[s.UNIFORM=64]="UNIFORM",s[s.STORAGE=128]="STORAGE",s[s.INDIRECT=256]="INDIRECT",s[s.QUERY_RESOLVE=512]="QUERY_RESOLVE",s[s.STATIC=1024]="STATIC",s))(_t||{});class bs extends Wt{constructor(t){let{data:e,size:r}=t;const{usage:n,label:i,shrinkToFit:o}=t;super(),this.uid=ct("buffer"),this._resourceType="buffer",this._resourceId=ct("resource"),this._touched=0,this._updateID=1,this._dataInt32=null,this.shrinkToFit=!0,this.destroyed=!1,e instanceof Array&&(e=new Float32Array(e)),this._data=e,r??(r=e==null?void 0:e.byteLength);const a=!!e;this.descriptor={size:r,usage:n,mappedAtCreation:a,label:i},this.shrinkToFit=o??!0}get data(){return this._data}set data(t){this.setDataWithSize(t,t.length,!0)}get dataInt32(){return this._dataInt32||(this._dataInt32=new Int32Array(this.data.buffer)),this._dataInt32}get static(){return!!(this.descriptor.usage&_t.STATIC)}set static(t){t?this.descriptor.usage|=_t.STATIC:this.descriptor.usage&=~_t.STATIC}setDataWithSize(t,e,r){if(this._updateID++,this._updateSize=e*t.BYTES_PER_ELEMENT,this._data===t){r&&this.emit("update",this);return}const n=this._data;if(this._data=t,this._dataInt32=null,!n||n.length!==t.length){!this.shrinkToFit&&n&&t.byteLength<n.byteLength?r&&this.emit("update",this):(this.descriptor.size=t.byteLength,this._resourceId=ct("resource"),this.emit("change",this));return}r&&this.emit("update",this)}update(t){this._updateSize=t??this._updateSize,this._updateID++,this.emit("update",this)}destroy(){this.destroyed=!0,this.emit("destroy",this),this.emit("change",this),this._data=null,this.descriptor=null,this.removeAllListeners()}}function Ga(s,t){if(!(s instanceof bs)){let e=t?_t.INDEX:_t.VERTEX;s instanceof Array&&(t?(s=new Uint32Array(s),e=_t.INDEX|_t.COPY_DST):(s=new Float32Array(s),e=_t.VERTEX|_t.COPY_DST)),s=new bs({data:s,label:t?"index-mesh-buffer":"vertex-mesh-buffer",usage:e})}return s}function ld(s,t,e){const r=s.getAttribute(t);if(!r)return e.minX=0,e.minY=0,e.maxX=0,e.maxY=0,e;const n=r.buffer.data;let i=1/0,o=1/0,a=-1/0,c=-1/0;const h=n.BYTES_PER_ELEMENT,l=(r.offset||0)/h,d=(r.stride||2*4)/h;for(let f=l;f<n.length;f+=d){const u=n[f],p=n[f+1];u>a&&(a=u),p>c&&(c=p),u<i&&(i=u),p<o&&(o=p)}return e.minX=i,e.minY=o,e.maxX=a,e.maxY=c,e}function hd(s){return(s instanceof bs||Array.isArray(s)||s.BYTES_PER_ELEMENT)&&(s={buffer:s}),s.buffer=Ga(s.buffer,!1),s}class dd extends Wt{constructor(t={}){super(),this.uid=ct("geometry"),this._layoutKey=0,this.instanceCount=1,this._bounds=new Ht,this._boundsDirty=!0;const{attributes:e,indexBuffer:r,topology:n}=t;if(this.buffers=[],this.attributes={},e)for(const i in e)this.addAttribute(i,e[i]);this.instanceCount=t.instanceCount??1,r&&this.addIndex(r),this.topology=n||"triangle-list"}onBufferUpdate(){this._boundsDirty=!0,this.emit("update",this)}getAttribute(t){return this.attributes[t]}getIndex(){return this.indexBuffer}getBuffer(t){return this.getAttribute(t).buffer}getSize(){for(const t in this.attributes){const e=this.attributes[t];return e.buffer.data.length/(e.stride/4||e.size)}return 0}addAttribute(t,e){const r=hd(e);this.buffers.indexOf(r.buffer)===-1&&(this.buffers.push(r.buffer),r.buffer.on("update",this.onBufferUpdate,this),r.buffer.on("change",this.onBufferUpdate,this)),this.attributes[t]=r}addIndex(t){this.indexBuffer=Ga(t,!0),this.buffers.push(this.indexBuffer)}get bounds(){return this._boundsDirty?(this._boundsDirty=!1,ld(this,"aPosition",this._bounds)):this._bounds}destroy(t=!1){this.emit("destroy",this),this.removeAllListeners(),t&&this.buffers.forEach(e=>e.destroy()),this.attributes=null,this.buffers=null,this.indexBuffer=null,this._bounds=null}}const ud=new Float32Array(1),fd=new Uint32Array(1);class pd extends dd{constructor(){const e=new bs({data:ud,label:"attribute-batch-buffer",usage:_t.VERTEX|_t.COPY_DST,shrinkToFit:!1}),r=new bs({data:fd,label:"index-batch-buffer",usage:_t.INDEX|_t.COPY_DST,shrinkToFit:!1}),n=6*4;super({attributes:{aPosition:{buffer:e,format:"float32x2",stride:n,offset:0},aUV:{buffer:e,format:"float32x2",stride:n,offset:2*4},aColor:{buffer:e,format:"unorm8x4",stride:n,offset:4*4},aTextureIdAndRound:{buffer:e,format:"uint16x2",stride:n,offset:5*4}},indexBuffer:r})}}function Fi(s,t,e){if(s)for(const r in s){const n=r.toLocaleLowerCase(),i=t[n];if(i){let o=s[r];r==="header"&&(o=o.replace(/@in\s+[^;]+;\s*/g,"").replace(/@out\s+[^;]+;\s*/g,"")),e&&i.push(`//----${e}----//`),i.push(o)}else ot(`${r} placement hook does not exist in shader`)}}const md=/\{\{(.*?)\}\}/g;function Ri(s){var r;const t={};return(((r=s.match(md))==null?void 0:r.map(n=>n.replace(/[{()}]/g,"")))??[]).forEach(n=>{t[n]=[]}),t}function Li(s,t){let e;const r=/@in\s+([^;]+);/g;for(;(e=r.exec(s))!==null;)t.push(e[1])}function zi(s,t,e=!1){const r=[];Li(t,r),s.forEach(a=>{a.header&&Li(a.header,r)});const n=r;e&&n.sort();const i=n.map((a,c)=>`       @location(${c}) ${a},`).join(`
`);let o=t.replace(/@in\s+[^;]+;\s*/g,"");return o=o.replace("{{in}}",`
${i}
`),o}function Gi(s,t){let e;const r=/@out\s+([^;]+);/g;for(;(e=r.exec(s))!==null;)t.push(e[1])}function gd(s){const e=/\b(\w+)\s*:/g.exec(s);return e?e[1]:""}function xd(s){const t=/@.*?\s+/g;return s.replace(t,"")}function yd(s,t){const e=[];Gi(t,e),s.forEach(c=>{c.header&&Gi(c.header,e)});let r=0;const n=e.sort().map(c=>c.indexOf("builtin")>-1?c:`@location(${r++}) ${c}`).join(`,
`),i=e.sort().map(c=>`       var ${xd(c)};`).join(`
`),o=`return VSOutput(
            ${e.sort().map(c=>` ${gd(c)}`).join(`,
`)});`;let a=t.replace(/@out\s+[^;]+;\s*/g,"");return a=a.replace("{{struct}}",`
${n}
`),a=a.replace("{{start}}",`
${i}
`),a=a.replace("{{return}}",`
${o}
`),a}function Ni(s,t){let e=s;for(const r in t){const n=t[r];n.join(`
`).length?e=e.replace(`{{${r}}}`,`//-----${r} START-----//
${n.join(`
`)}
//----${r} FINISH----//`):e=e.replace(`{{${r}}}`,"")}return e}const pe=Object.create(null),Ir=new Map;let bd=0;function wd({template:s,bits:t}){const e=Na(s,t);if(pe[e])return pe[e];const{vertex:r,fragment:n}=vd(s,t);return pe[e]=Oa(r,n,t),pe[e]}function _d({template:s,bits:t}){const e=Na(s,t);return pe[e]||(pe[e]=Oa(s.vertex,s.fragment,t)),pe[e]}function vd(s,t){const e=t.map(o=>o.vertex).filter(o=>!!o),r=t.map(o=>o.fragment).filter(o=>!!o);let n=zi(e,s.vertex,!0);n=yd(e,n);const i=zi(r,s.fragment,!0);return{vertex:n,fragment:i}}function Na(s,t){return t.map(e=>(Ir.has(e)||Ir.set(e,bd++),Ir.get(e))).sort((e,r)=>e-r).join("-")+s.vertex+s.fragment}function Oa(s,t,e){const r=Ri(s),n=Ri(t);return e.forEach(i=>{Fi(i.vertex,r,i.name),Fi(i.fragment,n,i.name)}),{vertex:Ni(s,r),fragment:Ni(t,n)}}const Ad=`
    @in aPosition: vec2<f32>;
    @in aUV: vec2<f32>;

    @out @builtin(position) vPosition: vec4<f32>;
    @out vUV : vec2<f32>;
    @out vColor : vec4<f32>;

    {{header}}

    struct VSOutput {
        {{struct}}
    };

    @vertex
    fn main( {{in}} ) -> VSOutput {

        var worldTransformMatrix = globalUniforms.uWorldTransformMatrix;
        var modelMatrix = mat3x3<f32>(
            1.0, 0.0, 0.0,
            0.0, 1.0, 0.0,
            0.0, 0.0, 1.0
          );
        var position = aPosition;
        var uv = aUV;

        {{start}}

        vColor = vec4<f32>(1., 1., 1., 1.);

        {{main}}

        vUV = uv;

        var modelViewProjectionMatrix = globalUniforms.uProjectionMatrix * worldTransformMatrix * modelMatrix;

        vPosition =  vec4<f32>((modelViewProjectionMatrix *  vec3<f32>(position, 1.0)).xy, 0.0, 1.0);

        vColor *= globalUniforms.uWorldColorAlpha;

        {{end}}

        {{return}}
    };
`,Sd=`
    @in vUV : vec2<f32>;
    @in vColor : vec4<f32>;

    {{header}}

    @fragment
    fn main(
        {{in}}
      ) -> @location(0) vec4<f32> {

        {{start}}

        var outColor:vec4<f32>;

        {{main}}

        var finalColor:vec4<f32> = outColor * vColor;

        {{end}}

        return finalColor;
      };
`,Cd=`
    in vec2 aPosition;
    in vec2 aUV;

    out vec4 vColor;
    out vec2 vUV;

    {{header}}

    void main(void){

        mat3 worldTransformMatrix = uWorldTransformMatrix;
        mat3 modelMatrix = mat3(
            1.0, 0.0, 0.0,
            0.0, 1.0, 0.0,
            0.0, 0.0, 1.0
          );
        vec2 position = aPosition;
        vec2 uv = aUV;

        {{start}}

        vColor = vec4(1.);

        {{main}}

        vUV = uv;

        mat3 modelViewProjectionMatrix = uProjectionMatrix * worldTransformMatrix * modelMatrix;

        gl_Position = vec4((modelViewProjectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);

        vColor *= uWorldColorAlpha;

        {{end}}
    }
`,kd=`

    in vec4 vColor;
    in vec2 vUV;

    out vec4 finalColor;

    {{header}}

    void main(void) {

        {{start}}

        vec4 outColor;

        {{main}}

        finalColor = outColor * vColor;

        {{end}}
    }
`,Pd={name:"global-uniforms-bit",vertex:{header:`
        struct GlobalUniforms {
            uProjectionMatrix:mat3x3<f32>,
            uWorldTransformMatrix:mat3x3<f32>,
            uWorldColorAlpha: vec4<f32>,
            uResolution: vec2<f32>,
        }

        @group(0) @binding(0) var<uniform> globalUniforms : GlobalUniforms;
        `}},Md={name:"global-uniforms-bit",vertex:{header:`
          uniform mat3 uProjectionMatrix;
          uniform mat3 uWorldTransformMatrix;
          uniform vec4 uWorldColorAlpha;
          uniform vec2 uResolution;
        `}};function Td({bits:s,name:t}){const e=wd({template:{fragment:Sd,vertex:Ad},bits:[Pd,...s]});return ir.from({name:t,vertex:{source:e.vertex,entryPoint:"main"},fragment:{source:e.fragment,entryPoint:"main"}})}function Ed({bits:s,name:t}){return new ma({name:t,..._d({template:{vertex:Cd,fragment:kd},bits:[Md,...s]})})}const Id={name:"color-bit",vertex:{header:`
            @in aColor: vec4<f32>;
        `,main:`
            vColor *= vec4<f32>(aColor.rgb * aColor.a, aColor.a);
        `}},Bd={name:"color-bit",vertex:{header:`
            in vec4 aColor;
        `,main:`
            vColor *= vec4(aColor.rgb * aColor.a, aColor.a);
        `}},Br={};function Fd(s){const t=[];if(s===1)t.push("@group(1) @binding(0) var textureSource1: texture_2d<f32>;"),t.push("@group(1) @binding(1) var textureSampler1: sampler;");else{let e=0;for(let r=0;r<s;r++)t.push(`@group(1) @binding(${e++}) var textureSource${r+1}: texture_2d<f32>;`),t.push(`@group(1) @binding(${e++}) var textureSampler${r+1}: sampler;`)}return t.join(`
`)}function Rd(s){const t=[];if(s===1)t.push("outColor = textureSampleGrad(textureSource1, textureSampler1, vUV, uvDx, uvDy);");else{t.push("switch vTextureId {");for(let e=0;e<s;e++)e===s-1?t.push("  default:{"):t.push(`  case ${e}:{`),t.push(`      outColor = textureSampleGrad(textureSource${e+1}, textureSampler${e+1}, vUV, uvDx, uvDy);`),t.push("      break;}");t.push("}")}return t.join(`
`)}function Ld(s){return Br[s]||(Br[s]={name:"texture-batch-bit",vertex:{header:`
                @in aTextureIdAndRound: vec2<u32>;
                @out @interpolate(flat) vTextureId : u32;
            `,main:`
                vTextureId = aTextureIdAndRound.y;
            `,end:`
                if(aTextureIdAndRound.x == 1)
                {
                    vPosition = vec4<f32>(roundPixels(vPosition.xy, globalUniforms.uResolution), vPosition.zw);
                }
            `},fragment:{header:`
                @in @interpolate(flat) vTextureId: u32;

                ${Fd(s)}
            `,main:`
                var uvDx = dpdx(vUV);
                var uvDy = dpdy(vUV);

                ${Rd(s)}
            `}}),Br[s]}const Fr={};function zd(s){const t=[];for(let e=0;e<s;e++)e>0&&t.push("else"),e<s-1&&t.push(`if(vTextureId < ${e}.5)`),t.push("{"),t.push(`	outColor = texture(uTextures[${e}], vUV);`),t.push("}");return t.join(`
`)}function Gd(s){return Fr[s]||(Fr[s]={name:"texture-batch-bit",vertex:{header:`
                in vec2 aTextureIdAndRound;
                out float vTextureId;

            `,main:`
                vTextureId = aTextureIdAndRound.y;
            `,end:`
                if(aTextureIdAndRound.x == 1.)
                {
                    gl_Position.xy = roundPixels(gl_Position.xy, uResolution);
                }
            `},fragment:{header:`
                in float vTextureId;

                uniform sampler2D uTextures[${s}];

            `,main:`

                ${zd(s)}
            `}}),Fr[s]}const Nd={name:"round-pixels-bit",vertex:{header:`
            fn roundPixels(position: vec2<f32>, targetSize: vec2<f32>) -> vec2<f32>
            {
                return (floor(((position * 0.5 + 0.5) * targetSize) + 0.5) / targetSize) * 2.0 - 1.0;
            }
        `}},Od={name:"round-pixels-bit",vertex:{header:`
            vec2 roundPixels(vec2 position, vec2 targetSize)
            {
                return (floor(((position * 0.5 + 0.5) * targetSize) + 0.5) / targetSize) * 2.0 - 1.0;
            }
        `}},Oi={};function Ud(s){let t=Oi[s];if(t)return t;const e=new Int32Array(s);for(let r=0;r<s;r++)e[r]=r;return t=Oi[s]=new ba({uTextures:{value:e,type:"i32",size:s}},{isStatic:!0}),t}class Dd extends En{constructor(t){const e=Ed({name:"batch",bits:[Bd,Gd(t),Od]}),r=Td({name:"batch",bits:[Id,Ld(t),Nd]});super({glProgram:e,gpuProgram:r,resources:{batchSamplers:Ud(t)}})}}let Rr=null;const Ua=class Da extends cd{constructor(t){super(t),this.geometry=new pd,this.name=Da.extension.name,this.vertexSize=6,Rr??(Rr=new Dd(t.maxTextures)),this.shader=Rr}packAttributes(t,e,r,n,i){const o=i<<16|t.roundPixels&65535,a=t.transform,c=a.a,h=a.b,l=a.c,d=a.d,f=a.tx,u=a.ty,{positions:p,uvs:g}=t,m=t.color,x=t.attributeOffset,y=x+t.attributeSize;for(let b=x;b<y;b++){const w=b*2,v=p[w],S=p[w+1];e[n++]=c*v+l*S+f,e[n++]=d*S+h*v+u,e[n++]=g[w],e[n++]=g[w+1],r[n++]=m,r[n++]=o}}packQuadAttributes(t,e,r,n,i){const o=t.texture,a=t.transform,c=a.a,h=a.b,l=a.c,d=a.d,f=a.tx,u=a.ty,p=t.bounds,g=p.maxX,m=p.minX,x=p.maxY,y=p.minY,b=o.uvs,w=t.color,v=i<<16|t.roundPixels&65535;e[n+0]=c*m+l*y+f,e[n+1]=d*y+h*m+u,e[n+2]=b.x0,e[n+3]=b.y0,r[n+4]=w,r[n+5]=v,e[n+6]=c*g+l*y+f,e[n+7]=d*y+h*g+u,e[n+8]=b.x1,e[n+9]=b.y1,r[n+10]=w,r[n+11]=v,e[n+12]=c*g+l*x+f,e[n+13]=d*x+h*g+u,e[n+14]=b.x2,e[n+15]=b.y2,r[n+16]=w,r[n+17]=v,e[n+18]=c*m+l*x+f,e[n+19]=d*x+h*m+u,e[n+20]=b.x3,e[n+21]=b.y3,r[n+22]=w,r[n+23]=v}};Ua.extension={type:[O.Batcher],name:"default"};let Hd=Ua;function Wd(s,t,e,r,n,i,o,a=null){let c=0;e*=t,n*=i;const h=a.a,l=a.b,d=a.c,f=a.d,u=a.tx,p=a.ty;for(;c<o;){const g=s[e],m=s[e+1];r[n]=h*g+d*m+u,r[n+1]=l*g+f*m+p,n+=i,e+=t,c++}}function jd(s,t,e,r){let n=0;for(t*=e;n<r;)s[t]=0,s[t+1]=0,t+=e,n++}function Ha(s,t,e,r,n){const i=t.a,o=t.b,a=t.c,c=t.d,h=t.tx,l=t.ty;e||(e=0),r||(r=2),n||(n=s.length/r-e);let d=e*r;for(let f=0;f<n;f++){const u=s[d],p=s[d+1];s[d]=i*u+a*p+h,s[d+1]=o*u+c*p+l,d+=r}}const $d=new X;class Wa{constructor(){this.packAsQuad=!1,this.batcherName="default",this.topology="triangle-list",this.applyTransform=!0,this.roundPixels=0,this._batcher=null,this._batch=null}get uvs(){return this.geometryData.uvs}get positions(){return this.geometryData.vertices}get indices(){return this.geometryData.indices}get blendMode(){return this.renderable&&this.applyTransform?this.renderable.groupBlendMode:"normal"}get color(){const t=this.baseColor,e=t>>16|t&65280|(t&255)<<16,r=this.renderable;return r?Xo(e,r.groupColor)+(this.alpha*r.groupAlpha*255<<24):e+(this.alpha*255<<24)}get transform(){var t;return((t=this.renderable)==null?void 0:t.groupTransform)||$d}copyTo(t){t.indexOffset=this.indexOffset,t.indexSize=this.indexSize,t.attributeOffset=this.attributeOffset,t.attributeSize=this.attributeSize,t.baseColor=this.baseColor,t.alpha=this.alpha,t.texture=this.texture,t.geometryData=this.geometryData,t.topology=this.topology}reset(){this.applyTransform=!0,this.renderable=null,this.topology="triangle-list"}}const ws={extension:{type:O.ShapeBuilder,name:"circle"},build(s,t){let e,r,n,i,o,a;if(s.type==="circle"){const w=s;if(o=a=w.radius,o<=0)return!1;e=w.x,r=w.y,n=i=0}else if(s.type==="ellipse"){const w=s;if(o=w.halfWidth,a=w.halfHeight,o<=0||a<=0)return!1;e=w.x,r=w.y,n=i=0}else{const w=s,v=w.width/2,S=w.height/2;e=w.x+v,r=w.y+S,o=a=Math.max(0,Math.min(w.radius,Math.min(v,S))),n=v-o,i=S-a}if(n<0||i<0)return!1;const c=Math.ceil(2.3*Math.sqrt(o+a)),h=c*8+(n?4:0)+(i?4:0);if(h===0)return!1;if(c===0)return t[0]=t[6]=e+n,t[1]=t[3]=r+i,t[2]=t[4]=e-n,t[5]=t[7]=r-i,!0;let l=0,d=c*4+(n?2:0)+2,f=d,u=h,p=n+o,g=i,m=e+p,x=e-p,y=r+g;if(t[l++]=m,t[l++]=y,t[--d]=y,t[--d]=x,i){const w=r-g;t[f++]=x,t[f++]=w,t[--u]=w,t[--u]=m}for(let w=1;w<c;w++){const v=Math.PI/2*(w/c),S=n+Math.cos(v)*o,k=i+Math.sin(v)*a,P=e+S,_=e-S,C=r+k,A=r-k;t[l++]=P,t[l++]=C,t[--d]=C,t[--d]=_,t[f++]=_,t[f++]=A,t[--u]=A,t[--u]=P}p=n,g=i+a,m=e+p,x=e-p,y=r+g;const b=r-g;return t[l++]=m,t[l++]=y,t[--u]=b,t[--u]=m,n&&(t[l++]=x,t[l++]=y,t[--u]=b,t[--u]=x),!0},triangulate(s,t,e,r,n,i){if(s.length===0)return;let o=0,a=0;for(let l=0;l<s.length;l+=2)o+=s[l],a+=s[l+1];o/=s.length/2,a/=s.length/2;let c=r;t[c*e]=o,t[c*e+1]=a;const h=c++;for(let l=0;l<s.length;l+=2)t[c*e]=s[l],t[c*e+1]=s[l+1],l>0&&(n[i++]=c,n[i++]=h,n[i++]=c-1),c++;n[i++]=h+1,n[i++]=h,n[i++]=c-1}},Vd={...ws,extension:{...ws.extension,name:"ellipse"}},Yd={...ws,extension:{...ws.extension,name:"roundedRectangle"}},ja=1e-4,Ui=1e-4;function Xd(s){const t=s.length;if(t<6)return 1;let e=0;for(let r=0,n=s[t-2],i=s[t-1];r<t;r+=2){const o=s[r],a=s[r+1];e+=(o-n)*(a+i),n=o,i=a}return e<0?-1:1}function Di(s,t,e,r,n,i,o,a){const c=s-e*n,h=t-r*n,l=s+e*i,d=t+r*i;let f,u;o?(f=r,u=-e):(f=-r,u=e);const p=c+f,g=h+u,m=l+f,x=d+u;return a.push(p,g),a.push(m,x),2}function we(s,t,e,r,n,i,o,a){const c=e-s,h=r-t;let l=Math.atan2(c,h),d=Math.atan2(n-s,i-t);a&&l<d?l+=Math.PI*2:!a&&l>d&&(d+=Math.PI*2);let f=l;const u=d-l,p=Math.abs(u),g=Math.sqrt(c*c+h*h),m=(15*p*Math.sqrt(g)/Math.PI>>0)+1,x=u/m;if(f+=x,a){o.push(s,t),o.push(e,r);for(let y=1,b=f;y<m;y++,b+=x)o.push(s,t),o.push(s+Math.sin(b)*g,t+Math.cos(b)*g);o.push(s,t),o.push(n,i)}else{o.push(e,r),o.push(s,t);for(let y=1,b=f;y<m;y++,b+=x)o.push(s+Math.sin(b)*g,t+Math.cos(b)*g),o.push(s,t);o.push(n,i),o.push(s,t)}return m*2}function qd(s,t,e,r,n,i){const o=ja;if(s.length===0)return;const a=t;let c=a.alignment;if(t.alignment!==.5){let D=Xd(s);c=(c-.5)*D+.5}const h=new mt(s[0],s[1]),l=new mt(s[s.length-2],s[s.length-1]),d=r,f=Math.abs(h.x-l.x)<o&&Math.abs(h.y-l.y)<o;if(d){s=s.slice(),f&&(s.pop(),s.pop(),l.set(s[s.length-2],s[s.length-1]));const D=(h.x+l.x)*.5,W=(l.y+h.y)*.5;s.unshift(D,W),s.push(D,W)}const u=n,p=s.length/2;let g=s.length;const m=u.length/2,x=a.width/2,y=x*x,b=a.miterLimit*a.miterLimit;let w=s[0],v=s[1],S=s[2],k=s[3],P=0,_=0,C=-(v-k),A=w-S,M=0,E=0,F=Math.sqrt(C*C+A*A);C/=F,A/=F,C*=x,A*=x;const R=c,T=(1-R)*2,I=R*2;d||(a.cap==="round"?g+=we(w-C*(T-I)*.5,v-A*(T-I)*.5,w-C*T,v-A*T,w+C*I,v+A*I,u,!0)+2:a.cap==="square"&&(g+=Di(w,v,C,A,T,I,!0,u))),u.push(w-C*T,v-A*T),u.push(w+C*I,v+A*I);for(let D=1;D<p-1;++D){w=s[(D-1)*2],v=s[(D-1)*2+1],S=s[D*2],k=s[D*2+1],P=s[(D+1)*2],_=s[(D+1)*2+1],C=-(v-k),A=w-S,F=Math.sqrt(C*C+A*A),C/=F,A/=F,C*=x,A*=x,M=-(k-_),E=S-P,F=Math.sqrt(M*M+E*E),M/=F,E/=F,M*=x,E*=x;const W=S-w,U=v-k,Z=S-P,H=_-k,K=W*Z+U*H,V=U*Z-H*W,et=V<0;if(Math.abs(V)<.001*Math.abs(K)){u.push(S-C*T,k-A*T),u.push(S+C*I,k+A*I),K>=0&&(a.join==="round"?g+=we(S,k,S-C*T,k-A*T,S-M*T,k-E*T,u,!1)+4:g+=2,u.push(S-M*I,k-E*I),u.push(S+M*T,k+E*T));continue}const J=(-C+w)*(-A+k)-(-C+S)*(-A+v),Mt=(-M+P)*(-E+k)-(-M+S)*(-E+_),ft=(W*Mt-Z*J)/V,St=(H*J-U*Mt)/V,bt=(ft-S)*(ft-S)+(St-k)*(St-k),Tt=S+(ft-S)*T,xe=k+(St-k)*T,ye=S-(ft-S)*I,be=k-(St-k)*I,jc=Math.min(W*W+U*U,Z*Z+H*H),Kn=et?T:I,$c=jc+Kn*Kn*y;bt<=$c?a.join==="bevel"||bt/y>b?(et?(u.push(Tt,xe),u.push(S+C*I,k+A*I),u.push(Tt,xe),u.push(S+M*I,k+E*I)):(u.push(S-C*T,k-A*T),u.push(ye,be),u.push(S-M*T,k-E*T),u.push(ye,be)),g+=2):a.join==="round"?et?(u.push(Tt,xe),u.push(S+C*I,k+A*I),g+=we(S,k,S+C*I,k+A*I,S+M*I,k+E*I,u,!0)+4,u.push(Tt,xe),u.push(S+M*I,k+E*I)):(u.push(S-C*T,k-A*T),u.push(ye,be),g+=we(S,k,S-C*T,k-A*T,S-M*T,k-E*T,u,!1)+4,u.push(S-M*T,k-E*T),u.push(ye,be)):(u.push(Tt,xe),u.push(ye,be)):(u.push(S-C*T,k-A*T),u.push(S+C*I,k+A*I),a.join==="round"?et?g+=we(S,k,S+C*I,k+A*I,S+M*I,k+E*I,u,!0)+2:g+=we(S,k,S-C*T,k-A*T,S-M*T,k-E*T,u,!1)+2:a.join==="miter"&&bt/y<=b&&(et?(u.push(ye,be),u.push(ye,be)):(u.push(Tt,xe),u.push(Tt,xe)),g+=2),u.push(S-M*T,k-E*T),u.push(S+M*I,k+E*I),g+=2)}w=s[(p-2)*2],v=s[(p-2)*2+1],S=s[(p-1)*2],k=s[(p-1)*2+1],C=-(v-k),A=w-S,F=Math.sqrt(C*C+A*A),C/=F,A/=F,C*=x,A*=x,u.push(S-C*T,k-A*T),u.push(S+C*I,k+A*I),d||(a.cap==="round"?g+=we(S-C*(T-I)*.5,k-A*(T-I)*.5,S-C*T,k-A*T,S+C*I,k+A*I,u,!1)+2:a.cap==="square"&&(g+=Di(S,k,C,A,T,I,!1,u)));const B=Ui*Ui;for(let D=m;D<g+m-2;++D)w=u[D*2],v=u[D*2+1],S=u[(D+1)*2],k=u[(D+1)*2+1],P=u[(D+2)*2],_=u[(D+2)*2+1],!(Math.abs(w*(k-_)+S*(_-v)+P*(v-k))<B)&&i.push(D,D+1,D+2)}function Kd(s,t,e,r){const n=ja;if(s.length===0)return;const i=s[0],o=s[1],a=s[s.length-2],c=s[s.length-1],h=t||Math.abs(i-a)<n&&Math.abs(o-c)<n,l=e,d=s.length/2,f=l.length/2;for(let u=0;u<d;u++)l.push(s[u*2]),l.push(s[u*2+1]);for(let u=0;u<d-1;u++)r.push(f+u,f+u+1);h&&r.push(f+d-1,f)}function $a(s,t,e,r,n,i,o){const a=zh(s,t,2);if(!a)return;for(let h=0;h<a.length;h+=3)i[o++]=a[h]+n,i[o++]=a[h+1]+n,i[o++]=a[h+2]+n;let c=n*r;for(let h=0;h<s.length;h+=2)e[c]=s[h],e[c+1]=s[h+1],c+=r}const Zd=[],Qd={extension:{type:O.ShapeBuilder,name:"polygon"},build(s,t){for(let e=0;e<s.points.length;e++)t[e]=s.points[e];return!0},triangulate(s,t,e,r,n,i){$a(s,Zd,t,e,r,n,i)}},Jd={extension:{type:O.ShapeBuilder,name:"rectangle"},build(s,t){const e=s,r=e.x,n=e.y,i=e.width,o=e.height;return i>0&&o>0?(t[0]=r,t[1]=n,t[2]=r+i,t[3]=n,t[4]=r+i,t[5]=n+o,t[6]=r,t[7]=n+o,!0):!1},triangulate(s,t,e,r,n,i){let o=0;r*=e,t[r+o]=s[0],t[r+o+1]=s[1],o+=e,t[r+o]=s[2],t[r+o+1]=s[3],o+=e,t[r+o]=s[6],t[r+o+1]=s[7],o+=e,t[r+o]=s[4],t[r+o+1]=s[5],o+=e;const a=r/e;n[i++]=a,n[i++]=a+1,n[i++]=a+2,n[i++]=a+1,n[i++]=a+3,n[i++]=a+2}},tu={extension:{type:O.ShapeBuilder,name:"triangle"},build(s,t){return t[0]=s.x,t[1]=s.y,t[2]=s.x2,t[3]=s.y2,t[4]=s.x3,t[5]=s.y3,!0},triangulate(s,t,e,r,n,i){let o=0;r*=e,t[r+o]=s[0],t[r+o+1]=s[1],o+=e,t[r+o]=s[2],t[r+o+1]=s[3],o+=e,t[r+o]=s[4],t[r+o+1]=s[5];const a=r/e;n[i++]=a,n[i++]=a+1,n[i++]=a+2}},eu=new X,su=new q;function ru(s,t,e,r){const n=t.matrix?s.copyFrom(t.matrix).invert():s.identity();if(t.textureSpace==="local"){const o=e.getBounds(su);t.width&&o.pad(t.width);const{x:a,y:c}=o,h=1/o.width,l=1/o.height,d=-a*h,f=-c*l,u=n.a,p=n.b,g=n.c,m=n.d;n.a*=h,n.b*=h,n.c*=l,n.d*=l,n.tx=d*u+f*g+n.tx,n.ty=d*p+f*m+n.ty}else n.translate(t.texture.frame.x,t.texture.frame.y),n.scale(1/t.texture.source.width,1/t.texture.source.height);const i=t.texture.source.style;return!(t.fill instanceof ce)&&i.addressMode==="clamp-to-edge"&&(i.addressMode="repeat",i.update()),r&&n.append(eu.copyFrom(r).invert()),n}const ar={};pt.handleByMap(O.ShapeBuilder,ar);pt.add(Jd,Qd,tu,ws,Vd,Yd);const nu=new q,iu=new X;function ou(s,t){const{geometryData:e,batches:r}=t;r.length=0,e.indices.length=0,e.vertices.length=0,e.uvs.length=0;for(let n=0;n<s.instructions.length;n++){const i=s.instructions[n];if(i.action==="texture")au(i.data,r,e);else if(i.action==="fill"||i.action==="stroke"){const o=i.action==="stroke",a=i.data.path.shapePath,c=i.data.style,h=i.data.hole;o&&h&&Hi(h.shapePath,c,!0,r,e),h&&(a.shapePrimitives[a.shapePrimitives.length-1].holes=h.shapePath.shapePrimitives),Hi(a,c,o,r,e)}}}function au(s,t,e){const r=[],n=ar.rectangle,i=nu;i.x=s.dx,i.y=s.dy,i.width=s.dw,i.height=s.dh;const o=s.transform;if(!n.build(i,r))return;const{vertices:a,uvs:c,indices:h}=e,l=h.length,d=a.length/2;o&&Ha(r,o),n.triangulate(r,a,2,d,h,l);const f=s.image,u=f.uvs;c.push(u.x0,u.y0,u.x1,u.y1,u.x3,u.y3,u.x2,u.y2);const p=oe.get(Wa);p.indexOffset=l,p.indexSize=h.length-l,p.attributeOffset=d,p.attributeSize=a.length/2-d,p.baseColor=s.style,p.alpha=s.alpha,p.texture=f,p.geometryData=e,t.push(p)}function Hi(s,t,e,r,n){const{vertices:i,uvs:o,indices:a}=n;s.shapePrimitives.forEach(({shape:c,transform:h,holes:l})=>{const d=[],f=ar[c.type];if(!f.build(c,d))return;const u=a.length,p=i.length/2;let g="triangle-list";if(h&&Ha(d,h),e){const b=c.closePath??!0,w=t;w.pixelLine?(Kd(d,b,i,a),g="line-list"):qd(d,w,!1,b,i,a)}else if(l){const b=[],w=d.slice();cu(l).forEach(S=>{b.push(w.length/2),w.push(...S)}),$a(w,b,i,2,p,a,u)}else f.triangulate(d,i,2,p,a,u);const m=o.length/2,x=t.texture;if(x!==$.WHITE){const b=ru(iu,t,c,h);Wd(i,2,p,o,m,2,i.length/2-p,b)}else jd(o,m,2,i.length/2-p);const y=oe.get(Wa);y.indexOffset=u,y.indexSize=a.length-u,y.attributeOffset=p,y.attributeSize=i.length/2-p,y.baseColor=t.color,y.alpha=t.alpha,y.texture=x,y.geometryData=n,y.topology=g,r.push(y)})}function cu(s){const t=[];for(let e=0;e<s.length;e++){const r=s[e].shape,n=[];ar[r.type].build(r,n)&&t.push(n)}return t}class lu{constructor(){this.batches=[],this.geometryData={vertices:[],uvs:[],indices:[]}}}class hu{constructor(){this.instructions=new Qo}init(t){this.batcher=new Hd({maxTextures:t}),this.instructions.reset()}get geometry(){return Y(al,"GraphicsContextRenderData#geometry is deprecated, please use batcher.geometry instead."),this.batcher.geometry}}const Ln=class pn{constructor(t){this._gpuContextHash={},this._graphicsDataContextHash=Object.create(null),this._renderer=t,t.renderableGC.addManagedHash(this,"_gpuContextHash"),t.renderableGC.addManagedHash(this,"_graphicsDataContextHash")}init(t){pn.defaultOptions.bezierSmoothness=(t==null?void 0:t.bezierSmoothness)??pn.defaultOptions.bezierSmoothness}getContextRenderData(t){return this._graphicsDataContextHash[t.uid]||this._initContextRenderData(t)}updateGpuContext(t){let e=this._gpuContextHash[t.uid]||this._initContext(t);if(t.dirty){e?this._cleanGraphicsContextData(t):e=this._initContext(t),ou(t,e);const r=t.batchMode;t.customShader||r==="no-batch"?e.isBatchable=!1:r==="auto"?e.isBatchable=e.geometryData.vertices.length<400:e.isBatchable=!0,t.dirty=!1}return e}getGpuContext(t){return this._gpuContextHash[t.uid]||this._initContext(t)}_initContextRenderData(t){const e=oe.get(hu,{maxTextures:this._renderer.limits.maxBatchableTextures}),{batches:r,geometryData:n}=this._gpuContextHash[t.uid],i=n.vertices.length,o=n.indices.length;for(let l=0;l<r.length;l++)r[l].applyTransform=!1;const a=e.batcher;a.ensureAttributeBuffer(i),a.ensureIndexBuffer(o),a.begin();for(let l=0;l<r.length;l++){const d=r[l];a.add(d)}a.finish(e.instructions);const c=a.geometry;c.indexBuffer.setDataWithSize(a.indexBuffer,a.indexSize,!0),c.buffers[0].setDataWithSize(a.attributeBuffer.float32View,a.attributeSize,!0);const h=a.batches;for(let l=0;l<h.length;l++){const d=h[l];d.bindGroup=Qh(d.textures.textures,d.textures.count,this._renderer.limits.maxBatchableTextures)}return this._graphicsDataContextHash[t.uid]=e,e}_initContext(t){const e=new lu;return e.context=t,this._gpuContextHash[t.uid]=e,t.on("destroy",this.onGraphicsContextDestroy,this),this._gpuContextHash[t.uid]}onGraphicsContextDestroy(t){this._cleanGraphicsContextData(t),t.off("destroy",this.onGraphicsContextDestroy,this),this._gpuContextHash[t.uid]=null}_cleanGraphicsContextData(t){const e=this._gpuContextHash[t.uid];e.isBatchable||this._graphicsDataContextHash[t.uid]&&(oe.return(this.getContextRenderData(t)),this._graphicsDataContextHash[t.uid]=null),e.batches&&e.batches.forEach(r=>{oe.return(r)})}destroy(){for(const t in this._gpuContextHash)this._gpuContextHash[t]&&this.onGraphicsContextDestroy(this._gpuContextHash[t].context)}};Ln.extension={type:[O.WebGLSystem,O.WebGPUSystem,O.CanvasSystem],name:"graphicsContext"};Ln.defaultOptions={bezierSmoothness:.5};let Va=Ln;const du=8,Bs=11920929e-14,uu=1;function Ya(s,t,e,r,n,i,o,a,c,h){const d=Math.min(.99,Math.max(0,h??Va.defaultOptions.bezierSmoothness));let f=(uu-d)/1;return f*=f,fu(t,e,r,n,i,o,a,c,s,f),s}function fu(s,t,e,r,n,i,o,a,c,h){mn(s,t,e,r,n,i,o,a,c,h,0),c.push(o,a)}function mn(s,t,e,r,n,i,o,a,c,h,l){if(l>du)return;const d=(s+e)/2,f=(t+r)/2,u=(e+n)/2,p=(r+i)/2,g=(n+o)/2,m=(i+a)/2,x=(d+u)/2,y=(f+p)/2,b=(u+g)/2,w=(p+m)/2,v=(x+b)/2,S=(y+w)/2;if(l>0){let k=o-s,P=a-t;const _=Math.abs((e-o)*P-(r-a)*k),C=Math.abs((n-o)*P-(i-a)*k);if(_>Bs&&C>Bs){if((_+C)*(_+C)<=h*(k*k+P*P)){c.push(v,S);return}}else if(_>Bs){if(_*_<=h*(k*k+P*P)){c.push(v,S);return}}else if(C>Bs){if(C*C<=h*(k*k+P*P)){c.push(v,S);return}}else if(k=v-(s+o)/2,P=S-(t+a)/2,k*k+P*P<=h){c.push(v,S);return}}mn(s,t,d,f,x,y,v,S,c,h,l+1),mn(v,S,b,w,g,m,o,a,c,h,l+1)}const pu=8,mu=11920929e-14,gu=1;function xu(s,t,e,r,n,i,o,a){const h=Math.min(.99,Math.max(0,a??Va.defaultOptions.bezierSmoothness));let l=(gu-h)/1;return l*=l,yu(t,e,r,n,i,o,s,l),s}function yu(s,t,e,r,n,i,o,a){gn(o,s,t,e,r,n,i,a,0),o.push(n,i)}function gn(s,t,e,r,n,i,o,a,c){if(c>pu)return;const h=(t+r)/2,l=(e+n)/2,d=(r+i)/2,f=(n+o)/2,u=(h+d)/2,p=(l+f)/2;let g=i-t,m=o-e;const x=Math.abs((r-i)*m-(n-o)*g);if(x>mu){if(x*x<=a*(g*g+m*m)){s.push(u,p);return}}else if(g=u-(t+i)/2,m=p-(e+o)/2,g*g+m*m<=a){s.push(u,p);return}gn(s,t,e,h,l,u,p,a,c+1),gn(s,u,p,d,f,i,o,a,c+1)}function Xa(s,t,e,r,n,i,o,a){let c=Math.abs(n-i);(!o&&n>i||o&&i>n)&&(c=2*Math.PI-c),a||(a=Math.max(6,Math.floor(6*Math.pow(r,1/3)*(c/Math.PI)))),a=Math.max(a,3);let h=c/a,l=n;h*=o?-1:1;for(let d=0;d<a+1;d++){const f=Math.cos(l),u=Math.sin(l),p=t+f*r,g=e+u*r;s.push(p,g),l+=h}}function bu(s,t,e,r,n,i){const o=s[s.length-2],c=s[s.length-1]-e,h=o-t,l=n-e,d=r-t,f=Math.abs(c*d-h*l);if(f<1e-8||i===0){(s[s.length-2]!==t||s[s.length-1]!==e)&&s.push(t,e);return}const u=c*c+h*h,p=l*l+d*d,g=c*l+h*d,m=i*Math.sqrt(u)/f,x=i*Math.sqrt(p)/f,y=m*g/u,b=x*g/p,w=m*d+x*h,v=m*l+x*c,S=h*(x+y),k=c*(x+y),P=d*(m+b),_=l*(m+b),C=Math.atan2(k-v,S-w),A=Math.atan2(_-v,P-w);Xa(s,w+t,v+e,i,C,A,h*l>d*c)}const ds=Math.PI*2,Lr={centerX:0,centerY:0,ang1:0,ang2:0},zr=({x:s,y:t},e,r,n,i,o,a,c)=>{s*=e,t*=r;const h=n*s-i*t,l=i*s+n*t;return c.x=h+o,c.y=l+a,c};function wu(s,t){const e=t===-1.5707963267948966?-.551915024494:1.3333333333333333*Math.tan(t/4),r=t===1.5707963267948966?.551915024494:e,n=Math.cos(s),i=Math.sin(s),o=Math.cos(s+t),a=Math.sin(s+t);return[{x:n-i*r,y:i+n*r},{x:o+a*r,y:a-o*r},{x:o,y:a}]}const Wi=(s,t,e,r)=>{const n=s*r-t*e<0?-1:1;let i=s*e+t*r;return i>1&&(i=1),i<-1&&(i=-1),n*Math.acos(i)},_u=(s,t,e,r,n,i,o,a,c,h,l,d,f)=>{const u=Math.pow(n,2),p=Math.pow(i,2),g=Math.pow(l,2),m=Math.pow(d,2);let x=u*p-u*m-p*g;x<0&&(x=0),x/=u*m+p*g,x=Math.sqrt(x)*(o===a?-1:1);const y=x*n/i*d,b=x*-i/n*l,w=h*y-c*b+(s+e)/2,v=c*y+h*b+(t+r)/2,S=(l-y)/n,k=(d-b)/i,P=(-l-y)/n,_=(-d-b)/i,C=Wi(1,0,S,k);let A=Wi(S,k,P,_);a===0&&A>0&&(A-=ds),a===1&&A<0&&(A+=ds),f.centerX=w,f.centerY=v,f.ang1=C,f.ang2=A};function vu(s,t,e,r,n,i,o,a=0,c=0,h=0){if(i===0||o===0)return;const l=Math.sin(a*ds/360),d=Math.cos(a*ds/360),f=d*(t-r)/2+l*(e-n)/2,u=-l*(t-r)/2+d*(e-n)/2;if(f===0&&u===0)return;i=Math.abs(i),o=Math.abs(o);const p=Math.pow(f,2)/Math.pow(i,2)+Math.pow(u,2)/Math.pow(o,2);p>1&&(i*=Math.sqrt(p),o*=Math.sqrt(p)),_u(t,e,r,n,i,o,c,h,l,d,f,u,Lr);let{ang1:g,ang2:m}=Lr;const{centerX:x,centerY:y}=Lr;let b=Math.abs(m)/(ds/4);Math.abs(1-b)<1e-7&&(b=1);const w=Math.max(Math.ceil(b),1);m/=w;let v=s[s.length-2],S=s[s.length-1];const k={x:0,y:0};for(let P=0;P<w;P++){const _=wu(g,m),{x:C,y:A}=zr(_[0],i,o,d,l,x,y,k),{x:M,y:E}=zr(_[1],i,o,d,l,x,y,k),{x:F,y:R}=zr(_[2],i,o,d,l,x,y,k);Ya(s,v,S,C,A,M,E,F,R),v=F,S=R,g+=m}}function Au(s,t,e){const r=(o,a)=>{const c=a.x-o.x,h=a.y-o.y,l=Math.sqrt(c*c+h*h),d=c/l,f=h/l;return{len:l,nx:d,ny:f}},n=(o,a)=>{o===0?s.moveTo(a.x,a.y):s.lineTo(a.x,a.y)};let i=t[t.length-1];for(let o=0;o<t.length;o++){const a=t[o%t.length],c=a.radius??e;if(c<=0){n(o,a),i=a;continue}const h=t[(o+1)%t.length],l=r(a,i),d=r(a,h);if(l.len<1e-4||d.len<1e-4){n(o,a),i=a;continue}let f=Math.asin(l.nx*d.ny-l.ny*d.nx),u=1,p=!1;l.nx*d.nx-l.ny*-d.ny<0?f<0?f=Math.PI+f:(f=Math.PI-f,u=-1,p=!0):f>0&&(u=-1,p=!0);const g=f/2;let m,x=Math.abs(Math.cos(g)*c/Math.sin(g));x>Math.min(l.len/2,d.len/2)?(x=Math.min(l.len/2,d.len/2),m=Math.abs(x*Math.sin(g)/Math.cos(g))):m=c;const y=a.x+d.nx*x+-d.ny*m*u,b=a.y+d.ny*x+d.nx*m*u,w=Math.atan2(l.ny,l.nx)+Math.PI/2*u,v=Math.atan2(d.ny,d.nx)-Math.PI/2*u;o===0&&s.moveTo(y+Math.cos(w)*m,b+Math.sin(w)*m),s.arc(y,b,m,w,v,p),i=a}}function Su(s,t,e,r){const n=(a,c)=>Math.sqrt((a.x-c.x)**2+(a.y-c.y)**2),i=(a,c,h)=>({x:a.x+(c.x-a.x)*h,y:a.y+(c.y-a.y)*h}),o=t.length;for(let a=0;a<o;a++){const c=t[(a+1)%o],h=c.radius??e;if(h<=0){a===0?s.moveTo(c.x,c.y):s.lineTo(c.x,c.y);continue}const l=t[a],d=t[(a+2)%o],f=n(l,c);let u;if(f<1e-4)u=c;else{const m=Math.min(f/2,h);u=i(c,l,m/f)}const p=n(d,c);let g;if(p<1e-4)g=c;else{const m=Math.min(p/2,h);g=i(c,d,m/p)}a===0?s.moveTo(u.x,u.y):s.lineTo(u.x,u.y),s.quadraticCurveTo(c.x,c.y,g.x,g.y,r)}}const Cu=new q;class ku{constructor(t){this.shapePrimitives=[],this._currentPoly=null,this._bounds=new Ht,this._graphicsPath2D=t,this.signed=t.checkForHoles}moveTo(t,e){return this.startPoly(t,e),this}lineTo(t,e){this._ensurePoly();const r=this._currentPoly.points,n=r[r.length-2],i=r[r.length-1];return(n!==t||i!==e)&&r.push(t,e),this}arc(t,e,r,n,i,o){this._ensurePoly(!1);const a=this._currentPoly.points;return Xa(a,t,e,r,n,i,o),this}arcTo(t,e,r,n,i){this._ensurePoly();const o=this._currentPoly.points;return bu(o,t,e,r,n,i),this}arcToSvg(t,e,r,n,i,o,a){const c=this._currentPoly.points;return vu(c,this._currentPoly.lastX,this._currentPoly.lastY,o,a,t,e,r,n,i),this}bezierCurveTo(t,e,r,n,i,o,a){this._ensurePoly();const c=this._currentPoly;return Ya(this._currentPoly.points,c.lastX,c.lastY,t,e,r,n,i,o,a),this}quadraticCurveTo(t,e,r,n,i){this._ensurePoly();const o=this._currentPoly;return xu(this._currentPoly.points,o.lastX,o.lastY,t,e,r,n,i),this}closePath(){return this.endPoly(!0),this}addPath(t,e){this.endPoly(),e&&!e.isIdentity()&&(t=t.clone(!0),t.transform(e));const r=this.shapePrimitives,n=r.length;for(let i=0;i<t.instructions.length;i++){const o=t.instructions[i];this[o.action](...o.data)}if(t.checkForHoles&&r.length-n>1){let i=null;for(let o=n;o<r.length;o++){const a=r[o];if(a.shape.type==="polygon"){const c=a.shape,h=i==null?void 0:i.shape;h&&h.containsPolygon(c)?(i.holes||(i.holes=[]),i.holes.push(a),r.copyWithin(o,o+1),r.length--,o--):i=a}}}return this}finish(t=!1){this.endPoly(t)}rect(t,e,r,n,i){return this.drawShape(new q(t,e,r,n),i),this}circle(t,e,r,n){return this.drawShape(new Bn(t,e,r),n),this}poly(t,e,r){const n=new hs(t);return n.closePath=e,this.drawShape(n,r),this}regularPoly(t,e,r,n,i=0,o){n=Math.max(n|0,3);const a=-1*Math.PI/2+i,c=Math.PI*2/n,h=[];for(let l=0;l<n;l++){const d=a-l*c;h.push(t+r*Math.cos(d),e+r*Math.sin(d))}return this.poly(h,!0,o),this}roundPoly(t,e,r,n,i,o=0,a){if(n=Math.max(n|0,3),i<=0)return this.regularPoly(t,e,r,n,o);const c=r*Math.sin(Math.PI/n)-.001;i=Math.min(i,c);const h=-1*Math.PI/2+o,l=Math.PI*2/n,d=(n-2)*Math.PI/n/2;for(let f=0;f<n;f++){const u=f*l+h,p=t+r*Math.cos(u),g=e+r*Math.sin(u),m=u+Math.PI+d,x=u-Math.PI-d,y=p+i*Math.cos(m),b=g+i*Math.sin(m),w=p+i*Math.cos(x),v=g+i*Math.sin(x);f===0?this.moveTo(y,b):this.lineTo(y,b),this.quadraticCurveTo(p,g,w,v,a)}return this.closePath()}roundShape(t,e,r=!1,n){return t.length<3?this:(r?Su(this,t,e,n):Au(this,t,e),this.closePath())}filletRect(t,e,r,n,i){if(i===0)return this.rect(t,e,r,n);const o=Math.min(r,n)/2,a=Math.min(o,Math.max(-o,i)),c=t+r,h=e+n,l=a<0?-a:0,d=Math.abs(a);return this.moveTo(t,e+d).arcTo(t+l,e+l,t+d,e,d).lineTo(c-d,e).arcTo(c-l,e+l,c,e+d,d).lineTo(c,h-d).arcTo(c-l,h-l,t+r-d,h,d).lineTo(t+d,h).arcTo(t+l,h-l,t,h-d,d).closePath()}chamferRect(t,e,r,n,i,o){if(i<=0)return this.rect(t,e,r,n);const a=Math.min(i,Math.min(r,n)/2),c=t+r,h=e+n,l=[t+a,e,c-a,e,c,e+a,c,h-a,c-a,h,t+a,h,t,h-a,t,e+a];for(let d=l.length-1;d>=2;d-=2)l[d]===l[d-2]&&l[d-1]===l[d-3]&&l.splice(d-1,2);return this.poly(l,!0,o)}ellipse(t,e,r,n,i){return this.drawShape(new Fn(t,e,r,n),i),this}roundRect(t,e,r,n,i,o){return this.drawShape(new Rn(t,e,r,n,i),o),this}drawShape(t,e){return this.endPoly(),this.shapePrimitives.push({shape:t,transform:e}),this}startPoly(t,e){let r=this._currentPoly;return r&&this.endPoly(),r=new hs,r.points.push(t,e),this._currentPoly=r,this}endPoly(t=!1){const e=this._currentPoly;return e&&e.points.length>2&&(e.closePath=t,this.shapePrimitives.push({shape:e})),this._currentPoly=null,this}_ensurePoly(t=!0){if(!this._currentPoly&&(this._currentPoly=new hs,t)){const e=this.shapePrimitives[this.shapePrimitives.length-1];if(e){let r=e.shape.x,n=e.shape.y;if(e.transform&&!e.transform.isIdentity()){const i=e.transform,o=r;r=i.a*r+i.c*n+i.tx,n=i.b*o+i.d*n+i.ty}this._currentPoly.points.push(r,n)}else this._currentPoly.points.push(0,0)}}buildPath(){const t=this._graphicsPath2D;this.shapePrimitives.length=0,this._currentPoly=null;for(let e=0;e<t.instructions.length;e++){const r=t.instructions[e];this[r.action](...r.data)}this.finish()}get bounds(){const t=this._bounds;t.clear();const e=this.shapePrimitives;for(let r=0;r<e.length;r++){const n=e[r],i=n.shape.getBounds(Cu);n.transform?t.addRect(i,n.transform):t.addRect(i)}return t}}class $e{constructor(t,e=!1){this.instructions=[],this.uid=ct("graphicsPath"),this._dirty=!0,this.checkForHoles=e,typeof t=="string"?Xh(t,this):this.instructions=(t==null?void 0:t.slice())??[]}get shapePath(){return this._shapePath||(this._shapePath=new ku(this)),this._dirty&&(this._dirty=!1,this._shapePath.buildPath()),this._shapePath}addPath(t,e){return t=t.clone(),this.instructions.push({action:"addPath",data:[t,e]}),this._dirty=!0,this}arc(...t){return this.instructions.push({action:"arc",data:t}),this._dirty=!0,this}arcTo(...t){return this.instructions.push({action:"arcTo",data:t}),this._dirty=!0,this}arcToSvg(...t){return this.instructions.push({action:"arcToSvg",data:t}),this._dirty=!0,this}bezierCurveTo(...t){return this.instructions.push({action:"bezierCurveTo",data:t}),this._dirty=!0,this}bezierCurveToShort(t,e,r,n,i){const o=this.instructions[this.instructions.length-1],a=this.getLastPoint(mt.shared);let c=0,h=0;if(!o||o.action!=="bezierCurveTo")c=a.x,h=a.y;else{c=o.data[2],h=o.data[3];const l=a.x,d=a.y;c=l+(l-c),h=d+(d-h)}return this.instructions.push({action:"bezierCurveTo",data:[c,h,t,e,r,n,i]}),this._dirty=!0,this}closePath(){return this.instructions.push({action:"closePath",data:[]}),this._dirty=!0,this}ellipse(...t){return this.instructions.push({action:"ellipse",data:t}),this._dirty=!0,this}lineTo(...t){return this.instructions.push({action:"lineTo",data:t}),this._dirty=!0,this}moveTo(...t){return this.instructions.push({action:"moveTo",data:t}),this}quadraticCurveTo(...t){return this.instructions.push({action:"quadraticCurveTo",data:t}),this._dirty=!0,this}quadraticCurveToShort(t,e,r){const n=this.instructions[this.instructions.length-1],i=this.getLastPoint(mt.shared);let o=0,a=0;if(!n||n.action!=="quadraticCurveTo")o=i.x,a=i.y;else{o=n.data[0],a=n.data[1];const c=i.x,h=i.y;o=c+(c-o),a=h+(h-a)}return this.instructions.push({action:"quadraticCurveTo",data:[o,a,t,e,r]}),this._dirty=!0,this}rect(t,e,r,n,i){return this.instructions.push({action:"rect",data:[t,e,r,n,i]}),this._dirty=!0,this}circle(t,e,r,n){return this.instructions.push({action:"circle",data:[t,e,r,n]}),this._dirty=!0,this}roundRect(...t){return this.instructions.push({action:"roundRect",data:t}),this._dirty=!0,this}poly(...t){return this.instructions.push({action:"poly",data:t}),this._dirty=!0,this}regularPoly(...t){return this.instructions.push({action:"regularPoly",data:t}),this._dirty=!0,this}roundPoly(...t){return this.instructions.push({action:"roundPoly",data:t}),this._dirty=!0,this}roundShape(...t){return this.instructions.push({action:"roundShape",data:t}),this._dirty=!0,this}filletRect(...t){return this.instructions.push({action:"filletRect",data:t}),this._dirty=!0,this}chamferRect(...t){return this.instructions.push({action:"chamferRect",data:t}),this._dirty=!0,this}star(t,e,r,n,i,o,a){i||(i=n/2);const c=-1*Math.PI/2+o,h=r*2,l=Math.PI*2/h,d=[];for(let f=0;f<h;f++){const u=f%2?i:n,p=f*l+c;d.push(t+u*Math.cos(p),e+u*Math.sin(p))}return this.poly(d,!0,a),this}clone(t=!1){const e=new $e;if(e.checkForHoles=this.checkForHoles,!t)e.instructions=this.instructions.slice();else for(let r=0;r<this.instructions.length;r++){const n=this.instructions[r];e.instructions.push({action:n.action,data:n.data.slice()})}return e}clear(){return this.instructions.length=0,this._dirty=!0,this}transform(t){if(t.isIdentity())return this;const e=t.a,r=t.b,n=t.c,i=t.d,o=t.tx,a=t.ty;let c=0,h=0,l=0,d=0,f=0,u=0,p=0,g=0;for(let m=0;m<this.instructions.length;m++){const x=this.instructions[m],y=x.data;switch(x.action){case"moveTo":case"lineTo":c=y[0],h=y[1],y[0]=e*c+n*h+o,y[1]=r*c+i*h+a;break;case"bezierCurveTo":l=y[0],d=y[1],f=y[2],u=y[3],c=y[4],h=y[5],y[0]=e*l+n*d+o,y[1]=r*l+i*d+a,y[2]=e*f+n*u+o,y[3]=r*f+i*u+a,y[4]=e*c+n*h+o,y[5]=r*c+i*h+a;break;case"quadraticCurveTo":l=y[0],d=y[1],c=y[2],h=y[3],y[0]=e*l+n*d+o,y[1]=r*l+i*d+a,y[2]=e*c+n*h+o,y[3]=r*c+i*h+a;break;case"arcToSvg":c=y[5],h=y[6],p=y[0],g=y[1],y[0]=e*p+n*g,y[1]=r*p+i*g,y[5]=e*c+n*h+o,y[6]=r*c+i*h+a;break;case"circle":y[4]=ss(y[3],t);break;case"rect":y[4]=ss(y[4],t);break;case"ellipse":y[8]=ss(y[8],t);break;case"roundRect":y[5]=ss(y[5],t);break;case"addPath":y[0].transform(t);break;case"poly":y[2]=ss(y[2],t);break;default:ot("unknown transform action",x.action);break}}return this._dirty=!0,this}get bounds(){return this.shapePath.bounds}getLastPoint(t){let e=this.instructions.length-1,r=this.instructions[e];if(!r)return t.x=0,t.y=0,t;for(;r.action==="closePath";){if(e--,e<0)return t.x=0,t.y=0,t;r=this.instructions[e]}switch(r.action){case"moveTo":case"lineTo":t.x=r.data[0],t.y=r.data[1];break;case"quadraticCurveTo":t.x=r.data[2],t.y=r.data[3];break;case"bezierCurveTo":t.x=r.data[4],t.y=r.data[5];break;case"arc":case"arcToSvg":t.x=r.data[5],t.y=r.data[6];break;case"addPath":r.data[0].getLastPoint(t);break}return t}}function ss(s,t){return s?s.prepend(t):t.clone()}function nt(s,t,e){const r=s.getAttribute(t);return r?Number(r):e}function Pu(s,t){const e=s.querySelectorAll("defs");for(let r=0;r<e.length;r++){const n=e[r];for(let i=0;i<n.children.length;i++){const o=n.children[i];switch(o.nodeName.toLowerCase()){case"lineargradient":t.defs[o.id]=Mu(o);break;case"radialgradient":t.defs[o.id]=Tu();break}}}}function Mu(s){const t=nt(s,"x1",0),e=nt(s,"y1",0),r=nt(s,"x2",1),n=nt(s,"y2",0),i=s.getAttribute("gradientUnits")||"objectBoundingBox",o=new ce(t,e,r,n,i==="objectBoundingBox"?"local":"global");for(let a=0;a<s.children.length;a++){const c=s.children[a],h=nt(c,"offset",0),l=lt.shared.setValue(c.getAttribute("stop-color")).toNumber();o.addColorStop(h,l)}return o}function Tu(s){return ot("[SVG Parser] Radial gradients are not yet supported"),new ce(0,0,1,0)}function ji(s){const t=s.match(/url\s*\(\s*['"]?\s*#([^'"\s)]+)\s*['"]?\s*\)/i);return t?t[1]:""}const $i={fill:{type:"paint",default:0},"fill-opacity":{type:"number",default:1},stroke:{type:"paint",default:0},"stroke-width":{type:"number",default:1},"stroke-opacity":{type:"number",default:1},"stroke-linecap":{type:"string",default:"butt"},"stroke-linejoin":{type:"string",default:"miter"},"stroke-miterlimit":{type:"number",default:10},"stroke-dasharray":{type:"string",default:"none"},"stroke-dashoffset":{type:"number",default:0},opacity:{type:"number",default:1}};function qa(s,t){const e=s.getAttribute("style"),r={},n={},i={strokeStyle:r,fillStyle:n,useFill:!1,useStroke:!1};for(const o in $i){const a=s.getAttribute(o);a&&Vi(t,i,o,a.trim())}if(e){const o=e.split(";");for(let a=0;a<o.length;a++){const c=o[a].trim(),[h,l]=c.split(":");$i[h]&&Vi(t,i,h,l.trim())}}return{strokeStyle:i.useStroke?r:null,fillStyle:i.useFill?n:null,useFill:i.useFill,useStroke:i.useStroke}}function Vi(s,t,e,r){switch(e){case"stroke":if(r!=="none"){if(r.startsWith("url(")){const n=ji(r);t.strokeStyle.fill=s.defs[n]}else t.strokeStyle.color=lt.shared.setValue(r).toNumber();t.useStroke=!0}break;case"stroke-width":t.strokeStyle.width=Number(r);break;case"fill":if(r!=="none"){if(r.startsWith("url(")){const n=ji(r);t.fillStyle.fill=s.defs[n]}else t.fillStyle.color=lt.shared.setValue(r).toNumber();t.useFill=!0}break;case"fill-opacity":t.fillStyle.alpha=Number(r);break;case"stroke-opacity":t.strokeStyle.alpha=Number(r);break;case"opacity":t.fillStyle.alpha=Number(r),t.strokeStyle.alpha=Number(r);break}}function Eu(s,t){if(typeof s=="string"){const o=document.createElement("div");o.innerHTML=s.trim(),s=o.querySelector("svg")}const e={context:t,defs:{},path:new $e};Pu(s,e);const r=s.children,{fillStyle:n,strokeStyle:i}=qa(s,e);for(let o=0;o<r.length;o++){const a=r[o];a.nodeName.toLowerCase()!=="defs"&&Ka(a,e,n,i)}return t}function Ka(s,t,e,r){const n=s.children,{fillStyle:i,strokeStyle:o}=qa(s,t);i&&e?e={...e,...i}:i&&(e=i),o&&r?r={...r,...o}:o&&(r=o);const a=!e&&!r;a&&(e={color:0});let c,h,l,d,f,u,p,g,m,x,y,b,w,v,S,k,P;switch(s.nodeName.toLowerCase()){case"path":v=s.getAttribute("d"),s.getAttribute("fill-rule")==="evenodd"&&ot("SVG Evenodd fill rule not supported, your svg may render incorrectly"),S=new $e(v,!0),t.context.path(S),e&&t.context.fill(e),r&&t.context.stroke(r);break;case"circle":p=nt(s,"cx",0),g=nt(s,"cy",0),m=nt(s,"r",0),t.context.ellipse(p,g,m,m),e&&t.context.fill(e),r&&t.context.stroke(r);break;case"rect":c=nt(s,"x",0),h=nt(s,"y",0),k=nt(s,"width",0),P=nt(s,"height",0),x=nt(s,"rx",0),y=nt(s,"ry",0),x||y?t.context.roundRect(c,h,k,P,x||y):t.context.rect(c,h,k,P),e&&t.context.fill(e),r&&t.context.stroke(r);break;case"ellipse":p=nt(s,"cx",0),g=nt(s,"cy",0),x=nt(s,"rx",0),y=nt(s,"ry",0),t.context.beginPath(),t.context.ellipse(p,g,x,y),e&&t.context.fill(e),r&&t.context.stroke(r);break;case"line":l=nt(s,"x1",0),d=nt(s,"y1",0),f=nt(s,"x2",0),u=nt(s,"y2",0),t.context.beginPath(),t.context.moveTo(l,d),t.context.lineTo(f,u),r&&t.context.stroke(r);break;case"polygon":w=s.getAttribute("points"),b=w.match(/\d+/g).map(_=>parseInt(_,10)),t.context.poly(b,!0),e&&t.context.fill(e),r&&t.context.stroke(r);break;case"polyline":w=s.getAttribute("points"),b=w.match(/\d+/g).map(_=>parseInt(_,10)),t.context.poly(b,!1),r&&t.context.stroke(r);break;case"g":case"svg":break;default:{ot(`[SVG parser] <${s.nodeName}> elements unsupported`);break}}a&&(e=null);for(let _=0;_<n.length;_++)Ka(n[_],t,e,r)}function Iu(s){return lt.isColorLike(s)}function Yi(s){return s instanceof or}function Xi(s){return s instanceof ce}function Bu(s){return s instanceof $}function Fu(s,t,e){const r=lt.shared.setValue(t??0);return s.color=r.toNumber(),s.alpha=r.alpha===1?e.alpha:r.alpha,s.texture=$.WHITE,{...e,...s}}function Ru(s,t,e){return s.texture=t,{...e,...s}}function qi(s,t,e){return s.fill=t,s.color=16777215,s.texture=t.texture,s.matrix=t.transform,{...e,...s}}function Ki(s,t,e){return t.buildGradient(),s.fill=t,s.color=16777215,s.texture=t.texture,s.matrix=t.transform,s.textureSpace=t.textureSpace,{...e,...s}}function Lu(s,t){const e={...t,...s},r=lt.shared.setValue(e.color);return e.alpha*=r.alpha,e.color=r.toNumber(),e}function Me(s,t){if(s==null)return null;const e={},r=s;return Iu(s)?Fu(e,s,t):Bu(s)?Ru(e,s,t):Yi(s)?qi(e,s,t):Xi(s)?Ki(e,s,t):r.fill&&Yi(r.fill)?qi(r,r.fill,t):r.fill&&Xi(r.fill)?Ki(r,r.fill,t):Lu(r,t)}function Xs(s,t){const{width:e,alignment:r,miterLimit:n,cap:i,join:o,pixelLine:a,...c}=t,h=Me(s,c);return h?{width:e,alignment:r,miterLimit:n,cap:i,join:o,pixelLine:a,...h}:null}const zu=new mt,Zi=new X,zn=class Yt extends Wt{constructor(){super(...arguments),this.uid=ct("graphicsContext"),this.dirty=!0,this.batchMode="auto",this.instructions=[],this._activePath=new $e,this._transform=new X,this._fillStyle={...Yt.defaultFillStyle},this._strokeStyle={...Yt.defaultStrokeStyle},this._stateStack=[],this._tick=0,this._bounds=new Ht,this._boundsDirty=!0}clone(){const t=new Yt;return t.batchMode=this.batchMode,t.instructions=this.instructions.slice(),t._activePath=this._activePath.clone(),t._transform=this._transform.clone(),t._fillStyle={...this._fillStyle},t._strokeStyle={...this._strokeStyle},t._stateStack=this._stateStack.slice(),t._bounds=this._bounds.clone(),t._boundsDirty=!0,t}get fillStyle(){return this._fillStyle}set fillStyle(t){this._fillStyle=Me(t,Yt.defaultFillStyle)}get strokeStyle(){return this._strokeStyle}set strokeStyle(t){this._strokeStyle=Xs(t,Yt.defaultStrokeStyle)}setFillStyle(t){return this._fillStyle=Me(t,Yt.defaultFillStyle),this}setStrokeStyle(t){return this._strokeStyle=Me(t,Yt.defaultStrokeStyle),this}texture(t,e,r,n,i,o){return this.instructions.push({action:"texture",data:{image:t,dx:r||0,dy:n||0,dw:i||t.frame.width,dh:o||t.frame.height,transform:this._transform.clone(),alpha:this._fillStyle.alpha,style:e?lt.shared.setValue(e).toNumber():16777215}}),this.onUpdate(),this}beginPath(){return this._activePath=new $e,this}fill(t,e){let r;const n=this.instructions[this.instructions.length-1];return this._tick===0&&n&&n.action==="stroke"?r=n.data.path:r=this._activePath.clone(),r?(t!=null&&(e!==void 0&&typeof t=="number"&&(Y(Q,"GraphicsContext.fill(color, alpha) is deprecated, use GraphicsContext.fill({ color, alpha }) instead"),t={color:t,alpha:e}),this._fillStyle=Me(t,Yt.defaultFillStyle)),this.instructions.push({action:"fill",data:{style:this.fillStyle,path:r}}),this.onUpdate(),this._initNextPathLocation(),this._tick=0,this):this}_initNextPathLocation(){const{x:t,y:e}=this._activePath.getLastPoint(mt.shared);this._activePath.clear(),this._activePath.moveTo(t,e)}stroke(t){let e;const r=this.instructions[this.instructions.length-1];return this._tick===0&&r&&r.action==="fill"?e=r.data.path:e=this._activePath.clone(),e?(t!=null&&(this._strokeStyle=Xs(t,Yt.defaultStrokeStyle)),this.instructions.push({action:"stroke",data:{style:this.strokeStyle,path:e}}),this.onUpdate(),this._initNextPathLocation(),this._tick=0,this):this}cut(){for(let t=0;t<2;t++){const e=this.instructions[this.instructions.length-1-t],r=this._activePath.clone();if(e&&(e.action==="stroke"||e.action==="fill"))if(e.data.hole)e.data.hole.addPath(r);else{e.data.hole=r;break}}return this._initNextPathLocation(),this}arc(t,e,r,n,i,o){this._tick++;const a=this._transform;return this._activePath.arc(a.a*t+a.c*e+a.tx,a.b*t+a.d*e+a.ty,r,n,i,o),this}arcTo(t,e,r,n,i){this._tick++;const o=this._transform;return this._activePath.arcTo(o.a*t+o.c*e+o.tx,o.b*t+o.d*e+o.ty,o.a*r+o.c*n+o.tx,o.b*r+o.d*n+o.ty,i),this}arcToSvg(t,e,r,n,i,o,a){this._tick++;const c=this._transform;return this._activePath.arcToSvg(t,e,r,n,i,c.a*o+c.c*a+c.tx,c.b*o+c.d*a+c.ty),this}bezierCurveTo(t,e,r,n,i,o,a){this._tick++;const c=this._transform;return this._activePath.bezierCurveTo(c.a*t+c.c*e+c.tx,c.b*t+c.d*e+c.ty,c.a*r+c.c*n+c.tx,c.b*r+c.d*n+c.ty,c.a*i+c.c*o+c.tx,c.b*i+c.d*o+c.ty,a),this}closePath(){var t;return this._tick++,(t=this._activePath)==null||t.closePath(),this}ellipse(t,e,r,n){return this._tick++,this._activePath.ellipse(t,e,r,n,this._transform.clone()),this}circle(t,e,r){return this._tick++,this._activePath.circle(t,e,r,this._transform.clone()),this}path(t){return this._tick++,this._activePath.addPath(t,this._transform.clone()),this}lineTo(t,e){this._tick++;const r=this._transform;return this._activePath.lineTo(r.a*t+r.c*e+r.tx,r.b*t+r.d*e+r.ty),this}moveTo(t,e){this._tick++;const r=this._transform,n=this._activePath.instructions,i=r.a*t+r.c*e+r.tx,o=r.b*t+r.d*e+r.ty;return n.length===1&&n[0].action==="moveTo"?(n[0].data[0]=i,n[0].data[1]=o,this):(this._activePath.moveTo(i,o),this)}quadraticCurveTo(t,e,r,n,i){this._tick++;const o=this._transform;return this._activePath.quadraticCurveTo(o.a*t+o.c*e+o.tx,o.b*t+o.d*e+o.ty,o.a*r+o.c*n+o.tx,o.b*r+o.d*n+o.ty,i),this}rect(t,e,r,n){return this._tick++,this._activePath.rect(t,e,r,n,this._transform.clone()),this}roundRect(t,e,r,n,i){return this._tick++,this._activePath.roundRect(t,e,r,n,i,this._transform.clone()),this}poly(t,e){return this._tick++,this._activePath.poly(t,e,this._transform.clone()),this}regularPoly(t,e,r,n,i=0,o){return this._tick++,this._activePath.regularPoly(t,e,r,n,i,o),this}roundPoly(t,e,r,n,i,o){return this._tick++,this._activePath.roundPoly(t,e,r,n,i,o),this}roundShape(t,e,r,n){return this._tick++,this._activePath.roundShape(t,e,r,n),this}filletRect(t,e,r,n,i){return this._tick++,this._activePath.filletRect(t,e,r,n,i),this}chamferRect(t,e,r,n,i,o){return this._tick++,this._activePath.chamferRect(t,e,r,n,i,o),this}star(t,e,r,n,i=0,o=0){return this._tick++,this._activePath.star(t,e,r,n,i,o,this._transform.clone()),this}svg(t){return this._tick++,Eu(t,this),this}restore(){const t=this._stateStack.pop();return t&&(this._transform=t.transform,this._fillStyle=t.fillStyle,this._strokeStyle=t.strokeStyle),this}save(){return this._stateStack.push({transform:this._transform.clone(),fillStyle:{...this._fillStyle},strokeStyle:{...this._strokeStyle}}),this}getTransform(){return this._transform}resetTransform(){return this._transform.identity(),this}rotate(t){return this._transform.rotate(t),this}scale(t,e=t){return this._transform.scale(t,e),this}setTransform(t,e,r,n,i,o){return t instanceof X?(this._transform.set(t.a,t.b,t.c,t.d,t.tx,t.ty),this):(this._transform.set(t,e,r,n,i,o),this)}transform(t,e,r,n,i,o){return t instanceof X?(this._transform.append(t),this):(Zi.set(t,e,r,n,i,o),this._transform.append(Zi),this)}translate(t,e=t){return this._transform.translate(t,e),this}clear(){return this._activePath.clear(),this.instructions.length=0,this.resetTransform(),this.onUpdate(),this}onUpdate(){this.dirty||(this.emit("update",this,16),this.dirty=!0,this._boundsDirty=!0)}get bounds(){if(!this._boundsDirty)return this._bounds;const t=this._bounds;t.clear();for(let e=0;e<this.instructions.length;e++){const r=this.instructions[e],n=r.action;if(n==="fill"){const i=r.data;t.addBounds(i.path.bounds)}else if(n==="texture"){const i=r.data;t.addFrame(i.dx,i.dy,i.dx+i.dw,i.dy+i.dh,i.transform)}if(n==="stroke"){const i=r.data,o=i.style.alignment,a=i.style.width*(1-o),c=i.path.bounds;t.addFrame(c.minX-a,c.minY-a,c.maxX+a,c.maxY+a)}}return t}containsPoint(t){var n;if(!this.bounds.containsPoint(t.x,t.y))return!1;const e=this.instructions;let r=!1;for(let i=0;i<e.length;i++){const o=e[i],a=o.data,c=a.path;if(!o.action||!c)continue;const h=a.style,l=c.shapePath.shapePrimitives;for(let d=0;d<l.length;d++){const f=l[d].shape;if(!h||!f)continue;const u=l[d].transform,p=u?u.applyInverse(t,zu):t;if(o.action==="fill")r=f.contains(p.x,p.y);else{const m=h;r=f.strokeContains(p.x,p.y,m.width,m.alignment)}const g=a.hole;if(g){const m=(n=g.shapePath)==null?void 0:n.shapePrimitives;if(m)for(let x=0;x<m.length;x++)m[x].shape.contains(p.x,p.y)&&(r=!1)}if(r)return!0}}return r}destroy(t=!1){if(this._stateStack.length=0,this._transform=null,this.emit("destroy",this),this.removeAllListeners(),typeof t=="boolean"?t:t==null?void 0:t.texture){const r=typeof t=="boolean"?t:t==null?void 0:t.textureSource;this._fillStyle.texture&&this._fillStyle.texture.destroy(r),this._strokeStyle.texture&&this._strokeStyle.texture.destroy(r)}this._fillStyle=null,this._strokeStyle=null,this.instructions=null,this._activePath=null,this._bounds=null,this._stateStack=null,this.customShader=null,this._transform=null}};zn.defaultFillStyle={color:16777215,alpha:1,texture:$.WHITE,matrix:null,fill:null,textureSpace:"local"};zn.defaultStrokeStyle={width:1,color:16777215,alpha:1,alignment:.5,miterLimit:10,cap:"butt",join:"miter",texture:$.WHITE,matrix:null,fill:null,textureSpace:"local",pixelLine:!1};let Ft=zn;const Qi=["align","breakWords","cssOverrides","fontVariant","fontWeight","leading","letterSpacing","lineHeight","padding","textBaseline","trim","whiteSpace","wordWrap","wordWrapWidth","fontFamily","fontStyle","fontSize"];function Gu(s){const t=[];let e=0;for(let r=0;r<Qi.length;r++){const n=`_${Qi[r]}`;t[e++]=s[n]}return e=Za(s._fill,t,e),e=Ou(s._stroke,t,e),e=Uu(s.dropShadow,t,e),e=Nu(s.filters,t,e),t.join("-")}function Nu(s,t,e){if(!s)return e;for(const r of s)t[e++]=r.uid;return e}function Za(s,t,e){var r;return s&&(t[e++]=s.color,t[e++]=s.alpha,t[e++]=(r=s.fill)==null?void 0:r.styleKey),e}function Ou(s,t,e){return s&&(e=Za(s,t,e),t[e++]=s.width,t[e++]=s.alignment,t[e++]=s.cap,t[e++]=s.join,t[e++]=s.miterLimit),e}function Uu(s,t,e){return s&&(t[e++]=s.alpha,t[e++]=s.angle,t[e++]=s.blur,t[e++]=s.distance,t[e++]=lt.shared.setValue(s.color).toNumber()),e}const Gn=class Ne extends Wt{constructor(t={}){super(),Du(t);const e={...Ne.defaultTextStyle,...t};for(const r in e){const n=r;this[n]=e[r]}this.update()}get align(){return this._align}set align(t){this._align=t,this.update()}get breakWords(){return this._breakWords}set breakWords(t){this._breakWords=t,this.update()}get dropShadow(){return this._dropShadow}set dropShadow(t){t!==null&&typeof t=="object"?this._dropShadow=this._createProxy({...Ne.defaultDropShadow,...t}):this._dropShadow=t?this._createProxy({...Ne.defaultDropShadow}):null,this.update()}get fontFamily(){return this._fontFamily}set fontFamily(t){this._fontFamily=t,this.update()}get fontSize(){return this._fontSize}set fontSize(t){typeof t=="string"?this._fontSize=parseInt(t,10):this._fontSize=t,this.update()}get fontStyle(){return this._fontStyle}set fontStyle(t){this._fontStyle=t.toLowerCase(),this.update()}get fontVariant(){return this._fontVariant}set fontVariant(t){this._fontVariant=t,this.update()}get fontWeight(){return this._fontWeight}set fontWeight(t){this._fontWeight=t,this.update()}get leading(){return this._leading}set leading(t){this._leading=t,this.update()}get letterSpacing(){return this._letterSpacing}set letterSpacing(t){this._letterSpacing=t,this.update()}get lineHeight(){return this._lineHeight}set lineHeight(t){this._lineHeight=t,this.update()}get padding(){return this._padding}set padding(t){this._padding=t,this.update()}get filters(){return this._filters}set filters(t){this._filters=t,this.update()}get trim(){return this._trim}set trim(t){this._trim=t,this.update()}get textBaseline(){return this._textBaseline}set textBaseline(t){this._textBaseline=t,this.update()}get whiteSpace(){return this._whiteSpace}set whiteSpace(t){this._whiteSpace=t,this.update()}get wordWrap(){return this._wordWrap}set wordWrap(t){this._wordWrap=t,this.update()}get wordWrapWidth(){return this._wordWrapWidth}set wordWrapWidth(t){this._wordWrapWidth=t,this.update()}get fill(){return this._originalFill}set fill(t){t!==this._originalFill&&(this._originalFill=t,this._isFillStyle(t)&&(this._originalFill=this._createProxy({...Ft.defaultFillStyle,...t},()=>{this._fill=Me({...this._originalFill},Ft.defaultFillStyle)})),this._fill=Me(t===0?"black":t,Ft.defaultFillStyle),this.update())}get stroke(){return this._originalStroke}set stroke(t){t!==this._originalStroke&&(this._originalStroke=t,this._isFillStyle(t)&&(this._originalStroke=this._createProxy({...Ft.defaultStrokeStyle,...t},()=>{this._stroke=Xs({...this._originalStroke},Ft.defaultStrokeStyle)})),this._stroke=Xs(t,Ft.defaultStrokeStyle),this.update())}_generateKey(){return this._styleKey=Gu(this),this._styleKey}update(){this._styleKey=null,this.emit("update",this)}reset(){const t=Ne.defaultTextStyle;for(const e in t)this[e]=t[e]}get styleKey(){return this._styleKey||this._generateKey()}clone(){return new Ne({align:this.align,breakWords:this.breakWords,dropShadow:this._dropShadow?{...this._dropShadow}:null,fill:this._fill,fontFamily:this.fontFamily,fontSize:this.fontSize,fontStyle:this.fontStyle,fontVariant:this.fontVariant,fontWeight:this.fontWeight,leading:this.leading,letterSpacing:this.letterSpacing,lineHeight:this.lineHeight,padding:this.padding,stroke:this._stroke,textBaseline:this.textBaseline,whiteSpace:this.whiteSpace,wordWrap:this.wordWrap,wordWrapWidth:this.wordWrapWidth,filters:this._filters?[...this._filters]:void 0})}_getFinalPadding(){let t=0;if(this._filters)for(let e=0;e<this._filters.length;e++)t+=this._filters[e].padding;return Math.max(this._padding,t)}destroy(t=!1){var r,n,i,o;if(this.removeAllListeners(),typeof t=="boolean"?t:t==null?void 0:t.texture){const a=typeof t=="boolean"?t:t==null?void 0:t.textureSource;(r=this._fill)!=null&&r.texture&&this._fill.texture.destroy(a),(n=this._originalFill)!=null&&n.texture&&this._originalFill.texture.destroy(a),(i=this._stroke)!=null&&i.texture&&this._stroke.texture.destroy(a),(o=this._originalStroke)!=null&&o.texture&&this._originalStroke.texture.destroy(a)}this._fill=null,this._stroke=null,this.dropShadow=null,this._originalStroke=null,this._originalFill=null}_createProxy(t,e){return new Proxy(t,{set:(r,n,i)=>(r[n]=i,e==null||e(n,i),this.update(),!0)})}_isFillStyle(t){return(t??null)!==null&&!(lt.isColorLike(t)||t instanceof ce||t instanceof or)}};Gn.defaultDropShadow={alpha:1,angle:Math.PI/6,blur:0,color:"black",distance:5};Gn.defaultTextStyle={align:"left",breakWords:!1,dropShadow:null,fill:"black",fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",leading:0,letterSpacing:0,lineHeight:0,padding:0,stroke:null,textBaseline:"alphabetic",trim:!1,whiteSpace:"pre",wordWrap:!1,wordWrapWidth:100};let At=Gn;function Du(s){const t=s;if(typeof t.dropShadow=="boolean"&&t.dropShadow){const e=At.defaultDropShadow;s.dropShadow={alpha:t.dropShadowAlpha??e.alpha,angle:t.dropShadowAngle??e.angle,blur:t.dropShadowBlur??e.blur,color:t.dropShadowColor??e.color,distance:t.dropShadowDistance??e.distance}}if(t.strokeThickness!==void 0){Y(Q,"strokeThickness is now a part of stroke");const e=t.stroke;let r={};if(lt.isColorLike(e))r.color=e;else if(e instanceof ce||e instanceof or)r.fill=e;else if(Object.hasOwnProperty.call(e,"color")||Object.hasOwnProperty.call(e,"fill"))r=e;else throw new Error("Invalid stroke value.");s.stroke={...r,width:t.strokeThickness}}if(Array.isArray(t.fillGradientStops)){Y(Q,"gradient fill is now a fill pattern: `new FillGradient(...)`");let e;s.fontSize==null?s.fontSize=At.defaultTextStyle.fontSize:typeof s.fontSize=="string"?e=parseInt(s.fontSize,10):e=s.fontSize;const r=new ce({start:{x:0,y:0},end:{x:0,y:(e||0)*1.7}}),n=t.fillGradientStops.map(i=>lt.shared.setValue(i).toNumber());n.forEach((i,o)=>{const a=o/(n.length-1);r.addColorStop(a,i)}),s.fill={fill:r}}}class Hu{constructor(t){this._canvasPool=Object.create(null),this.canvasOptions=t||{},this.enableFullScreen=!1}_createCanvasAndContext(t,e){const r=at.get().createCanvas();r.width=t,r.height=e;const n=r.getContext("2d");return{canvas:r,context:n}}getOptimalCanvasAndContext(t,e,r=1){t=Math.ceil(t*r-1e-6),e=Math.ceil(e*r-1e-6),t=De(t),e=De(e);const n=(t<<17)+(e<<1);this._canvasPool[n]||(this._canvasPool[n]=[]);let i=this._canvasPool[n].pop();return i||(i=this._createCanvasAndContext(t,e)),i}returnCanvasAndContext(t){const e=t.canvas,{width:r,height:n}=e,i=(r<<17)+(n<<1);t.context.clearRect(0,0,r,n),this._canvasPool[i].push(t)}clear(){this._canvasPool={}}}const qs=new Hu,Ji=1e5;function Ks(s,t,e,r=0){if(s.texture===$.WHITE&&!s.fill)return lt.shared.setValue(s.color).setAlpha(s.alpha??1).toHexa();if(s.fill){if(s.fill instanceof or){const n=s.fill,i=t.createPattern(n.texture.source.resource,"repeat"),o=n.transform.copyTo(X.shared);return o.scale(n.texture.frame.width,n.texture.frame.height),i.setTransform(o),i}else if(s.fill instanceof ce){const n=s.fill,i=n.type==="linear",o=n.textureSpace==="local";let a=1,c=1;o&&e&&(a=e.width+r,c=e.height+r);let h,l=!1;if(i){const{start:d,end:f}=n;h=t.createLinearGradient(d.x*a,d.y*c,f.x*a,f.y*c),l=Math.abs(f.x-d.x)<Math.abs((f.y-d.y)*.1)}else{const{center:d,innerRadius:f,outerCenter:u,outerRadius:p}=n;h=t.createRadialGradient(d.x*a,d.y*c,f*a,u.x*a,u.y*c,p*a)}if(l&&o&&e){const d=e.lineHeight/c;for(let f=0;f<e.lines.length;f++){const u=(f*e.lineHeight+r/2)/c;n.colorStops.forEach(p=>{const g=u+p.offset*d;h.addColorStop(Math.floor(g*Ji)/Ji,lt.shared.setValue(p.color).toHex())})}}else n.colorStops.forEach(d=>{h.addColorStop(d.offset,lt.shared.setValue(d.color).toHex())});return h}}else{const n=t.createPattern(s.texture.source.resource,"repeat"),i=s.matrix.copyTo(X.shared);return i.scale(s.texture.frame.width,s.texture.frame.height),n.setTransform(i),n}return ot("FillStyle not recognised",s),"red"}const Qa=class Ja extends Ba{constructor(t){super(),this.resolution=1,this.pages=[],this._padding=0,this._measureCache=Object.create(null),this._currentChars=[],this._currentX=0,this._currentY=0,this._currentMaxCharHeight=0,this._currentPageIndex=-1,this._skipKerning=!1;const e={...Ja.defaultOptions,...t};this._textureSize=e.textureSize,this._mipmap=e.mipmap;const r=e.style.clone();e.overrideFill&&(r._fill.color=16777215,r._fill.alpha=1,r._fill.texture=$.WHITE,r._fill.fill=null),this.applyFillAsTint=e.overrideFill;const n=r.fontSize;r.fontSize=this.baseMeasurementFontSize;const i=Ys(r);e.overrideSize?r._stroke&&(r._stroke.width*=this.baseRenderedFontSize/n):r.fontSize=this.baseRenderedFontSize=n,this._style=r,this._skipKerning=e.skipKerning??!1,this.resolution=e.resolution??1,this._padding=e.padding??4,e.textureStyle&&(this._textureStyle=e.textureStyle instanceof He?e.textureStyle:new He(e.textureStyle)),this.fontMetrics=qt.measureFont(i),this.lineHeight=r.lineHeight||this.fontMetrics.fontSize||r.fontSize}ensureCharacters(t){var m,x;const e=qt.graphemeSegmenter(t).filter(y=>!this._currentChars.includes(y)).filter((y,b,w)=>w.indexOf(y)===b);if(!e.length)return;this._currentChars=[...this._currentChars,...e];let r;this._currentPageIndex===-1?r=this._nextPage():r=this.pages[this._currentPageIndex];let{canvas:n,context:i}=r.canvasAndContext,o=r.texture.source;const a=this._style;let c=this._currentX,h=this._currentY,l=this._currentMaxCharHeight;const d=this.baseRenderedFontSize/this.baseMeasurementFontSize,f=this._padding*d;let u=!1;const p=n.width/this.resolution,g=n.height/this.resolution;for(let y=0;y<e.length;y++){const b=e[y],w=qt.measureText(b,a,n,!1);w.lineHeight=w.height;const v=w.width*d,S=Math.ceil((a.fontStyle==="italic"?2:1)*v),k=w.height*d,P=S+f*2,_=k+f*2;if(u=!1,b!==`
`&&b!=="\r"&&b!=="	"&&b!==" "&&(u=!0,l=Math.ceil(Math.max(_,l))),c+P>p&&(h+=l,l=_,c=0,h+l>g)){o.update();const A=this._nextPage();n=A.canvasAndContext.canvas,i=A.canvasAndContext.context,o=A.texture.source,c=0,h=0,l=0}const C=v/d-(((m=a.dropShadow)==null?void 0:m.distance)??0)-(((x=a._stroke)==null?void 0:x.width)??0);if(this.chars[b]={id:b.codePointAt(0),xOffset:-this._padding,yOffset:-this._padding,xAdvance:C,kerning:{}},u){this._drawGlyph(i,w,c+f,h+f,d,a);const A=o.width*d,M=o.height*d,E=new q(c/A*o.width,h/M*o.height,P/A*o.width,_/M*o.height);this.chars[b].texture=new $({source:o,frame:E}),c+=Math.ceil(P)}}o.update(),this._currentX=c,this._currentY=h,this._currentMaxCharHeight=l,this._skipKerning&&this._applyKerning(e,i)}get pageTextures(){return Y(Q,"BitmapFont.pageTextures is deprecated, please use BitmapFont.pages instead."),this.pages}_applyKerning(t,e){const r=this._measureCache;for(let n=0;n<t.length;n++){const i=t[n];for(let o=0;o<this._currentChars.length;o++){const a=this._currentChars[o];let c=r[i];c||(c=r[i]=e.measureText(i).width);let h=r[a];h||(h=r[a]=e.measureText(a).width);let l=e.measureText(i+a).width,d=l-(c+h);d&&(this.chars[i].kerning[a]=d),l=e.measureText(i+a).width,d=l-(c+h),d&&(this.chars[a].kerning[i]=d)}}}_nextPage(){this._currentPageIndex++;const t=this.resolution,e=qs.getOptimalCanvasAndContext(this._textureSize,this._textureSize,t);this._setupContext(e.context,this._style,t);const r=t*(this.baseRenderedFontSize/this.baseMeasurementFontSize),n=new $({source:new Be({resource:e.canvas,resolution:r,alphaMode:"premultiply-alpha-on-upload",autoGenerateMipmaps:this._mipmap})});this._textureStyle&&(n.source.style=this._textureStyle);const i={canvasAndContext:e,texture:n};return this.pages[this._currentPageIndex]=i,i}_setupContext(t,e,r){e.fontSize=this.baseRenderedFontSize,t.scale(r,r),t.font=Ys(e),e.fontSize=this.baseMeasurementFontSize,t.textBaseline=e.textBaseline;const n=e._stroke,i=(n==null?void 0:n.width)??0;if(n&&(t.lineWidth=i,t.lineJoin=n.join,t.miterLimit=n.miterLimit,t.strokeStyle=Ks(n,t)),e._fill&&(t.fillStyle=Ks(e._fill,t)),e.dropShadow){const o=e.dropShadow,a=lt.shared.setValue(o.color).toArray(),c=o.blur*r,h=o.distance*r;t.shadowColor=`rgba(${a[0]*255},${a[1]*255},${a[2]*255},${o.alpha})`,t.shadowBlur=c,t.shadowOffsetX=Math.cos(o.angle)*h,t.shadowOffsetY=Math.sin(o.angle)*h}else t.shadowColor="black",t.shadowBlur=0,t.shadowOffsetX=0,t.shadowOffsetY=0}_drawGlyph(t,e,r,n,i,o){const a=e.text,c=e.fontProperties,h=o._stroke,l=((h==null?void 0:h.width)??0)*i,d=r+l/2,f=n-l/2,u=c.descent*i,p=e.lineHeight*i;o.stroke&&l&&t.strokeText(a,d,f+p-u),o._fill&&t.fillText(a,d,f+p-u)}destroy(){super.destroy();for(let t=0;t<this.pages.length;t++){const{canvasAndContext:e,texture:r}=this.pages[t];qs.returnCanvasAndContext(e),r.destroy(!0)}this.pages=null}};Qa.defaultOptions={textureSize:512,style:new At,mipmap:!0};let to=Qa;function Wu(s,t,e,r){const n={width:0,height:0,offsetY:0,scale:t.fontSize/e.baseMeasurementFontSize,lines:[{width:0,charPositions:[],spaceWidth:0,spacesIndex:[],chars:[]}]};n.offsetY=e.baseLineOffset;let i=n.lines[0],o=null,a=!0;const c={width:0,start:0,index:0,positions:[],chars:[]},h=p=>{const g=i.width;for(let m=0;m<c.index;m++){const x=p.positions[m];i.chars.push(p.chars[m]),i.charPositions.push(x+g)}i.width+=p.width,a=!1,c.width=0,c.index=0,c.chars.length=0},l=()=>{let p=i.chars.length-1;if(r){let g=i.chars[p];for(;g===" ";)i.width-=e.chars[g].xAdvance,g=i.chars[--p]}n.width=Math.max(n.width,i.width),i={width:0,charPositions:[],chars:[],spaceWidth:0,spacesIndex:[]},a=!0,n.lines.push(i),n.height+=e.lineHeight},d=e.baseMeasurementFontSize/t.fontSize,f=t.letterSpacing*d,u=t.wordWrapWidth*d;for(let p=0;p<s.length+1;p++){let g;const m=p===s.length;m||(g=s[p]);const x=e.chars[g]||e.chars[" "];if(/(?:\s)/.test(g)||g==="\r"||g===`
`||m){if(!a&&t.wordWrap&&i.width+c.width-f>u?(l(),h(c),m||i.charPositions.push(0)):(c.start=i.width,h(c),m||i.charPositions.push(0)),g==="\r"||g===`
`)i.width!==0&&l();else if(!m){const v=x.xAdvance+(x.kerning[o]||0)+f;i.width+=v,i.spaceWidth=v,i.spacesIndex.push(i.charPositions.length),i.chars.push(g)}}else{const w=x.kerning[o]||0,v=x.xAdvance+w+f;c.positions[c.index++]=c.width+w,c.chars.push(g),c.width+=v}o=g}return l(),t.align==="center"?ju(n):t.align==="right"?$u(n):t.align==="justify"&&Vu(n),n}function ju(s){for(let t=0;t<s.lines.length;t++){const e=s.lines[t],r=s.width/2-e.width/2;for(let n=0;n<e.charPositions.length;n++)e.charPositions[n]+=r}}function $u(s){for(let t=0;t<s.lines.length;t++){const e=s.lines[t],r=s.width-e.width;for(let n=0;n<e.charPositions.length;n++)e.charPositions[n]+=r}}function Vu(s){const t=s.width;for(let e=0;e<s.lines.length;e++){const r=s.lines[e];let n=0,i=r.spacesIndex[n++],o=0;const a=r.spacesIndex.length,h=(t-r.width)/a;for(let l=0;l<r.charPositions.length;l++)l===i&&(i=r.spacesIndex[n++],o+=h),r.charPositions[l]+=o}}function Yu(s){if(s==="")return[];typeof s=="string"&&(s=[s]);const t=[];for(let e=0,r=s.length;e<r;e++){const n=s[e];if(Array.isArray(n)){if(n.length!==2)throw new Error(`[BitmapFont]: Invalid character range length, expecting 2 got ${n.length}.`);if(n[0].length===0||n[1].length===0)throw new Error("[BitmapFont]: Invalid character delimiter.");const i=n[0].charCodeAt(0),o=n[1].charCodeAt(0);if(o<i)throw new Error("[BitmapFont]: Invalid character range.");for(let a=i,c=o;a<=c;a++)t.push(String.fromCharCode(a))}else t.push(...Array.from(n))}if(t.length===0)throw new Error("[BitmapFont]: Empty set when resolving characters.");return t}let Fs=0;class Xu{constructor(){this.ALPHA=[["a","z"],["A","Z"]," "],this.NUMERIC=[["0","9"]],this.ALPHANUMERIC=[["a","z"],["A","Z"],["0","9"]," "],this.ASCII=[[" ","~"]],this.defaultOptions={chars:this.ALPHANUMERIC,resolution:1,padding:4,skipKerning:!1,textureStyle:null}}getFont(t,e){var o;let r=`${e.fontFamily}-bitmap`,n=!0;if(e._fill.fill&&!e._stroke)r+=e._fill.fill.styleKey,n=!1;else if(e._stroke||e.dropShadow){let a=e.styleKey;a=a.substring(0,a.lastIndexOf("-")),r=`${a}-bitmap`,n=!1}if(!it.has(r)){const a=new to({style:e,overrideFill:n,overrideSize:!0,...this.defaultOptions});Fs++,Fs>50&&ot("BitmapText",`You have dynamically created ${Fs} bitmap fonts, this can be inefficient. Try pre installing your font styles using \`BitmapFont.install({name:"style1", style})\``),a.once("destroy",()=>{Fs--,it.remove(r)}),it.set(r,a)}const i=it.get(r);return(o=i.ensureCharacters)==null||o.call(i,t),i}getLayout(t,e,r=!0){const n=this.getFont(t,e),i=qt.graphemeSegmenter(t);return Wu(i,e,n,r)}measureText(t,e,r=!0){return this.getLayout(t,e,r)}install(...t){var h,l,d,f;let e=t[0];typeof e=="string"&&(e={name:e,style:t[1],chars:(h=t[2])==null?void 0:h.chars,resolution:(l=t[2])==null?void 0:l.resolution,padding:(d=t[2])==null?void 0:d.padding,skipKerning:(f=t[2])==null?void 0:f.skipKerning},Y(Q,"BitmapFontManager.install(name, style, options) is deprecated, use BitmapFontManager.install({name, style, ...options})"));const r=e==null?void 0:e.name;if(!r)throw new Error("[BitmapFontManager] Property `name` is required.");e={...this.defaultOptions,...e};const n=e.style,i=n instanceof At?n:new At(n),o=i._fill.fill!==null&&i._fill.fill!==void 0,a=new to({style:i,overrideFill:o,skipKerning:e.skipKerning,padding:e.padding,resolution:e.resolution,overrideSize:!1,textureStyle:e.textureStyle}),c=Yu(e.chars);return a.ensureCharacters(c.join("")),it.set(`${r}-bitmap`,a),a.once("destroy",()=>it.remove(`${r}-bitmap`)),a}uninstall(t){const e=`${t}-bitmap`,r=it.get(e);r&&r.destroy()}}const eo=new Xu;class tc extends Ba{constructor(t,e){super();const{textures:r,data:n}=t;Object.keys(n.pages).forEach(i=>{const o=n.pages[parseInt(i,10)],a=r[o.id];this.pages.push({texture:a})}),Object.keys(n.chars).forEach(i=>{const o=n.chars[i],{frame:a,source:c}=r[o.page],h=new q(o.x+a.x,o.y+a.y,o.width,o.height),l=new $({source:c,frame:h});this.chars[i]={id:i.codePointAt(0),xOffset:o.xOffset,yOffset:o.yOffset,xAdvance:o.xAdvance,kerning:o.kerning??{},texture:l}}),this.baseRenderedFontSize=n.fontSize,this.baseMeasurementFontSize=n.fontSize,this.fontMetrics={ascent:0,descent:0,fontSize:n.fontSize},this.baseLineOffset=n.baseLineOffset,this.lineHeight=n.lineHeight,this.fontFamily=n.fontFamily,this.distanceField=n.distanceField??{type:"none",range:0},this.url=e}destroy(){super.destroy();for(let t=0;t<this.pages.length;t++){const{texture:e}=this.pages[t];e.destroy(!0)}this.pages=null}static install(t){eo.install(t)}static uninstall(t){eo.uninstall(t)}}const Gr={test(s){return typeof s=="string"&&s.startsWith("info face=")},parse(s){const t=s.match(/^[a-z]+\s+.+$/gm),e={info:[],common:[],page:[],char:[],chars:[],kerning:[],kernings:[],distanceField:[]};for(const d in t){const f=t[d].match(/^[a-z]+/gm)[0],u=t[d].match(/[a-zA-Z]+=([^\s"']+|"([^"]*)")/gm),p={};for(const g in u){const m=u[g].split("="),x=m[0],y=m[1].replace(/"/gm,""),b=parseFloat(y),w=isNaN(b)?y:b;p[x]=w}e[f].push(p)}const r={chars:{},pages:[],lineHeight:0,fontSize:0,fontFamily:"",distanceField:null,baseLineOffset:0},[n]=e.info,[i]=e.common,[o]=e.distanceField??[];o&&(r.distanceField={range:parseInt(o.distanceRange,10),type:o.fieldType}),r.fontSize=parseInt(n.size,10),r.fontFamily=n.face,r.lineHeight=parseInt(i.lineHeight,10);const a=e.page;for(let d=0;d<a.length;d++)r.pages.push({id:parseInt(a[d].id,10)||0,file:a[d].file});const c={};r.baseLineOffset=r.lineHeight-parseInt(i.base,10);const h=e.char;for(let d=0;d<h.length;d++){const f=h[d],u=parseInt(f.id,10);let p=f.letter??f.char??String.fromCharCode(u);p==="space"&&(p=" "),c[u]=p,r.chars[p]={id:u,page:parseInt(f.page,10)||0,x:parseInt(f.x,10),y:parseInt(f.y,10),width:parseInt(f.width,10),height:parseInt(f.height,10),xOffset:parseInt(f.xoffset,10),yOffset:parseInt(f.yoffset,10),xAdvance:parseInt(f.xadvance,10),kerning:{}}}const l=e.kerning||[];for(let d=0;d<l.length;d++){const f=parseInt(l[d].first,10),u=parseInt(l[d].second,10),p=parseInt(l[d].amount,10);r.chars[c[u]].kerning[c[f]]=p}return r}},so={test(s){const t=s;return typeof t!="string"&&"getElementsByTagName"in t&&t.getElementsByTagName("page").length&&t.getElementsByTagName("info")[0].getAttribute("face")!==null},parse(s){const t={chars:{},pages:[],lineHeight:0,fontSize:0,fontFamily:"",distanceField:null,baseLineOffset:0},e=s.getElementsByTagName("info")[0],r=s.getElementsByTagName("common")[0],n=s.getElementsByTagName("distanceField")[0];n&&(t.distanceField={type:n.getAttribute("fieldType"),range:parseInt(n.getAttribute("distanceRange"),10)});const i=s.getElementsByTagName("page"),o=s.getElementsByTagName("char"),a=s.getElementsByTagName("kerning");t.fontSize=parseInt(e.getAttribute("size"),10),t.fontFamily=e.getAttribute("face"),t.lineHeight=parseInt(r.getAttribute("lineHeight"),10);for(let h=0;h<i.length;h++)t.pages.push({id:parseInt(i[h].getAttribute("id"),10)||0,file:i[h].getAttribute("file")});const c={};t.baseLineOffset=t.lineHeight-parseInt(r.getAttribute("base"),10);for(let h=0;h<o.length;h++){const l=o[h],d=parseInt(l.getAttribute("id"),10);let f=l.getAttribute("letter")??l.getAttribute("char")??String.fromCharCode(d);f==="space"&&(f=" "),c[d]=f,t.chars[f]={id:d,page:parseInt(l.getAttribute("page"),10)||0,x:parseInt(l.getAttribute("x"),10),y:parseInt(l.getAttribute("y"),10),width:parseInt(l.getAttribute("width"),10),height:parseInt(l.getAttribute("height"),10),xOffset:parseInt(l.getAttribute("xoffset"),10),yOffset:parseInt(l.getAttribute("yoffset"),10),xAdvance:parseInt(l.getAttribute("xadvance"),10),kerning:{}}}for(let h=0;h<a.length;h++){const l=parseInt(a[h].getAttribute("first"),10),d=parseInt(a[h].getAttribute("second"),10),f=parseInt(a[h].getAttribute("amount"),10);t.chars[c[d]].kerning[c[l]]=f}return t}},ro={test(s){return typeof s=="string"&&s.includes("<font>")?so.test(at.get().parseXML(s)):!1},parse(s){return so.parse(at.get().parseXML(s))}},qu=[".xml",".fnt"],Ku={extension:{type:O.CacheParser,name:"cacheBitmapFont"},test:s=>s instanceof tc,getCacheableAssets(s,t){const e={};return s.forEach(r=>{e[r]=t,e[`${r}-bitmap`]=t}),e[`${t.fontFamily}-bitmap`]=t,e}},Zu={extension:{type:O.LoadParser,priority:ge.Normal},name:"loadBitmapFont",test(s){return qu.includes(Pt.extname(s).toLowerCase())},async testParse(s){return Gr.test(s)||ro.test(s)},async parse(s,t,e){const r=Gr.test(s)?Gr.parse(s):ro.parse(s),{src:n}=t,{pages:i}=r,o=[],a=r.distanceField?{scaleMode:"linear",alphaMode:"premultiply-alpha-on-upload",autoGenerateMipmaps:!1,resolution:1}:{};for(let d=0;d<i.length;++d){const f=i[d].file;let u=Pt.join(Pt.dirname(n),f);u=nn(u,n),o.push({src:u,data:a})}const c=await e.load(o),h=o.map(d=>c[d.src]);return new tc({data:r,textures:h},n)},async load(s,t){return await(await at.get().fetch(s)).text()},async unload(s,t,e){await Promise.all(s.pages.map(r=>e.unload(r.texture.source._sourceOrigin))),s.destroy()}};class Qu{constructor(t,e=!1){this._loader=t,this._assetList=[],this._isLoading=!1,this._maxConcurrent=1,this.verbose=e}add(t){t.forEach(e=>{this._assetList.push(e)}),this.verbose&&console.log("[BackgroundLoader] assets: ",this._assetList),this._isActive&&!this._isLoading&&this._next()}async _next(){if(this._assetList.length&&this._isActive){this._isLoading=!0;const t=[],e=Math.min(this._assetList.length,this._maxConcurrent);for(let r=0;r<e;r++)t.push(this._assetList.pop());await this._loader.load(t),this._isLoading=!1,this._next()}}get active(){return this._isActive}set active(t){this._isActive!==t&&(this._isActive=t,t&&!this._isLoading&&this._next())}}const Ju={extension:{type:O.CacheParser,name:"cacheTextureArray"},test:s=>Array.isArray(s)&&s.every(t=>t instanceof $),getCacheableAssets:(s,t)=>{const e={};return s.forEach(r=>{t.forEach((n,i)=>{e[r+(i===0?"":i+1)]=n})}),e}};async function ec(s){if("Image"in globalThis)return new Promise(t=>{const e=new Image;e.onload=()=>{t(!0)},e.onerror=()=>{t(!1)},e.src=s});if("createImageBitmap"in globalThis&&"fetch"in globalThis){try{const t=await(await fetch(s)).blob();await createImageBitmap(t)}catch{return!1}return!0}return!1}const tf={extension:{type:O.DetectionParser,priority:1},test:async()=>ec("data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAAB0AAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAIAAAACAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQ0MAAAAABNjb2xybmNseAACAAIAAYAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAACVtZGF0EgAKCBgANogQEAwgMg8f8D///8WfhwB8+ErK42A="),add:async s=>[...s,"avif"],remove:async s=>s.filter(t=>t!=="avif")},no=["png","jpg","jpeg"],ef={extension:{type:O.DetectionParser,priority:-1},test:()=>Promise.resolve(!0),add:async s=>[...s,...no],remove:async s=>s.filter(t=>!no.includes(t))},sf="WorkerGlobalScope"in globalThis&&globalThis instanceof globalThis.WorkerGlobalScope;function Nn(s){return sf?!1:document.createElement("video").canPlayType(s)!==""}const rf={extension:{type:O.DetectionParser,priority:0},test:async()=>Nn("video/mp4"),add:async s=>[...s,"mp4","m4v"],remove:async s=>s.filter(t=>t!=="mp4"&&t!=="m4v")},nf={extension:{type:O.DetectionParser,priority:0},test:async()=>Nn("video/ogg"),add:async s=>[...s,"ogv"],remove:async s=>s.filter(t=>t!=="ogv")},of={extension:{type:O.DetectionParser,priority:0},test:async()=>Nn("video/webm"),add:async s=>[...s,"webm"],remove:async s=>s.filter(t=>t!=="webm")},af={extension:{type:O.DetectionParser,priority:0},test:async()=>ec("data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAAAAAAfQ//73v/+BiOh/AAA="),add:async s=>[...s,"webp"],remove:async s=>s.filter(t=>t!=="webp")};class cf{constructor(){this._parsers=[],this._parsersValidated=!1,this.parsers=new Proxy(this._parsers,{set:(t,e,r)=>(this._parsersValidated=!1,t[e]=r,!0)}),this.promiseCache={}}reset(){this._parsersValidated=!1,this.promiseCache={}}_getLoadPromiseAndParser(t,e){const r={promise:null,parser:null};return r.promise=(async()=>{var o,a;let n=null,i=null;if(e.loadParser&&(i=this._parserHash[e.loadParser],i||ot(`[Assets] specified load parser "${e.loadParser}" not found while loading ${t}`)),!i){for(let c=0;c<this.parsers.length;c++){const h=this.parsers[c];if(h.load&&((o=h.test)!=null&&o.call(h,t,e,this))){i=h;break}}if(!i)return ot(`[Assets] ${t} could not be loaded as we don't know how to parse it, ensure the correct parser has been added`),null}n=await i.load(t,e,this),r.parser=i;for(let c=0;c<this.parsers.length;c++){const h=this.parsers[c];h.parse&&h.parse&&await((a=h.testParse)==null?void 0:a.call(h,n,e,this))&&(n=await h.parse(n,e,this)||n,r.parser=h)}return n})(),r}async load(t,e){this._parsersValidated||this._validateParsers();let r=0;const n={},i=Vs(t),o=Ut(t,h=>({alias:[h],src:h,data:{}})),a=o.length,c=o.map(async h=>{const l=Pt.toAbsolute(h.src);if(!n[h.src])try{this.promiseCache[l]||(this.promiseCache[l]=this._getLoadPromiseAndParser(l,h)),n[h.src]=await this.promiseCache[l].promise,e&&e(++r/a)}catch(d){throw delete this.promiseCache[l],delete n[h.src],new Error(`[Loader.load] Failed to load ${l}.
${d}`)}});return await Promise.all(c),i?n[o[0].src]:n}async unload(t){const r=Ut(t,n=>({alias:[n],src:n})).map(async n=>{var a,c;const i=Pt.toAbsolute(n.src),o=this.promiseCache[i];if(o){const h=await o.promise;delete this.promiseCache[i],await((c=(a=o.parser)==null?void 0:a.unload)==null?void 0:c.call(a,h,n,this))}});await Promise.all(r)}_validateParsers(){this._parsersValidated=!0,this._parserHash=this._parsers.filter(t=>t.name).reduce((t,e)=>(e.name?t[e.name]&&ot(`[Assets] loadParser name conflict "${e.name}"`):ot("[Assets] loadParser should have a name"),{...t,[e.name]:e}),{})}}function qe(s,t){if(Array.isArray(t)){for(const e of t)if(s.startsWith(`data:${e}`))return!0;return!1}return s.startsWith(`data:${t}`)}function Ke(s,t){const e=s.split("?")[0],r=Pt.extname(e).toLowerCase();return Array.isArray(t)?t.includes(r):r===t}const lf=".json",hf="application/json",df={extension:{type:O.LoadParser,priority:ge.Low},name:"loadJson",test(s){return qe(s,hf)||Ke(s,lf)},async load(s){return await(await at.get().fetch(s)).json()}},uf=".txt",ff="text/plain",pf={name:"loadTxt",extension:{type:O.LoadParser,priority:ge.Low,name:"loadTxt"},test(s){return qe(s,ff)||Ke(s,uf)},async load(s){return await(await at.get().fetch(s)).text()}},mf=["normal","bold","100","200","300","400","500","600","700","800","900"],gf=[".ttf",".otf",".woff",".woff2"],xf=["font/ttf","font/otf","font/woff","font/woff2"],yf=/^(--|-?[A-Z_])[0-9A-Z_-]*$/i;function bf(s){const t=Pt.extname(s),n=Pt.basename(s,t).replace(/(-|_)/g," ").toLowerCase().split(" ").map(a=>a.charAt(0).toUpperCase()+a.slice(1));let i=n.length>0;for(const a of n)if(!a.match(yf)){i=!1;break}let o=n.join(" ");return i||(o=`"${o.replace(/[\\"]/g,"\\$&")}"`),o}const wf=/^[0-9A-Za-z%:/?#\[\]@!\$&'()\*\+,;=\-._~]*$/;function _f(s){return wf.test(s)?s:encodeURI(s)}const vf={extension:{type:O.LoadParser,priority:ge.Low},name:"loadWebFont",test(s){return qe(s,xf)||Ke(s,gf)},async load(s,t){var r,n,i;const e=at.get().getFontFaceSet();if(e){const o=[],a=((r=t.data)==null?void 0:r.family)??bf(s),c=((i=(n=t.data)==null?void 0:n.weights)==null?void 0:i.filter(l=>mf.includes(l)))??["normal"],h=t.data??{};for(let l=0;l<c.length;l++){const d=c[l],f=new FontFace(a,`url(${_f(s)})`,{...h,weight:d});await f.load(),e.add(f),o.push(f)}return it.set(`${a}-and-url`,{url:s,fontFaces:o}),o.length===1?o[0]:o}return ot("[loadWebFont] FontFace API is not supported. Skipping loading font"),null},unload(s){(Array.isArray(s)?s:[s]).forEach(t=>{it.remove(`${t.family}-and-url`),at.get().getFontFaceSet().delete(t)})}};function On(s,t=1){var r;const e=(r=Xe.RETINA_PREFIX)==null?void 0:r.exec(s);return e?parseFloat(e[1]):t}function Un(s,t,e){s.label=e,s._sourceOrigin=e;const r=new $({source:s,label:e}),n=()=>{delete t.promiseCache[e],it.has(e)&&it.remove(e)};return r.source.once("destroy",()=>{t.promiseCache[e]&&(ot("[Assets] A TextureSource managed by Assets was destroyed instead of unloaded! Use Assets.unload() instead of destroying the TextureSource."),n())}),r.once("destroy",()=>{s.destroyed||(ot("[Assets] A Texture managed by Assets was destroyed instead of unloaded! Use Assets.unload() instead of destroying the Texture."),n())}),r}const Af=".svg",Sf="image/svg+xml",Cf={extension:{type:O.LoadParser,priority:ge.Low,name:"loadSVG"},name:"loadSVG",config:{crossOrigin:"anonymous",parseAsGraphicsContext:!1},test(s){return qe(s,Sf)||Ke(s,Af)},async load(s,t,e){var r;return((r=t.data)==null?void 0:r.parseAsGraphicsContext)??this.config.parseAsGraphicsContext?Pf(s):kf(s,t,e,this.config.crossOrigin)},unload(s){s.destroy(!0)}};async function kf(s,t,e,r){var m,x,y;const i=await(await at.get().fetch(s)).blob(),o=URL.createObjectURL(i),a=new Image;a.src=o,a.crossOrigin=r,await a.decode(),URL.revokeObjectURL(o);const c=document.createElement("canvas"),h=c.getContext("2d"),l=((m=t.data)==null?void 0:m.resolution)||On(s),d=((x=t.data)==null?void 0:x.width)??a.width,f=((y=t.data)==null?void 0:y.height)??a.height;c.width=d*l,c.height=f*l,h.drawImage(a,0,0,d*l,f*l);const{parseAsGraphicsContext:u,...p}=t.data??{},g=new Be({resource:c,alphaMode:"premultiply-alpha-on-upload",resolution:l,...p});return Un(g,e,s)}async function Pf(s){const e=await(await at.get().fetch(s)).text(),r=new Ft;return r.svg(e),r}const Mf=`(function () {
    'use strict';

    const WHITE_PNG = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mP8/x8AAwMCAO+ip1sAAAAASUVORK5CYII=";
    async function checkImageBitmap() {
      try {
        if (typeof createImageBitmap !== "function")
          return false;
        const response = await fetch(WHITE_PNG);
        const imageBlob = await response.blob();
        const imageBitmap = await createImageBitmap(imageBlob);
        return imageBitmap.width === 1 && imageBitmap.height === 1;
      } catch (_e) {
        return false;
      }
    }
    void checkImageBitmap().then((result) => {
      self.postMessage(result);
    });

})();
`;let Oe=null,xn=class{constructor(){Oe||(Oe=URL.createObjectURL(new Blob([Mf],{type:"application/javascript"}))),this.worker=new Worker(Oe)}};xn.revokeObjectURL=function(){Oe&&(URL.revokeObjectURL(Oe),Oe=null)};const Tf=`(function () {
    'use strict';

    async function loadImageBitmap(url, alphaMode) {
      const response = await fetch(url);
      if (!response.ok) {
        throw new Error(\`[WorkerManager.loadImageBitmap] Failed to fetch \${url}: \${response.status} \${response.statusText}\`);
      }
      const imageBlob = await response.blob();
      return alphaMode === "premultiplied-alpha" ? createImageBitmap(imageBlob, { premultiplyAlpha: "none" }) : createImageBitmap(imageBlob);
    }
    self.onmessage = async (event) => {
      try {
        const imageBitmap = await loadImageBitmap(event.data.data[0], event.data.data[1]);
        self.postMessage({
          data: imageBitmap,
          uuid: event.data.uuid,
          id: event.data.id
        }, [imageBitmap]);
      } catch (e) {
        self.postMessage({
          error: e,
          uuid: event.data.uuid,
          id: event.data.id
        });
      }
    };

})();
`;let Ue=null;class sc{constructor(){Ue||(Ue=URL.createObjectURL(new Blob([Tf],{type:"application/javascript"}))),this.worker=new Worker(Ue)}}sc.revokeObjectURL=function(){Ue&&(URL.revokeObjectURL(Ue),Ue=null)};let io=0,Nr;class Ef{constructor(){this._initialized=!1,this._createdWorkers=0,this._workerPool=[],this._queue=[],this._resolveHash={}}isImageBitmapSupported(){return this._isImageBitmapSupported!==void 0?this._isImageBitmapSupported:(this._isImageBitmapSupported=new Promise(t=>{const{worker:e}=new xn;e.addEventListener("message",r=>{e.terminate(),xn.revokeObjectURL(),t(r.data)})}),this._isImageBitmapSupported)}loadImageBitmap(t,e){var r;return this._run("loadImageBitmap",[t,(r=e==null?void 0:e.data)==null?void 0:r.alphaMode])}async _initWorkers(){this._initialized||(this._initialized=!0)}_getWorker(){Nr===void 0&&(Nr=navigator.hardwareConcurrency||4);let t=this._workerPool.pop();return!t&&this._createdWorkers<Nr&&(this._createdWorkers++,t=new sc().worker,t.addEventListener("message",e=>{this._complete(e.data),this._returnWorker(e.target),this._next()})),t}_returnWorker(t){this._workerPool.push(t)}_complete(t){t.error!==void 0?this._resolveHash[t.uuid].reject(t.error):this._resolveHash[t.uuid].resolve(t.data),this._resolveHash[t.uuid]=null}async _run(t,e){await this._initWorkers();const r=new Promise((n,i)=>{this._queue.push({id:t,arguments:e,resolve:n,reject:i})});return this._next(),r}_next(){if(!this._queue.length)return;const t=this._getWorker();if(!t)return;const e=this._queue.pop(),r=e.id;this._resolveHash[io]={resolve:e.resolve,reject:e.reject},t.postMessage({data:e.arguments,uuid:io++,id:r})}}const oo=new Ef,If=[".jpeg",".jpg",".png",".webp",".avif"],Bf=["image/jpeg","image/png","image/webp","image/avif"];async function Ff(s,t){var n;const e=await at.get().fetch(s);if(!e.ok)throw new Error(`[loadImageBitmap] Failed to fetch ${s}: ${e.status} ${e.statusText}`);const r=await e.blob();return((n=t==null?void 0:t.data)==null?void 0:n.alphaMode)==="premultiplied-alpha"?createImageBitmap(r,{premultiplyAlpha:"none"}):createImageBitmap(r)}const rc={name:"loadTextures",extension:{type:O.LoadParser,priority:ge.High,name:"loadTextures"},config:{preferWorkers:!0,preferCreateImageBitmap:!0,crossOrigin:"anonymous"},test(s){return qe(s,Bf)||Ke(s,If)},async load(s,t,e){var i;let r=null;globalThis.createImageBitmap&&this.config.preferCreateImageBitmap?this.config.preferWorkers&&await oo.isImageBitmapSupported()?r=await oo.loadImageBitmap(s,t):r=await Ff(s,t):r=await new Promise((o,a)=>{r=new Image,r.crossOrigin=this.config.crossOrigin,r.src=s,r.complete?o(r):(r.onload=()=>{o(r)},r.onerror=a)});const n=new Be({resource:r,alphaMode:"premultiply-alpha-on-upload",resolution:((i=t.data)==null?void 0:i.resolution)||On(s),...t.data});return Un(n,e,s)},unload(s){s.destroy(!0)}},nc=[".mp4",".m4v",".webm",".ogg",".ogv",".h264",".avi",".mov"],Rf=nc.map(s=>`video/${s.substring(1)}`);function Lf(s,t,e){e===void 0&&!t.startsWith("data:")?s.crossOrigin=Gf(t):e!==!1&&(s.crossOrigin=typeof e=="string"?e:"anonymous")}function zf(s){return new Promise((t,e)=>{s.addEventListener("canplaythrough",r),s.addEventListener("error",n),s.load();function r(){i(),t()}function n(o){i(),e(o)}function i(){s.removeEventListener("canplaythrough",r),s.removeEventListener("error",n)}})}function Gf(s,t=globalThis.location){if(s.startsWith("data:"))return"";t||(t=globalThis.location);const e=new URL(s,document.baseURI);return e.hostname!==t.hostname||e.port!==t.port||e.protocol!==t.protocol?"anonymous":""}const Nf={name:"loadVideo",extension:{type:O.LoadParser,name:"loadVideo"},test(s){const t=qe(s,Rf),e=Ke(s,nc);return t||e},async load(s,t,e){var c,h;const r={...Hs.defaultOptions,resolution:((c=t.data)==null?void 0:c.resolution)||On(s),alphaMode:((h=t.data)==null?void 0:h.alphaMode)||await aa(),...t.data},n=document.createElement("video"),i={preload:r.autoLoad!==!1?"auto":void 0,"webkit-playsinline":r.playsinline!==!1?"":void 0,playsinline:r.playsinline!==!1?"":void 0,muted:r.muted===!0?"":void 0,loop:r.loop===!0?"":void 0,autoplay:r.autoPlay!==!1?"":void 0};Object.keys(i).forEach(l=>{const d=i[l];d!==void 0&&n.setAttribute(l,d)}),r.muted===!0&&(n.muted=!0),Lf(n,s,r.crossorigin);const o=document.createElement("source");let a;if(s.startsWith("data:"))a=s.slice(5,s.indexOf(";"));else if(!s.startsWith("blob:")){const l=s.split("?")[0].slice(s.lastIndexOf(".")+1).toLowerCase();a=Hs.MIME_TYPES[l]||`video/${l}`}return o.src=s,a&&(o.type=a),new Promise(l=>{const d=async()=>{const f=new Hs({...r,resource:n});n.removeEventListener("canplay",d),t.data.preload&&await zf(n),l(Un(f,e,s))};r.preload&&!r.autoPlay&&n.load(),n.addEventListener("canplay",d),n.appendChild(o)})},unload(s){s.destroy(!0)}},ic={extension:{type:O.ResolveParser,name:"resolveTexture"},test:rc.test,parse:s=>{var t;return{resolution:parseFloat(((t=Xe.RETINA_PREFIX.exec(s))==null?void 0:t[1])??"1"),format:s.split(".").pop(),src:s}}},Of={extension:{type:O.ResolveParser,priority:-2,name:"resolveJson"},test:s=>Xe.RETINA_PREFIX.test(s)&&s.endsWith(".json"),parse:ic.parse};class Uf{constructor(){this._detections=[],this._initialized=!1,this.resolver=new Xe,this.loader=new cf,this.cache=it,this._backgroundLoader=new Qu(this.loader),this._backgroundLoader.active=!0,this.reset()}async init(t={}){var i,o;if(this._initialized){ot("[Assets]AssetManager already initialized, did you load before calling this Assets.init()?");return}if(this._initialized=!0,t.defaultSearchParams&&this.resolver.setDefaultSearchParams(t.defaultSearchParams),t.basePath&&(this.resolver.basePath=t.basePath),t.bundleIdentifier&&this.resolver.setBundleIdentifier(t.bundleIdentifier),t.manifest){let a=t.manifest;typeof a=="string"&&(a=await this.load(a)),this.resolver.addManifest(a)}const e=((i=t.texturePreference)==null?void 0:i.resolution)??1,r=typeof e=="number"?[e]:e,n=await this._detectFormats({preferredFormats:(o=t.texturePreference)==null?void 0:o.format,skipDetections:t.skipDetections,detections:this._detections});this.resolver.prefer({params:{format:n,resolution:r}}),t.preferences&&this.setPreferences(t.preferences)}add(t){this.resolver.add(t)}async load(t,e){this._initialized||await this.init();const r=Vs(t),n=Ut(t).map(a=>{if(typeof a!="string"){const c=this.resolver.getAlias(a);return c.some(h=>!this.resolver.hasKey(h))&&this.add(a),Array.isArray(c)?c[0]:c}return this.resolver.hasKey(a)||this.add({alias:a,src:a}),a}),i=this.resolver.resolve(n),o=await this._mapLoadToResolve(i,e);return r?o[n[0]]:o}addBundle(t,e){this.resolver.addBundle(t,e)}async loadBundle(t,e){this._initialized||await this.init();let r=!1;typeof t=="string"&&(r=!0,t=[t]);const n=this.resolver.resolveBundle(t),i={},o=Object.keys(n);let a=0,c=0;const h=()=>{e==null||e(++a/c)},l=o.map(d=>{const f=n[d];return c+=Object.keys(f).length,this._mapLoadToResolve(f,h).then(u=>{i[d]=u})});return await Promise.all(l),r?i[t[0]]:i}async backgroundLoad(t){this._initialized||await this.init(),typeof t=="string"&&(t=[t]);const e=this.resolver.resolve(t);this._backgroundLoader.add(Object.values(e))}async backgroundLoadBundle(t){this._initialized||await this.init(),typeof t=="string"&&(t=[t]);const e=this.resolver.resolveBundle(t);Object.values(e).forEach(r=>{this._backgroundLoader.add(Object.values(r))})}reset(){this.resolver.reset(),this.loader.reset(),this.cache.reset(),this._initialized=!1}get(t){if(typeof t=="string")return it.get(t);const e={};for(let r=0;r<t.length;r++)e[r]=it.get(t[r]);return e}async _mapLoadToResolve(t,e){const r=[...new Set(Object.values(t))];this._backgroundLoader.active=!1;const n=await this.loader.load(r,e);this._backgroundLoader.active=!0;const i={};return r.forEach(o=>{const a=n[o.src],c=[o.src];o.alias&&c.push(...o.alias),c.forEach(h=>{i[h]=a}),it.set(c,a)}),i}async unload(t){this._initialized||await this.init();const e=Ut(t).map(n=>typeof n!="string"?n.src:n),r=this.resolver.resolve(e);await this._unloadFromResolved(r)}async unloadBundle(t){this._initialized||await this.init(),t=Ut(t);const e=this.resolver.resolveBundle(t),r=Object.keys(e).map(n=>this._unloadFromResolved(e[n]));await Promise.all(r)}async _unloadFromResolved(t){const e=Object.values(t);e.forEach(r=>{it.remove(r.src)}),await this.loader.unload(e)}async _detectFormats(t){let e=[];t.preferredFormats&&(e=Array.isArray(t.preferredFormats)?t.preferredFormats:[t.preferredFormats]);for(const r of t.detections)t.skipDetections||await r.test()?e=await r.add(e):t.skipDetections||(e=await r.remove(e));return e=e.filter((r,n)=>e.indexOf(r)===n),e}get detections(){return this._detections}setPreferences(t){this.loader.parsers.forEach(e=>{e.config&&Object.keys(e.config).filter(r=>r in t).forEach(r=>{e.config[r]=t[r]})})}}const kt=new Uf;pt.handleByList(O.LoadParser,kt.loader.parsers).handleByList(O.ResolveParser,kt.resolver.parsers).handleByList(O.CacheParser,kt.cache.parsers).handleByList(O.DetectionParser,kt.detections);pt.add(Ju,ef,tf,af,rf,nf,of,df,pf,vf,Cf,rc,Nf,Zu,Ku,ic,Of);const ao={loader:O.LoadParser,resolver:O.ResolveParser,cache:O.CacheParser,detection:O.DetectionParser};pt.handle(O.Asset,s=>{const t=s.ref;Object.entries(ao).filter(([e])=>!!t[e]).forEach(([e,r])=>pt.add(Object.assign(t[e],{extension:t[e].extension??r})))},s=>{const t=s.ref;Object.keys(ao).filter(e=>!!t[e]).forEach(e=>pt.remove(t[e]))});class tt extends Mn{constructor(t){t instanceof Ft&&(t={context:t});const{context:e,roundPixels:r,...n}=t||{};super({label:"Graphics",...n}),this.renderPipeId="graphics",e?this._context=e:this._context=this._ownedContext=new Ft,this._context.on("update",this.onViewUpdate,this),this.didViewUpdate=!0,this.allowChildren=!1,this.roundPixels=r??!1}set context(t){t!==this._context&&(this._context.off("update",this.onViewUpdate,this),this._context=t,this._context.on("update",this.onViewUpdate,this),this.onViewUpdate())}get context(){return this._context}get bounds(){return this._context.bounds}updateBounds(){}containsPoint(t){return this._context.containsPoint(t)}destroy(t){this._ownedContext&&!t?this._ownedContext.destroy(t):(t===!0||(t==null?void 0:t.context)===!0)&&this._context.destroy(t),this._ownedContext=null,this._context=null,super.destroy(t)}_callContextMethod(t,e){return this.context[t](...e),this}setFillStyle(...t){return this._callContextMethod("setFillStyle",t)}setStrokeStyle(...t){return this._callContextMethod("setStrokeStyle",t)}fill(...t){return this._callContextMethod("fill",t)}stroke(...t){return this._callContextMethod("stroke",t)}texture(...t){return this._callContextMethod("texture",t)}beginPath(){return this._callContextMethod("beginPath",[])}cut(){return this._callContextMethod("cut",[])}arc(...t){return this._callContextMethod("arc",t)}arcTo(...t){return this._callContextMethod("arcTo",t)}arcToSvg(...t){return this._callContextMethod("arcToSvg",t)}bezierCurveTo(...t){return this._callContextMethod("bezierCurveTo",t)}closePath(){return this._callContextMethod("closePath",[])}ellipse(...t){return this._callContextMethod("ellipse",t)}circle(...t){return this._callContextMethod("circle",t)}path(...t){return this._callContextMethod("path",t)}lineTo(...t){return this._callContextMethod("lineTo",t)}moveTo(...t){return this._callContextMethod("moveTo",t)}quadraticCurveTo(...t){return this._callContextMethod("quadraticCurveTo",t)}rect(...t){return this._callContextMethod("rect",t)}roundRect(...t){return this._callContextMethod("roundRect",t)}poly(...t){return this._callContextMethod("poly",t)}regularPoly(...t){return this._callContextMethod("regularPoly",t)}roundPoly(...t){return this._callContextMethod("roundPoly",t)}roundShape(...t){return this._callContextMethod("roundShape",t)}filletRect(...t){return this._callContextMethod("filletRect",t)}chamferRect(...t){return this._callContextMethod("chamferRect",t)}star(...t){return this._callContextMethod("star",t)}svg(...t){return this._callContextMethod("svg",t)}restore(...t){return this._callContextMethod("restore",t)}save(){return this._callContextMethod("save",[])}getTransform(){return this.context.getTransform()}resetTransform(){return this._callContextMethod("resetTransform",[])}rotateTransform(...t){return this._callContextMethod("rotate",t)}scaleTransform(...t){return this._callContextMethod("scale",t)}setTransform(...t){return this._callContextMethod("setTransform",t)}transform(...t){return this._callContextMethod("transform",t)}translateTransform(...t){return this._callContextMethod("translate",t)}clear(){return this._callContextMethod("clear",[])}get fillStyle(){return this._context.fillStyle}set fillStyle(t){this._context.fillStyle=t}get strokeStyle(){return this._context.strokeStyle}set strokeStyle(t){this._context.strokeStyle=t}clone(t=!1){return t?new tt(this._context.clone()):(this._ownedContext=null,new tt(this._context))}lineStyle(t,e,r){Y(Q,"Graphics#lineStyle is no longer needed. Use Graphics#setStrokeStyle to set the stroke style.");const n={};return t&&(n.width=t),e&&(n.color=e),r&&(n.alpha=r),this.context.strokeStyle=n,this}beginFill(t,e){Y(Q,"Graphics#beginFill is no longer needed. Use Graphics#fill to fill the shape with the desired style.");const r={};return t!==void 0&&(r.color=t),e!==void 0&&(r.alpha=e),this.context.fillStyle=r,this}endFill(){Y(Q,"Graphics#endFill is no longer needed. Use Graphics#fill to fill the shape with the desired style."),this.context.fill();const t=this.context.strokeStyle;return(t.width!==Ft.defaultStrokeStyle.width||t.color!==Ft.defaultStrokeStyle.color||t.alpha!==Ft.defaultStrokeStyle.alpha)&&this.context.stroke(),this}drawCircle(...t){return Y(Q,"Graphics#drawCircle has been renamed to Graphics#circle"),this._callContextMethod("circle",t)}drawEllipse(...t){return Y(Q,"Graphics#drawEllipse has been renamed to Graphics#ellipse"),this._callContextMethod("ellipse",t)}drawPolygon(...t){return Y(Q,"Graphics#drawPolygon has been renamed to Graphics#poly"),this._callContextMethod("poly",t)}drawRect(...t){return Y(Q,"Graphics#drawRect has been renamed to Graphics#rect"),this._callContextMethod("rect",t)}drawRoundedRect(...t){return Y(Q,"Graphics#drawRoundedRect has been renamed to Graphics#roundRect"),this._callContextMethod("roundRect",t)}drawStar(...t){return Y(Q,"Graphics#drawStar has been renamed to Graphics#star"),this._callContextMethod("star",t)}}class Zs extends Gt{constructor(...t){let e=t[0];Array.isArray(t[0])&&(e={textures:t[0],autoUpdate:t[1]});const{animationSpeed:r=1,autoPlay:n=!1,autoUpdate:i=!0,loop:o=!0,onComplete:a=null,onFrameChange:c=null,onLoop:h=null,textures:l,updateAnchor:d=!1,...f}=e,[u]=l;super({...f,texture:u instanceof $?u:u.texture}),this._textures=null,this._durations=null,this._autoUpdate=i,this._isConnectedToTicker=!1,this.animationSpeed=r,this.loop=o,this.updateAnchor=d,this.onComplete=a,this.onFrameChange=c,this.onLoop=h,this._currentTime=0,this._playing=!1,this._previousFrame=null,this.textures=l,n&&this.play()}stop(){this._playing&&(this._playing=!1,this._autoUpdate&&this._isConnectedToTicker&&(Dt.shared.remove(this.update,this),this._isConnectedToTicker=!1))}play(){this._playing||(this._playing=!0,this._autoUpdate&&!this._isConnectedToTicker&&(Dt.shared.add(this.update,this,$s.HIGH),this._isConnectedToTicker=!0))}gotoAndStop(t){this.stop(),this.currentFrame=t}gotoAndPlay(t){this.currentFrame=t,this.play()}update(t){if(!this._playing)return;const e=t.deltaTime,r=this.animationSpeed*e,n=this.currentFrame;if(this._durations!==null){let i=this._currentTime%1*this._durations[this.currentFrame];for(i+=r/60*1e3;i<0;)this._currentTime--,i+=this._durations[this.currentFrame];const o=Math.sign(this.animationSpeed*e);for(this._currentTime=Math.floor(this._currentTime);i>=this._durations[this.currentFrame];)i-=this._durations[this.currentFrame]*o,this._currentTime+=o;this._currentTime+=i/this._durations[this.currentFrame]}else this._currentTime+=r;this._currentTime<0&&!this.loop?(this.gotoAndStop(0),this.onComplete&&this.onComplete()):this._currentTime>=this._textures.length&&!this.loop?(this.gotoAndStop(this._textures.length-1),this.onComplete&&this.onComplete()):n!==this.currentFrame&&(this.loop&&this.onLoop&&(this.animationSpeed>0&&this.currentFrame<n||this.animationSpeed<0&&this.currentFrame>n)&&this.onLoop(),this._updateTexture())}_updateTexture(){const t=this.currentFrame;this._previousFrame!==t&&(this._previousFrame=t,this.texture=this._textures[t],this.updateAnchor&&this.texture.defaultAnchor&&this.anchor.copyFrom(this.texture.defaultAnchor),this.onFrameChange&&this.onFrameChange(this.currentFrame))}destroy(){this.stop(),super.destroy(),this.onComplete=null,this.onFrameChange=null,this.onLoop=null}static fromFrames(t){const e=[];for(let r=0;r<t.length;++r)e.push($.from(t[r]));return new Zs(e)}static fromImages(t){const e=[];for(let r=0;r<t.length;++r)e.push($.from(t[r]));return new Zs(e)}get totalFrames(){return this._textures.length}get textures(){return this._textures}set textures(t){if(t[0]instanceof $)this._textures=t,this._durations=null;else{this._textures=[],this._durations=[];for(let e=0;e<t.length;e++)this._textures.push(t[e].texture),this._durations.push(t[e].time)}this._previousFrame=null,this.gotoAndStop(0),this._updateTexture()}get currentFrame(){let t=Math.floor(this._currentTime)%this._textures.length;return t<0&&(t+=this._textures.length),t}set currentFrame(t){if(t<0||t>this.totalFrames-1)throw new Error(`[AnimatedSprite]: Invalid frame index value ${t}, expected to be between 0 and totalFrames ${this.totalFrames}.`);const e=this.currentFrame;this._currentTime=t,e!==this.currentFrame&&this._updateTexture()}get playing(){return this._playing}get autoUpdate(){return this._autoUpdate}set autoUpdate(t){t!==this._autoUpdate&&(this._autoUpdate=t,!this._autoUpdate&&this._isConnectedToTicker?(Dt.shared.remove(this.update,this),this._isConnectedToTicker=!1):this._autoUpdate&&!this._isConnectedToTicker&&this._playing&&(Dt.shared.add(this.update,this),this._isConnectedToTicker=!0))}}class Df extends Mn{constructor(t,e){const{text:r,resolution:n,style:i,anchor:o,width:a,height:c,roundPixels:h,...l}=t;super({...l}),this.batched=!0,this._resolution=null,this._autoResolution=!0,this._didTextUpdate=!0,this._styleClass=e,this.text=r??"",this.style=i,this.resolution=n??null,this.allowChildren=!1,this._anchor=new wt({_onUpdate:()=>{this.onViewUpdate()}}),o&&(this.anchor=o),this.roundPixels=h??!1,a!==void 0&&(this.width=a),c!==void 0&&(this.height=c)}get anchor(){return this._anchor}set anchor(t){typeof t=="number"?this._anchor.set(t):this._anchor.copyFrom(t)}set text(t){t=t.toString(),this._text!==t&&(this._text=t,this.onViewUpdate())}get text(){return this._text}set resolution(t){this._autoResolution=t===null,this._resolution=t,this.onViewUpdate()}get resolution(){return this._resolution}get style(){return this._style}set style(t){var e;t||(t={}),(e=this._style)==null||e.off("update",this.onViewUpdate,this),t instanceof this._styleClass?this._style=t:this._style=new this._styleClass(t),this._style.on("update",this.onViewUpdate,this),this.onViewUpdate()}get width(){return Math.abs(this.scale.x)*this.bounds.width}set width(t){this._setWidth(t,this.bounds.width)}get height(){return Math.abs(this.scale.y)*this.bounds.height}set height(t){this._setHeight(t,this.bounds.height)}getSize(t){return t||(t={}),t.width=Math.abs(this.scale.x)*this.bounds.width,t.height=Math.abs(this.scale.y)*this.bounds.height,t}setSize(t,e){typeof t=="object"?(e=t.height??t.width,t=t.width):e??(e=t),t!==void 0&&this._setWidth(t,this.bounds.width),e!==void 0&&this._setHeight(e,this.bounds.height)}containsPoint(t){const e=this.bounds.width,r=this.bounds.height,n=-e*this.anchor.x;let i=0;return t.x>=n&&t.x<=n+e&&(i=-r*this.anchor.y,t.y>=i&&t.y<=i+r)}onViewUpdate(){this.didViewUpdate||(this._didTextUpdate=!0),super.onViewUpdate()}destroy(t=!1){super.destroy(t),this.owner=null,this._bounds=null,this._anchor=null,(typeof t=="boolean"?t:t!=null&&t.style)&&this._style.destroy(t),this._style=null,this._text=null}}function Hf(s,t){let e=s[0]??{};return(typeof e=="string"||s[1])&&(Y(Q,`use new ${t}({ text: "hi!", style }) instead`),e={text:e,style:s[1]}),e}let _e=null,re=null;function Wf(s,t){_e||(_e=at.get().createCanvas(256,128),re=_e.getContext("2d",{willReadFrequently:!0}),re.globalCompositeOperation="copy",re.globalAlpha=1),(_e.width<s||_e.height<t)&&(_e.width=De(s),_e.height=De(t))}function co(s,t,e){for(let r=0,n=4*e*t;r<t;++r,n+=4)if(s[n+3]!==0)return!1;return!0}function lo(s,t,e,r,n){const i=4*t;for(let o=r,a=r*i+4*e;o<=n;++o,a+=i)if(s[a+3]!==0)return!1;return!0}function jf(...s){let t=s[0];t.canvas||(t={canvas:s[0],resolution:s[1]});const{canvas:e}=t,r=Math.min(t.resolution??1,1),n=t.width??e.width,i=t.height??e.height;let o=t.output;if(Wf(n,i),!re)throw new TypeError("Failed to get canvas 2D context");re.drawImage(e,0,0,n,i,0,0,n*r,i*r);const c=re.getImageData(0,0,n,i).data;let h=0,l=0,d=n-1,f=i-1;for(;l<i&&co(c,n,l);)++l;if(l===i)return q.EMPTY;for(;co(c,n,f);)--f;for(;lo(c,n,h,l,f);)++h;for(;lo(c,n,d,l,f);)--d;return++d,++f,re.globalCompositeOperation="source-over",re.strokeRect(h,l,d-h,f-l),re.globalCompositeOperation="copy",o??(o=new q),o.set(h/r,l/r,(d-h)/r,(f-l)/r),o}const ho=new q;class $f{getCanvasAndContext(t){const{text:e,style:r,resolution:n=1}=t,i=r._getFinalPadding(),o=qt.measureText(e||" ",r),a=Math.ceil(Math.ceil(Math.max(1,o.width)+i*2)*n),c=Math.ceil(Math.ceil(Math.max(1,o.height)+i*2)*n),h=qs.getOptimalCanvasAndContext(a,c);this._renderTextToCanvas(e,r,i,n,h);const l=r.trim?jf({canvas:h.canvas,width:a,height:c,resolution:1,output:ho}):ho.set(0,0,a,c);return{canvasAndContext:h,frame:l}}returnCanvasAndContext(t){qs.returnCanvasAndContext(t)}_renderTextToCanvas(t,e,r,n,i){var b,w,v,S;const{canvas:o,context:a}=i,c=Ys(e),h=qt.measureText(t||" ",e),l=h.lines,d=h.lineHeight,f=h.lineWidths,u=h.maxLineWidth,p=h.fontProperties,g=o.height;if(a.resetTransform(),a.scale(n,n),a.textBaseline=e.textBaseline,(b=e._stroke)!=null&&b.width){const k=e._stroke;a.lineWidth=k.width,a.miterLimit=k.miterLimit,a.lineJoin=k.join,a.lineCap=k.cap}a.font=c;let m,x;const y=e.dropShadow?2:1;for(let k=0;k<y;++k){const P=e.dropShadow&&k===0,_=P?Math.ceil(Math.max(1,g)+r*2):0,C=_*n;if(P){a.fillStyle="black",a.strokeStyle="black";const E=e.dropShadow,F=E.color,R=E.alpha;a.shadowColor=lt.shared.setValue(F).setAlpha(R).toRgbaString();const T=E.blur*n,I=E.distance*n;a.shadowBlur=T,a.shadowOffsetX=Math.cos(E.angle)*I,a.shadowOffsetY=Math.sin(E.angle)*I+C}else{if(a.fillStyle=e._fill?Ks(e._fill,a,h):null,(w=e._stroke)!=null&&w.width){const E=e._stroke.width*e._stroke.alignment;a.strokeStyle=Ks(e._stroke,a,h,E)}a.shadowColor="black"}let A=(d-p.fontSize)/2;d-p.fontSize<0&&(A=0);const M=((v=e._stroke)==null?void 0:v.width)??0;for(let E=0;E<l.length;E++)m=M/2,x=M/2+E*d+p.ascent+A,e.align==="right"?m+=u-f[E]:e.align==="center"&&(m+=(u-f[E])/2),(S=e._stroke)!=null&&S.width&&this._drawLetterSpacing(l[E],e,i,m+r,x+r-_,!0),e._fill!==void 0&&this._drawLetterSpacing(l[E],e,i,m+r,x+r-_)}}_drawLetterSpacing(t,e,r,n,i,o=!1){const{context:a}=r,c=e.letterSpacing;let h=!1;if(qt.experimentalLetterSpacingSupported&&(qt.experimentalLetterSpacing?(a.letterSpacing=`${c}px`,a.textLetterSpacing=`${c}px`,h=!0):(a.letterSpacing="0px",a.textLetterSpacing="0px")),c===0||h){o?a.strokeText(t,n,i):a.fillText(t,n,i);return}let l=n;const d=qt.graphemeSegmenter(t);let f=a.measureText(t).width,u=0;for(let p=0;p<d.length;++p){const g=d[p];o?a.strokeText(g,l,i):a.fillText(g,l,i);let m="";for(let x=p+1;x<d.length;++x)m+=d[x];u=a.measureText(m).width,l+=f-u+c,f=u}}}const uo=new $f;class Zt extends Df{constructor(...t){const e=Hf(t,"Text");super(e,At),this.renderPipeId="text",e.textureStyle&&(this.textureStyle=e.textureStyle instanceof He?e.textureStyle:new He(e.textureStyle))}updateBounds(){const t=this._bounds,e=this._anchor;let r=0,n=0;if(this._style.trim){const{frame:i,canvasAndContext:o}=uo.getCanvasAndContext({text:this.text,style:this._style,resolution:1});uo.returnCanvasAndContext(o),r=i.width,n=i.height}else{const i=qt.measureText(this._text,this._style);r=i.width,n=i.height}t.minX=-e._x*r,t.maxX=t.minX+r,t.minY=-e._y*n,t.maxY=t.minY+n}}pt.add(Zc,Qc);const Vf="game-imgs/btc-net-sim",fo=["circle-btn","ctx-option","reset","zoom-btn-up","zoom-btn-dn","ms-default","ms-grabbing","ms-grab","ms-pointer","server-anim-coin","server-off"],Yf=()=>{const s={};return{createSprite:e=>new Gt(s[e]),getTexture:e=>s[e],load:async()=>{kt.reset();for(const r of fo)kt.add({alias:r,src:`${Vf}/${r}.png`});const e=await kt.load(fo);for(const r of Object.keys(e))s[r]=e[r],s[r].source.scaleMode="nearest"}}},Xf=()=>{const s={x:0,y:0},t=854,e=480;let r=1,n=1,i=1;return{getAppZeroPos:()=>s,virtWidth:t,virtHeight:e,getBaseScale:()=>r,updateBaseScaleFromScreen:({screenWidth:f,screenHeight:u})=>{const p=f/u,g=t/e;if(p>g){r=u/t;const m=(f-t*r)/2;s.x=m,s.y=0}else{r=f/t;const m=(u-e*r)/2;s.x=0,s.y=m}i=r*n},getGameScale:()=>i,zoom:f=>{const u=1+f;n=n*u,n<.4&&(n=.4),n>1.75&&(n=1.75)},setZoom:f=>{n=f,n<.4&&(n=.4),n>1.75&&(n=1.75)}}},qf=s=>({resize:(t,e)=>{const{width:r,height:n}=t.screen;s.updateBaseScaleFromScreen({screenWidth:r,screenHeight:n});const i=s.getGameScale(),o=s.getAppZeroPos();e.scale.set(i,i),e.position.set(o.x,o.y)}}),Kf=s=>{const{gameVars:t,bounds:e,clampCamera:r=!0}=s,{app:n,game:i,scaler:o}=t,a={width:0,height:0};let c=0;return{lookAt:p=>{try{if(!p)return;a.width=n.screen.width,a.height=n.screen.height;let g=-p.x+a.width*.5,m=-p.y+a.height*.5;if(r){const y=-(e.width*o.getGameScale()-a.width);g=Math.min(Math.max(g,y),0);const v=-(e.height*o.getGameScale()-a.height);m=Math.min(Math.max(m,v),0)}i.position.set(g,m)}catch{}},viewport:a,zoom:p=>{c=p},resetZoom:()=>o.setZoom(1),update:p=>{c!==0&&(o.zoom(c*p.deltaMS),c=0)},setZoom:p=>o.setZoom(p)}};var _s=(s=>(s[s.bottom=0]="bottom",s[s.mid=1]="mid",s[s.top=2]="top",s))(_s||{});const Zf=s=>{const t=new Map;return{connect:a=>{a.ip()!==s&&(t.has(a.ip())||t.set(a.ip(),a))},disconnect:()=>{t.clear()},connectCount:()=>t.size,isConnectedTo:a=>t.has(a.ip()),getAll:()=>{const a=[];for(const c of t.values())a.push(c);return a}}},Qf=()=>{const s=[];return{clearTxs:()=>{s.length=0},hasTx:t=>s.some(e=>e.hash===t.hash),getAllTxs:()=>s,add:t=>s.push(t),displayJsonData:()=>Jf()}},Jf=()=>`{
  "inputs": [
    {
      "id": "utxo-abc123def456",
      "value": "50000000",
      "owner": "alice_address_xyz"
    },
    {
      "id": "utxo-ghi789jkl012",
      "value": "20000000",
      "owner": "alice_address_xyz"
    }
  ],
  "outputs": [
    {
      "id": "utxo-newTx123_0",
      "value": "60000000",
      "owner": "bob_address_pqr"
    },
    {
      "id": "utxo-newTx123_1",
      "value": "9990000",
      "owner": "alice_address_xyz"
    }
  ],
  "pubKey": "038e88e88e88e88e88e88e88e88e88e88e88e88e88e88e88e88e88e88e88e88e88",
  "fee": "10000",
  "sig": "3045022100a7b8f9d0c2e1d4b6a7c8e9f0a1b2c3d4e5f6a7b8c9d0e1f2a3b4c5d6e7f8a9b02200a7b8f9d0c2e1d4b6a7c8e9f0a1b2c3d4e5f6a7b8c9d0e1f2a3b4c5d6e7f8a9b0",
  "hash": "a1b2c3d4e5f6a7b8c9d0e1f2a3b4c5d6e7f8a9b0c1d2e3f4a5b6c7d8e9f0a1b2"
}`,ze=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */function Dn(s){return s instanceof Uint8Array||ArrayBuffer.isView(s)&&s.constructor.name==="Uint8Array"}function yn(s){if(!Number.isSafeInteger(s)||s<0)throw new Error("positive integer expected, got "+s)}function le(s,...t){if(!Dn(s))throw new Error("Uint8Array expected");if(t.length>0&&!t.includes(s.length))throw new Error("Uint8Array expected of length "+t+", got length="+s.length)}function tp(s){if(typeof s!="function"||typeof s.create!="function")throw new Error("Hash should be wrapped by utils.createHasher");yn(s.outputLen),yn(s.blockLen)}function Qs(s,t=!0){if(s.destroyed)throw new Error("Hash instance has been destroyed");if(t&&s.finished)throw new Error("Hash#digest() has already been called")}function ep(s,t){le(s);const e=t.outputLen;if(s.length<e)throw new Error("digestInto() expects output buffer of length at least "+e)}function Ve(...s){for(let t=0;t<s.length;t++)s[t].fill(0)}function Or(s){return new DataView(s.buffer,s.byteOffset,s.byteLength)}function $t(s,t){return s<<32-t|s>>>t}function Rs(s,t){return s<<t|s>>>32-t>>>0}const oc=typeof Uint8Array.from([]).toHex=="function"&&typeof Uint8Array.fromHex=="function",sp=Array.from({length:256},(s,t)=>t.toString(16).padStart(2,"0"));function me(s){if(le(s),oc)return s.toHex();let t="";for(let e=0;e<s.length;e++)t+=sp[s[e]];return t}const te={_0:48,_9:57,A:65,F:70,a:97,f:102};function po(s){if(s>=te._0&&s<=te._9)return s-te._0;if(s>=te.A&&s<=te.F)return s-(te.A-10);if(s>=te.a&&s<=te.f)return s-(te.a-10)}function Hn(s){if(typeof s!="string")throw new Error("hex string expected, got "+typeof s);if(oc)return Uint8Array.fromHex(s);const t=s.length,e=t/2;if(t%2)throw new Error("hex string expected, got unpadded hex of length "+t);const r=new Uint8Array(e);for(let n=0,i=0;n<e;n++,i+=2){const o=po(s.charCodeAt(i)),a=po(s.charCodeAt(i+1));if(o===void 0||a===void 0){const c=s[i]+s[i+1];throw new Error('hex string expected, got non-hex character "'+c+'" at index '+i)}r[n]=o*16+a}return r}function rp(s){if(typeof s!="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(s))}function Wn(s){return typeof s=="string"&&(s=rp(s)),le(s),s}function Te(...s){let t=0;for(let r=0;r<s.length;r++){const n=s[r];le(n),t+=n.length}const e=new Uint8Array(t);for(let r=0,n=0;r<s.length;r++){const i=s[r];e.set(i,n),n+=i.length}return e}class ac{}function cc(s){const t=r=>s().update(Wn(r)).digest(),e=s();return t.outputLen=e.outputLen,t.blockLen=e.blockLen,t.create=()=>s(),t}function np(s=32){if(ze&&typeof ze.getRandomValues=="function")return ze.getRandomValues(new Uint8Array(s));if(ze&&typeof ze.randomBytes=="function")return Uint8Array.from(ze.randomBytes(s));throw new Error("crypto.getRandomValues must be defined")}function ip(s,t,e,r){if(typeof s.setBigUint64=="function")return s.setBigUint64(t,e,r);const n=BigInt(32),i=BigInt(4294967295),o=Number(e>>n&i),a=Number(e&i),c=r?4:0,h=r?0:4;s.setUint32(t+c,o,r),s.setUint32(t+h,a,r)}function op(s,t,e){return s&t^~s&e}function ap(s,t,e){return s&t^s&e^t&e}class lc extends ac{constructor(t,e,r,n){super(),this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.blockLen=t,this.outputLen=e,this.padOffset=r,this.isLE=n,this.buffer=new Uint8Array(t),this.view=Or(this.buffer)}update(t){Qs(this),t=Wn(t),le(t);const{view:e,buffer:r,blockLen:n}=this,i=t.length;for(let o=0;o<i;){const a=Math.min(n-this.pos,i-o);if(a===n){const c=Or(t);for(;n<=i-o;o+=n)this.process(c,o);continue}r.set(t.subarray(o,o+a),this.pos),this.pos+=a,o+=a,this.pos===n&&(this.process(e,0),this.pos=0)}return this.length+=t.length,this.roundClean(),this}digestInto(t){Qs(this),ep(t,this),this.finished=!0;const{buffer:e,view:r,blockLen:n,isLE:i}=this;let{pos:o}=this;e[o++]=128,Ve(this.buffer.subarray(o)),this.padOffset>n-o&&(this.process(r,0),o=0);for(let d=o;d<n;d++)e[d]=0;ip(r,n-8,BigInt(this.length*8),i),this.process(r,0);const a=Or(t),c=this.outputLen;if(c%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const h=c/4,l=this.get();if(h>l.length)throw new Error("_sha2: outputLen bigger than state");for(let d=0;d<h;d++)a.setUint32(4*d,l[d],i)}digest(){const{buffer:t,outputLen:e}=this;this.digestInto(t);const r=t.slice(0,e);return this.destroy(),r}_cloneInto(t){t||(t=new this.constructor),t.set(...this.get());const{blockLen:e,buffer:r,length:n,finished:i,destroyed:o,pos:a}=this;return t.destroyed=o,t.finished=i,t.length=n,t.pos=a,n%e&&t.buffer.set(r),t}clone(){return this._cloneInto()}}const he=Uint32Array.from([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),cp=Uint32Array.from([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),de=new Uint32Array(64);class lp extends lc{constructor(t=32){super(64,t,8,!1),this.A=he[0]|0,this.B=he[1]|0,this.C=he[2]|0,this.D=he[3]|0,this.E=he[4]|0,this.F=he[5]|0,this.G=he[6]|0,this.H=he[7]|0}get(){const{A:t,B:e,C:r,D:n,E:i,F:o,G:a,H:c}=this;return[t,e,r,n,i,o,a,c]}set(t,e,r,n,i,o,a,c){this.A=t|0,this.B=e|0,this.C=r|0,this.D=n|0,this.E=i|0,this.F=o|0,this.G=a|0,this.H=c|0}process(t,e){for(let d=0;d<16;d++,e+=4)de[d]=t.getUint32(e,!1);for(let d=16;d<64;d++){const f=de[d-15],u=de[d-2],p=$t(f,7)^$t(f,18)^f>>>3,g=$t(u,17)^$t(u,19)^u>>>10;de[d]=g+de[d-7]+p+de[d-16]|0}let{A:r,B:n,C:i,D:o,E:a,F:c,G:h,H:l}=this;for(let d=0;d<64;d++){const f=$t(a,6)^$t(a,11)^$t(a,25),u=l+f+op(a,c,h)+cp[d]+de[d]|0,g=($t(r,2)^$t(r,13)^$t(r,22))+ap(r,n,i)|0;l=h,h=c,c=a,a=o+u|0,o=i,i=n,n=r,r=u+g|0}r=r+this.A|0,n=n+this.B|0,i=i+this.C|0,o=o+this.D|0,a=a+this.E|0,c=c+this.F|0,h=h+this.G|0,l=l+this.H|0,this.set(r,n,i,o,a,c,h,l)}roundClean(){Ve(de)}destroy(){this.set(0,0,0,0,0,0,0,0),Ve(this.buffer)}}const Js=cc(()=>new lp);class hc extends ac{constructor(t,e){super(),this.finished=!1,this.destroyed=!1,tp(t);const r=Wn(e);if(this.iHash=t.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const n=this.blockLen,i=new Uint8Array(n);i.set(r.length>n?t.create().update(r).digest():r);for(let o=0;o<i.length;o++)i[o]^=54;this.iHash.update(i),this.oHash=t.create();for(let o=0;o<i.length;o++)i[o]^=106;this.oHash.update(i),Ve(i)}update(t){return Qs(this),this.iHash.update(t),this}digestInto(t){Qs(this),le(t,this.outputLen),this.finished=!0,this.iHash.digestInto(t),this.oHash.update(t),this.oHash.digestInto(t),this.destroy()}digest(){const t=new Uint8Array(this.oHash.outputLen);return this.digestInto(t),t}_cloneInto(t){t||(t=Object.create(Object.getPrototypeOf(this),{}));const{oHash:e,iHash:r,finished:n,destroyed:i,blockLen:o,outputLen:a}=this;return t=t,t.finished=n,t.destroyed=i,t.blockLen=o,t.outputLen=a,t.oHash=e._cloneInto(t.oHash),t.iHash=r._cloneInto(t.iHash),t}clone(){return this._cloneInto()}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}const dc=(s,t,e)=>new hc(s,t).update(e).digest();dc.create=(s,t)=>new hc(s,t);/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const jn=BigInt(0),bn=BigInt(1);function tr(s,t){if(typeof t!="boolean")throw new Error(s+" boolean expected, got "+t)}function Ls(s){const t=s.toString(16);return t.length&1?"0"+t:t}function uc(s){if(typeof s!="string")throw new Error("hex string expected, got "+typeof s);return s===""?jn:BigInt("0x"+s)}function cr(s){return uc(me(s))}function fc(s){return le(s),uc(me(Uint8Array.from(s).reverse()))}function $n(s,t){return Hn(s.toString(16).padStart(t*2,"0"))}function pc(s,t){return $n(s,t).reverse()}function It(s,t,e){let r;if(typeof t=="string")try{r=Hn(t)}catch(i){throw new Error(s+" must be hex string or Uint8Array, cause: "+i)}else if(Dn(t))r=Uint8Array.from(t);else throw new Error(s+" must be hex string or Uint8Array");const n=r.length;if(typeof e=="number"&&n!==e)throw new Error(s+" of length "+e+" expected, got "+n);return r}const Ur=s=>typeof s=="bigint"&&jn<=s;function hp(s,t,e){return Ur(s)&&Ur(t)&&Ur(e)&&t<=s&&s<e}function dp(s,t,e,r){if(!hp(t,e,r))throw new Error("expected valid "+s+": "+e+" <= n < "+r+", got "+t)}function up(s){let t;for(t=0;s>jn;s>>=bn,t+=1);return t}const lr=s=>(bn<<BigInt(s))-bn;function fp(s,t,e){if(typeof s!="number"||s<2)throw new Error("hashLen must be a number");if(typeof t!="number"||t<2)throw new Error("qByteLen must be a number");if(typeof e!="function")throw new Error("hmacFn must be a function");const r=u=>new Uint8Array(u),n=u=>Uint8Array.of(u);let i=r(s),o=r(s),a=0;const c=()=>{i.fill(1),o.fill(0),a=0},h=(...u)=>e(o,i,...u),l=(u=r(0))=>{o=h(n(0),u),i=h(),u.length!==0&&(o=h(n(1),u),i=h())},d=()=>{if(a++>=1e3)throw new Error("drbg: tried 1000 values");let u=0;const p=[];for(;u<t;){i=h();const g=i.slice();p.push(g),u+=i.length}return Te(...p)};return(u,p)=>{c(),l(u);let g;for(;!(g=p(d()));)l();return c(),g}}function Vn(s,t,e={}){if(!s||typeof s!="object")throw new Error("expected valid options object");function r(n,i,o){const a=s[n];if(o&&a===void 0)return;const c=typeof a;if(c!==i||a===null)throw new Error(`param "${n}" is invalid: expected ${i}, got ${c}`)}Object.entries(t).forEach(([n,i])=>r(n,i,!1)),Object.entries(e).forEach(([n,i])=>r(n,i,!0))}function mo(s){const t=new WeakMap;return(e,...r)=>{const n=t.get(e);if(n!==void 0)return n;const i=s(e,...r);return t.set(e,i),i}}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const vt=BigInt(0),yt=BigInt(1),Ee=BigInt(2),pp=BigInt(3),mc=BigInt(4),gc=BigInt(5),xc=BigInt(8);function Bt(s,t){const e=s%t;return e>=vt?e:t+e}function Et(s,t,e){let r=s;for(;t-- >vt;)r*=r,r%=e;return r}function go(s,t){if(s===vt)throw new Error("invert: expected non-zero number");if(t<=vt)throw new Error("invert: expected positive modulus, got "+t);let e=Bt(s,t),r=t,n=vt,i=yt;for(;e!==vt;){const a=r/e,c=r%e,h=n-i*a;r=e,e=c,n=i,i=h}if(r!==yt)throw new Error("invert: does not exist");return Bt(n,t)}function yc(s,t){const e=(s.ORDER+yt)/mc,r=s.pow(t,e);if(!s.eql(s.sqr(r),t))throw new Error("Cannot find square root");return r}function mp(s,t){const e=(s.ORDER-gc)/xc,r=s.mul(t,Ee),n=s.pow(r,e),i=s.mul(t,n),o=s.mul(s.mul(i,Ee),n),a=s.mul(i,s.sub(o,s.ONE));if(!s.eql(s.sqr(a),t))throw new Error("Cannot find square root");return a}function gp(s){if(s<BigInt(3))throw new Error("sqrt is not defined for small field");let t=s-yt,e=0;for(;t%Ee===vt;)t/=Ee,e++;let r=Ee;const n=hr(s);for(;xo(n,r)===1;)if(r++>1e3)throw new Error("Cannot find square root: probably non-prime P");if(e===1)return yc;let i=n.pow(r,t);const o=(t+yt)/Ee;return function(c,h){if(c.is0(h))return h;if(xo(c,h)!==1)throw new Error("Cannot find square root");let l=e,d=c.mul(c.ONE,i),f=c.pow(h,t),u=c.pow(h,o);for(;!c.eql(f,c.ONE);){if(c.is0(f))return c.ZERO;let p=1,g=c.sqr(f);for(;!c.eql(g,c.ONE);)if(p++,g=c.sqr(g),p===l)throw new Error("Cannot find square root");const m=yt<<BigInt(l-p-1),x=c.pow(d,m);l=p,d=c.sqr(x),f=c.mul(f,d),u=c.mul(u,x)}return u}}function xp(s){return s%mc===pp?yc:s%xc===gc?mp:gp(s)}const yp=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function bp(s){const t={ORDER:"bigint",MASK:"bigint",BYTES:"number",BITS:"number"},e=yp.reduce((r,n)=>(r[n]="function",r),t);return Vn(s,e),s}function wp(s,t,e){if(e<vt)throw new Error("invalid exponent, negatives unsupported");if(e===vt)return s.ONE;if(e===yt)return t;let r=s.ONE,n=t;for(;e>vt;)e&yt&&(r=s.mul(r,n)),n=s.sqr(n),e>>=yt;return r}function bc(s,t,e=!1){const r=new Array(t.length).fill(e?s.ZERO:void 0),n=t.reduce((o,a,c)=>s.is0(a)?o:(r[c]=o,s.mul(o,a)),s.ONE),i=s.inv(n);return t.reduceRight((o,a,c)=>s.is0(a)?o:(r[c]=s.mul(o,r[c]),s.mul(o,a)),i),r}function xo(s,t){const e=(s.ORDER-yt)/Ee,r=s.pow(t,e),n=s.eql(r,s.ONE),i=s.eql(r,s.ZERO),o=s.eql(r,s.neg(s.ONE));if(!n&&!i&&!o)throw new Error("invalid Legendre symbol result");return n?1:i?0:-1}function _p(s,t){t!==void 0&&yn(t);const e=t!==void 0?t:s.toString(2).length,r=Math.ceil(e/8);return{nBitLength:e,nByteLength:r}}function hr(s,t,e=!1,r={}){if(s<=vt)throw new Error("invalid field: expected ORDER > 0, got "+s);let n,i;if(typeof t=="object"&&t!=null){if(r.sqrt||e)throw new Error("cannot specify opts in two arguments");const l=t;l.BITS&&(n=l.BITS),l.sqrt&&(i=l.sqrt),typeof l.isLE=="boolean"&&(e=l.isLE)}else typeof t=="number"&&(n=t),r.sqrt&&(i=r.sqrt);const{nBitLength:o,nByteLength:a}=_p(s,n);if(a>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");let c;const h=Object.freeze({ORDER:s,isLE:e,BITS:o,BYTES:a,MASK:lr(o),ZERO:vt,ONE:yt,create:l=>Bt(l,s),isValid:l=>{if(typeof l!="bigint")throw new Error("invalid field element: expected bigint, got "+typeof l);return vt<=l&&l<s},is0:l=>l===vt,isValidNot0:l=>!h.is0(l)&&h.isValid(l),isOdd:l=>(l&yt)===yt,neg:l=>Bt(-l,s),eql:(l,d)=>l===d,sqr:l=>Bt(l*l,s),add:(l,d)=>Bt(l+d,s),sub:(l,d)=>Bt(l-d,s),mul:(l,d)=>Bt(l*d,s),pow:(l,d)=>wp(h,l,d),div:(l,d)=>Bt(l*go(d,s),s),sqrN:l=>l*l,addN:(l,d)=>l+d,subN:(l,d)=>l-d,mulN:(l,d)=>l*d,inv:l=>go(l,s),sqrt:i||(l=>(c||(c=xp(s)),c(h,l))),toBytes:l=>e?pc(l,a):$n(l,a),fromBytes:l=>{if(l.length!==a)throw new Error("Field.fromBytes: expected "+a+" bytes, got "+l.length);return e?fc(l):cr(l)},invertBatch:l=>bc(h,l),cmov:(l,d,f)=>f?d:l});return Object.freeze(h)}function wc(s){if(typeof s!="bigint")throw new Error("field order must be bigint");const t=s.toString(2).length;return Math.ceil(t/8)}function _c(s){const t=wc(s);return t+Math.ceil(t/2)}function vp(s,t,e=!1){const r=s.length,n=wc(t),i=_c(t);if(r<16||r<i||r>1024)throw new Error("expected "+i+"-1024 bytes of input, got "+r);const o=e?fc(s):cr(s),a=Bt(o,t-yt)+yt;return e?pc(a,n):$n(a,n)}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Ye=BigInt(0),Ie=BigInt(1);function us(s,t){const e=t.negate();return s?e:t}function Ap(s,t,e){const r=o=>o.pz,n=bc(s.Fp,e.map(r));return e.map((o,a)=>o.toAffine(n[a])).map(s.fromAffine)}function vc(s,t){if(!Number.isSafeInteger(s)||s<=0||s>t)throw new Error("invalid window size, expected [1.."+t+"], got W="+s)}function Dr(s,t){vc(s,t);const e=Math.ceil(t/s)+1,r=2**(s-1),n=2**s,i=lr(s),o=BigInt(s);return{windows:e,windowSize:r,mask:i,maxNumber:n,shiftBy:o}}function yo(s,t,e){const{windowSize:r,mask:n,maxNumber:i,shiftBy:o}=e;let a=Number(s&n),c=s>>o;a>r&&(a-=i,c+=Ie);const h=t*r,l=h+Math.abs(a)-1,d=a===0,f=a<0,u=t%2!==0;return{nextN:c,offset:l,isZero:d,isNeg:f,isNegF:u,offsetF:h}}function Sp(s,t){if(!Array.isArray(s))throw new Error("array expected");s.forEach((e,r)=>{if(!(e instanceof t))throw new Error("invalid point at index "+r)})}function Cp(s,t){if(!Array.isArray(s))throw new Error("array of scalars expected");s.forEach((e,r)=>{if(!t.isValid(e))throw new Error("invalid scalar at index "+r)})}const Hr=new WeakMap,Ac=new WeakMap;function Wr(s){return Ac.get(s)||1}function bo(s){if(s!==Ye)throw new Error("invalid wNAF")}function kp(s,t){return{constTimeNegate:us,hasPrecomputes(e){return Wr(e)!==1},unsafeLadder(e,r,n=s.ZERO){let i=e;for(;r>Ye;)r&Ie&&(n=n.add(i)),i=i.double(),r>>=Ie;return n},precomputeWindow(e,r){const{windows:n,windowSize:i}=Dr(r,t),o=[];let a=e,c=a;for(let h=0;h<n;h++){c=a,o.push(c);for(let l=1;l<i;l++)c=c.add(a),o.push(c);a=c.double()}return o},wNAF(e,r,n){let i=s.ZERO,o=s.BASE;const a=Dr(e,t);for(let c=0;c<a.windows;c++){const{nextN:h,offset:l,isZero:d,isNeg:f,isNegF:u,offsetF:p}=yo(n,c,a);n=h,d?o=o.add(us(u,r[p])):i=i.add(us(f,r[l]))}return bo(n),{p:i,f:o}},wNAFUnsafe(e,r,n,i=s.ZERO){const o=Dr(e,t);for(let a=0;a<o.windows&&n!==Ye;a++){const{nextN:c,offset:h,isZero:l,isNeg:d}=yo(n,a,o);if(n=c,!l){const f=r[h];i=i.add(d?f.negate():f)}}return bo(n),i},getPrecomputes(e,r,n){let i=Hr.get(r);return i||(i=this.precomputeWindow(r,e),e!==1&&(typeof n=="function"&&(i=n(i)),Hr.set(r,i))),i},wNAFCached(e,r,n){const i=Wr(e);return this.wNAF(i,this.getPrecomputes(i,e,n),r)},wNAFCachedUnsafe(e,r,n,i){const o=Wr(e);return o===1?this.unsafeLadder(e,r,i):this.wNAFUnsafe(o,this.getPrecomputes(o,e,n),r,i)},setWindowSize(e,r){vc(r,t),Ac.set(e,r),Hr.delete(e)}}}function Pp(s,t,e,r){let n=t,i=s.ZERO,o=s.ZERO;for(;e>Ye||r>Ye;)e&Ie&&(i=i.add(n)),r&Ie&&(o=o.add(n)),n=n.double(),e>>=Ie,r>>=Ie;return{p1:i,p2:o}}function Mp(s,t,e,r){Sp(e,s),Cp(r,t);const n=e.length,i=r.length;if(n!==i)throw new Error("arrays of points and scalars must have equal length");const o=s.ZERO,a=up(BigInt(n));let c=1;a>12?c=a-3:a>4?c=a-2:a>0&&(c=2);const h=lr(c),l=new Array(Number(h)+1).fill(o),d=Math.floor((t.BITS-1)/c)*c;let f=o;for(let u=d;u>=0;u-=c){l.fill(o);for(let g=0;g<i;g++){const m=r[g],x=Number(m>>BigInt(u)&h);l[x]=l[x].add(e[g])}let p=o;for(let g=l.length-1,m=o;g>0;g--)m=m.add(l[g]),p=p.add(m);if(f=f.add(p),u!==0)for(let g=0;g<c;g++)f=f.double()}return f}function wo(s,t){if(t){if(t.ORDER!==s)throw new Error("Field.ORDER must match order: Fp == p, Fn == n");return bp(t),t}else return hr(s)}function Tp(s,t,e={}){if(!t||typeof t!="object")throw new Error(`expected valid ${s} CURVE object`);for(const a of["p","n","h"]){const c=t[a];if(!(typeof c=="bigint"&&c>Ye))throw new Error(`CURVE.${a} must be positive bigint`)}const r=wo(t.p,e.Fp),n=wo(t.n,e.Fn),o=["Gx","Gy","a","b"];for(const a of o)if(!r.isValid(t[a]))throw new Error(`CURVE.${a} must be valid field element of CURVE.Fp`);return{Fp:r,Fn:n}}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */function _o(s){s.lowS!==void 0&&tr("lowS",s.lowS),s.prehash!==void 0&&tr("prehash",s.prehash)}class Ep extends Error{constructor(t=""){super(t)}}const ne={Err:Ep,_tlv:{encode:(s,t)=>{const{Err:e}=ne;if(s<0||s>256)throw new e("tlv.encode: wrong tag");if(t.length&1)throw new e("tlv.encode: unpadded data");const r=t.length/2,n=Ls(r);if(n.length/2&128)throw new e("tlv.encode: long form length too big");const i=r>127?Ls(n.length/2|128):"";return Ls(s)+i+n+t},decode(s,t){const{Err:e}=ne;let r=0;if(s<0||s>256)throw new e("tlv.encode: wrong tag");if(t.length<2||t[r++]!==s)throw new e("tlv.decode: wrong tlv");const n=t[r++],i=!!(n&128);let o=0;if(!i)o=n;else{const c=n&127;if(!c)throw new e("tlv.decode(long): indefinite length not supported");if(c>4)throw new e("tlv.decode(long): byte length is too big");const h=t.subarray(r,r+c);if(h.length!==c)throw new e("tlv.decode: length bytes not complete");if(h[0]===0)throw new e("tlv.decode(long): zero leftmost byte");for(const l of h)o=o<<8|l;if(r+=c,o<128)throw new e("tlv.decode(long): not minimal encoding")}const a=t.subarray(r,r+o);if(a.length!==o)throw new e("tlv.decode: wrong value length");return{v:a,l:t.subarray(r+o)}}},_int:{encode(s){const{Err:t}=ne;if(s<fs)throw new t("integer: negative integers are not allowed");let e=Ls(s);if(Number.parseInt(e[0],16)&8&&(e="00"+e),e.length&1)throw new t("unexpected DER parsing assertion: unpadded hex");return e},decode(s){const{Err:t}=ne;if(s[0]&128)throw new t("invalid signature integer: negative");if(s[0]===0&&!(s[1]&128))throw new t("invalid signature integer: unnecessary leading zero");return cr(s)}},toSig(s){const{Err:t,_int:e,_tlv:r}=ne,n=It("signature",s),{v:i,l:o}=r.decode(48,n);if(o.length)throw new t("invalid signature: left bytes after parsing");const{v:a,l:c}=r.decode(2,i),{v:h,l}=r.decode(2,c);if(l.length)throw new t("invalid signature: left bytes after parsing");return{r:e.decode(a),s:e.decode(h)}},hexFromSig(s){const{_tlv:t,_int:e}=ne,r=t.encode(2,e.encode(s.r)),n=t.encode(2,e.encode(s.s)),i=r+n;return t.encode(48,i)}},fs=BigInt(0),ps=BigInt(1),Ip=BigInt(2),zs=BigInt(3),Bp=BigInt(4);function Fp(s,t,e){function r(n){const i=s.sqr(n),o=s.mul(i,n);return s.add(s.add(o,s.mul(n,t)),e)}return r}function Sc(s,t,e){const{BYTES:r}=s;function n(i){let o;if(typeof i=="bigint")o=i;else{let a=It("private key",i);if(t){if(!t.includes(a.length*2))throw new Error("invalid private key");const c=new Uint8Array(r);c.set(a,c.length-a.length),a=c}try{o=s.fromBytes(a)}catch{throw new Error(`invalid private key: expected ui8a of size ${r}, got ${typeof i}`)}}if(e&&(o=s.create(o)),!s.isValidNot0(o))throw new Error("invalid private key: out of range [1..N-1]");return o}return n}function Rp(s,t={}){const{Fp:e,Fn:r}=Tp("weierstrass",s,t),{h:n,n:i}=s;Vn(t,{},{allowInfinityPoint:"boolean",clearCofactor:"function",isTorsionFree:"function",fromBytes:"function",toBytes:"function",endo:"object",wrapPrivateKey:"boolean"});const{endo:o}=t;if(o&&(!e.is0(s.a)||typeof o.beta!="bigint"||typeof o.splitScalar!="function"))throw new Error('invalid endo: expected "beta": bigint and "splitScalar": function');function a(){if(!e.isOdd)throw new Error("compression is not supported: Field does not have .isOdd()")}function c(P,_,C){const{x:A,y:M}=_.toAffine(),E=e.toBytes(A);if(tr("isCompressed",C),C){a();const F=!e.isOdd(M);return Te(Cc(F),E)}else return Te(Uint8Array.of(4),E,e.toBytes(M))}function h(P){le(P);const _=e.BYTES,C=_+1,A=2*_+1,M=P.length,E=P[0],F=P.subarray(1);if(M===C&&(E===2||E===3)){const R=e.fromBytes(F);if(!e.isValid(R))throw new Error("bad point: is not on curve, wrong x");const T=f(R);let I;try{I=e.sqrt(T)}catch(W){const U=W instanceof Error?": "+W.message:"";throw new Error("bad point: is not on curve, sqrt error"+U)}a();const B=e.isOdd(I);return(E&1)===1!==B&&(I=e.neg(I)),{x:R,y:I}}else if(M===A&&E===4){const R=e.fromBytes(F.subarray(_*0,_*1)),T=e.fromBytes(F.subarray(_*1,_*2));if(!u(R,T))throw new Error("bad point: is not on curve");return{x:R,y:T}}else throw new Error(`bad point: got length ${M}, expected compressed=${C} or uncompressed=${A}`)}const l=t.toBytes||c,d=t.fromBytes||h,f=Fp(e,s.a,s.b);function u(P,_){const C=e.sqr(_),A=f(P);return e.eql(C,A)}if(!u(s.Gx,s.Gy))throw new Error("bad curve params: generator point");const p=e.mul(e.pow(s.a,zs),Bp),g=e.mul(e.sqr(s.b),BigInt(27));if(e.is0(e.add(p,g)))throw new Error("bad curve params: a or b");function m(P,_,C=!1){if(!e.isValid(_)||C&&e.is0(_))throw new Error(`bad point coordinate ${P}`);return _}function x(P){if(!(P instanceof v))throw new Error("ProjectivePoint expected")}const y=mo((P,_)=>{const{px:C,py:A,pz:M}=P;if(e.eql(M,e.ONE))return{x:C,y:A};const E=P.is0();_==null&&(_=E?e.ONE:e.inv(M));const F=e.mul(C,_),R=e.mul(A,_),T=e.mul(M,_);if(E)return{x:e.ZERO,y:e.ZERO};if(!e.eql(T,e.ONE))throw new Error("invZ was invalid");return{x:F,y:R}}),b=mo(P=>{if(P.is0()){if(t.allowInfinityPoint&&!e.is0(P.py))return;throw new Error("bad point: ZERO")}const{x:_,y:C}=P.toAffine();if(!e.isValid(_)||!e.isValid(C))throw new Error("bad point: x or y not field elements");if(!u(_,C))throw new Error("bad point: equation left != right");if(!P.isTorsionFree())throw new Error("bad point: not in prime-order subgroup");return!0});function w(P,_,C,A,M){return C=new v(e.mul(C.px,P),C.py,C.pz),_=us(A,_),C=us(M,C),_.add(C)}class v{constructor(_,C,A){this.px=m("x",_),this.py=m("y",C,!0),this.pz=m("z",A),Object.freeze(this)}static fromAffine(_){const{x:C,y:A}=_||{};if(!_||!e.isValid(C)||!e.isValid(A))throw new Error("invalid affine point");if(_ instanceof v)throw new Error("projective point not allowed");return e.is0(C)&&e.is0(A)?v.ZERO:new v(C,A,e.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(_){return Ap(v,"pz",_)}static fromBytes(_){return le(_),v.fromHex(_)}static fromHex(_){const C=v.fromAffine(d(It("pointHex",_)));return C.assertValidity(),C}static fromPrivateKey(_){const C=Sc(r,t.allowedPrivateKeyLengths,t.wrapPrivateKey);return v.BASE.multiply(C(_))}static msm(_,C){return Mp(v,r,_,C)}precompute(_=8,C=!0){return k.setWindowSize(this,_),C||this.multiply(zs),this}_setWindowSize(_){this.precompute(_)}assertValidity(){b(this)}hasEvenY(){const{y:_}=this.toAffine();if(!e.isOdd)throw new Error("Field doesn't support isOdd");return!e.isOdd(_)}equals(_){x(_);const{px:C,py:A,pz:M}=this,{px:E,py:F,pz:R}=_,T=e.eql(e.mul(C,R),e.mul(E,M)),I=e.eql(e.mul(A,R),e.mul(F,M));return T&&I}negate(){return new v(this.px,e.neg(this.py),this.pz)}double(){const{a:_,b:C}=s,A=e.mul(C,zs),{px:M,py:E,pz:F}=this;let R=e.ZERO,T=e.ZERO,I=e.ZERO,B=e.mul(M,M),D=e.mul(E,E),W=e.mul(F,F),U=e.mul(M,E);return U=e.add(U,U),I=e.mul(M,F),I=e.add(I,I),R=e.mul(_,I),T=e.mul(A,W),T=e.add(R,T),R=e.sub(D,T),T=e.add(D,T),T=e.mul(R,T),R=e.mul(U,R),I=e.mul(A,I),W=e.mul(_,W),U=e.sub(B,W),U=e.mul(_,U),U=e.add(U,I),I=e.add(B,B),B=e.add(I,B),B=e.add(B,W),B=e.mul(B,U),T=e.add(T,B),W=e.mul(E,F),W=e.add(W,W),B=e.mul(W,U),R=e.sub(R,B),I=e.mul(W,D),I=e.add(I,I),I=e.add(I,I),new v(R,T,I)}add(_){x(_);const{px:C,py:A,pz:M}=this,{px:E,py:F,pz:R}=_;let T=e.ZERO,I=e.ZERO,B=e.ZERO;const D=s.a,W=e.mul(s.b,zs);let U=e.mul(C,E),Z=e.mul(A,F),H=e.mul(M,R),K=e.add(C,A),V=e.add(E,F);K=e.mul(K,V),V=e.add(U,Z),K=e.sub(K,V),V=e.add(C,M);let et=e.add(E,R);return V=e.mul(V,et),et=e.add(U,H),V=e.sub(V,et),et=e.add(A,M),T=e.add(F,R),et=e.mul(et,T),T=e.add(Z,H),et=e.sub(et,T),B=e.mul(D,V),T=e.mul(W,H),B=e.add(T,B),T=e.sub(Z,B),B=e.add(Z,B),I=e.mul(T,B),Z=e.add(U,U),Z=e.add(Z,U),H=e.mul(D,H),V=e.mul(W,V),Z=e.add(Z,H),H=e.sub(U,H),H=e.mul(D,H),V=e.add(V,H),U=e.mul(Z,V),I=e.add(I,U),U=e.mul(et,V),T=e.mul(K,T),T=e.sub(T,U),U=e.mul(K,Z),B=e.mul(et,B),B=e.add(B,U),new v(T,I,B)}subtract(_){return this.add(_.negate())}is0(){return this.equals(v.ZERO)}multiply(_){const{endo:C}=t;if(!r.isValidNot0(_))throw new Error("invalid scalar: out of range");let A,M;const E=F=>k.wNAFCached(this,F,v.normalizeZ);if(C){const{k1neg:F,k1:R,k2neg:T,k2:I}=C.splitScalar(_),{p:B,f:D}=E(R),{p:W,f:U}=E(I);M=D.add(U),A=w(C.beta,B,W,F,T)}else{const{p:F,f:R}=E(_);A=F,M=R}return v.normalizeZ([A,M])[0]}multiplyUnsafe(_){const{endo:C}=t,A=this;if(!r.isValid(_))throw new Error("invalid scalar: out of range");if(_===fs||A.is0())return v.ZERO;if(_===ps)return A;if(k.hasPrecomputes(this))return this.multiply(_);if(C){const{k1neg:M,k1:E,k2neg:F,k2:R}=C.splitScalar(_),{p1:T,p2:I}=Pp(v,A,E,R);return w(C.beta,T,I,M,F)}else return k.wNAFCachedUnsafe(A,_)}multiplyAndAddUnsafe(_,C,A){const M=this.multiplyUnsafe(C).add(_.multiplyUnsafe(A));return M.is0()?void 0:M}toAffine(_){return y(this,_)}isTorsionFree(){const{isTorsionFree:_}=t;return n===ps?!0:_?_(v,this):k.wNAFCachedUnsafe(this,i).is0()}clearCofactor(){const{clearCofactor:_}=t;return n===ps?this:_?_(v,this):this.multiplyUnsafe(n)}toBytes(_=!0){return tr("isCompressed",_),this.assertValidity(),l(v,this,_)}toRawBytes(_=!0){return this.toBytes(_)}toHex(_=!0){return me(this.toBytes(_))}toString(){return`<Point ${this.is0()?"ZERO":this.toHex()}>`}}v.BASE=new v(s.Gx,s.Gy,e.ONE),v.ZERO=new v(e.ZERO,e.ONE,e.ZERO),v.Fp=e,v.Fn=r;const S=r.BITS,k=kp(v,t.endo?Math.ceil(S/2):S);return v}function Cc(s){return Uint8Array.of(s?2:3)}function Lp(s,t,e={}){Vn(t,{hash:"function"},{hmac:"function",lowS:"boolean",randomBytes:"function",bits2int:"function",bits2int_modN:"function"});const r=t.randomBytes||np,n=t.hmac||((A,...M)=>dc(t.hash,A,Te(...M))),{Fp:i,Fn:o}=s,{ORDER:a,BITS:c}=o;function h(A){const M=a>>ps;return A>M}function l(A){return h(A)?o.neg(A):A}function d(A,M){if(!o.isValidNot0(M))throw new Error(`invalid signature ${A}: out of range 1..CURVE.n`)}class f{constructor(M,E,F){d("r",M),d("s",E),this.r=M,this.s=E,F!=null&&(this.recovery=F),Object.freeze(this)}static fromCompact(M){const E=o.BYTES,F=It("compactSignature",M,E*2);return new f(o.fromBytes(F.subarray(0,E)),o.fromBytes(F.subarray(E,E*2)))}static fromDER(M){const{r:E,s:F}=ne.toSig(It("DER",M));return new f(E,F)}assertValidity(){}addRecoveryBit(M){return new f(this.r,this.s,M)}recoverPublicKey(M){const E=i.ORDER,{r:F,s:R,recovery:T}=this;if(T==null||![0,1,2,3].includes(T))throw new Error("recovery id invalid");if(a*Ip<E&&T>1)throw new Error("recovery id is ambiguous for h>1 curve");const B=T===2||T===3?F+a:F;if(!i.isValid(B))throw new Error("recovery id 2 or 3 invalid");const D=i.toBytes(B),W=s.fromHex(Te(Cc((T&1)===0),D)),U=o.inv(B),Z=b(It("msgHash",M)),H=o.create(-Z*U),K=o.create(R*U),V=s.BASE.multiplyUnsafe(H).add(W.multiplyUnsafe(K));if(V.is0())throw new Error("point at infinify");return V.assertValidity(),V}hasHighS(){return h(this.s)}normalizeS(){return this.hasHighS()?new f(this.r,o.neg(this.s),this.recovery):this}toBytes(M){if(M==="compact")return Te(o.toBytes(this.r),o.toBytes(this.s));if(M==="der")return Hn(ne.hexFromSig(this));throw new Error("invalid format")}toDERRawBytes(){return this.toBytes("der")}toDERHex(){return me(this.toBytes("der"))}toCompactRawBytes(){return this.toBytes("compact")}toCompactHex(){return me(this.toBytes("compact"))}}const u=Sc(o,e.allowedPrivateKeyLengths,e.wrapPrivateKey),p={isValidPrivateKey(A){try{return u(A),!0}catch{return!1}},normPrivateKeyToScalar:u,randomPrivateKey:()=>{const A=a;return vp(r(_c(A)),A)},precompute(A=8,M=s.BASE){return M.precompute(A,!1)}};function g(A,M=!0){return s.fromPrivateKey(A).toBytes(M)}function m(A){if(typeof A=="bigint")return!1;if(A instanceof s)return!0;const E=It("key",A).length,F=i.BYTES,R=F+1,T=2*F+1;if(!(e.allowedPrivateKeyLengths||o.BYTES===R))return E===R||E===T}function x(A,M,E=!0){if(m(A)===!0)throw new Error("first arg must be private key");if(m(M)===!1)throw new Error("second arg must be public key");return s.fromHex(M).multiply(u(A)).toBytes(E)}const y=t.bits2int||function(A){if(A.length>8192)throw new Error("input is too large");const M=cr(A),E=A.length*8-c;return E>0?M>>BigInt(E):M},b=t.bits2int_modN||function(A){return o.create(y(A))},w=lr(c);function v(A){return dp("num < 2^"+c,A,fs,w),o.toBytes(A)}function S(A,M,E=k){if(["recovered","canonical"].some(K=>K in E))throw new Error("sign() legacy options not supported");const{hash:F}=t;let{lowS:R,prehash:T,extraEntropy:I}=E;R==null&&(R=!0),A=It("msgHash",A),_o(E),T&&(A=It("prehashed msgHash",F(A)));const B=b(A),D=u(M),W=[v(D),v(B)];if(I!=null&&I!==!1){const K=I===!0?r(i.BYTES):I;W.push(It("extraEntropy",K))}const U=Te(...W),Z=B;function H(K){const V=y(K);if(!o.isValidNot0(V))return;const et=o.inv(V),J=s.BASE.multiply(V).toAffine(),Mt=o.create(J.x);if(Mt===fs)return;const ft=o.create(et*o.create(Z+Mt*D));if(ft===fs)return;let St=(J.x===Mt?0:2)|Number(J.y&ps),bt=ft;return R&&h(ft)&&(bt=l(ft),St^=1),new f(Mt,bt,St)}return{seed:U,k2sig:H}}const k={lowS:t.lowS,prehash:!1},P={lowS:t.lowS,prehash:!1};function _(A,M,E=k){const{seed:F,k2sig:R}=S(A,M,E);return fp(t.hash.outputLen,o.BYTES,n)(F,R)}s.BASE.precompute(8);function C(A,M,E,F=P){const R=A;M=It("msgHash",M),E=It("publicKey",E),_o(F);const{lowS:T,prehash:I,format:B}=F;if("strict"in F)throw new Error("options.strict was renamed to lowS");if(B!==void 0&&!["compact","der","js"].includes(B))throw new Error('format must be "compact", "der" or "js"');const D=typeof R=="string"||Dn(R),W=!D&&!B&&typeof R=="object"&&R!==null&&typeof R.r=="bigint"&&typeof R.s=="bigint";if(!D&&!W)throw new Error("invalid signature, expected Uint8Array, hex string or Signature instance");let U,Z;try{if(W)if(B===void 0||B==="js")U=new f(R.r,R.s);else throw new Error("invalid format");if(D){try{B!=="compact"&&(U=f.fromDER(R))}catch(bt){if(!(bt instanceof ne.Err))throw bt}!U&&B!=="der"&&(U=f.fromCompact(R))}Z=s.fromHex(E)}catch{return!1}if(!U||T&&U.hasHighS())return!1;I&&(M=t.hash(M));const{r:H,s:K}=U,V=b(M),et=o.inv(K),J=o.create(V*et),Mt=o.create(H*et),ft=s.BASE.multiplyUnsafe(J).add(Z.multiplyUnsafe(Mt));return ft.is0()?!1:o.create(ft.x)===H}return Object.freeze({getPublicKey:g,getSharedSecret:x,sign:_,verify:C,utils:p,Point:s,Signature:f})}function zp(s){const t={a:s.a,b:s.b,p:s.Fp.ORDER,n:s.n,h:s.h,Gx:s.Gx,Gy:s.Gy},e=s.Fp,r=hr(t.n,s.nBitLength),n={Fp:e,Fn:r,allowedPrivateKeyLengths:s.allowedPrivateKeyLengths,allowInfinityPoint:s.allowInfinityPoint,endo:s.endo,wrapPrivateKey:s.wrapPrivateKey,isTorsionFree:s.isTorsionFree,clearCofactor:s.clearCofactor,fromBytes:s.fromBytes,toBytes:s.toBytes};return{CURVE:t,curveOpts:n}}function Gp(s){const{CURVE:t,curveOpts:e}=zp(s),r={hash:s.hash,hmac:s.hmac,randomBytes:s.randomBytes,lowS:s.lowS,bits2int:s.bits2int,bits2int_modN:s.bits2int_modN};return{CURVE:t,curveOpts:e,ecdsaOpts:r}}function Np(s,t){return Object.assign({},t,{ProjectivePoint:t.Point,CURVE:s})}function Op(s){const{CURVE:t,curveOpts:e,ecdsaOpts:r}=Gp(s),n=Rp(t,e),i=Lp(n,r,e);return Np(s,i)}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */function Up(s,t){const e=r=>Op({...s,hash:r});return{...e(t),create:e}}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const er={p:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),n:BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),h:BigInt(1),a:BigInt(0),b:BigInt(7),Gx:BigInt("0x79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798"),Gy:BigInt("0x483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8")};BigInt(0);const Dp=BigInt(1),wn=BigInt(2),vo=(s,t)=>(s+t/wn)/t;function Hp(s){const t=er.p,e=BigInt(3),r=BigInt(6),n=BigInt(11),i=BigInt(22),o=BigInt(23),a=BigInt(44),c=BigInt(88),h=s*s*s%t,l=h*h*s%t,d=Et(l,e,t)*l%t,f=Et(d,e,t)*l%t,u=Et(f,wn,t)*h%t,p=Et(u,n,t)*u%t,g=Et(p,i,t)*p%t,m=Et(g,a,t)*g%t,x=Et(m,c,t)*m%t,y=Et(x,a,t)*g%t,b=Et(y,e,t)*l%t,w=Et(b,o,t)*p%t,v=Et(w,r,t)*h%t,S=Et(v,wn,t);if(!_n.eql(_n.sqr(S),s))throw new Error("Cannot find square root");return S}const _n=hr(er.p,void 0,void 0,{sqrt:Hp}),jr=Up({...er,Fp:_n,lowS:!0,endo:{beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar:s=>{const t=er.n,e=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),r=-Dp*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),n=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),i=e,o=BigInt("0x100000000000000000000000000000000"),a=vo(i*s,t),c=vo(-r*s,t);let h=Bt(s-a*e-c*n,t),l=Bt(-a*r-c*i,t);const d=h>o,f=l>o;if(d&&(h=t-h),f&&(l=t-l),h>o||l>o)throw new Error("splitScalar: Endomorphism failed, k="+s);return{k1neg:d,k1:h,k2neg:f,k2:l}}}},Js),Wp=Uint8Array.from([7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8]),kc=Uint8Array.from(new Array(16).fill(0).map((s,t)=>t)),jp=kc.map(s=>(9*s+5)%16),Pc=(()=>{const e=[[kc],[jp]];for(let r=0;r<4;r++)for(let n of e)n.push(n[r].map(i=>Wp[i]));return e})(),Mc=Pc[0],Tc=Pc[1],Ec=[[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8],[12,13,11,15,6,9,9,7,12,15,11,13,7,8,7,7],[13,15,14,11,7,7,6,8,13,14,13,12,5,5,6,9],[14,11,12,14,8,6,5,5,15,12,15,14,9,9,8,6],[15,12,13,13,9,5,8,6,14,11,12,11,8,6,5,5]].map(s=>Uint8Array.from(s)),$p=Mc.map((s,t)=>s.map(e=>Ec[t][e])),Vp=Tc.map((s,t)=>s.map(e=>Ec[t][e])),Yp=Uint32Array.from([0,1518500249,1859775393,2400959708,2840853838]),Xp=Uint32Array.from([1352829926,1548603684,1836072691,2053994217,0]);function Ao(s,t,e,r){return s===0?t^e^r:s===1?t&e|~t&r:s===2?(t|~e)^r:s===3?t&r|e&~r:t^(e|~r)}const Gs=new Uint32Array(16);class qp extends lc{constructor(){super(64,20,8,!0),this.h0=1732584193,this.h1=-271733879,this.h2=-1732584194,this.h3=271733878,this.h4=-1009589776}get(){const{h0:t,h1:e,h2:r,h3:n,h4:i}=this;return[t,e,r,n,i]}set(t,e,r,n,i){this.h0=t|0,this.h1=e|0,this.h2=r|0,this.h3=n|0,this.h4=i|0}process(t,e){for(let u=0;u<16;u++,e+=4)Gs[u]=t.getUint32(e,!0);let r=this.h0|0,n=r,i=this.h1|0,o=i,a=this.h2|0,c=a,h=this.h3|0,l=h,d=this.h4|0,f=d;for(let u=0;u<5;u++){const p=4-u,g=Yp[u],m=Xp[u],x=Mc[u],y=Tc[u],b=$p[u],w=Vp[u];for(let v=0;v<16;v++){const S=Rs(r+Ao(u,i,a,h)+Gs[x[v]]+g,b[v])+d|0;r=d,d=h,h=Rs(a,10)|0,a=i,i=S}for(let v=0;v<16;v++){const S=Rs(n+Ao(p,o,c,l)+Gs[y[v]]+m,w[v])+f|0;n=f,f=l,l=Rs(c,10)|0,c=o,o=S}}this.set(this.h1+a+l|0,this.h2+h+f|0,this.h3+d+n|0,this.h4+r+o|0,this.h0+i+c|0)}roundClean(){Ve(Gs)}destroy(){this.destroyed=!0,Ve(this.buffer),this.set(0,0,0,0,0)}}const Kp=cc(()=>new qp);var ve={},So;function Zp(){if(So)return ve;So=1,Object.defineProperty(ve,"__esModule",{value:!0}),ve.bech32m=ve.bech32=void 0;const s="qpzry9x8gf2tvdw0s3jn54khce6mua7l",t={};for(let h=0;h<s.length;h++){const l=s.charAt(h);t[l]=h}function e(h){const l=h>>25;return(h&33554431)<<5^-(l>>0&1)&996825010^-(l>>1&1)&642813549^-(l>>2&1)&513874426^-(l>>3&1)&1027748829^-(l>>4&1)&705979059}function r(h){let l=1;for(let d=0;d<h.length;++d){const f=h.charCodeAt(d);if(f<33||f>126)return"Invalid prefix ("+h+")";l=e(l)^f>>5}l=e(l);for(let d=0;d<h.length;++d){const f=h.charCodeAt(d);l=e(l)^f&31}return l}function n(h,l,d,f){let u=0,p=0;const g=(1<<d)-1,m=[];for(let x=0;x<h.length;++x)for(u=u<<l|h[x],p+=l;p>=d;)p-=d,m.push(u>>p&g);if(f)p>0&&m.push(u<<d-p&g);else{if(p>=l)return"Excess padding";if(u<<d-p&g)return"Non-zero padding"}return m}function i(h){return n(h,8,5,!0)}function o(h){const l=n(h,5,8,!1);if(Array.isArray(l))return l}function a(h){const l=n(h,5,8,!1);if(Array.isArray(l))return l;throw new Error(l)}function c(h){let l;h==="bech32"?l=1:l=734539939;function d(g,m,x){if(x=x||90,g.length+7+m.length>x)throw new TypeError("Exceeds length limit");g=g.toLowerCase();let y=r(g);if(typeof y=="string")throw new Error(y);let b=g+"1";for(let w=0;w<m.length;++w){const v=m[w];if(v>>5!==0)throw new Error("Non 5-bit word");y=e(y)^v,b+=s.charAt(v)}for(let w=0;w<6;++w)y=e(y);y^=l;for(let w=0;w<6;++w){const v=y>>(5-w)*5&31;b+=s.charAt(v)}return b}function f(g,m){if(m=m||90,g.length<8)return g+" too short";if(g.length>m)return"Exceeds length limit";const x=g.toLowerCase(),y=g.toUpperCase();if(g!==x&&g!==y)return"Mixed-case string "+g;g=x;const b=g.lastIndexOf("1");if(b===-1)return"No separator character for "+g;if(b===0)return"Missing prefix for "+g;const w=g.slice(0,b),v=g.slice(b+1);if(v.length<6)return"Data too short";let S=r(w);if(typeof S=="string")return S;const k=[];for(let P=0;P<v.length;++P){const _=v.charAt(P),C=t[_];if(C===void 0)return"Unknown character "+_;S=e(S)^C,!(P+6>=v.length)&&k.push(C)}return S!==l?"Invalid checksum for "+g:{prefix:w,words:k}}function u(g,m){const x=f(g,m);if(typeof x=="object")return x}function p(g,m){const x=f(g,m);if(typeof x=="object")return x;throw new Error(x)}return{decodeUnsafe:u,decode:p,encode:d,toWords:i,fromWordsUnsafe:o,fromWords:a}}return ve.bech32=c("bech32"),ve.bech32m=c("bech32m"),ve}var Co=Zp();const Ot={idStr:()=>crypto.randomUUID().replaceAll("-","").slice(0,25),numAsStr:s=>s.toFixed(8),hash:s=>{const t=typeof s=="object"?JSON.stringify(s):`${s}`,e=new TextEncoder().encode(t),r=Js(e);return me(r)},round:s=>Math.round(s*1e9)/1e9,randomIp:()=>{const s=r=>{const[n,i]=r.split(".").map(Number);return n===10||n===172&&i>=16&&i<=31||n===192&&i===168},t=()=>{const r=ie({min:65,max:172}),n=ie({min:20,max:256}),i=ie({min:20,max:256}),o=ie({min:20,max:256});return`${r}.${n}.${i}.${o}`};let e;do e=t();while(s(e));return e}},ie=s=>{const{min:t,max:e,decimal:r=!1}=s,n=Math.random()*(e-t+1)+t;return r?n:Math.floor(n)},Qp=()=>{const s=jr.utils.randomPrivateKey(),t=jr.getPublicKey(s,!0),e=me(t);let r=[];const n=l=>{let d=0;for(let f=0;f<l.length;f++)d+=l[f];return Ot.round(d)},i=()=>n(r.map(l=>Number(l.value))),o=(()=>{const l=Kp(Js(t)),d=Co.bech32.toWords(l);return d.unshift(0),`addr${Co.bech32.encode("tb",d)}`})(),a=l=>{let d;for(const f of r){if(!d){d=f;continue}const u=Math.abs(l-Number(d.value));Math.abs(l-Number(f.value))<u&&(d=f)}return d},c=({units:l,recAddr:d})=>{const f=l*.0012345;if(i()<l+f){const S=`NSF ERROR
addr: ${o}
 balance: ${i()}`;throw new Error(S)}r.sort((S,k)=>Number(S.value)-Number(k.value));const u=[],p=()=>n(u.map(S=>Number(S.value)));for(;p()<l+f;){const S=l-p(),k=a(S);if(!k)throw new Error("unknown reason utxo not found :(");r=r.filter(P=>P.id!==k.id),u.push(k)}const g=S=>{const k=JSON.stringify(S),P=Js(new TextEncoder().encode(k)),_=jr.sign(P,s).toDERRawBytes();return me(_)},m={inputs:u,outputs:[{id:Ot.idStr(),value:Ot.numAsStr(l),owner:d}],pubKey:e,fee:Ot.numAsStr(f)},y=u.map(S=>Number(S.value)).reduce((S,k)=>S+k)-(l+f);y>0&&m.outputs.push({id:Ot.idStr(),value:Ot.numAsStr(y),owner:o});const b=g(m),w={...m,sig:b},v=Ot.hash(w);return{...w,hash:v}},h=l=>{r.length=0,l.map(d=>{d.owner=o,r.push(d)})};return h(Array.from({length:1e3}).map(()=>({id:Ot.idStr(),value:Ot.numAsStr(Math.random()*(1-.001+1)+.001),owner:""}))),{addr:()=>o,pubKey:()=>e,utxos:()=>r,setNewUTXOs:h,balance:i,createTx:c}};let $r="";const Jp=s=>{const{gameVars:t,pos:e}=s,{game:r,assets:n}=t,i=new Date,o=Ot.randomIp(),a=Qp(),c=Qf(),h=Zf(o),l=37,d=43,f=5,u=1.25,p=n.getTexture("server-anim-coin"),g=n.createSprite("server-off");g.texture.source.scaleMode="nearest",g.visible=!1,g.scale.set(u);let m=0;const x=Array.from({length:f},(P,_)=>{const C=new $({source:p.source,frame:new q(l*_+m,0,l,d)});return m+=1,C.source.scaleMode="nearest",C}),y=new Zs({textures:x});y.scale.set(u),y.animationSpeed=.07,y.play(),y.zIndex=_s.mid,g.zIndex=_s.mid,r.addChild(y),r.addChild(g),y.x=e?e.x-y.width*.5:0,y.y=e?e.y-y.height*.5:0;const b=P=>{y.visible=P,g.visible=!P,P===!0?y.position.set(y.x,y.y):g.position.set(y.x,y.y)},w=()=>new q(y.x,y.y,y.width,y.height),v=P=>{const{units:_,node:C}=P,A=C.wallet.addr(),M=a.createTx({units:_,recAddr:A});c.add(M),Rt.fire("newTx",{originId:o,tx:M})};return $r||($r=o),{setRunning:b,anim:y,createdAt:()=>i,ip:()=>o,destroy:()=>{y.parent&&y.parent.removeChild(y),y.destroy(),g.parent&&g.parent.removeChild(g),g.destroy()},toRect:w,connections:()=>h,sendBtc:v,receiveTx:P=>c.hasTx(P)?!1:(c.add(P),o===$r&&console.log(`ip: ${o}`,P),!0),wallet:a,mempool:c,pos:()=>({x:y.x+y.width*.5,y:y.y+y.height*.5})}},tm=s=>{const{gameVars:t,store:e}=s,{game:r,scaler:n}=t,i=()=>({width:r.width/n.getGameScale(),height:r.height/n.getGameScale()});return{create:()=>{const a=rm(e.data(),i());return Jp({gameVars:t,pos:a})}}},em=s=>{const t={top:new q,topLeft:new q,topRight:new q,bottom:new q,bottomLeft:new q,bottomRight:new q},e=2,r=175,n=s.anim.x+s.anim.width*.5,i=s.anim.y+s.anim.height*.5;return[{key:"top",angle:Math.PI*1.5},{key:"topRight",angle:Math.PI*1.85},{key:"bottomRight",angle:Math.PI*.15},{key:"bottom",angle:Math.PI*.5},{key:"bottomLeft",angle:Math.PI*.85},{key:"topLeft",angle:Math.PI*1.15}].map(a=>{const c=a.angle,h=n+Math.cos(c)*r,l=i+Math.sin(c)*r;t[a.key]=new q(h-e*.5,l-e*.5,e,e)}),t},sm=s=>{const{rectA:t,rectB:e,buffer:r=0}=s,n=new q(t.x-r,t.y-r,t.width+r*2,t.height+r*2),i=new q(e.x-r,e.y-r,e.width+r*2,e.height+r*2);return!(!(n.x<i.x+i.width)||!(n.x+n.width>i.x)||!(n.y<i.y+i.height)||!(n.y+n.height>i.y))},rm=(s,t)=>{if(s.length===0)return{x:t.width*.5-25,y:t.height*.5-25};const e=50;for(let r=0;r<s.length;r++){const n=s[r],i=em(n),o=["top","topRight","bottomRight","bottom","bottomLeft","topLeft"];for(const a of o){const c=i[a];if(!(c.x<10||c.y<10||c.x+c.width+e>t.width||c.y+c.height+e>t.height||s.some(l=>sm({rectA:c,rectB:l.toRect(),buffer:e}))))return{x:c.x+c.width*.5,y:c.y+c.height*.5}}}return console.warn("No open position found around any existing nodes."),{x:-1,y:-1}},nm=(s,t,e)=>{const r=Xf(),n=()=>({width:t.width/r.getGameScale(),height:t.height/r.getGameScale()});return{app:s,game:t,assets:e,resizer:qf(r),scaler:r,getWindowSize:n}},im=()=>{const s=[];return{push:t=>s.push(t),pop:()=>s.pop(),count:()=>s.length,data:()=>s}},om=s=>{const t=[];return{displayMovement:n=>{const{fromNode:i,toNode:o,txMsg:a}=n,c=am({start:i,end:o,container:s.game,txMsg:a});t.push(c)},update:n=>{for(let i=t.length-1;i>=0;i--){const o=t[i];if(o.update(n)){o.destroy(),t.splice(i,1);const c={originId:o.endId(),tx:o.txMsg()};Rt.fire("newTx",c)}}}}},am=s=>{const{container:t,start:e,end:r,txMsg:n,speed:i=9}=s,o=e.pos(),a=r.pos(),c=new tt().circle(0,0,5).fill({color:"#ff8f45"});c.x=o.x,c.y=o.y,t.addChild(c);const h=a.x-o.x,l=a.y-o.y,d=Math.sqrt(h*h+l*l),f=d===0?0:h/d,u=d===0?0:l/d;return{update:m=>{if(d===0)return!0;const x=a.x-c.x,y=a.y-c.y,b=Math.sqrt(x*x+y*y),w=i*m.deltaTime;return w>=b?(c.x=a.x,c.y=a.y,!0):(c.x+=f*w,c.y+=u*w,!1)},destroy:()=>{c.parent&&c.parent.removeChild(c),c.destroy()},txMsg:()=>n,startId:()=>e.ip(),endId:()=>r.ip()}},cm=s=>{const{gameVars:t,store:e}=s,{game:r}=t,n=c=>{const{node1:h,node2:l}=c,d={x:h.anim.x+h.anim.width*.5,y:h.anim.y+h.anim.height*.5},f={x:l.anim.x+l.anim.width*.5,y:l.anim.y+l.anim.height*.5},u=new tt,p=2,g=p*7.5,m="#FFFFFF",x=f.x-d.x,y=f.y-d.y,b=Math.sqrt(x*x+y*y),w=Math.atan2(y,x);for(let v=0;v<b;v+=g){const S=d.x+Math.cos(w)*v,k=d.y+Math.sin(w)*v;u.circle(S,k,p).fill({color:m})}return u.zIndex=_s.bottom,u},i=[];return{setup:()=>{for(;i.length>0;){const c=i.pop();c&&r.removeChild(c),c==null||c.destroy()}for(const c of e.data())c.connections().disconnect();for(const c of e.data())c.connections().connectCount()>=8||lm({node:c,count:6,store:e}).map(h=>{c.connections().connect(h),h.connections().connect(c);const l=n({node1:c,node2:h});i.push(l)});for(const c of i)r.addChild(c)},update:c=>{}}},lm=s=>{const{node:t,count:e,store:r}=s,n=r.data(),i=[],o=(c,h)=>{const l=c.x-h.x,d=c.y-h.y;return Math.sqrt(l*l+d*d)};for(const c of n){if(c.connections().isConnectedTo(t)||c.ip()===t.ip()||c.connections().connectCount()>=6)continue;const h=o(t.anim,c.anim);h>=200||i.push({node:c,distance:h})}return i.sort((c,h)=>c.distance-h.distance),i.slice(0,e+1).map(c=>c.node)},hm=s=>{const{gameVars:t,bounds:e}=s,{app:r,game:n,scaler:i}=t;let o={x:r.screen.width*.5,y:r.screen.height*.5},a=!1,c=null,h=null;n.eventMode="static",n.on("pointerdown",u=>{a=!0,c=u.global.clone(),h={...o},n.cursor="grabbing"}),n.on("pointermove",u=>{if(!a||!c||!h)return;const p=u.global,g=p.x-c.x,m=p.y-c.y;o={x:h.x-g,y:h.y-m};const x=e.width*i.getGameScale();o.x=Math.min(o.x,x-r.screen.width*.5),o.x=Math.max(o.x,r.screen.width*.5);const y=e.height*i.getGameScale();o.y=Math.min(o.y,y-r.screen.height*.5),o.y=Math.max(o.y,r.screen.height*.5)});const l=()=>{a=!1,c=null,h=null,n.cursor="default"};return n.on("pointerup",l),n.on("pointerupoutside",l),{getFocusPoint:()=>o,setFocusPoint:u=>{u&&(o=u)},isDragging:()=>a}},dm=s=>{const{store:t}=s,e=()=>{const i=t.data(),o=ie({min:0,max:i.length,decimal:!1});let a=ie({min:0,max:i.length,decimal:!1});if(a===o&&a!==i.length-1)a++;else if(a===o&&a!==0)a--;else if(a===o)throw new Error("cant send btc to self");return{sendIdx:o,recIdx:a}},r=()=>{try{const i=t.data();if(i.length<2)return;const{sendIdx:o,recIdx:a}=e(),c=i[o],h=i[a],l=c.wallet.balance(),d=ie({min:l*1e-5,max:l*.01,decimal:!0}),f=Ot.round(d);Rt.fire("randSend",{fromId:c.ip(),toId:h.ip(),units:f})}catch{}},n=(()=>{let i=ie({min:1500,max:3e3}),o=0;return{update:a=>{o>=i&&(o=0,i=ie({min:500,max:3e3}),r()),o+=a.deltaMS}}})();return{update:i=>{n.update(i)}}},um=({rows:s,cols:t})=>{const r="#4E505F",n=new tt;n.zIndex=_s.bottom;const i=[],o=new At({fontFamily:"GraphPix",fontSize:8});for(let h=0;h<s;h++)for(let l=0;l<t;l++){const d=l*50,f=h*50;n.rect(d,f,50,50).fill(r);const u=new Zt({style:o,text:`${h+1},${l+1}`});u.resolution=2,u.anchor.set(.5,.5),u.position.set(d+50*.5,f+50*.5),i.push(u)}const a=1,c="#b6cdd5";for(let h=0;h<=s;h++)for(let l=0;l<=t;l++){const d=l*50,f=h*50;n.circle(d,f,a).fill({color:c,alpha:.25})}return{size:{width:t*50,height:s*50},graphic:n,texts:i}},fm=()=>{const t=new tt,e=275;t.rect(0,0,180,e).fill({color:"#dca27f"});const r=5,n="#cd7a47",i=new tt;i.moveTo(0,-r*.5),i.lineTo(180,-r*.5),i.stroke({width:r,color:n});const o=new tt;o.moveTo(-r*.5,0),o.lineTo(-r*.5,e),o.stroke({width:r,color:n});const a=new tt;a.moveTo(180+r*.5,0),a.lineTo(180+r*.5,e),a.stroke({width:r,color:n});const c=new tt;c.moveTo(0,e+r*.5),c.lineTo(180,e+r*.5),c.stroke({width:r,color:n});const h=new ut;h.addChild(t,i,a,c,o);let l=!0;return{ctr:h,setIsOpen:f=>{if(l===f)return;l=f;const u=f?180:15;t.clear(),t.rect(0,0,u,e).fill({color:"#dca27f"}),i.clear(),i.moveTo(0,-r*.5),i.lineTo(u,-r*.5),i.stroke({width:r,color:n}),a.clear(),a.moveTo(u+r*.5,0),a.lineTo(u+r*.5,e),a.stroke({width:r,color:n}),c.clear(),c.moveTo(0,e+r*.5),c.lineTo(u,e+r*.5),c.stroke({width:r,color:n})}}},pm=()=>{let s=!0;const t=new ut,e={x:5,y:5},r=4,n=new tt().rect(e.x,e.y,r,r).fill("#FFFFFF"),i=new tt().rect(e.x+r,e.y+r,r,r).fill("#FFFFFF"),o=new tt().rect(e.x+r*2,e.y+r*2,r,r).fill("#FFFFFF"),a=new tt().rect(e.x+r,e.y+r*3,r,r).fill("#FFFFFF"),c=new tt().rect(e.x,e.y+r*4,r,r).fill("#FFFFFF"),h=new tt().rect(e.x-2,e.y-2,r*3+4,r*5+4).fill({color:"#FFFFFF",alpha:0});return t.addChild(n,i,o,a,c,h),{ctr:t,hitArea:h,faceRight:()=>{s||(n.x-=r*2,o.x+=r*2,c.x-=r*2,s=!0)},faceLeft:()=>{s&&(n.x+=r*2,o.x-=r*2,c.x+=r*2,s=!1)}}},ko=s=>{const{app:t,onChange:e,values:r,pos:n,label:i}=s,o=new ut,a=new At({fontFamily:"GraphPix",fontSize:10,fill:"#FFFFFF"}),c=new Zt({style:a,text:`${i}: 0`});c.resolution=2;const h=new ut,l={x:0,y:c.height+15},d=new tt().rect(l.x,l.y,150,10).fill({color:"#aa4f11"}),f=4,u={x:-f,y:l.y+f*.75},p=new tt().rect(u.x,u.y,f,f).fill({color:"#aa4f11"}),g={x:d.width,y:l.y+f*.75},m=new tt().rect(g.x,g.y,4,4).fill({color:"#aa4f11"}),x=new ut,y=new tt().rect(5,25,10,10).fill({color:"#d8bbaa"}),b=new tt().rect(5,22,10,3).fill({color:"#FFFFFF"}),w=new tt().rect(15,25,3,10).fill({color:"#FFFFFF"}),v=new tt().rect(5,35,10,3).fill({color:"#FFFFFF"}),S=new tt().rect(2,25,3,10).fill({color:"#FFFFFF"});x.addChild(y,b,w,v,S),x.y-=1,h.addChild(d,p,m,x);let k=0,P=!1;x.interactive=!0,x.cursor="grab";const _=A=>{if(!P)return;const E=x.parent.toLocal(A.global),F=d.x,R=d.width,T=y.width;let I=E.x-10;const B=-2,D=F+R-T-8;I=Math.max(B,Math.min(I,D));const W=D-B,U=I-B,Z=W/r.max,H=Math.round(U/Z);e&&k!==H&&(k=H,e(H),c.text=`${i}: ${H}`,c.x=d.width*.5-c.width*.5),x.x=I},C=()=>{P=!1,x.cursor="grab",t.stage.off("pointermove",_),t.stage.off("pointerup",C),t.stage.off("pointerupoutside",C)};return x.on("pointerdown",()=>{P=!0,x.cursor="grabbing",t.stage.on("pointermove",_),t.stage.on("pointerup",C),t.stage.on("pointerupoutside",C)}),o.addChild(c,h),o.x=n.x,o.y=n.y,c.x=d.width*.5-c.width*.5,s.disable&&(o.alpha=.5,x.interactive=!1),{ctr:o}},mm=s=>{const{assets:t,pos:e,label:r}=s,n=new ut,i=Vr({pos:{x:0,y:0},assets:t,icon:"+"}),o=Vr({pos:{x:40,y:0},assets:t,icon:"-"}),a=Vr({pos:{x:80,y:0},assets:t,icon:t.createSprite("reset")}),c=new At({fontFamily:"GraphPix",fontSize:10,fill:"#FFFFFF"}),h=new Zt({style:c,text:r});return h.resolution=2,h.x+=5,h.y-=20,n.addChild(i.ctr,o.ctr,a.ctr,h),n.position.set(e.x,e.y),{ctr:n,isZoomInPressed:i.isPressed,isZoomOutPressed:o.isPressed,isZoomResetPressed:a.isPressed}},Vr=s=>{const{pos:t,assets:e,icon:r}=s,n={x:t.x,y:t.y},i={x:t.x,y:t.y+4},o=new ut;o.position.set(n.x,n.y);let a=!1;const c=e.getTexture("zoom-btn-up"),h=e.getTexture("zoom-btn-dn"),l=new Gt(c);if(l.scale.set(2.5),o.addChild(l),o.interactive=!0,o.on("pointerdown",()=>{a=!0,l.texture=h,o.position.set(i.x,i.y)}),o.on("pointerup",()=>{a=!1,l.texture=c,o.position.set(n.x,n.y)}),o.on("pointerout",()=>{a=!1,l.texture=c,o.position.set(n.x,n.y)}),typeof r=="string"){const d=new At({fontFamily:"GraphPix",fontSize:18,fill:"#FFFFFF"}),f=new Zt({style:d,text:r});f.resolution=2,f.x=l.width*.5-f.width*.43,f.y=l.height*.5-f.height*.6,o.addChild(f)}return typeof r=="object"&&(r.scale.set(2.5),r.x=r.width*.5,r.y=r.height*.45,o.addChild(r)),{ctr:o,isPressed:()=>a}},gm=s=>{const{app:t,scaler:e,assets:r}=s,n=new ut,i=fm(),o=pm();let a=!0;const c=p=>{n.scale.set(e.getBaseScale()),n.position.set(p.screen.width-n.width,90*e.getBaseScale())},h=()=>setTimeout(()=>c(t),10);window.addEventListener("windowResize",h);const l=ko({app:t,pos:{x:15,y:48},label:"Bitcoin Nodes",values:{min:0,max:127},onChange:p=>{Rt.fire("node",{count:p})}}),d=ko({app:t,pos:{x:15,y:113},label:"Bad Actor Nodes",values:{min:0,max:100},disable:!0,onChange:p=>{}}),f=mm({assets:r,pos:{x:32,y:225},label:"Zoom Controls"}),u=p=>{i.setIsOpen(p),p===!1?(o.faceLeft(),o.ctr.x-=5):(o.faceRight(),o.ctr.x+=5),l.ctr.visible=p,d.ctr.visible=p,a=p,f.ctr.visible=p,c(t)};return u(!1),o.hitArea.interactive=!0,o.hitArea.cursor="pointer",o.hitArea.on("pointerdown",()=>u(!a)),n.addChild(i.ctr,o.ctr,l.ctr,d.ctr,f.ctr),t.stage.addChild(n),c(t),{update:p=>{f.isZoomInPressed()&&Rt.fire("zoom","in"),f.isZoomOutPressed()&&Rt.fire("zoom","out"),f.isZoomResetPressed()&&Rt.fire("zoom","reset")}}},xm=s=>{const t="game-imgs/btc-net-sim",e=r=>`url(${t}/${r}.png),auto`;s.renderer.events.cursorStyles.default=e("ms-default"),s.renderer.events.cursorStyles.pointer=e("ms-pointer"),s.renderer.events.cursorStyles.grabbing=e("ms-grabbing"),s.renderer.events.cursorStyles.grab=e("ms-grab")},Rt=Lo();async function ym(s){const t=new ut,e=Yf(),r=nm(s,t,e);bm(r).next(()=>wm(r))}const bm=s=>{let t,e;const{game:r,app:n,resizer:i}=s;return n.stage.addChild(r),setTimeout(()=>i.resize(n,r),0),{next:async o=>{r.removeChildren(),r.removeAllListeners(),t&&t.destroy(),e=o();const a=c=>{e==null||e.update(c)};t=new Dt().add(a),await e.load(r),t.start()}}},wm=s=>{const{game:t,app:e,assets:r,resizer:n}=s;let i,o,a,c,h,l;const d=im(),f=tm({gameVars:s,store:d}),u=um({rows:30,cols:46}),p=()=>window.dispatchEvent(new CustomEvent("windowResize"));window.addEventListener("resize",()=>p);const g=()=>setTimeout(()=>{n.resize(e,t),h==null||h.lookAt(i==null?void 0:i.getFocusPoint())},10);return window.addEventListener("windowResize",g),e.canvas.addEventListener("contextmenu",m=>m.preventDefault()),e.stage.interactive=!0,xm(e),Rt.on("zoom",m=>{if(!i||!h)return;const x=.001;m==="in"&&h.zoom(x),m==="out"&&h.zoom(-x),m==="reset"&&h.resetZoom();const y=t.getSize();n.resize(e,t);const b=t.getSize(),w=b.height>y.height,v=Math.max(y.width,b.width),k=Math.min(y.width,b.width)/v,P=Math.max(y.height,b.height),C=Math.min(y.height,b.height)/P,A=i.getFocusPoint(),M={x:w?A.x/k:A.x*k,y:w?A.y/C:A.y*C};i.setFocusPoint(M),h==null||h.lookAt(i==null?void 0:i.getFocusPoint())}),Rt.on("node",m=>{if(m.count>d.count())for(;m.count>d.count();){const x=f.create();d.push(x),o==null||o.setup()}if(m.count<d.count()){for(;m.count<d.count();){const x=d.pop();x==null||x.destroy()}o==null||o.setup()}}),Rt.on("randSend",m=>{try{const x=d.data(),y=x.find(w=>w.ip()===m.toId),b=x.find(w=>w.ip()===m.fromId);if(!b||!y||y.ip()===m.fromId)return;b.sendBtc({units:m.units,node:y})}catch{}}),Rt.on("newTx",m=>{const x=d.data().find(b=>b.ip()===m.originId);if(!x)return;x.connections().getAll().map(b=>{b.receiveTx(m.tx)&&(a==null||a.displayMovement({fromNode:x,toNode:b,txMsg:m.tx}))})}),{load:async()=>{await r.load(),t.addChild(u.graphic),h=Kf({gameVars:s,bounds:u.size,clampCamera:!1}),i=hm({gameVars:s,bounds:u.size}),o=cm({gameVars:s,store:d}),a=om(s),c=dm({store:d}),setTimeout(()=>{if(!i||!h)return;const m={x:t.width*.5,y:t.height*.5};i.setFocusPoint(m),h.lookAt(i==null?void 0:i.getFocusPoint()),Rt.fire("node",{count:19}),h==null||h.setZoom(.6),i.setFocusPoint({x:e.screen.width*.8,y:e.screen.height*.92}),window.dispatchEvent(new CustomEvent("windowResize")),h==null||h.lookAt(i==null?void 0:i.getFocusPoint())},50),l=gm(s)},update:m=>{h==null||h.update(m),l==null||l.update(m),i!=null&&i.isDragging()&&(h==null||h.lookAt(i==null?void 0:i.getFocusPoint())),o==null||o.update(m),a==null||a.update(m),c==null||c.update(m)}}},Yr=854,Xr=480;let Xt=1;const Yn=s=>{const{width:t,height:e}=s.screen,r=t/e,n=Yr/Xr;if(r>n){Xt=e/Xr;const i=(t-Yr*Xt)/2;s.stage.scale.set(Xt,Xt),s.stage.position.set(i,0)}else{Xt=t/Yr;const i=(e-Xr*Xt)/2;s.stage.scale.set(Xt,Xt),s.stage.position.set(0,i)}};let qr=0;const _m=150,Ic=s=>{try{qr+=s.ticker.deltaMS,qr>=_m&&(Yn(s),qr=0)}catch{}};var zt=(s=>(s[s.bottom=0]="bottom",s[s.mid=1]="mid",s[s.top=2]="top",s))(zt||{}),fe=(s=>(s[s.paused=0]="paused",s[s.play=1]="play",s))(fe||{});const vm=s=>{const t=new Map,e=({game:o,pos:a})=>{const c=new Gt(s);c.zIndex=zt.bottom,c.scale.set(Xn),c.anchor.set(.5),c.x=a.x,c.y=a.y;const h=crypto.randomUUID().replaceAll("-","").slice(0,15),l={id:h,sprite:c};o.addChild(l.sprite),t.set(h,l)},r=()=>{const o=[];for(const[a,c]of t)o.push(c);return o},n=({game:o,id:a})=>{const c=t.get(a);c&&(o.removeChild(c.sprite),c.sprite.destroy(),t.delete(a))};return{list:r,createApple:e,remove:n,reset:o=>{for(const[a,c]of t)n({game:o,id:a})}}},Am=async()=>{const s=await kt.load(`${ms}/apple.png`);return s.source.scaleMode="nearest",vm(s)},Sm=({gridSize:s,texture:t})=>{const e=[],{row:r,col:n}=s,i=new At({fontFamily:"GraphPix",fontSize:6,fill:"#000000"});for(let h=0;h<r*n;h++){const l=new Gt(t);l.scale.set(Xn),l.anchor.set(.5,.5);const d=Math.floor(h/n),f=h%n;l.x=f*l.width+l.width*.5,l.y=d*l.height+l.height*.5,l.zIndex=zt.bottom;const u=Cm(l);e.push(u)}const o=h=>{const l=h.row*s.col+h.col;return e[l]},a=h=>{for(let l=0;l<e.length;l++){const d=e[l],f=new Zt({style:i,text:`${l}`});f.resolution=2;const{x:u,y:p}=d.sprite;f.position.set(u-18,p-18),f.zIndex=zt.mid,h.addChild(f)}},c=h=>{for(const l of e){const d=l.getIndexPos(),f=new Zt({style:i,text:`${d.row}, ${d.col}`});f.resolution=2;const{x:u,y:p}=l.sprite;f.position.set(u-18,p-18),f.zIndex=zt.mid,h.addChild(f)}};return{tiles:e,sizeIdx:s,size:{width:e[0].sprite.width*s.col,height:e[0].sprite.height*s.row},getTileFromIndexPos:o,displayIndexes:a,displayPosIndexes:c}},Cm=s=>({sprite:s,getIndexPos:()=>{const{x:e,y:r,width:n,height:i}=s,o=e-n*.5,a=r-i*.5,c=Math.floor(o/n),h=Math.floor(a/i);return{col:c,row:h}}}),km=async()=>{const s=`${ms}/game-tile.png`,t=await kt.load(s);return t.source.scaleMode="nearest",t},Pm=s=>{const{game:t,app:e,bounds:r}=s,n={x:0,y:0},i={width:0,height:0};return{posZero:n,lookAt:a=>{if(!a)return;i.width=e.screen.width/Xt,i.height=e.screen.height/Xt;let c=-a.x+i.width*.5,h=-a.y+i.height*.5;const l=-(r.width-i.width);c=Math.min(Math.max(c,l),0);const f=-(r.height-i.height);h=Math.min(Math.max(h,f),0),t.position.set(c,h),n.x=-t.position.x,n.y=-t.position.y},viewport:i}};var gt=(s=>(s[s.up=0]="up",s[s.right=1]="right",s[s.down=2]="down",s[s.left=3]="left",s))(gt||{});const Po=s=>{const t={x:0,y:0},e=new Gt(s);e.zIndex=zt.mid,e.scale.set(Xn),e.anchor.set(.5);const r={faceUp:()=>{e.rotation=Math.PI},faceRight:()=>{e.rotation=Math.PI*1.5},faceDown:()=>{e.rotation=0},faceLeft:()=>{e.rotation=Math.PI*.5},isFacing:{up:()=>e.rotation===Math.PI,right:()=>e.rotation===Math.PI*1.5,down:()=>e.rotation===0,left:()=>e.rotation===Math.PI*.5}},n=()=>e.x===t.x&&e.y===t.y;return{nextPos:t,direction:r,moveTo:c=>{t.x=c.x,t.y=c.y},placeAt:c=>{t.x=c.x,t.y=c.y,e.x=c.x,e.y=c.y},sprite:e,update:c=>{n()||(e.y>t.y&&(e.y-=.125*c.deltaMS,e.y<t.y&&(e.y=t.y)),e.x<t.x&&(e.x+=.125*c.deltaMS,e.x>t.x&&(e.x=t.x)),e.y<t.y&&(e.y+=.125*c.deltaMS,e.y>t.y&&(e.y=t.y)),e.x>t.x&&(e.x-=.125*c.deltaMS,e.x<t.x&&(e.x=t.x)))},isIdle:n}},Mm=s=>{const{head:t,dead:e,body:r}=s,n=Po(t),i=[];return{head:n,body:i,update:l=>{n.update(l);for(let d=0;d<i.length;d++)i[d].update(l)},died:()=>{n.sprite.texture=e},addSegment:l=>{const d=Po(r);if(i.length===0){const{x:f,y:u}=n.sprite;d.placeAt({x:f,y:u})}else{const{x:f,y:u}=i[i.length-1].sprite;d.placeAt({x:f,y:u})}i.push(d),l.addChild(d.sprite)},reset:l=>{n.sprite.texture=t,i.map(d=>{l.removeChild(d.sprite),d.sprite.destroy()}),i.length=0}}},Tm=async()=>{const s=kt.load(`${ms}/snake-head.png`),t=kt.load(`${ms}/snake-dead.png`),e=kt.load(`${ms}/snake-body.png`),r=await Promise.all([s,t,e]);for(const n of r)n.source.scaleMode="nearest";return{head:r[0],dead:r[1],body:r[2]}},Mo=s=>{const{snake:t,gameTiles:e,initPos:r}=s;let n={...r,direction:gt.down},i={...r,direction:gt.down};Em(t).on(e).at(r),t.head.direction.faceDown(),rs(t).on(e).to(r),Kt.on("keyPressed",h=>{if(t){if(h==="up"){if(t.head.direction.isFacing.down())return;i={...n,direction:gt.up,row:n.row-1}}if(h==="right"){if(t.head.direction.isFacing.left())return;i={...n,direction:gt.right,col:n.col+1}}if(h==="down"){if(t.head.direction.isFacing.up())return;i={...n,direction:gt.down,row:n.row+1}}if(h==="left"){if(t.head.direction.isFacing.right())return;i={...n,direction:gt.left,col:n.col-1}}}});let o=0;const a=h=>{if(o<2500){o+=h.elapsedMS;return}for(let l=0;l<t.body.length;l++){const d=t.body[l];if(rr.circles(t.head.sprite,d.sprite))return!0}return!1};return{update:h=>{if(a(h)&&Kt.fire("gameEvent","gameOver"),!t.head.isIdle())return;let l=t.head;for(let d=0;d<t.body.length;d++){const{x:f,y:u}=l.sprite,p=t.body[d];p.moveTo({x:f,y:u}),l=p}n={...i},n.direction===gt.up&&(t.head.direction.faceUp(),rs(t).on(e).to(n),i={...n,direction:gt.up,row:n.row-1}),n.direction===gt.right&&(t.head.direction.faceRight(),rs(t).on(e).to(n),i={...n,direction:gt.right,col:n.col+1}),n.direction===gt.down&&(t.head.direction.faceDown(),rs(t).on(e).to(n),i={...n,direction:gt.down,row:n.row+1}),n.direction===gt.left&&(t.head.direction.faceLeft(),rs(t).on(e).to(n),i={...n,direction:gt.left,col:n.col-1})}}},Em=s=>({on:e=>({at:n=>{const{row:i,col:o}=n,{x:a,y:c}=e.getTileFromIndexPos({row:i,col:o}).sprite;s.head.placeAt({x:a,y:c})}})}),rs=s=>({on:e=>({to:n=>{const{row:i,col:o}=n,a=i<e.sizeIdx.row&&i>=0,c=o<e.sizeIdx.col&&o>=0;if(a&&c){const{x:h,y:l}=e.getTileFromIndexPos(n).sprite;s.head.moveTo({x:h,y:l})}if(o<0){const{y:h}=e.getTileFromIndexPos({row:i,col:0}).sprite,l=-e.tiles[0].sprite.width;s.head.moveTo({x:l,y:h})}if(i<0){const{x:h}=e.getTileFromIndexPos({row:0,col:o}).sprite,l=-e.tiles[0].sprite.height;s.head.moveTo({x:h,y:l})}if(i>=e.sizeIdx.row){const h=e.sizeIdx.row-1,{x:l,y:d}=e.getTileFromIndexPos({row:h,col:o}).sprite,f=d+e.tiles[0].sprite.height;s.head.moveTo({x:l,y:f})}if(o>=e.sizeIdx.col){const h=e.sizeIdx.col-1,{x:l,y:d}=e.getTileFromIndexPos({row:i,col:h}).sprite,f=l+e.tiles[0].sprite.width;s.head.moveTo({x:f,y:d})}}})}),ms="game-imgs/slither-slim";let sr=0;const Xn=3.25,Kt=Lo();async function Im(s){Bm(s).next((e,r)=>Fm(e,r)),window.addEventListener("keydown",e=>{switch(e.code){case"ArrowUp":Kt.fire("keyPressed","up");break;case"ArrowRight":Kt.fire("keyPressed","right");break;case"ArrowDown":Kt.fire("keyPressed","down");break;case"ArrowLeft":Kt.fire("keyPressed","left");break;case"Enter":Kt.fire("keyPressed","enter");break}})}const Bm=s=>{let t,e;const r=new ut;return s.stage.addChild(r),setTimeout(()=>Yn(s),0),{next:async n=>{r.removeChildren(),r.removeAllListeners(),t&&t.destroy(),e=n(r,s);const i=o=>{Ic(s),e==null||e.update(o)};t=new Dt().add(i),await e.load(r),t.start()}}},Fm=(s,t)=>{let e,r,n,i,o;const a=Rm(),c=Lm();let h=fe.paused;const l=()=>{if(!r||!e||!o)return;i=Mo({snake:r,gameTiles:e,initPos:{row:5,col:5}}),r.reset(s),r.addSegment(s),a.setScore(r==null?void 0:r.body.length),o.reset(s),Array.from({length:12}).map(()=>d())},d=()=>{const f=zm({gameTiles:e,snake:r,apples:o}).getRandomTile(),u={x:f.sprite.x,y:f.sprite.y};o==null||o.createApple({game:s,pos:u})};return Kt.on("keyPressed",f=>{f==="enter"&&h===fe.paused&&(h=fe.play,a.setVisible(!0),c.setVisible(!1),l())}),Kt.on("gameEvent",f=>{f==="gameOver"&&h===fe.play&&(r==null||r.died(),h=fe.paused,a.setVisible(!1),c.setVisible(!0))}),{load:async()=>{const f=await km();if(e=Sm({texture:f,gridSize:{row:15,col:20}}),e.tiles.map(u=>s.addChild(u.sprite)),r=await Tm().then(u=>Mm(u)),!(r!=null&&r.head))throw new Error("snake head did not load");s.addChild(r.head.sprite),o=await Am(),i=Mo({snake:r,gameTiles:e,initPos:{row:5,col:5}}),a.addToApp(t),c.addTo(s),n=Pm({app:t,game:s,bounds:e.size})},update:f=>{if(!(!r||!e||!o)){if(h===fe.paused&&c.update(n),h===fe.play){r.update(f),i==null||i.update(f),Gm({snake:r,bounds:e.size})&&Kt.fire("gameEvent","gameOver");for(const u of o.list())if(rr.circles(r.head.sprite,u.sprite)){const{id:p}=u;o.remove({game:s,id:p}),r.addSegment(s),a.setScore(r==null?void 0:r.body.length),d()}}n==null||n.lookAt(r==null?void 0:r.head.sprite.position)}}}},Rm=()=>{const s=new Zt({style:new At({fontFamily:"GraphPix",fontSize:10,fill:"#FFFFFF"}),text:"LENGTH: 0"});s.resolution=2,s.zIndex=zt.top;const t=new tt().roundRect(0,0,100,100,6).fill({color:"#000000",alpha:.5});t.zIndex=zt.top;const e=o=>{o.addChild(t),o.addChild(s)},r=o=>{o.stage.addChild(t),o.stage.addChild(s),t.position.set(3,3),s.position.set(7,5)},n=o=>{s.visible=o,t.visible=o};return n(!1),{addTo:e,setVisible:n,setScore:o=>{const a=(o||0)+1;s.text=`LENGTH: ${a}`,sr=Math.max(a,sr),t.width=s.width+5,t.height=s.height+5},addToApp:r}},Lm=()=>{const s="GraphPix",t="#FFFFFF",e=new At({fontFamily:s,fontSize:40,fill:t}),r=new Zt({style:e});r.resolution=2,r.text="SLITHER SLIM",r.zIndex=zt.top;const n=new At({fontFamily:s,fontSize:18,fill:t}),i=new Zt({style:n});i.resolution=2,i.text=`HIGH SCORE: ${sr}`,i.scale.set(.75),i.zIndex=zt.top;const o=new Zt({style:n});o.resolution=2,o.text="Press “ENTER” to begin",o.zIndex=zt.top;const a=new tt().rect(0,0,100,100).fill({color:"#000000",alpha:.65});return a.zIndex=zt.top,{addTo:d=>{d.addChild(a),d.addChild(r),d.addChild(o),d.addChild(i)},update:d=>{if(!d)return;const{posZero:f,viewport:u}=d,p=u.width===a.width,g=u.height===a.height;(!p||!g)&&(a.width=u.width+10,a.height=u.height+10),a.position.set(f.x-5,f.y-5);const m=u.width*.5-r.width*.5;r.position.set(f.x+m,f.y+50);const x=u.width*.5-i.width*.5;i.position.set(f.x+x,f.y+225);const y=u.width*.5-o.width*.5;o.position.set(f.x+y,f.y+400)},setVisible:d=>{a.visible=d,r.visible=d,i.visible=d,o.visible=d,i.text=`HIGH SCORE: ${sr}`}}},zm=({gameTiles:s,snake:t,apples:e})=>{if(!s)throw new Error("in fromOpenTiles(), gameTiles not defined");if(!t)throw new Error("in fromOpenTiles(), snake not defined");if(!e)throw new Error("in fromOpenTiles(), apples not defined");const r=[];for(let i=0;i<s.tiles.length;i++){const o=s.tiles[i];let a=!1;for(let h=0;h<t.body.length&&!a;h++){const l=t.body[h];rr.squares(l.sprite,o.sprite)&&(a=!0)}const c=e.list();for(let h=0;h<c.length&&!a;h++){const l=c[h];rr.squares(l.sprite,o.sprite)&&(a=!0)}a||r.push(o)}return{getRandomTile:()=>{if(r.length===0)throw new Error("empty game tiles");const i=Math.floor(Math.random()*r.length);return r[i]}}},rr={circles:(s,t)=>{const r={x:s.x,y:s.y,radius:s.width*.5-8},n={x:t.x,y:t.y,radius:t.width*.5},i=r.x-n.x,o=r.y-n.y;return Math.sqrt(i*i+o*o)<r.radius+n.radius},squares:(s,t)=>{const e=s.getBounds(),r=t.getBounds(),n=e.left<r.right&&e.right>r.left,i=e.top<r.bottom&&e.bottom>r.top;return n&&i}},Gm=s=>{const{snake:t,bounds:e}=s,r={x:t.head.sprite.x,y:t.head.sprite.y,width:t.head.sprite.width,height:t.head.sprite.height},n=r.width*.35;return r.x-n<0||r.y-n<0||r.x+n>e.width||r.y+n>e.height};async function Ns(s){Nm(s).next(Om)}const Nm=s=>{let t,e;const r=new ut;return s.stage.addChild(r),setTimeout(()=>Yn(s),0),{next:async n=>{r.removeChildren(),r.removeAllListeners(),t&&t.destroy(),e=n(r);const i=o=>{Ic(s),e==null||e.update(o)};t=new Dt().add(i),await e.load(r),t.start()}}},Om=s=>({load:async()=>{const t=await kt.load("game-imgs/space-game.png"),e=new Gt(t);e.x=0,e.y=0,s.addChild(e)},update:t=>{}});function Bc(s){var t,e,r="";if(typeof s=="string"||typeof s=="number")r+=s;else if(typeof s=="object")if(Array.isArray(s)){var n=s.length;for(t=0;t<n;t++)s[t]&&(e=Bc(s[t]))&&(r&&(r+=" "),r+=e)}else for(e in s)s[e]&&(r&&(r+=" "),r+=e);return r}function Um(){for(var s,t,e=0,r="",n=arguments.length;e<n;e++)(s=arguments[e])&&(t=Bc(s))&&(r&&(r+=" "),r+=t);return r}const qn="-",Dm=s=>{const t=Wm(s),{conflictingClassGroups:e,conflictingClassGroupModifiers:r}=s;return{getClassGroupId:o=>{const a=o.split(qn);return a[0]===""&&a.length!==1&&a.shift(),Fc(a,t)||Hm(o)},getConflictingClassGroupIds:(o,a)=>{const c=e[o]||[];return a&&r[o]?[...c,...r[o]]:c}}},Fc=(s,t)=>{var o;if(s.length===0)return t.classGroupId;const e=s[0],r=t.nextPart.get(e),n=r?Fc(s.slice(1),r):void 0;if(n)return n;if(t.validators.length===0)return;const i=s.join(qn);return(o=t.validators.find(({validator:a})=>a(i)))==null?void 0:o.classGroupId},To=/^\[(.+)\]$/,Hm=s=>{if(To.test(s)){const t=To.exec(s)[1],e=t==null?void 0:t.substring(0,t.indexOf(":"));if(e)return"arbitrary.."+e}},Wm=s=>{const{theme:t,classGroups:e}=s,r={nextPart:new Map,validators:[]};for(const n in e)vn(e[n],r,n,t);return r},vn=(s,t,e,r)=>{s.forEach(n=>{if(typeof n=="string"){const i=n===""?t:Eo(t,n);i.classGroupId=e;return}if(typeof n=="function"){if(jm(n)){vn(n(r),t,e,r);return}t.validators.push({validator:n,classGroupId:e});return}Object.entries(n).forEach(([i,o])=>{vn(o,Eo(t,i),e,r)})})},Eo=(s,t)=>{let e=s;return t.split(qn).forEach(r=>{e.nextPart.has(r)||e.nextPart.set(r,{nextPart:new Map,validators:[]}),e=e.nextPart.get(r)}),e},jm=s=>s.isThemeGetter,$m=s=>{if(s<1)return{get:()=>{},set:()=>{}};let t=0,e=new Map,r=new Map;const n=(i,o)=>{e.set(i,o),t++,t>s&&(t=0,r=e,e=new Map)};return{get(i){let o=e.get(i);if(o!==void 0)return o;if((o=r.get(i))!==void 0)return n(i,o),o},set(i,o){e.has(i)?e.set(i,o):n(i,o)}}},An="!",Sn=":",Vm=Sn.length,Ym=s=>{const{prefix:t,experimentalParseClassName:e}=s;let r=n=>{const i=[];let o=0,a=0,c=0,h;for(let p=0;p<n.length;p++){let g=n[p];if(o===0&&a===0){if(g===Sn){i.push(n.slice(c,p)),c=p+Vm;continue}if(g==="/"){h=p;continue}}g==="["?o++:g==="]"?o--:g==="("?a++:g===")"&&a--}const l=i.length===0?n:n.substring(c),d=Xm(l),f=d!==l,u=h&&h>c?h-c:void 0;return{modifiers:i,hasImportantModifier:f,baseClassName:d,maybePostfixModifierPosition:u}};if(t){const n=t+Sn,i=r;r=o=>o.startsWith(n)?i(o.substring(n.length)):{isExternal:!0,modifiers:[],hasImportantModifier:!1,baseClassName:o,maybePostfixModifierPosition:void 0}}if(e){const n=r;r=i=>e({className:i,parseClassName:n})}return r},Xm=s=>s.endsWith(An)?s.substring(0,s.length-1):s.startsWith(An)?s.substring(1):s,qm=s=>{const t=Object.fromEntries(s.orderSensitiveModifiers.map(r=>[r,!0]));return r=>{if(r.length<=1)return r;const n=[];let i=[];return r.forEach(o=>{o[0]==="["||t[o]?(n.push(...i.sort(),o),i=[]):i.push(o)}),n.push(...i.sort()),n}},Km=s=>({cache:$m(s.cacheSize),parseClassName:Ym(s),sortModifiers:qm(s),...Dm(s)}),Zm=/\s+/,Qm=(s,t)=>{const{parseClassName:e,getClassGroupId:r,getConflictingClassGroupIds:n,sortModifiers:i}=t,o=[],a=s.trim().split(Zm);let c="";for(let h=a.length-1;h>=0;h-=1){const l=a[h],{isExternal:d,modifiers:f,hasImportantModifier:u,baseClassName:p,maybePostfixModifierPosition:g}=e(l);if(d){c=l+(c.length>0?" "+c:c);continue}let m=!!g,x=r(m?p.substring(0,g):p);if(!x){if(!m){c=l+(c.length>0?" "+c:c);continue}if(x=r(p),!x){c=l+(c.length>0?" "+c:c);continue}m=!1}const y=i(f).join(":"),b=u?y+An:y,w=b+x;if(o.includes(w))continue;o.push(w);const v=n(x,m);for(let S=0;S<v.length;++S){const k=v[S];o.push(b+k)}c=l+(c.length>0?" "+c:c)}return c};function Jm(){let s=0,t,e,r="";for(;s<arguments.length;)(t=arguments[s++])&&(e=Rc(t))&&(r&&(r+=" "),r+=e);return r}const Rc=s=>{if(typeof s=="string")return s;let t,e="";for(let r=0;r<s.length;r++)s[r]&&(t=Rc(s[r]))&&(e&&(e+=" "),e+=t);return e};function tg(s,...t){let e,r,n,i=o;function o(c){const h=t.reduce((l,d)=>d(l),s());return e=Km(h),r=e.cache.get,n=e.cache.set,i=a,a(c)}function a(c){const h=r(c);if(h)return h;const l=Qm(c,e);return n(c,l),l}return function(){return i(Jm.apply(null,arguments))}}const ht=s=>{const t=e=>e[s]||[];return t.isThemeGetter=!0,t},Lc=/^\[(?:(\w[\w-]*):)?(.+)\]$/i,zc=/^\((?:(\w[\w-]*):)?(.+)\)$/i,eg=/^\d+\/\d+$/,sg=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,rg=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,ng=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,ig=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,og=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,Ge=s=>eg.test(s),j=s=>!!s&&!Number.isNaN(Number(s)),ue=s=>!!s&&Number.isInteger(Number(s)),Kr=s=>s.endsWith("%")&&j(s.slice(0,-1)),ee=s=>sg.test(s),ag=()=>!0,cg=s=>rg.test(s)&&!ng.test(s),Gc=()=>!1,lg=s=>ig.test(s),hg=s=>og.test(s),dg=s=>!L(s)&&!z(s),ug=s=>Ze(s,Uc,Gc),L=s=>Lc.test(s),Ae=s=>Ze(s,Dc,cg),Zr=s=>Ze(s,xg,j),Io=s=>Ze(s,Nc,Gc),fg=s=>Ze(s,Oc,hg),Os=s=>Ze(s,Hc,lg),z=s=>zc.test(s),ns=s=>Qe(s,Dc),pg=s=>Qe(s,yg),Bo=s=>Qe(s,Nc),mg=s=>Qe(s,Uc),gg=s=>Qe(s,Oc),Us=s=>Qe(s,Hc,!0),Ze=(s,t,e)=>{const r=Lc.exec(s);return r?r[1]?t(r[1]):e(r[2]):!1},Qe=(s,t,e=!1)=>{const r=zc.exec(s);return r?r[1]?t(r[1]):e:!1},Nc=s=>s==="position"||s==="percentage",Oc=s=>s==="image"||s==="url",Uc=s=>s==="length"||s==="size"||s==="bg-size",Dc=s=>s==="length",xg=s=>s==="number",yg=s=>s==="family-name",Hc=s=>s==="shadow",bg=()=>{const s=ht("color"),t=ht("font"),e=ht("text"),r=ht("font-weight"),n=ht("tracking"),i=ht("leading"),o=ht("breakpoint"),a=ht("container"),c=ht("spacing"),h=ht("radius"),l=ht("shadow"),d=ht("inset-shadow"),f=ht("text-shadow"),u=ht("drop-shadow"),p=ht("blur"),g=ht("perspective"),m=ht("aspect"),x=ht("ease"),y=ht("animate"),b=()=>["auto","avoid","all","avoid-page","page","left","right","column"],w=()=>["center","top","bottom","left","right","top-left","left-top","top-right","right-top","bottom-right","right-bottom","bottom-left","left-bottom"],v=()=>[...w(),z,L],S=()=>["auto","hidden","clip","visible","scroll"],k=()=>["auto","contain","none"],P=()=>[z,L,c],_=()=>[Ge,"full","auto",...P()],C=()=>[ue,"none","subgrid",z,L],A=()=>["auto",{span:["full",ue,z,L]},ue,z,L],M=()=>[ue,"auto",z,L],E=()=>["auto","min","max","fr",z,L],F=()=>["start","end","center","between","around","evenly","stretch","baseline","center-safe","end-safe"],R=()=>["start","end","center","stretch","center-safe","end-safe"],T=()=>["auto",...P()],I=()=>[Ge,"auto","full","dvw","dvh","lvw","lvh","svw","svh","min","max","fit",...P()],B=()=>[s,z,L],D=()=>[...w(),Bo,Io,{position:[z,L]}],W=()=>["no-repeat",{repeat:["","x","y","space","round"]}],U=()=>["auto","cover","contain",mg,ug,{size:[z,L]}],Z=()=>[Kr,ns,Ae],H=()=>["","none","full",h,z,L],K=()=>["",j,ns,Ae],V=()=>["solid","dashed","dotted","double"],et=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],J=()=>[j,Kr,Bo,Io],Mt=()=>["","none",p,z,L],ft=()=>["none",j,z,L],St=()=>["none",j,z,L],bt=()=>[j,z,L],Tt=()=>[Ge,"full",...P()];return{cacheSize:500,theme:{animate:["spin","ping","pulse","bounce"],aspect:["video"],blur:[ee],breakpoint:[ee],color:[ag],container:[ee],"drop-shadow":[ee],ease:["in","out","in-out"],font:[dg],"font-weight":["thin","extralight","light","normal","medium","semibold","bold","extrabold","black"],"inset-shadow":[ee],leading:["none","tight","snug","normal","relaxed","loose"],perspective:["dramatic","near","normal","midrange","distant","none"],radius:[ee],shadow:[ee],spacing:["px",j],text:[ee],"text-shadow":[ee],tracking:["tighter","tight","normal","wide","wider","widest"]},classGroups:{aspect:[{aspect:["auto","square",Ge,L,z,m]}],container:["container"],columns:[{columns:[j,L,z,a]}],"break-after":[{"break-after":b()}],"break-before":[{"break-before":b()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],sr:["sr-only","not-sr-only"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:v()}],overflow:[{overflow:S()}],"overflow-x":[{"overflow-x":S()}],"overflow-y":[{"overflow-y":S()}],overscroll:[{overscroll:k()}],"overscroll-x":[{"overscroll-x":k()}],"overscroll-y":[{"overscroll-y":k()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:_()}],"inset-x":[{"inset-x":_()}],"inset-y":[{"inset-y":_()}],start:[{start:_()}],end:[{end:_()}],top:[{top:_()}],right:[{right:_()}],bottom:[{bottom:_()}],left:[{left:_()}],visibility:["visible","invisible","collapse"],z:[{z:[ue,"auto",z,L]}],basis:[{basis:[Ge,"full","auto",a,...P()]}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["nowrap","wrap","wrap-reverse"]}],flex:[{flex:[j,Ge,"auto","initial","none",L]}],grow:[{grow:["",j,z,L]}],shrink:[{shrink:["",j,z,L]}],order:[{order:[ue,"first","last","none",z,L]}],"grid-cols":[{"grid-cols":C()}],"col-start-end":[{col:A()}],"col-start":[{"col-start":M()}],"col-end":[{"col-end":M()}],"grid-rows":[{"grid-rows":C()}],"row-start-end":[{row:A()}],"row-start":[{"row-start":M()}],"row-end":[{"row-end":M()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":E()}],"auto-rows":[{"auto-rows":E()}],gap:[{gap:P()}],"gap-x":[{"gap-x":P()}],"gap-y":[{"gap-y":P()}],"justify-content":[{justify:[...F(),"normal"]}],"justify-items":[{"justify-items":[...R(),"normal"]}],"justify-self":[{"justify-self":["auto",...R()]}],"align-content":[{content:["normal",...F()]}],"align-items":[{items:[...R(),{baseline:["","last"]}]}],"align-self":[{self:["auto",...R(),{baseline:["","last"]}]}],"place-content":[{"place-content":F()}],"place-items":[{"place-items":[...R(),"baseline"]}],"place-self":[{"place-self":["auto",...R()]}],p:[{p:P()}],px:[{px:P()}],py:[{py:P()}],ps:[{ps:P()}],pe:[{pe:P()}],pt:[{pt:P()}],pr:[{pr:P()}],pb:[{pb:P()}],pl:[{pl:P()}],m:[{m:T()}],mx:[{mx:T()}],my:[{my:T()}],ms:[{ms:T()}],me:[{me:T()}],mt:[{mt:T()}],mr:[{mr:T()}],mb:[{mb:T()}],ml:[{ml:T()}],"space-x":[{"space-x":P()}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":P()}],"space-y-reverse":["space-y-reverse"],size:[{size:I()}],w:[{w:[a,"screen",...I()]}],"min-w":[{"min-w":[a,"screen","none",...I()]}],"max-w":[{"max-w":[a,"screen","none","prose",{screen:[o]},...I()]}],h:[{h:["screen","lh",...I()]}],"min-h":[{"min-h":["screen","lh","none",...I()]}],"max-h":[{"max-h":["screen","lh",...I()]}],"font-size":[{text:["base",e,ns,Ae]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:[r,z,Zr]}],"font-stretch":[{"font-stretch":["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded",Kr,L]}],"font-family":[{font:[pg,L,t]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:[n,z,L]}],"line-clamp":[{"line-clamp":[j,"none",z,Zr]}],leading:[{leading:[i,...P()]}],"list-image":[{"list-image":["none",z,L]}],"list-style-position":[{list:["inside","outside"]}],"list-style-type":[{list:["disc","decimal","none",z,L]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"placeholder-color":[{placeholder:B()}],"text-color":[{text:B()}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...V(),"wavy"]}],"text-decoration-thickness":[{decoration:[j,"from-font","auto",z,Ae]}],"text-decoration-color":[{decoration:B()}],"underline-offset":[{"underline-offset":[j,"auto",z,L]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:P()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",z,L]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],wrap:[{wrap:["break-word","anywhere","normal"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",z,L]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:D()}],"bg-repeat":[{bg:W()}],"bg-size":[{bg:U()}],"bg-image":[{bg:["none",{linear:[{to:["t","tr","r","br","b","bl","l","tl"]},ue,z,L],radial:["",z,L],conic:[ue,z,L]},gg,fg]}],"bg-color":[{bg:B()}],"gradient-from-pos":[{from:Z()}],"gradient-via-pos":[{via:Z()}],"gradient-to-pos":[{to:Z()}],"gradient-from":[{from:B()}],"gradient-via":[{via:B()}],"gradient-to":[{to:B()}],rounded:[{rounded:H()}],"rounded-s":[{"rounded-s":H()}],"rounded-e":[{"rounded-e":H()}],"rounded-t":[{"rounded-t":H()}],"rounded-r":[{"rounded-r":H()}],"rounded-b":[{"rounded-b":H()}],"rounded-l":[{"rounded-l":H()}],"rounded-ss":[{"rounded-ss":H()}],"rounded-se":[{"rounded-se":H()}],"rounded-ee":[{"rounded-ee":H()}],"rounded-es":[{"rounded-es":H()}],"rounded-tl":[{"rounded-tl":H()}],"rounded-tr":[{"rounded-tr":H()}],"rounded-br":[{"rounded-br":H()}],"rounded-bl":[{"rounded-bl":H()}],"border-w":[{border:K()}],"border-w-x":[{"border-x":K()}],"border-w-y":[{"border-y":K()}],"border-w-s":[{"border-s":K()}],"border-w-e":[{"border-e":K()}],"border-w-t":[{"border-t":K()}],"border-w-r":[{"border-r":K()}],"border-w-b":[{"border-b":K()}],"border-w-l":[{"border-l":K()}],"divide-x":[{"divide-x":K()}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":K()}],"divide-y-reverse":["divide-y-reverse"],"border-style":[{border:[...V(),"hidden","none"]}],"divide-style":[{divide:[...V(),"hidden","none"]}],"border-color":[{border:B()}],"border-color-x":[{"border-x":B()}],"border-color-y":[{"border-y":B()}],"border-color-s":[{"border-s":B()}],"border-color-e":[{"border-e":B()}],"border-color-t":[{"border-t":B()}],"border-color-r":[{"border-r":B()}],"border-color-b":[{"border-b":B()}],"border-color-l":[{"border-l":B()}],"divide-color":[{divide:B()}],"outline-style":[{outline:[...V(),"none","hidden"]}],"outline-offset":[{"outline-offset":[j,z,L]}],"outline-w":[{outline:["",j,ns,Ae]}],"outline-color":[{outline:B()}],shadow:[{shadow:["","none",l,Us,Os]}],"shadow-color":[{shadow:B()}],"inset-shadow":[{"inset-shadow":["none",d,Us,Os]}],"inset-shadow-color":[{"inset-shadow":B()}],"ring-w":[{ring:K()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:B()}],"ring-offset-w":[{"ring-offset":[j,Ae]}],"ring-offset-color":[{"ring-offset":B()}],"inset-ring-w":[{"inset-ring":K()}],"inset-ring-color":[{"inset-ring":B()}],"text-shadow":[{"text-shadow":["none",f,Us,Os]}],"text-shadow-color":[{"text-shadow":B()}],opacity:[{opacity:[j,z,L]}],"mix-blend":[{"mix-blend":[...et(),"plus-darker","plus-lighter"]}],"bg-blend":[{"bg-blend":et()}],"mask-clip":[{"mask-clip":["border","padding","content","fill","stroke","view"]},"mask-no-clip"],"mask-composite":[{mask:["add","subtract","intersect","exclude"]}],"mask-image-linear-pos":[{"mask-linear":[j]}],"mask-image-linear-from-pos":[{"mask-linear-from":J()}],"mask-image-linear-to-pos":[{"mask-linear-to":J()}],"mask-image-linear-from-color":[{"mask-linear-from":B()}],"mask-image-linear-to-color":[{"mask-linear-to":B()}],"mask-image-t-from-pos":[{"mask-t-from":J()}],"mask-image-t-to-pos":[{"mask-t-to":J()}],"mask-image-t-from-color":[{"mask-t-from":B()}],"mask-image-t-to-color":[{"mask-t-to":B()}],"mask-image-r-from-pos":[{"mask-r-from":J()}],"mask-image-r-to-pos":[{"mask-r-to":J()}],"mask-image-r-from-color":[{"mask-r-from":B()}],"mask-image-r-to-color":[{"mask-r-to":B()}],"mask-image-b-from-pos":[{"mask-b-from":J()}],"mask-image-b-to-pos":[{"mask-b-to":J()}],"mask-image-b-from-color":[{"mask-b-from":B()}],"mask-image-b-to-color":[{"mask-b-to":B()}],"mask-image-l-from-pos":[{"mask-l-from":J()}],"mask-image-l-to-pos":[{"mask-l-to":J()}],"mask-image-l-from-color":[{"mask-l-from":B()}],"mask-image-l-to-color":[{"mask-l-to":B()}],"mask-image-x-from-pos":[{"mask-x-from":J()}],"mask-image-x-to-pos":[{"mask-x-to":J()}],"mask-image-x-from-color":[{"mask-x-from":B()}],"mask-image-x-to-color":[{"mask-x-to":B()}],"mask-image-y-from-pos":[{"mask-y-from":J()}],"mask-image-y-to-pos":[{"mask-y-to":J()}],"mask-image-y-from-color":[{"mask-y-from":B()}],"mask-image-y-to-color":[{"mask-y-to":B()}],"mask-image-radial":[{"mask-radial":[z,L]}],"mask-image-radial-from-pos":[{"mask-radial-from":J()}],"mask-image-radial-to-pos":[{"mask-radial-to":J()}],"mask-image-radial-from-color":[{"mask-radial-from":B()}],"mask-image-radial-to-color":[{"mask-radial-to":B()}],"mask-image-radial-shape":[{"mask-radial":["circle","ellipse"]}],"mask-image-radial-size":[{"mask-radial":[{closest:["side","corner"],farthest:["side","corner"]}]}],"mask-image-radial-pos":[{"mask-radial-at":w()}],"mask-image-conic-pos":[{"mask-conic":[j]}],"mask-image-conic-from-pos":[{"mask-conic-from":J()}],"mask-image-conic-to-pos":[{"mask-conic-to":J()}],"mask-image-conic-from-color":[{"mask-conic-from":B()}],"mask-image-conic-to-color":[{"mask-conic-to":B()}],"mask-mode":[{mask:["alpha","luminance","match"]}],"mask-origin":[{"mask-origin":["border","padding","content","fill","stroke","view"]}],"mask-position":[{mask:D()}],"mask-repeat":[{mask:W()}],"mask-size":[{mask:U()}],"mask-type":[{"mask-type":["alpha","luminance"]}],"mask-image":[{mask:["none",z,L]}],filter:[{filter:["","none",z,L]}],blur:[{blur:Mt()}],brightness:[{brightness:[j,z,L]}],contrast:[{contrast:[j,z,L]}],"drop-shadow":[{"drop-shadow":["","none",u,Us,Os]}],"drop-shadow-color":[{"drop-shadow":B()}],grayscale:[{grayscale:["",j,z,L]}],"hue-rotate":[{"hue-rotate":[j,z,L]}],invert:[{invert:["",j,z,L]}],saturate:[{saturate:[j,z,L]}],sepia:[{sepia:["",j,z,L]}],"backdrop-filter":[{"backdrop-filter":["","none",z,L]}],"backdrop-blur":[{"backdrop-blur":Mt()}],"backdrop-brightness":[{"backdrop-brightness":[j,z,L]}],"backdrop-contrast":[{"backdrop-contrast":[j,z,L]}],"backdrop-grayscale":[{"backdrop-grayscale":["",j,z,L]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[j,z,L]}],"backdrop-invert":[{"backdrop-invert":["",j,z,L]}],"backdrop-opacity":[{"backdrop-opacity":[j,z,L]}],"backdrop-saturate":[{"backdrop-saturate":[j,z,L]}],"backdrop-sepia":[{"backdrop-sepia":["",j,z,L]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":P()}],"border-spacing-x":[{"border-spacing-x":P()}],"border-spacing-y":[{"border-spacing-y":P()}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["","all","colors","opacity","shadow","transform","none",z,L]}],"transition-behavior":[{transition:["normal","discrete"]}],duration:[{duration:[j,"initial",z,L]}],ease:[{ease:["linear","initial",x,z,L]}],delay:[{delay:[j,z,L]}],animate:[{animate:["none",y,z,L]}],backface:[{backface:["hidden","visible"]}],perspective:[{perspective:[g,z,L]}],"perspective-origin":[{"perspective-origin":v()}],rotate:[{rotate:ft()}],"rotate-x":[{"rotate-x":ft()}],"rotate-y":[{"rotate-y":ft()}],"rotate-z":[{"rotate-z":ft()}],scale:[{scale:St()}],"scale-x":[{"scale-x":St()}],"scale-y":[{"scale-y":St()}],"scale-z":[{"scale-z":St()}],"scale-3d":["scale-3d"],skew:[{skew:bt()}],"skew-x":[{"skew-x":bt()}],"skew-y":[{"skew-y":bt()}],transform:[{transform:[z,L,"","none","gpu","cpu"]}],"transform-origin":[{origin:v()}],"transform-style":[{transform:["3d","flat"]}],translate:[{translate:Tt()}],"translate-x":[{"translate-x":Tt()}],"translate-y":[{"translate-y":Tt()}],"translate-z":[{"translate-z":Tt()}],"translate-none":["translate-none"],accent:[{accent:B()}],appearance:[{appearance:["none","auto"]}],"caret-color":[{caret:B()}],"color-scheme":[{scheme:["normal","dark","light","light-dark","only-dark","only-light"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",z,L]}],"field-sizing":[{"field-sizing":["fixed","content"]}],"pointer-events":[{"pointer-events":["auto","none"]}],resize:[{resize:["none","","y","x"]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":P()}],"scroll-mx":[{"scroll-mx":P()}],"scroll-my":[{"scroll-my":P()}],"scroll-ms":[{"scroll-ms":P()}],"scroll-me":[{"scroll-me":P()}],"scroll-mt":[{"scroll-mt":P()}],"scroll-mr":[{"scroll-mr":P()}],"scroll-mb":[{"scroll-mb":P()}],"scroll-ml":[{"scroll-ml":P()}],"scroll-p":[{"scroll-p":P()}],"scroll-px":[{"scroll-px":P()}],"scroll-py":[{"scroll-py":P()}],"scroll-ps":[{"scroll-ps":P()}],"scroll-pe":[{"scroll-pe":P()}],"scroll-pt":[{"scroll-pt":P()}],"scroll-pr":[{"scroll-pr":P()}],"scroll-pb":[{"scroll-pb":P()}],"scroll-pl":[{"scroll-pl":P()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",z,L]}],fill:[{fill:["none",...B()]}],"stroke-w":[{stroke:[j,ns,Ae,Zr]}],stroke:[{stroke:["none",...B()]}],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-x","border-w-y","border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-x","border-color-y","border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],translate:["translate-x","translate-y","translate-none"],"translate-none":["translate","translate-x","translate-y","translate-z"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]},orderSensitiveModifiers:["*","**","after","backdrop","before","details-content","file","first-letter","first-line","marker","placeholder","selection"]}},wg=tg(bg);function Wc(...s){return wg(Um(s))}function Ig({}){return[{title:"Canvas Games"},{name:"description",content:"Just here to learn making games with the canvas"}]}const _g=[{id:"slither-slim",title:"Slither Slim",image:"game-imgs/slither-slim/game-img.png",init:Im},{id:"bitcoin-sim",title:"Bitcoin Network Sim",image:"game-imgs/space-game.png",init:ym},{id:"placeholder3",title:"Placeholder",image:"game-imgs/space-game.png",init:Ns},{id:"placeholder4",title:"Placeholder",image:"game-imgs/space-game.png",init:Ns},{id:"placeholder5",title:"Placeholder",image:"game-imgs/space-game.png",init:Ns},{id:"placeholder6",title:"Placeholder",image:"game-imgs/space-game.png",init:Ns}],Bg=Vc(function(){const[t,e]=Yc(),r=t.get("game"),n=Xc();return G.jsxs("div",{className:"mx-auto max-w-[100rem]",children:[G.jsx(vg,{}),G.jsx("div",{id:"about"}),G.jsxs("div",{className:"px-8",children:[G.jsxs("div",{className:"flex items-center mt-[8rem]",children:[G.jsx("img",{className:"mr-5",src:"assets/vr-boy.png",alt:"boy vr headset"}),G.jsx("h1",{className:"font-font md:text-xl sm:text-md font-bold text-white",children:"About"})]}),G.jsx("div",{className:"w-full flex justify-center mt-3",children:G.jsxs("div",{className:"max-w-[50rem] text-gray-200",children:[G.jsx("div",{children:"Welcome! This site is a personal project where I'm collecting and showcasing projects I've built as part of my learning journey. Think of it as my digital playground for exploring game development and various html canvas ideas."}),G.jsx("div",{className:"mt-8",children:"Thanks for stopping by!"})]})})]}),G.jsx("div",{id:"collection"}),G.jsxs("div",{className:"px-8",children:[G.jsxs("div",{className:"flex items-center mt-[8rem]",children:[G.jsx("img",{className:"mr-5",src:"assets/rocket.png",alt:"rocket ship"}),G.jsx("h1",{className:"font-font md:text-xl sm:text-md font-bold text-white",children:"Collection"})]}),G.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-8 mt-8",children:_g.map(i=>G.jsxs("div",{onClick:()=>{r||n(`?game=${i.id}#collection`)},className:Wc("relative overflow-hidden rounded-lg shadow-lg group border-3 border-transparent hover:border-sky-400 transition",{"cursor-pointer":!r}),children:[G.jsx("img",{src:i.image,alt:i.title,className:"w-full h-full object-cover opacity-70 group-hover:opacity-100 transition"}),G.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:G.jsx("span",{className:"text-white text-xl font-bold bg-black/40 px-4 py-2 rounded",children:i.title})}),G.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-4",children:[G.jsx(Ag,{title:"Example Game",onClick:()=>e({game:i.id})},i.id),r===i.id&&G.jsx(Sg,{createGame:i.init,onClose:()=>{location.hash.includes("collection")?n("#collection"):e("")}})]})]},i.id))})]}),G.jsx("div",{className:"my-14",children:G.jsx("img",{src:"assets/earth-large.png",alt:"Large Earth",className:"mx-auto md:w-[35rem] w-[20rem]"})}),G.jsx(Cg,{})]})});function vg(){return G.jsxs("div",{children:[G.jsx("div",{id:"home"}),G.jsx("div",{className:"bg-gray-800 py-6 rounded-b-lg",children:G.jsxs("div",{className:"grid grid-cols-2 px-8",children:[G.jsxs("div",{className:"flex items-center col-start-1",children:[G.jsx("img",{className:"mr-5 w-8 h-8",src:"assets/pixel-earth.png",alt:"pixel earth"}),G.jsx("h1",{className:"font-font md:text-xl sm:text-md font-bold sm:block hidden text-white",children:"Canvas Game"})]}),G.jsxs("div",{className:"flex justify-end items-center col-start-2 sm:space-x-8 space-x-4 font-font md:text-md text-sm font-bold",children:[G.jsx("a",{href:"#home",className:"text-gray-300 hover:text-white",children:"Home"}),G.jsx("a",{href:"#about",className:"text-gray-300 hover:text-white",children:"About"}),G.jsx("a",{href:"#collection",className:"text-gray-300 hover:text-white",children:"Collection"})]})]})})]})}function Ag({title:s,onClick:t}){return G.jsx("div",{onClick:t,className:"p-4 bg-gray-800 shadow rounded hover:scale-105 transition",children:G.jsx("h2",{className:"text-lg font-semibold",children:s})})}function Sg({createGame:s,onClose:t}){const e=se.useRef(null),r=se.useRef(null),n=se.useRef(null),[i,o]=se.useState({width:window.innerWidth,height:window.innerHeight}),a=window.innerWidth<768||Fo();se.useEffect(()=>{const d=()=>{o({width:window.innerWidth,height:window.innerHeight}),window.dispatchEvent(new CustomEvent("windowResize"))};return window.addEventListener("resize",d),()=>window.removeEventListener("resize",d)},[]),se.useEffect(()=>((async()=>{if(!e.current)return;const f=new Ia;await f.init({resizeTo:e.current,backgroundColor:"#000000",antialias:!0,autoDensity:!0}),e.current&&(e.current.innerHTML="",e.current.appendChild(f.canvas)),n.current=f,s(f)})(),()=>{n.current&&(n.current.destroy(!0),n.current=null)}),[s,Fo]);const c=()=>{var d;document.fullscreenElement?document.exitFullscreen():(d=r.current)==null||d.requestFullscreen()},{isFullscreen:h}=kg();Pg();const l=i.height*(16/9);return G.jsxs("div",{ref:r,className:"fixed inset-0 flex items-center justify-center z-50",children:[G.jsx("div",{className:"absolute inset-0 bg-black/40 backdrop-blur-sm",onClick:t}),G.jsxs("div",{style:{maxWidth:h?`${l}px`:void 0},className:Wc("aspect-[16/9] relative bg-gray-800 z-10 w-[90vw] max-w-[1920px] rounded-lg shadow-lg",{"w-full max-w-full":h}),children:[!h&&G.jsx("div",{children:G.jsx("button",{onClick:c,title:"Toggle Fullscreen",className:"absolute bottom-2 right-3 text-gray-400 hover:text-gray-700 text-4xl cursor-pointer",children:"⛶"})}),a&&G.jsx("div",{className:"w-full h-full flex items-center justify-center bg-gray-800 text-white text-center p-4 rounded",children:G.jsx("p",{className:"text-lg font-medium",children:"Uh oh... looks like you're on mobile. Only can play the games on a desktop for now."})}),!a&&G.jsx("div",{ref:e,className:"w-full h-full overflow-hidden rounded"})]})]})}function Cg(){return G.jsxs("footer",{className:"bg-gray-800 text-gray-300 mt-20 w-full rounded-t-lg",children:[G.jsxs("div",{className:"max-w-screen-xl mx-auto px-6 py-10 grid grid-cols-1 md:grid-cols-3 gap-10",children:[G.jsxs("div",{children:[G.jsx("div",{className:"flex items-center space-x-3",children:G.jsx("span",{className:"text-xl font-bold text-white",children:"Canvas Games"})}),G.jsx("p",{className:"mt-4 text-sm text-gray-400",children:"A collection of experimental HTML canvas games built with curiosity and a bit of pixel dust."})]}),G.jsxs("div",{className:"md:col-start-3 md:text-right",children:[G.jsx("h3",{className:"text-white text-lg font-semibold mb-4",children:"Follow Me"}),G.jsxs("div",{className:"flex md:justify-end space-x-4",children:[G.jsx("a",{href:"https://github.com",target:"_blank",rel:"noopener noreferrer",className:"hover:text-white",children:"GitHub"}),G.jsx("a",{href:"https://twitter.com",target:"_blank",rel:"noopener noreferrer",className:"hover:text-white",children:"Twitter"}),G.jsx("a",{href:"https://linkedin.com",target:"_blank",rel:"noopener noreferrer",className:"hover:text-white",children:"LinkedIn"})]})]})]}),G.jsxs("div",{className:"border-t border-gray-700 text-center text-sm py-4 text-gray-500 pb-5",children:["© ",new Date().getFullYear()," Paul Q. Peters"]})]})}function kg(){const[s,t]=se.useState(!1);return se.useEffect(()=>{const e=()=>{t(!!document.fullscreenElement)};return document.addEventListener("fullscreenchange",e),document.addEventListener("webkitfullscreenchange",e),document.addEventListener("mozfullscreenchange",e),document.addEventListener("MSFullscreenChange",e),t(!!document.fullscreenElement),()=>{document.removeEventListener("fullscreenchange",e),document.removeEventListener("webkitfullscreenchange",e),document.removeEventListener("mozfullscreenchange",e),document.removeEventListener("MSFullscreenChange",e)}},[]),{isFullscreen:s}}function Pg(){se.useEffect(()=>{const s=t=>{["ArrowUp","ArrowDown"," "].includes(t.key)&&t.preventDefault()};return window.addEventListener("keydown",s,{passive:!1}),()=>{window.removeEventListener("keydown",s)}},[])}function Fo(){return/Mobi|Android|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)}export{Y as $,Pa as A,_t as B,ut as C,at as D,O as E,Ul as F,ir as G,di as H,Gt as I,hh as J,bh as K,ct as L,X as M,q as N,Gh as O,mt as P,fi as Q,an as R,ed as S,Dt as T,$s as U,wr as V,pi as W,Wl as X,lt as Y,qo as Z,Ma as _,Wt as a,Q as a0,Hh as a1,dd as a2,nd as a3,Ed as a4,Bd as a5,Gd as a6,Od as a7,Ud as a8,At as a9,Wa as aa,Ei as ab,Mi as ac,He as ad,eo as ae,qt as af,Wu as ag,it as ah,tt as ai,hl as aj,uo as ak,Va as al,Ig as am,Bg as an,bs as b,Ws as c,Tn as d,pt as e,Ti as f,Qh as g,Sa as h,ia as i,jt as j,ba as k,qs as l,Td as m,Id as n,Ld as o,Nd as p,En as q,Al as r,$ as s,ma as t,ll as u,Hd as v,ot as w,oe as x,Vo as y,Ht as z};
